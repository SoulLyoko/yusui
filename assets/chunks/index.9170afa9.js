import{l as w}from"./index.6700b933.js";import{C as y,j as E,d as k,g as M,H as U,z as v,a5 as m,h as A,E as b}from"./framework.6b67ac47.js";import"./state-local.dd516420.js";var B=Object.defineProperty,F=Object.defineProperties,q=Object.getOwnPropertyDescriptors,$=Object.getOwnPropertySymbols,G=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable,j=(e,t,a)=>t in e?B(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,O=(e,t)=>{for(var a in t||(t={}))G.call(t,a)&&j(e,a,t[a]);if($)for(var a of $(t))J.call(t,a)&&j(e,a,t[a]);return e},K=(e,t)=>F(e,q(t));const P={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}};function T(e,t){const a=M(()=>{const{width:r,height:d}=e;return K(O({},P.wrapper),{width:r,height:d})}),l=M(()=>O(O({},P.fullWidth),!t.value&&P.hide));return{wrapperStyle:a,containerStyle:l}}function H(){const e=y(w.__getMonacoInstance());let t;return E(()=>{e.value||(t=w.init(),t.then(l=>e.value=l).catch(l=>{(l==null?void 0:l.type)!=="cancelation"&&console.error("Monaco initialization error:",l)}))}),{monacoRef:e,unload:()=>t==null?void 0:t.cancel()}}function z(e){return typeof e=="function"?e():e}function Q(e){return e===void 0}function h(e,t,a,l){return X(e,l)||Y(e,t,a,l)}function X(e,t){return e.editor.getModel(W(e,t))}function Y(e,t,a,l){return e.editor.createModel(t,a,l?W(e,l):void 0)}function W(e,t){return e.Uri.parse(t)}var Z=Object.defineProperty,x=Object.getOwnPropertySymbols,R=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable,C=(e,t,a)=>t in e?Z(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,te=(e,t)=>{for(var a in t||(t={}))R.call(t,a)&&C(e,a,t[a]);if(x)for(var a of x(t))ee.call(t,a)&&C(e,a,t[a]);return e};const ae={display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"};var D=k({name:"VueMonacoEditor",model:{prop:"value",event:"update:value"},props:{defaultValue:String,defaultPath:String,defaultLanguage:String,value:String,language:String,path:String,theme:{type:String,default:"vs"},line:Number,options:{type:Object,default:()=>({})},overrideServices:{type:Object,default:()=>({})},saveViewState:{type:Boolean,default:!0},width:{type:[Number,String],default:"100%"},height:{type:[Number,String],default:"100%"},className:String},emits:["update:value","beforeMount","mount","change","validate"],setup(e,t){const a=new Map,l=y(null),{monacoRef:r,unload:d}=H(),{editorRef:i}=le(t,e,r,l),{disposeValidator:s}=ie(t,e,r,i),g=M(()=>!!r.value&&!!i.value),{wrapperStyle:n,containerStyle:o}=T(e,g);return U(()=>{var u,f;(u=s.value)==null||u.call(s),i.value?((f=i.value.getModel())==null||f.dispose(),i.value.dispose()):d()}),v(()=>e.path,(u,f)=>{const c=h(r.value,e.value||e.defaultValue||"",e.language||e.defaultLanguage||"",u||e.defaultPath||"");c!==i.value.getModel()&&(e.saveViewState&&a.set(f,i.value.saveViewState()),i.value.setModel(c),e.saveViewState&&i.value.restoreViewState(a.get(u)))}),v(()=>e.value,u=>{i.value&&i.value.getValue()!==u&&i.value.setValue(u)}),v(()=>e.options,u=>i.value&&i.value.updateOptions(u),{deep:!0}),v(()=>e.theme,u=>r.value&&r.value.editor.setTheme(u)),v(()=>e.language,u=>g.value&&r.value.editor.setModelLanguage(i.value.getModel(),u)),v(()=>e.line,u=>{i.value&&!Q(u)&&i.value.revealLine(u)}),{containerRef:l,isEditorReady:g,wrapperStyle:n,containerStyle:o}},render(){const{$slots:e,isEditorReady:t,wrapperStyle:a,containerStyle:l,className:r}=this;return m("div",{style:a},[!t&&m("div",{style:ae},e.default?z(e.default):"loading..."),m("div",{ref:"containerRef",key:"monaco_editor_container",style:l,class:r})])}});function le({emit:e},t,a,l){const r=y(null);E(()=>{const i=v(a,()=>{l.value&&a.value&&(b(()=>i()),d())},{immediate:!0})});function d(){var i;if(!l.value||!a.value||r.value)return;e("beforeMount",a.value);const s=t.path||t.defaultPath,g=h(a.value,t.value||t.defaultValue||"",t.language||t.defaultLanguage||"",s||"");r.value=a.value.editor.create(l.value,te({model:g,theme:t.theme,automaticLayout:!0,autoIndent:"brackets",formatOnPaste:!0,formatOnType:!0},t.options),t.overrideServices),(i=r.value)==null||i.onDidChangeModelContent(n=>{const o=r.value.getValue();o!==t.value&&(e("update:value",o),e("change",o,n))}),e("mount",r.value,a.value)}return{editorRef:r}}function ie({emit:e},t,a,l){const r=A(null),d=v([a,l],()=>{if(a.value&&l.value){b(()=>d());const i=a.value.editor.onDidChangeMarkers(s=>{var g,n;const o=(n=(g=l.value)==null?void 0:g.getModel())==null?void 0:n.uri;if(o&&s.find(f=>f.path===o.path)){const f=a.value.editor.getModelMarkers({resource:o});e("validate",f)}});r.value=()=>i==null?void 0:i.dispose()}});return{disposeValidator:r}}var ne=Object.defineProperty,N=Object.getOwnPropertySymbols,re=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable,p=(e,t,a)=>t in e?ne(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,ue=(e,t)=>{for(var a in t||(t={}))re.call(t,a)&&p(e,a,t[a]);if(N)for(var a of N(t))oe.call(t,a)&&p(e,a,t[a]);return e};const de={display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"};var I=k({name:"VueMonacoDiffEditor",props:{original:String,modified:String,language:String,originalLanguage:String,modifiedLanguage:String,originalModelPath:String,modifiedModelPath:String,theme:{type:String,default:"vs"},options:{type:Object,default:()=>({})},width:{type:[Number,String],default:"100%"},height:{type:[Number,String],default:"100%"},className:String},setup(e,t){const a=y(null),{monacoRef:l,unload:r}=H(),{diffEditorRef:d}=ve(t,e,l,a),i=M(()=>!!l.value&&!!d.value),{wrapperStyle:s,containerStyle:g}=T(e,i);return U(()=>{var n,o,u,f,c,V,S,L;!l.value&&r();const _=(o=(n=d.value)==null?void 0:n.getModel)==null?void 0:o.call(n);(f=(u=_==null?void 0:_.original)==null?void 0:u.dispose)==null||f.call(u),(V=(c=_==null?void 0:_.modified)==null?void 0:c.dispose)==null||V.call(c),(L=(S=d.value)==null?void 0:S.dispose)==null||L.call(S)}),v(()=>e.originalModelPath,()=>{if(!l.value||!d.value)return;const n=d.value.getOriginalEditor(),o=h(l.value,e.original||"",e.originalLanguage||e.language||"text",e.originalModelPath||"");o!==n.getModel()&&n.setModel(o)}),v(()=>e.modifiedModelPath,()=>{if(!l.value||!d.value)return;const n=d.value.getModifiedEditor(),o=h(l.value,e.modified||"",e.modifiedLanguage||e.language||"text",e.modifiedModelPath||"");o!==n.getModel()&&n.setModel(o)}),v(()=>e.modified,()=>{if(!i.value)return;const n=d.value.getModifiedEditor();n.getOption(l.value.editor.EditorOption.readOnly)?n.setValue(e.modified||""):e.modified!==n.getValue()&&(n.executeEdits("",[{range:n.getModel().getFullModelRange(),text:e.modified||"",forceMoveMarkers:!0}]),n.pushUndoStop())}),v(()=>e.original,()=>{var n,o;(o=(n=d.value)==null?void 0:n.getModel())==null||o.original.setValue((e==null?void 0:e.original)||"")}),v(()=>[e.language,e.originalLanguage,e.modifiedLanguage],()=>{if(!i.value)return;const{original:n,modified:o}=d.value.getModel();l.value.editor.setModelLanguage(n,e.originalLanguage||e.language||"text"),l.value.editor.setModelLanguage(o,e.originalLanguage||e.language||"text")}),v(()=>e.theme,()=>{var n;return(n=l.value)==null?void 0:n.editor.setTheme(e.theme)}),v(()=>e.options,()=>{var n;return(n=d.value)==null?void 0:n.updateOptions(e.options)},{deep:!0}),{containerRef:a,isDiffEditorReady:i,wrapperStyle:s,containerStyle:g}},render(){const{$slots:e,isDiffEditorReady:t,wrapperStyle:a,containerStyle:l,className:r}=this;return m("div",{style:a},[!t&&m("div",{style:de},e.default?z(e.default):"loading..."),m("div",{ref:"containerRef",key:"monaco_diff_editor_container",style:l,class:r})])}});function ve({emit:e},t,a,l){const r=y(null);E(()=>{const i=v(a,()=>{l.value&&a.value&&(b(()=>i()),d())},{immediate:!0})});function d(){var i;if(!l.value||!a.value||r.value)return;e("beforeMount",a.value),r.value=a.value.editor.createDiffEditor(l.value,ue({automaticLayout:!0,autoIndent:"brackets",theme:t.theme,formatOnPaste:!0,formatOnType:!0},t.options));const s=h(a.value,t.original||"",t.originalLanguage||t.language||"text",t.originalModelPath||""),g=h(a.value,t.modified||"",t.modifiedLanguage||t.language||"text",t.modifiedModelPath||"");(i=r.value)==null||i.setModel({original:s,modified:g}),e("mount",r.value,a.value)}return{diffEditorRef:r}}function ce(e,t){t&&w.config(t),e.component(D.name,D),e.component(I.name,I)}export{I as DiffEditor,D as Editor,I as VueMonacoDiffEditor,D as VueMonacoEditor,D as default,ce as install,w as loader,H as useMonaco};
