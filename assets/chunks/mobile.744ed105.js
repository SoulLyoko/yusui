import{d as Ee}from"./index.013eb64a.js";import{I as Ce}from"./iconify.924204c7.js";import{a as ue,f as Re,g as Me,w as Ge,h as Je}from"./index.63550f19.js";import{m as Qe,u as We}from"./index.3bec44c8.js";import{e as Ye}from"./index.181284a5.js";import"./form.b5017a1b.js";import"./index.7749527f.js";import"./index.6700b933.js";import{j as He}from"./tree.c7a66f34.js";import"./vuedraggable.umd.9831e9f5.js";import{u as te}from"./index.es.1accc3d3.js";import{e as J}from"./index.0246ace1.js";import{ab as Ie,g as j,h as B,A as ae,l as y,E as de,$ as Xe,S as Ze,Y as Fe,d as W,J as x,c as E,L as ee,K as H,o as V,b as O,w as T,e as R,a as M,t as G,N as S,B as re,a3 as ge,k as F,R as Ve,_ as me,C as qe,U as et,O as Te,a5 as tt,D as at,a9 as ot,aa as lt}from"./framework.6b67ac47.js";import{p as nt}from"./pick.3451ca24.js";import{t as Ue,a as st}from"./index.af03a1c8.js";import{E as se}from"./index.6dee874e.js";import{u as xe}from"./index.386fc70b.js";import{d as rt}from"./zipWith.b37739bd.js";import{d as it}from"./data.4983ed38.js";import{g as ne}from"./getTag.0b794599.js";import{c as ut}from"./cloneDeep.707d050f.js";import{m as ct}from"./merge.0f72b880.js";function X(e){const{tableOption:t}=Y();return Ie({...t,...e})}function pt(e){const{buttonHandler:t,request:o}=Y(),{commitTask:c,revokeTask:f,saveDraft:r,startTask:n,terminateTask:d,transferTask:s,withdrawTask:i,rejectTask:v,greenChannel:w}=_e(o),a=j(()=>{const{flowDetail:g,formVariables:A,approvalFormData:m,debug:U,fileIds:$}=e,{flowDeployId:N}=g.value.process??{},{taskId:b,flowInstanceId:u}=g.value.task??{};return{flowDeployId:N,taskId:b,flowInstanceId:u,variables:A.value,debug:U.value,fileIds:$==null?void 0:$.value,...m.value}}),p=()=>a.value.taskId&&a.value.flowInstanceId;return{flow_draft(){if(p())return r(a.value)},flow_pass(){return p()?c(a.value):n(a.value)},flow_revoke(){if(p())return f(a.value)},flow_withdraw(){if(p())return i(a.value)},flow_terminate(){if(p())return d(a.value)},flow_transfer(){if(p())return s(a.value)},flow_reject(){if(p())return v(a.value)},flow_green(){if(p())return w(a.value)},...t==null?void 0:t(e)}}function ke(){const e=Qe();return{emitter:e,onAfterGetDetail:r=>{e.on("afterGetDetail",async(...n)=>await(r==null?void 0:r(...n)))},onBeforeClick:r=>{e.on("beforeClick",async(...n)=>await(r==null?void 0:r(...n)))},onBeforeSubmit:r=>{e.on("beforeSubmit",async(...n)=>await(r==null?void 0:r(...n)))},onAfterSubmit:r=>{e.on("afterSubmit",async(...n)=>await(r==null?void 0:r(...n)))}}}function Le(e,t){e.forEach(o=>{var r,n,d,s,i;const c=t==null?void 0:t.find(v=>v.prop===o.prop);if(!c)return;o.display=c.display,o.disabled=c.disabled,o.detail=c.detail,o.readonly=c.readonly;const f=o.rules??[];c.required&&(f!=null&&f.some(v=>v.required))||(c.required?(r=o.rules)==null||r.push({required:!0,message:`${o.label}为必填项`}):o.rules=f.filter(v=>!v.required),(d=(n=o.children)==null?void 0:n.column)!=null&&d.length&&((s=c.children)!=null&&s.length)&&Le((i=o.children)==null?void 0:i.column,c.children))})}function dt(e){const t=B({});return ae(async()=>{var c;const{formProperty:o}=((c=y(e))==null?void 0:c.properties)||{};o!=null&&o.length&&(await de(),Le(Object.values(t.value),o))}),t}const mt={modelValue:{type:Object,default:()=>({})},title:{type:String},flowDetail:{type:Object,default:()=>({})},formLoading:{type:Boolean},submitLoading:{type:Boolean},activeTab:{type:String,default:"formTab"},activeBtn:{type:Object,default:()=>({})},approvalVisible:{type:Boolean},approvalFormData:{type:Object,default:()=>({})},flowKey:{type:String},taskId:{type:String},instanceId:{type:String},formId:{type:String},fileIds:{type:String},permission:{type:Object},afterGetDetail:{type:Function},beforeClick:{type:Function},beforeSubmit:{type:Function},afterSubmit:{type:Function},detail:{type:[Boolean,String],default:!1},debug:{type:[Boolean,String],default:!1}},ft={complete:e=>e},$e=Symbol("flowFormState");function vt(e,t){const o=ue(e,void 0,{passive:!0,deep:!0}),{flowDetail:c,modelValue:f,formLoading:r,activeTab:n,afterGetDetail:d}=o,{emitter:s}=ke(),{tabs:i,customForm:v,request:w}=Y(),a=B({}),p=j(()=>(i==null?void 0:i.filter(N=>{var k,l,D;const b=(D=(l=(k=c.value)==null?void 0:k.properties)==null?void 0:l.formProperty)==null?void 0:D.find(C=>C.prop===N.prop),u={...N,display:(b==null?void 0:b.display)??N.display};return(u==null?void 0:u.display)!==!1}).map(N=>{var u,k;let b=N.component;if(N.prop==="formTab"){const l=v==null?void 0:v[((k=(u=c==null?void 0:c.value)==null?void 0:u.process)==null?void 0:k.formPath)??""];typeof l=="function"?b=Fe(l):l&&(b=l)}return{...N,component:b}}))??[]),g=B();Q()&&Re(g,{onSwipeEnd(N,b){if(!["left","right"].includes(b))return;const u=p.value.findIndex(l=>l.prop===n.value),k=Me(u+(b==="right"?-1:1),0,p.value.length-1);n.value=p.value[k].prop}});const{getFlowDetail:A}=_e(w);ae(()=>{const{flowKey:N,taskId:b,instanceId:u}=e;!N&&!b&&!u||(r.value=!0,A({flowKey:N,taskId:b,flowInstanceId:u}).then(async k=>{var l;c.value=k.data,f.value=k.data.formData||{},await((l=d==null?void 0:d.value)==null?void 0:l.call(d)),await s.emitAsync("afterGetDetail",k.data)}).finally(()=>{r.value=!1}))});const m=j(()=>Object.entries(f.value||{}).filter(([N])=>!N.startsWith("$")).map(([N,b])=>({key:N,value:b}))),U=j(()=>e.detail===!0||e.detail==="true"),$={...o,...ke(),formData:f,formVariables:m,tabRefs:a,tabList:p,detail:U,tabsRef:g,emit:t};return Xe($e,$),$}function q(){return Ze($e)}const he=W({__name:"button-list",emits:["click"],setup(e,{emit:t}){const{userInfo:o,request:c}=Y(),{flowDetail:f}=q(),{data:r}=Pe(c).useList();function n(s,i){return s.map(v=>{const w=i.find(p=>p.buttonKey===v.buttonKey);return{...v,...nt(w,["display","approval","validate"])}})}const d=j(()=>{var $,N,b,u;const s=typeof o=="function"?o():o,{assignee:i,status:v}=(($=f.value)==null?void 0:$.task)||{},{createUser:w,flowInstanceId:a,status:p}=((N=f.value)==null?void 0:N.flowInstance)||{},g={false:!1,startUser:w==(s==null?void 0:s.userId),assignee:i==(s==null?void 0:s.userId),todo:v==ie.待办,done:v==ie.已办,unfinished:p===pe.未办结,finished:p===pe.已办结,started:!!a},A={true:!0,notstarted:!a},{button:m}=((b=f.value)==null?void 0:b.properties)||{};return((u=n(r.value??[],m??[]))==null?void 0:u.filter(k=>{var I;const l=(I=k.display)==null?void 0:I.split(","),D=l==null?void 0:l.every(_=>g[_]),C=l==null?void 0:l.some(_=>A[_]);return D||C}))??[]});return(s,i)=>{const v=x("el-button");return V(!0),E(H,null,ee(d.value,w=>(V(),O(v,{key:w.buttonKey,type:w.buttonType,onClick:a=>t("click",w)},{default:T(()=>[w.icon?(V(),O(y(Ce),{key:0,icon:w.icon},null,8,["icon"])):R("",!0),M(" "+G(w.name),1)]),_:2},1032,["type","onClick"]))),128)}}}),bt=W({__name:"common-comments",props:{modelValue:{}},setup(e){const t=e,{modelValue:o}=ue(t),{request:c}=Y(),{batchUpdate:f,create:r,remove:n,useList:d}=St(c),s=B(!1),{activeBtn:i}=q(),v=j(()=>{var b;return(b=i.value)==null?void 0:b.buttonKey}),{data:w,refresh:a}=d(v),p=j(()=>{var u,k,l;const b=o.value;if(b&&!((u=w.value)!=null&&u.some(D=>D.content===b))){const D=(((l=(k=w.value)==null?void 0:k[0])==null?void 0:l.sort)||1)-1;return[{content:b,sort:D},...w.value||[]]}return w.value});async function g(b){var u;await r({...b,type:(u=i.value)==null?void 0:u.buttonKey}),se.success("添加成功"),a()}async function A(b){await n(b.id),se.success("删除成功"),a()}async function m(b,u){let k=u.parent.data;k=k.map((l,D)=>({id:l.id,sort:D+1})),await f(k),se.success("修改排序成功"),a(),s.value=!1}function U(){s.value=!0}const $=B();async function N(b){var u;o.value=b.content??"",await de(),(u=$.value)==null||u.blur()}return(b,u)=>{const k=x("el-input"),l=x("el-text"),D=x("el-col"),C=x("el-button"),I=x("el-row"),_=x("el-tree"),h=x("el-popover");return V(),O(h,{visible:s.value,placement:"bottom",title:"常用意见",width:y(Q)()?"98%":"600px"},{reference:T(()=>[S(k,{ref_key:"inputRef",ref:$,modelValue:y(o),"onUpdate:modelValue":u[0]||(u[0]=P=>re(o)?o.value=P:null),type:"textarea",placeholder:"请输入意见",rows:"5",onFocus:u[1]||(u[1]=P=>s.value=!0),onBlur:u[2]||(u[2]=P=>s.value=!1)},null,8,["modelValue"])]),default:T(()=>[S(_,{data:p.value,"node-key":"content",draggable:"","allow-drop":(P,K,L)=>L!=="inner",props:{label:"content"},onNodeClick:N,onNodeDrop:m,onNodeDragStart:U},{default:T(({data:P})=>[S(I,{style:{width:"100%"}},{default:T(()=>[S(D,{span:22},{default:T(()=>[S(l,{truncated:"",title:P.content},{default:T(()=>[M(G(P.content),1)]),_:2},1032,["title"])]),_:2},1024),S(D,{span:2},{default:T(()=>[P.id?(V(),O(C,{key:0,type:"danger",size:"small",icon:"el-icon-close",text:"",onClick:ge(K=>A(P),["stop"])},null,8,["onClick"])):(V(),O(C,{key:1,type:"primary",size:"small",icon:"el-icon-plus",text:"",onClick:ge(K=>g(P),["stop"])},null,8,["onClick"]))]),_:2},1024)]),_:2},1024)]),_:1},8,["data","allow-drop"])]),_:1},8,["visible","width"])}}}),_t=W({__name:"approval-tree",props:{modelValue:{},data:{},autoCheck:{type:Boolean},mode:{}},setup(e){const t=e,{modelValue:o}=ue(t),c={element:"ep:flag",post:"ep:share",dept:"ep:share",user:"ep:user"},r={defaultExpandAll:!0,lazy:!0,showCheckbox:!0,nodeKey:"id",load:(a,p)=>{a.level===0?p(d.value):p(a.data.children??[])},onCheck:i,props:{label:"title",class(a){return`node-${a.type}`}}},n=B(),d=j(()=>Ue(t.data??[],(a,p,g)=>{const A=xe();return a.taskNodeKey=(g==null?void 0:g.taskNodeKey)??a.taskNodeKey,a.incoming=(g==null?void 0:g.incoming)??a.incoming,a.multiple=(g==null?void 0:g.multiple)??a.multiple,a.parentId=(g==null?void 0:g.id)??a.parentId,{...a,id:A}}));Ge(()=>[d.value,n.value],async()=>{if(!(!n.value||!d.value.length)&&t.autoCheck){const a=s(d.value);a&&w([a])}},{immediate:!0,debounce:100});function s(a){var p;if(a.length===1)return(p=a[0].children)!=null&&p.length?s(a[0].children):a[0]}async function i(a,{checkedNodes:p}){var m;let g=p.filter(U=>U.type==="user");const A=g.some(U=>U.id===a.id);if(d.value.every(U=>!U.multiple)&&A)g=[a];else if(!a.multiple&&A){const N=((m=n.value)==null?void 0:m.getNode(a)).parent.data.children.filter(b=>b.id!==a.id);g=rt(g,N,"id")}w(g)}function v(a){const p=o.value.filter(g=>g.id!==a.id);w(p)}function w(a){var p;o.value=a,(p=n.value)==null||p.setCheckedNodes(a)}return(a,p)=>{const g=x("el-tag"),A=x("Icon"),m=x("el-tree");return V(),E(H,null,[(V(!0),E(H,null,ee(y(o),U=>(V(),O(g,{key:U.id,type:"info",closable:"",onClose:$=>v(U)},{default:T(()=>[M(G(U.title),1)]),_:2},1032,["onClose"]))),128)),S(m,Ve({ref_key:"treeRef",ref:n,class:["approval-tree",`mode-${a.mode}`],data:d.value},r),{default:T(({data:U})=>[F("div",null,[S(A,{icon:c[U.type]||c.element,style:{display:"inline-block"}},null,8,["icon"]),F("span",null,G(U.title),1)])]),_:1},16,["class","data"])],64)}}});const Ne=me(_t,[["__scopeId","data-v-9646bed9"]]),yt={key:0,class:"flow-viewer"},wt={key:0,class:"flow-status-legend"},gt={class:"legend-text"},kt=W({__name:"index",props:{modelValue:{},view:{type:Boolean},flowFormOption:{},flowHistory:{},showLegend:{type:Boolean}},emits:["update:modelValue","nodeClick"],setup(e,{emit:t}){const o=e,c=qe();Je(c,()=>{var l;(l=c.value)==null||l.on("node:click",D=>t("nodeClick",D))});const f=j({get(){let l=it();return typeof o.modelValue=="string"&&o.modelValue?l=JSON.parse(o.modelValue):typeof o.modelValue=="object"&&Object.keys(o.modelValue)&&(l=o.modelValue),l},set(l){t("update:modelValue",JSON.stringify(l))}}),r=j(()=>{const{column:l=[],group:D=[]}=JSON.parse(o.flowFormOption||"{}");return[...l,...D.map(I=>I.column??[]).flat()]}),{FlowDesign:n,tabs:d,request:s}=Y(),i=j(()=>(d==null?void 0:d.map(l=>({...l,display:l.display??!0})))??[]),v=j(()=>!o.view),{data:w}=Pe(s).useList({ready:v}),{useUserTree:a}=jt(s),{data:p}=a({ready:v}),{data:g}=a({ready:v,defaultParams:["dept"]}),{data:A}=a({ready:v,defaultParams:["post"]}),{useParam:m}=be(s),{data:U}=m("flow.trends.user");function $(l){return Ue(l,D=>({...D,label:D.title,value:D.id}))}const N=j(()=>({formPropertyList:[...r.value,...i.value],buttonList:w.value,fieldsDic:r.value.map(l=>({label:l.label,value:`\${${l.prop}}`,desc:`\${${l.prop}}`})),flowButtonDisplayDic:J(fe),flowButtonApprovalDic:J(ve),flowButtonValidateDic:oe.map(l=>({...l,label:""})),flowAssigneeUserDic:$(p.value??[]),flowAssigneeDeptDic:$(g.value??[]),flowAssigneePostDic:$(A.value??[]),flowAssigneeDynamicDic:U.value})),{data:b}=m("flow.task.status"),u=j(()=>{var l;return(l=o.flowHistory)==null?void 0:l.map(D=>{var I,_;const C=(_=(I=b.value)==null?void 0:I.find(h=>h.value===D.status))==null?void 0:_.style;return{id:D.taskNodeKey,style:C}})}),k=j(()=>{var l,D;return(D=(l=o.flowHistory)==null?void 0:l.filter(C=>C.taskNodeType==="userTask"))==null?void 0:D.map(C=>{var I;return{id:C.taskNodeKey,content:`<div>${C.assigneeName}</div>
        <div>${C.endTime??""}</div>
        <div>${((I=C.comment)==null?void 0:I.handleComment)??""}</div>`}})});return(l,D)=>l.view?(V(),E("div",yt,[l.showLegend!==!1?(V(),E("div",wt,[(V(!0),E(H,null,ee(y(b),C=>{var I;return V(),E("div",{key:C.label,class:"legend-item"},[F("div",{class:"legend-color",style:et({backgroundColor:(I=C.style)==null?void 0:I.fill})},null,4),F("span",gt,G(C.label),1)])}),128))])):R("",!0),S(y(n),{lf:c.value,"onUpdate:lf":D[0]||(D[0]=C=>c.value=C),"model-value":f.value,styles:u.value,tooltips:k.value,type:"viewer"},null,8,["lf","model-value","styles","tooltips"])])):(V(),O(y(n),{key:1,modelValue:f.value,"onUpdate:modelValue":D[1]||(D[1]=C=>f.value=C),"form-options":y(Ye),"data-options":N.value,"form-width":"30%"},null,8,["modelValue","form-options","data-options"]))}});const Oe=me(kt,[["__scopeId","data-v-7f223fe3"]]),ht=W({__name:"node-select",props:{modelValue:{}},setup(e){const t=e,{modelValue:o}=ue(t),{flowDetail:c}=q(),f=B(!1);function r({data:n}){n.type==="userTask"&&(f.value=!1,o.value=n.id)}return(n,d)=>{const s=x("el-button"),i=x("el-popover");return V(),O(i,{visible:f.value,"onUpdate:visible":d[0]||(d[0]=v=>f.value=v),placement:"bottom-start",width:"800px",trigger:"click"},{reference:T(()=>[S(s,null,{default:T(()=>[M(" 点击选择节点 ")]),_:1})]),default:T(()=>{var v,w;return[S(Oe,{"model-value":(w=(v=y(c))==null?void 0:v.process)==null?void 0:w.flowData,view:"",style:{height:"600px"},onNodeClick:r},null,8,["model-value"])]}),_:1},8,["visible"])}}}),Nt=W({__name:"approval-form",emits:["submit"],setup(e,{emit:t}){const{request:o}=Y(),{getApprovalNode:c}=_e(o),{useParam:f}=be(o),{formData:r,approvalFormData:n,activeBtn:d,approvalVisible:s,formVariables:i,flowDetail:v}=q(),w=B([]),a=B([]),p=B([]),g=B([]),A=B(!1),m=B(!1),U=B(),$=j(()=>{const I=w.value.length,_=p.value.length&&!w.value.length;return{menuBtn:!1,labelWidth:"auto",span:24,column:[{label:"指定节点",prop:"jumpTaskNodeKey",display:N("specifyNode"),rules:[{required:!0,message:"请选择指定节点"}]},{label:"审批人",prop:"assignee",display:N("assignee"),rules:I?[{required:!0,validator:b}]:[]},{label:"传阅人",prop:"circulate",display:N("circulate"),rules:_?[{required:!0,message:"请选择传阅人"}]:[]},{label:"意见",prop:"comment",display:N("comment"),rules:[{required:!0,message:"请填写意见"}]}]}});function N(I){var _,h;return(h=(_=d.value)==null?void 0:_.approval)==null?void 0:h.includes(I)}function b(I,_,h){var L,Z,le;const P=((L=w.value[0])==null?void 0:L.type)==="parallelGateway",K=(le=(Z=w.value[0])==null?void 0:Z.children)==null?void 0:le.every(z=>st([z],ce=>a.value.some(ze=>ze.id===ce.id)));if(a.value.length){if(P&&!K)return h("请在每个节点选择审批人")}else return h("请选择审批人");return!0}const{data:u}=f("flow.approval.autocheck"),{data:k}=f("flow.approval.autocomment");ae(async()=>{!s.value||!U.value||(de(()=>{U.value.resetForm(),n.value.comment=r.value.comment||k.value==="true"&&d.value.name||""}),l())}),ae(async()=>{var I,_;if(N("assignee")&&!(N("specifyNode")&&!n.value.jumpTaskNodeKey))try{m.value=!0;const{taskId:h}=((I=v.value)==null?void 0:I.task)||{},{flowKey:P}=((_=v.value)==null?void 0:_.process)||{},K=await c({flowKey:P,taskId:h,variables:i.value,buttonType:d.value.buttonKey,jumpTaskNodeKey:n.value.jumpTaskNodeKey});w.value=K.data.approvalNodeList,p.value=K.data.circulateNodeList}finally{m.value=!1}});function l(){w.value=[],a.value=[],p.value=[],g.value=[]}async function D(){await Be(U),A.value=!0;const{data:I,outgoing:_}=C(a.value),{data:h}=C(g.value);n.value.assignee=I,n.value.circulate=h,n.value.outgoing=[..._],t("submit")}function C(I){const _={},h={},P=new Set;return I.forEach(K=>{const{taskNodeKey:L,incoming:Z}=K;_[L]||(_[L]=new Set),K.userId&&_[L].add(K.userId),h[L]=[..._[L]].join(","),Z&&P.add(Z)}),{dataSet:_,data:h,outgoing:P}}return(I,_)=>{const h=x("el-skeleton"),P=x("avue-form"),K=x("el-button");return V(),O(Te(y(Q)()?"el-drawer":"el-dialog"),{modelValue:y(s),"onUpdate:modelValue":_[6]||(_[6]=L=>re(s)?s.value=L:null),class:"approval-form-overlay",title:y(d).name,"append-to-body":"",width:"900px",size:"50%",direction:"btt"},{footer:T(()=>[S(K,{onClick:_[5]||(_[5]=L=>s.value=!1)},{default:T(()=>[M(" 取 消 ")]),_:1}),S(K,{type:"primary",onClick:D},{default:T(()=>[M(" 确 定 ")]),_:1})]),default:T(()=>[S(P,{ref_key:"formRef",ref:U,modelValue:y(n),"onUpdate:modelValue":_[4]||(_[4]=L=>re(n)?n.value=L:null),class:"approval-form",option:$.value},{jumpTaskNodeKey:T(()=>[S(ht,{modelValue:y(n).jumpTaskNodeKey,"onUpdate:modelValue":_[0]||(_[0]=L=>y(n).jumpTaskNodeKey=L)},null,8,["modelValue"])]),assignee:T(()=>[m.value?(V(),O(h,{key:0})):(V(),O(Ne,{key:"AssigneeTree",modelValue:a.value,"onUpdate:modelValue":_[1]||(_[1]=L=>a.value=L),data:w.value,"auto-check":y(u)==="true",mode:y(Q)()?"vertical":"horizontal"},null,8,["modelValue","data","auto-check","mode"]))]),circulate:T(()=>[m.value?(V(),O(h,{key:0})):(V(),O(Ne,{key:"CirculateTree",modelValue:g.value,"onUpdate:modelValue":_[2]||(_[2]=L=>g.value=L),data:p.value,mode:y(Q)()?"vertical":"horizontal"},null,8,["modelValue","data","mode"]))]),comment:T(()=>[S(bt,{modelValue:y(n).comment,"onUpdate:modelValue":_[3]||(_[3]=L=>y(n).comment=L)},null,8,["modelValue"])]),_:1},8,["modelValue","option"])]),_:1},8,["modelValue","title"])}}});const Dt={class:"flow-form__title"},Ct=W({__name:"index",props:mt,emits:ft,setup(e,{emit:t}){const c=vt(e,t),{ApprovalForm:f,tabsProps:r}=Y(),n=f??Nt,{title:d,detail:s,flowDetail:i,tabRefs:v,tabList:w,activeTab:a,activeBtn:p,formLoading:g,approvalVisible:A,submitLoading:m,beforeClick:U,beforeSubmit:$,afterSubmit:N,tabsRef:b,emitter:u}=c;async function k(C){var I,_;if(p.value=C,C.validate===1)for(const h of Object.values(v.value))await((I=h==null?void 0:h.validate)==null?void 0:I.call(h));await((_=U==null?void 0:U.value)==null?void 0:_.call(U,C)),await u.emitAsync("beforeClick",C),(C==null?void 0:C.approval)!=="false"?A.value=!0:D()}const l=pt(c);async function D(){var C,I;try{m.value=!0,await((C=$==null?void 0:$.value)==null?void 0:C.call($,p.value)),await u.emitAsync("beforeSubmit",p.value);const{buttonKey:_}=p.value,h=l[_];if(!h){se.error("无法找到相应的操作");return}await(h==null?void 0:h()),await((I=N==null?void 0:N.value)==null?void 0:I.call(N,p.value)),await u.emitAsync("afterSubmit",p.value),A.value=!1,t("complete",p.value)}finally{m.value=!1}}return(C,I)=>{const _=x("el-skeleton"),h=x("el-main"),P=x("el-header"),K=x("el-tab-pane"),L=x("el-tabs"),Z=x("el-footer"),le=x("el-container");return y(g)?(V(),O(h,{key:0},{default:T(()=>[S(_)]),_:1})):(V(),O(le,{key:1,class:"flow-form"},{default:T(()=>[S(P,{class:"flow-form__header",height:"auto"},{default:T(()=>{var z;return[F("div",Dt,G(y(d)??((z=y(i).flowInstance)==null?void 0:z.title)),1),!y(s)&&!y(Q)()?(V(),O(he,{key:0,onClick:k})):R("",!0)]}),_:1}),S(h,{class:"flow-form__main"},{default:T(()=>[S(L,Ve({ref_key:"tabsRef",ref:b,modelValue:y(a),"onUpdate:modelValue":I[0]||(I[0]=z=>re(a)?a.value=z:null)},y(r)),{default:T(()=>[(V(!0),E(H,null,ee(y(w),z=>(V(),O(K,{key:z.prop,label:z.label,name:z.prop,lazy:z.lazy,disabled:z.disabled,closable:z.closable},{default:T(()=>[(V(),O(Te(z.component),{ref_for:!0,ref:ce=>y(v)[z.prop]=ce},null,512))]),_:2},1032,["label","name","lazy","disabled","closable"]))),128))]),_:1},16,["modelValue"])]),_:1}),!y(s)&&y(Q)()?(V(),O(Z,{key:0,class:"flow-form__footer",height:"auto"},{default:T(()=>[S(he,{onClick:k})]),_:1})):R("",!0),S(y(n),{onSubmit:D})]),_:1}))}}});const It=W({setup(){const{flowDetail:e,formData:t,detail:o}=q(),c=dt(e.value),{proxy:f}=at(),r=B({});ae(()=>{const{formOption:s}=e.value.process??{};r.value=He.bind(f)(s||'{"menuBtn":false}'),r.value.detail=!!o.value});const n=B();function d(){return Be(n)}return{form:t,option:r,defaults:c,formRef:n,validate:d}},render(){return tt(x("avue-form"),{ref:"formRef",modelValue:this.form,defaults:this.defaults,option:this.option,class:this.option.class,"onUpdate:modelValue":e=>this.form=e,"onUpdate:defaults":e=>this.defaults=e})}}),Vt=W({__name:"upload-table",setup(e){const{flowDetail:t,fileIds:o,detail:c}=q(),{upload:{action:f,headers:r,preview:n,download:d,props:s}={},request:i}=Y(),v=typeof r=="function"?r():r,w=j(()=>{var k,l;return((l=(k=t.value)==null?void 0:k.task)==null?void 0:l.flowInstanceId)??xe()}),a=[{label:"文件名",prop:"fileName"},{label:"文件类型",prop:"fileType"},{label:"文件大小",prop:"fileSize"},{label:"版本",prop:"version"},{label:"上传时间",prop:"createTime"}],p=a.filter(k=>k.prop==="fileName"),g={rowKey:"id",align:"center",index:!1,border:!0,stripe:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuType:"menu",menuBtnTitle:"操作",column:Q()?p:a},{bindVal:A,getDataList:m,handleDel:U,handleSave:$,afterGetList:N,crudStateRefs:{tableData:b}}=We({crudOption:{...Pt(i),saveSuccessMsg:"上传成功"},tableOption:g,queryForm:{isLatest:1,flowInstanceId:w.value}});N(()=>{o.value=b.value.map(k=>k.id).join(",")}),m();async function u(k,l){var K,L;const{fileName:D,fileType:C,fileSize:I,fileUrl:_,res:h}=s,P={fileName:ne({res:k},`${h}.${D}`),fileType:ne({res:k},`${h}.${C}`),fileSize:ne({res:k},`${h}.${I}`),fileUrl:ne({res:k},`${h}.${_}`),taskId:(L=(K=t.value)==null?void 0:K.task)==null?void 0:L.taskId,flowInstanceId:w.value,rootMark:(l==null?void 0:l.rootMark)||"",version:typeof(l==null?void 0:l.version)=="number"?l.version+1:1};await $(P,m,()=>{})}return(k,l)=>{const D=x("el-button"),C=x("el-upload"),I=x("el-dropdown-item"),_=x("avue-crud");return V(),O(_,ot(lt(y(A))),{"menu-left":T(()=>[y(c)?R("",!0):(V(),O(C,{key:0,action:y(f),headers:y(v),"show-file-list":!1,onSuccess:l[0]||(l[0]=h=>u(h))},{default:T(()=>[S(D,{type:"primary",icon:"el-icon-upload"},{default:T(()=>[M(" 点击上传 ")]),_:1})]),_:1},8,["action","headers"]))]),"menu-btn":T(({row:h,index:P})=>[S(I,{icon:"el-icon-view",onClick:K=>{var L;return(L=y(n))==null?void 0:L(h,y(b))}},{default:T(()=>[M(" 预览 ")]),_:2},1032,["onClick"]),S(I,{icon:"el-icon-download",onClick:K=>{var L;return(L=y(d))==null?void 0:L(h,y(b))}},{default:T(()=>[M(" 下载 ")]),_:2},1032,["onClick"]),y(c)?R("",!0):(V(),O(I,{key:0,icon:"el-icon-upload"},{default:T(()=>[S(C,{action:y(f),headers:y(v),"show-file-list":!1,onSuccess:K=>u(K,h)},{default:T(()=>[M(" 更新版本 ")]),_:2},1032,["action","headers","onSuccess"])]),_:2},1024)),y(c)?R("",!0):(V(),O(I,{key:1,icon:"el-icon-delete",onClick:K=>y(U)(h,P)},{default:T(()=>[M(" 删除 ")]),_:2},1032,["onClick"]))]),_:1},16)}}}),Tt={class:"flow-track"},Ut={key:0},xt={key:1},Lt=W({__name:"flow-track",setup(e){const{flowDetail:t}=q(),o=B(Q()?"timeline":"table"),c=[{label:"table",icon:"ep:grid"},{label:"graph",icon:"ep:picture"},{label:"timeline",icon:"ep:finished"}],f=j(()=>{var i,v,w;return((w=(v=(i=t.value)==null?void 0:i.flowHistory)==null?void 0:v.filter(a=>a.taskNodeType==="userTask"))==null?void 0:w.map(a=>({...a,duration:Ee(a.duration)})))??[]}),r={addBtn:!1,menu:!1,border:!0,column:[{label:"节点名称",prop:"taskNodeName"},{label:"处理人",prop:"assigneeName"},{label:"接收时间",prop:"startTime"},{label:"处理时间",prop:"endTime"},{label:"办理时长",prop:"duration"},{label:"操作类型",prop:"type",dicUrl:"/sapier-flow/flow-param/getParam",dicQuery:{paramKey:"flow.handle.type"}},{label:"办理意见",prop:"comment",bind:"comment.handleComment"}]},{request:n}=Y(),{data:d}=be(n).useParam("flow.handle.type");function s(i){var v;return(v=d.value)==null?void 0:v.find(w=>w.value===i)}return(i,v)=>{var $,N,b;const w=x("el-radio-button"),a=x("el-radio-group"),p=x("avue-crud"),g=x("el-card"),A=x("el-timeline-item"),m=x("el-timeline"),U=x("el-empty");return V(),E(H,null,[y(Q)()?R("",!0):(V(),O(a,{key:0,modelValue:o.value,"onUpdate:modelValue":v[0]||(v[0]=u=>o.value=u)},{default:T(()=>[(V(),E(H,null,ee(c,u=>S(w,{key:u.label,label:u.label},{default:T(()=>[S(y(Ce),{icon:u.icon},null,8,["icon"])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])),F("div",Tt,[o.value==="table"?(V(),O(p,{key:0,data:f.value,option:r},null,8,["data"])):R("",!0),o.value==="graph"?(V(),O(Oe,{key:1,"model-value":(N=($=y(t))==null?void 0:$.process)==null?void 0:N.flowData,"flow-history":(b=y(t))==null?void 0:b.flowHistory,view:"","show-legend":""},null,8,["model-value","flow-history"])):R("",!0),o.value==="timeline"?(V(),E(H,{key:2},[f.value.length?(V(),O(m,{key:0},{default:T(()=>[(V(!0),E(H,null,ee([...f.value].reverse(),u=>(V(),O(A,{key:u.id,timestamp:u.endTime,placement:"top"},{default:T(()=>[S(g,null,{default:T(()=>{var k,l,D;return[F("div",null,G(u.assigneeName)+" 开始处理 ["+G(u.taskNodeName)+"] 环节 ",1),u.duration?(V(),E("div",Ut," 办理时长："+G(u.duration),1)):R("",!0),u.type&&((k=u.comment)!=null&&k.handleComment)?(V(),E("div",xt,G((l=s(u.type))==null?void 0:l.label)+"意见："+G((D=u.comment)==null?void 0:D.handleComment),1)):R("",!0)]}),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:1})):(V(),O(U,{key:1}))],64)):R("",!0)])],64)}}});const $t=me(Lt,[["__scopeId","data-v-b788684b"]]),Ot={FlowDesign:{},FormDesign:{},FlowForm:Ct,request:{},tabs:[{label:"审批表单",prop:"formTab",component:It},{label:"附件资料",prop:"fileTab",component:Vt},{label:"流程跟踪",prop:"trackTab",component:$t}],useFlowFormOptions:{type:"drawer",window:["","flow-form","left=0,top=0,width=1600,height=900"],overlay:{width:"80%",size:"80%",top:"100px",fullscreen:!0,destroyOnClose:!0}},tableOption:{align:"center",border:!0,card:!0,stripe:!0,searchMenuSpan:6,span:24},upload:{props:{fileName:"fileOriginalName",fileType:"fileType",fileSize:"fileSize",fileUrl:"fileUrl",res:"res.data"}}};function St(e){const t={list:"/sapier-flow/flow-user-common/list",save:"/sapier-flow/flow-user-common/save",update:"/sapier-flow/flow-user-common/update",remove:"/sapier-flow/flow-user-common/remove",batchUpdate:"/sapier-flow/flow-user-common/batchUpdate"},o=s=>e.get(t.list,{params:{type:s,ascs:"sort"}});return{url:t,getList:o,useList:s=>te(()=>o(s.value).then(i=>i.data.records),{refreshDeps:[s]}),create:s=>e.post(t.save,s),update:s=>e.post(t.update,s),remove:s=>e.post(t.remove,{},{params:{ids:s}}),batchUpdate:s=>e.post(t.batchUpdate,s)}}var Se=(e=>(e.默认="default",e.主要="primary",e.成功="success",e.警告="warning",e.危险="danger",e.信息="info",e.文字="text",e))(Se||{}),At=(e=>(e.保存草稿="flow_draft",e.发送="flow_pass",e.退回="flow_reject",e.终止="flow_terminate",e.撤销="flow_revoke",e.撤回到发起="flow_withdraw",e.打印="flow_print",e.转办="flow_transfer",e.加签="flow_add_instance",e.减签="flow_del_instance",e.指定回退="flow_rollback",e.绿色通道="flow_green",e))(At||{}),fe=(e=>(e.显示="true",e.隐藏="false",e.发起人="startUser",e.处理人="assignee",e.已办="done",e.待办="todo",e.已办结="finished",e.未办结="unfinished",e.已发起="started",e.未发起="notstarted",e))(fe||{}),ve=(e=>(e.不显示="false",e.指定节点="specifyNode",e.审批人="assignee",e.传阅人="circulate",e.意见="comment",e))(ve||{}),Ae=(e=>(e[e.禁用=0]="禁用",e[e.正常=1]="正常",e))(Ae||{});function Pe(e){const t={list:"/sapier-flow/dev-button/list",save:"/sapier-flow/dev-button/save",update:"/sapier-flow/dev-button/update",remove:"/sapier-flow/dev-button/remove"},o=d=>e.get(t.list,{params:d});return{url:t,getList:o,useList:d=>te(()=>o({size:-1,ascs:"sort",status:1}).then(s=>s.data.records),d),create:d=>e.post(t.save,d),update:d=>e.post(t.update,d),remove:d=>e.post(t.remove,{},{params:{ids:d}})}}function Pt(e){const t={list:"/sapier-flow/flow-file/list",save:"/sapier-flow/flow-file/save",remove:"/sapier-flow/flow-file/remove"};return{getList:r=>e.get(t.list,{params:r}),create:r=>e.post(t.save,r),remove:r=>e.post(t.remove,{},{params:{ids:r}})}}function be(e){const t={list:"/sapier-flow/flow-param/list",save:"/sapier-flow/flow-param/save",update:"/sapier-flow/flow-param/update",remove:"/sapier-flow/flow-param/remove",all:"/sapier-flow/flow-param/getAllParam",key:"/sapier-flow/flow-param/getParam"},o=i=>e.get(t.list,{params:i}),c=()=>e.get(t.all),f=i=>e.get(t.key,{params:{paramKey:i}});return{url:t,getList:o,getAllParam:c,getParam:f,useParam:i=>te(()=>f(i).then(v=>v.data)),create:i=>e.post(t.save,i),update:i=>e.post(t.update,i),remove:i=>e.post(t.remove,{},{params:{ids:i}})}}var ie=(e=>(e[e.已办=1]="已办",e[e.待办=2]="待办",e[e.失败=3]="失败",e[e.撤销=4]="撤销",e[e.终止=5]="终止",e))(ie||{}),pe=(e=>(e[e.已办结=1]="已办结",e[e.未办结=2]="未办结",e[e.已终止=3]="已终止",e))(pe||{}),Kt=(e=>(e[e.系统执行=1]="系统执行",e[e.用户办理=2]="用户办理",e[e.任务撤销=3]="任务撤销",e[e.任务退回=4]="任务退回",e[e.流程终止=5]="流程终止",e[e.任务转办=6]="任务转办",e[e.绿色通道=7]="绿色通道",e))(Kt||{});function _e(e){const t={publishList:"/sapier-flow/flow-run/queryPublishFlowList",taskList:"/sapier-flow/flow-run/userTaskList",detail:"/sapier-flow/flow-run/queryPublishFlowDetail",approvalNode:"/sapier-flow/flow-run/queryApprovalNode",start:"/sapier-flow/flow-run/startProcess",commit:"/sapier-flow/flow-run/commitTask",draft:"/sapier-flow/flow-run/saveDraft",revoke:"/sapier-flow/flow-run/revokeTask",terminate:"/sapier-flow/flow-run/terminateFlow",withdraw:"/sapier-flow/flow-run/withdrawToStart",transfer:"/sapier-flow/flow-run/transferTask",reject:"/sapier-flow/flow-run/rollbackTask",green:"/sapier-flow/flow-run/greenTask"},o=m=>e.get(t.detail,{params:m}),c=m=>e.post(t.approvalNode,m),f=m=>e.post(t.start,m),r=m=>e.post(t.commit,m),n=m=>e.post(t.draft,m),d=m=>e.post(t.revoke,m),s=m=>e.post(t.terminate,m),i=m=>e.post(t.withdraw,m),v=m=>e.post(t.transfer,m),w=m=>e.post(t.reject,m),a=m=>e.post(t.green,m),p=m=>e.get(t.publishList,{params:m});return{url:t,getFlowDetail:o,getApprovalNode:c,startTask:f,commitTask:r,saveDraft:n,revokeTask:d,terminateTask:s,withdrawTask:i,transferTask:v,rejectTask:w,greenChannel:a,getPublishList:p,usePublishList:()=>te(()=>p({ascs:"sort"}).then(m=>m.data)),getTaskList:m=>e.get(t.taskList,{params:m})}}function jt(e){const t={tree:"/sapier-flow/flow-user/tree"},o=f=>e.get(t.tree,{params:{filter:f}});return{url:t,getUserTree:o,useUserTree:f=>te(r=>o(r).then(n=>n.data),f)}}var ye=(e=>(e.ASSIGN_ID="ASSIGN_ID",e.ASSIGN_UUID="ASSIGN_UUID",e.AUTO="AUTO",e.INPUT="INPUT",e.NONE="NONE",e))(ye||{}),we=(e=>(e.bigint="bigint",e.blob="blob",e.char="char",e.date="date",e.datetime="datetime",e.decimal="decimal",e.double="double",e.enum="enum",e.float="float",e.int="int",e.longblob="longblob",e.longtext="longtext",e.mediumblob="mediumblob",e.mediumint="mediumint",e.mediumtext="mediumtext",e.set="set",e.smallint="smallint",e.text="text",e.time="time",e.timestamp="timestamp",e.tinyblob="tinyblob",e.tinyint="tinyint",e.tinytext="tinytext",e.varbinary="varbinary",e.varchar="varchar",e.year="year",e))(we||{});function ia(e){const t={list:"/sapier-flow/dev-table/list",save:"/sapier-flow/dev-table/save",update:"/sapier-flow/dev-table/update",remove:"/sapier-flow/dev-table/remove",deploy:"/sapier-flow/dev-table/deploy",getFields:"/sapier-flow/dev-table/getTableFields"},o=i=>e.get(t.list,{params:i});return{url:t,getList:o,useList:()=>te(()=>o({size:-1}).then(i=>i.data.records)),create:i=>e.post(t.save,i),update:i=>e.post(t.update,i),remove:i=>e.post(t.remove,{},{params:{ids:i}}),deploy:i=>e.post(t.deploy,i),getFields:i=>e.get(t.getFields,{params:i})}}var Ke=(e=>(e[e.否=0]="否",e[e.是=1]="是",e))(Ke||{});const oe=J(Ke),ua=J(we),ca=J(ye),Bt=Ie(ut(Ot));function Y(e){return ct(Bt,e)}const pa=X({rowKey:"id",labelWidth:150,column:[{label:"按钮名称",prop:"name",search:!0},{label:"按钮标识",prop:"buttonKey",search:!0},{label:"按钮图标",prop:"icon",component:"icon-select"},{label:"按钮类型",prop:"buttonType",type:"select",dicData:J(Se)},{label:"默认显示条件",prop:"display",type:"select",multiple:!0,dataType:"string",value:"false",dicData:J(fe),tip:"选择多个时,所有条件都满足才显示",labelTip:`显示: 始终显示，或运算条件;<br/>隐藏: 始终隐藏，与运算条件;<br/>
      发起人: 用户为发起人时显示，与运算条件;<br/>处理人: 用户为处理人时显示，与运算条件;<br/>
      已办: 任务状态为已办时显示，与运算条件;<br/>待办: 任务状态为待办时显示，与运算条件;<br/>
      已办结: 流程已办结时显示，与运算条件;<br/>未办结: 流程未办结时显示，与运算条件;<br/>
      已发起: 流程已发起时显示，与运算条件;<br/>未发起: 流程未发起时显示，或运算条件;`},{label:"默认审批窗口显示",prop:"approval",type:"select",multiple:!0,dataType:"string",value:"false",dicData:J(ve),labelTip:`不显示: 不显示审批窗口;<br/>指定节点: 显示指定节点选择框(常用于绿色通道等);<br/>
      审批人: 显示审批人选择框;<br/>传阅人: 显示传阅人选择框;<br/>意见: 显示意见输入框;`},{label:"默认是否校验",prop:"validate",type:"switch",value:1,dicData:oe,labelTip:"是: 点击按钮时先执行每个tab的校验;<br/>否: 点击按钮不执行校验;"},{label:"备注",prop:"remarks",overHidden:!0},{label:"排序",prop:"sort",type:"number",value:0},{label:"状态",prop:"status",type:"switch",value:1,dicData:J(Ae)},{label:"按钮预览",prop:"buttonPreview",width:150}]}),je={menuBtn:!1,span:24,column:[{label:"流程名称",prop:"flowName",rules:[{required:!0,message:"请输入流程名称"}]},{label:"流程标识",prop:"flowKey",editDisabled:!0,rules:[{required:!0,message:"请输入流程标识"}]},{label:"流程分类",prop:"categoryId",type:"select",dicUrl:"/sapier-flow/flow-category/list",dicQuery:{size:-1,ascs:"sort"},props:{label:"name",value:"id"}},{label:"流程图标",prop:"flowIcon",component:"icon-select"},{label:"流程描述",prop:"remarks"},{label:"自定义表单",prop:"formPath"},{label:"关联表",prop:"formDataTable",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicUrl:"/sapier-flow/dev-table/list",dicQuery:{size:-1},props:{label:"tableComment",value:"tableName",desc:"tableName",res:"data.records"}},{label:"排序",prop:"sort",type:"number",width:110},{label:"表单设计",prop:"formOption",display:!1,hide:!0},{label:"模型设计",prop:"flowData",display:!1,hide:!0}]},da=X({rowKey:"flowModuleId",dialogFullscreen:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuWidth:100,menuType:"menu",menuBtnTitle:"操作",column:[...je.column.map((e,t)=>({...e,search:t<2})),{label:"流程主版本",prop:"mainVersion",formatter(e,t){return t?`V${t||""}`:""}}]}),ma=X({rowKey:"flowDeloyId",dialogFullscreen:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuWidth:100,menuType:"menu",menuBtnTitle:"操作",column:[...je.column,{prop:"sort",hide:!0},{label:"流程版本",prop:"version",formatter(e,t){return t?`V${t||""}`:""}},{label:"是否主版本",prop:"mainVersion",type:"select",dicData:[{label:"否",value:0},{label:"是",value:1}]}]}),fa=X({rowKey:"id",menu:!1,addBtn:!1,column:[{label:"流程名称",prop:"flowName"},{label:"流程标识",prop:"flowKey"},{label:"流程分类",prop:"categoryId",type:"select",search:!0,dicUrl:"/sapier-flow/flow-category/list",props:{label:"name",value:"id"}},{label:"标题",prop:"processTitle",search:!0},{label:"流水号",prop:"serialNumber"},{label:"当前节点",prop:"taskNodeName"},{label:"审批人",prop:"assigneeName"},{label:"申请人",prop:"applyUserName"},{label:"接收时间",prop:"startTime"},{label:"任务状态",prop:"status",type:"select",search:!0,searchValue:ie.待办,dicUrl:"/sapier-flow/flow-param/getParam",dicQuery:{paramKey:"flow.task.status"}}]}),va=X({rowKey:"id",column:[{label:"配置名称",prop:"paramName",search:!0},{label:"配置Key",prop:"paramKey",search:!0},{label:"备注",prop:"remark"},{label:"系统内置",prop:"paramType",type:"switch",dicData:oe},{label:"配置值",prop:"paramValue",type:"textarea",maxRows:20,span:24,overHidden:!0}]}),ba=X({rowKey:"id",menu:!1,addBtn:!1,column:[{label:"流程名称",prop:"flowName"},{label:"流程标识",prop:"flowKey"},{label:"流程分类",prop:"categoryId",type:"select",search:!0,dicUrl:"/sapier-flow/flow-category/list",props:{label:"name",value:"id"}},{label:"标题",prop:"processTitle",search:!0},{label:"流水号",prop:"serialNumber"},{label:"当前节点",prop:"taskNodeName"},{label:"审批人",prop:"assigneeName"},{label:"申请人",prop:"applyUserName"},{label:"接收时间",prop:"startTime"}]});const _a=X({rowKey:"id",column:[{label:"流程标识",prop:"flowKey",search:!0},{label:"流程名称",prop:"flowName",search:!0},{label:"流程备注",prop:"remarks"},{label:"排序",prop:"sort"}]}),ya=X({rowKey:"id",column:[{label:"表单标识",prop:"formKey",search:!0},{label:"表单名称",prop:"formName",search:!0},{label:"表单备注",prop:"remarks"},{label:"排序",prop:"sort",type:"number"}]}),De=[{label:"字段名称",prop:"name"},{label:"字段备注",prop:"comment"},{label:"字段类型",prop:"type",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:J(we)},{label:"字段长度",prop:"size",type:"number"},{label:"小数位",prop:"point",type:"number"},{label:"默认值",prop:"default"},{label:"是否主键",prop:"primary",type:"switch",dicData:oe,value:0},{label:"是否允许为空",prop:"permitNull",type:"switch",dicData:oe,value:1}],wa=X({rowKey:"id",dialogFullscreen:!0,column:[{label:"表名",prop:"tableName",search:!0},{label:"表注释",prop:"tableComment",search:!0},{label:"表引擎",prop:"tableEngine"},{label:"表主键策略",prop:"tablePrimary",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:J(ye)},{label:"数据库字段",prop:"editFields",hide:!0,type:"dynamic",children:{column:De}},{label:"默认字段",prop:"defaultFields",hide:!0,type:"dynamic",children:{addBtn:!1,delBtn:!1,column:De}}]});function Be(e){return new Promise((t,o)=>{y(e).validate((f,r,n)=>{f?(r(),t(n)):o(n)})})}function Q(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}export{jt as A,ye as B,Ot as C,we as D,X as E,Oe as F,oe as G,Kt as H,ua as I,ca as J,Nt as K,he as L,$t as M,It as N,Vt as O,pt as P,ke as Q,Le as R,mt as S,ie as T,ft as U,$e as V,Ke as W,vt as X,Q as Y,Ct as _,dt as a,Be as b,Y as c,Pe as d,da as e,ma as f,ia as g,je as h,fa as i,va as j,be as k,ba as l,_e as m,_a as n,ya as o,wa as p,St as q,Se as r,At as s,pa as t,q as u,fe as v,ve as w,Ae as x,Pt as y,pe as z};
