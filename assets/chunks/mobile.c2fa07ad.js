import{j as Re}from"./index.288677a1.js";import{I as Ce}from"./iconify.b68073ff.js";import{a as re,e as Ee,f as Me,w as Ie,g as Ge}from"./index.cd412afd.js";import{_ as Je,d as Qe}from"./index.b00b9483.js";import"./index.890dc192.js";import{d as We}from"./data.4cb21f02.js";import{j as Ye}from"./tree.21d3b17d.js";import"./index.3d38e212.js";import"./vuedraggable.umd.00d46a83.js";import{u as te,m as He}from"./index.es.e5378d01.js";import{e as J,u as Xe}from"./index.ac4ff024.js";import{ab as Ue,g as A,h as j,A as ue,l as _,E as me,$ as Ze,S as qe,Y as Fe,d as Q,J as I,c as R,L as ee,K as H,o as V,b as T,w as D,N as L,a as M,t as G,B as oe,a3 as ge,k as q,R as se,_ as fe,z as et,C as tt,e as E,U as at,O as xe,a5 as lt,D as ot,a9 as st,aa as nt}from"./framework.f01dabf7.js";import{p as rt}from"./pick.2b716c9d.js";import{t as ut,b as ke,f as it}from"./index.fc3eb3b1.js";import{E as le}from"./index.22b43a78.js";import{u as $e}from"./index.386fc70b.js";import{d as ct}from"./differenceBy.dc3bb284.js";import{g as ae}from"./get.c8715fa2.js";function X(e){const{tableOption:t}=W();return Ue({...t,...e})}function pt(e){const{buttonHandler:t,request:o}=W(),{commitTask:y,revokeTask:u,saveDraft:w,startTask:s,terminateTask:v,transferTask:i,withdrawTask:c,rejectTask:k,greenChannel:f}=_e(o),a=A(()=>{const{flowDetail:h,formVariables:N,approvalFormData:n,debug:l,fileIds:r}=e,{flowDeployId:d}=h.value.process??{},{taskId:p,flowInstanceId:m}=h.value.task??{};return{flowDeployId:d,taskId:p,flowInstanceId:m,variables:N.value,debug:l.value,fileIds:r==null?void 0:r.value,...n.value}}),b=()=>a.value.taskId&&a.value.flowInstanceId;return{flow_draft(){if(b())return w(a.value)},flow_pass(){return b()?y(a.value):s(a.value)},flow_revoke(){if(b())return u(a.value)},flow_withdraw(){if(b())return c(a.value)},flow_terminate(){if(b())return v(a.value)},flow_transfer(){if(b())return i(a.value)},flow_reject(){if(b())return k(a.value)},flow_green(){if(b())return f(a.value)},...t==null?void 0:t(e)}}function dt(e){const t=j({});return ue(async()=>{var y;const{formProperty:o}=((y=_(e))==null?void 0:y.properties)||{};o!=null&&o.length&&(await me(),Object.keys(t.value).forEach(u=>{var v,i,c,k;const w=((v=t.value[u])==null?void 0:v.label)||"",s=o==null?void 0:o.find(f=>f.prop===u);if(t.value[u].display=s==null?void 0:s.display,t.value[u].disabled=s==null?void 0:s.disabled,t.value[u].detail=s==null?void 0:s.detail,t.value[u].readonly=s==null?void 0:s.readonly,t.value[u].rules=t.value[u].rules??[],s!=null&&s.required&&((i=t.value[u].rules)!=null&&i.some(f=>f.required)))return null;s!=null&&s.required?(c=t.value[u].rules)==null||c.push({required:!0,message:`${w}为必填项`}):t.value[u].rules=(k=t.value[u].rules)==null?void 0:k.filter(f=>!f.required)}))}),t}const mt={modelValue:{type:Object,default:()=>({})},title:{type:String},flowDetail:{type:Object,default:()=>({})},formLoading:{type:Boolean},submitLoading:{type:Boolean},activeTab:{type:String,default:"formTab"},activeBtn:{type:Object,default:()=>({})},approvalVisible:{type:Boolean},approvalFormData:{type:Object,default:()=>({})},flowKey:{type:String},taskId:{type:String},instanceId:{type:String},formId:{type:String},fileIds:{type:String},permission:{type:Object},beforeClick:{type:Function},beforeSubmit:{type:Function},afterSubmit:{type:Function},detail:{type:[Boolean,String],default:!1},debug:{type:[Boolean,String],default:!1}},ft={complete:e=>e},Le=Symbol("flowFormState");function vt(e,t){const o=re(e,void 0,{passive:!0,deep:!0}),{flowDetail:y,modelValue:u,formLoading:w,activeTab:s}=o,{tabs:v,customForm:i,request:c}=W(),k=j({}),f=A(()=>(v==null?void 0:v.filter(l=>{var d,p,m;const r=(m=(p=(d=y.value)==null?void 0:d.properties)==null?void 0:p.formProperty)==null?void 0:m.find(C=>C.prop===l.prop);return(r==null?void 0:r.display)!==!1}).map(l=>{var d,p;let r=l.component;if(l.prop==="formTab"){const m=i==null?void 0:i[((p=(d=y==null?void 0:y.value)==null?void 0:d.process)==null?void 0:p.formPath)??""];typeof m=="function"?r=Fe(m):m&&(r=m)}return{...l,component:r}}))??[]),a=j();Y()&&Ee(a,{onSwipeEnd(l,r){if(!["left","right"].includes(r))return;const d=f.value.findIndex(m=>m.prop===s.value),p=Me(d+(r==="right"?-1:1),0,f.value.length-1);s.value=f.value[p].prop}});const{getFlowDetail:b}=_e(c);ue(()=>{const{flowKey:l,taskId:r,instanceId:d}=e;!l&&!r&&!d||(w.value=!0,b({flowKey:l,taskId:r,flowInstanceId:d}).then(p=>{y.value=p.data,u.value=p.data.formData||{}}).finally(()=>{w.value=!1}))});const h=A(()=>Object.entries(u.value||{}).filter(([l])=>!l.startsWith("$")).map(([l,r])=>({key:l,value:r}))),N=A(()=>e.detail===!0||e.detail==="true"),n={...o,formData:u,formVariables:h,tabRefs:k,tabList:f,detail:N,tabsRef:a,emit:t};return Ze(Le,n),n}function F(){return qe(Le)}const he=Q({__name:"button-list",emits:["click"],setup(e,{emit:t}){const{userInfo:o,request:y}=W(),{flowDetail:u}=F(),{data:w}=Ke(y).useList();function s(i,c){return i.map(k=>{const f=c.find(b=>b.buttonKey===k.buttonKey);return{...k,...rt(f,["display","approval"])}})}const v=A(()=>{var l,r,d,p;const i=typeof o=="function"?o():o,{assignee:c,status:k}=((l=u.value)==null?void 0:l.task)||{},{createUser:f,flowInstanceId:a,status:b}=((r=u.value)==null?void 0:r.flowInstance)||{},h={true:!0,false:!1,startUser:f==(i==null?void 0:i.userId),assignee:c==(i==null?void 0:i.userId),todo:k==ne.待办,done:k==ne.已办,notstarted:!a,started:!!a,finished:b===pe.已办结,unfinished:b===pe.未办结},{button:N}=((d=u.value)==null?void 0:d.properties)||{};return((p=s(w.value??[],N??[]))==null?void 0:p.filter(m=>{var C,U;return(U=(C=m.display)==null?void 0:C.split(","))==null?void 0:U.every(O=>h[O])}))??[]});return(i,c)=>{const k=I("el-button");return V(!0),R(H,null,ee(v.value,f=>(V(),T(k,{key:f.buttonKey,type:f.buttonType,onClick:a=>t("click",f)},{default:D(()=>[L(_(Ce),{icon:f.icon},null,8,["icon"]),M(" "+G(f.name),1)]),_:2},1032,["type","onClick"]))),128)}}}),bt=Q({__name:"common-comments",props:{modelValue:{}},setup(e){const t=e,{modelValue:o}=re(t),{request:y}=W(),{batchUpdate:u,create:w,remove:s,useList:v}=Kt(y),i=j(!1),{activeBtn:c}=F(),k=A(()=>{var p;return(p=c.value)==null?void 0:p.buttonKey}),{data:f,refresh:a}=v(k),b=A(()=>{var m,C,U;const p=o.value;if(p&&!((m=f.value)!=null&&m.some(O=>O.content===p))){const O=(((U=(C=f.value)==null?void 0:C[0])==null?void 0:U.sort)||1)-1;return[{content:p,sort:O},...f.value||[]]}return f.value});async function h(p){var m;await w({...p,type:(m=c.value)==null?void 0:m.buttonKey}),le.success("添加成功"),a()}async function N(p){await s(p.id),le.success("删除成功"),a()}async function n(p,m){let C=m.parent.data;C=C.map((U,O)=>({id:U.id,sort:O+1})),await u(C),le.success("修改排序成功"),a(),i.value=!1}function l(){i.value=!0}const r=j();async function d(p){var m;o.value=p.content??"",await me(),(m=r.value)==null||m.blur()}return(p,m)=>{const C=I("el-input"),U=I("el-text"),O=I("el-col"),z=I("el-button"),S=I("el-row"),g=I("el-tree"),$=I("el-popover");return V(),T($,{visible:i.value,placement:"bottom",title:"常用意见",width:_(Y)()?"98%":"600px"},{reference:D(()=>[L(C,{ref_key:"inputRef",ref:r,modelValue:_(o),"onUpdate:modelValue":m[0]||(m[0]=K=>oe(o)?o.value=K:null),type:"textarea",placeholder:"请输入意见",rows:"5",onFocus:m[1]||(m[1]=K=>i.value=!0),onBlur:m[2]||(m[2]=K=>i.value=!1)},null,8,["modelValue"])]),default:D(()=>[L(g,{data:b.value,"node-key":"content",draggable:"","allow-drop":(K,P,x)=>x!=="inner",props:{label:"content"},onNodeClick:d,onNodeDrop:n,onNodeDragStart:l},{default:D(({data:K})=>[L(S,{style:{width:"100%"}},{default:D(()=>[L(O,{span:22},{default:D(()=>[L(U,{truncated:"",title:K.content},{default:D(()=>[M(G(K.content),1)]),_:2},1032,["title"])]),_:2},1024),L(O,{span:2},{default:D(()=>[K.id?(V(),T(z,{key:0,type:"danger",size:"small",icon:"el-icon-close",text:"",onClick:ge(P=>N(K),["stop"])},null,8,["onClick"])):(V(),T(z,{key:1,type:"primary",size:"small",icon:"el-icon-plus",text:"",onClick:ge(P=>h(K),["stop"])},null,8,["onClick"]))]),_:2},1024)]),_:2},1024)]),_:1},8,["data","allow-drop"])]),_:1},8,["visible","width"])}}}),_t=Q({__name:"approval-tree",props:{modelValue:{},data:{},autoCheck:{type:Boolean},mode:{}},setup(e){const t=e,{modelValue:o}=re(t),y={element:"ep:flag",post:"ep:share",dept:"ep:share",user:"ep:user"},w={defaultExpandAll:!0,lazy:!0,showCheckbox:!0,nodeKey:"id",load:(a,b)=>{a.level===0?b(v.value):b(a.data.children??[])},onCheck:c,props:{label:"title",class(a){return`node-${a.type}`}}},s=j(),v=A(()=>ut(t.data??[],(a,b,h)=>{const N=$e();return a.taskNodeKey=(h==null?void 0:h.taskNodeKey)??a.taskNodeKey,a.incoming=(h==null?void 0:h.incoming)??a.incoming,a.multiple=(h==null?void 0:h.multiple)??a.multiple,a.parentId=(h==null?void 0:h.id)??a.parentId,{...a,id:N}}));Ie(()=>[v.value,s.value],async()=>{if(!(!s.value||!v.value.length)&&t.autoCheck){const a=i(v.value);a&&f([a])}},{immediate:!0,debounce:100});function i(a){var b;if(a.length===1)return(b=a[0].children)!=null&&b.length?i(a[0].children):a[0]}async function c(a,{checkedNodes:b}){var n;let h=b.filter(l=>l.type==="user");const N=h.some(l=>l.id===a.id);if(v.value.every(l=>!l.multiple)&&N)h=[a];else if(!a.multiple&&N){const d=((n=s.value)==null?void 0:n.getNode(a)).parent.data.children.filter(p=>p.id!==a.id);h=ct(h,d,"id")}f(h)}function k(a){const b=o.value.filter(h=>h.id!==a.id);f(b)}function f(a){var b;o.value=a,(b=s.value)==null||b.setCheckedNodes(a)}return(a,b)=>{const h=I("el-tag"),N=I("Icon"),n=I("el-tree");return V(),R(H,null,[(V(!0),R(H,null,ee(_(o),l=>(V(),T(h,{key:l.id,type:"info",closable:"",onClose:r=>k(l)},{default:D(()=>[M(G(l.title),1)]),_:2},1032,["onClose"]))),128)),L(n,se({ref_key:"treeRef",ref:s,class:["approval-tree",`mode-${a.mode}`],data:v.value},w),{default:D(({data:l})=>[q("div",null,[L(N,{icon:y[l.type]||y.element,style:{display:"inline-block"}},null,8,["icon"]),q("span",null,G(l.title),1)])]),_:1},16,["class","data"])],64)}}});const Ve=fe(_t,[["__scopeId","data-v-9646bed9"]]),yt={key:0},Ne=Q({__name:"assignee-setter",props:{modelValue:{},tableData:{},placeholder:{}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,y=A({get(){return typeof o.modelValue=="string"?o.modelValue?o.modelValue.split(","):[]:o.modelValue},set(N){var n;t("update:modelValue",N.join(",")),(n=o.tableData)!=null&&n.row&&(o.tableData.row.values=ke(v.value,l=>N==null?void 0:N.includes(l.id)),o.tableData.row.idVal=o.tableData.row.values.map(l=>l[`${s.value}Id`]).join(","))}}),u=A({get(){return Array.isArray(o.modelValue)?o.modelValue.join(","):o.modelValue},set(N){t("update:modelValue",N)}}),w=j(!1),s=A(()=>{var N,n;return(n=(N=o.tableData)==null?void 0:N.row)==null?void 0:n.type}),v=j([]),i=j([]),{request:c}=W(),{getUserTree:k}=zt(c),{getParam:f}=ie(c);et(s,async N=>{try{if(w.value=!0,["dept","post","user"].includes(N)){const n=await k(N==="user"?"":N);v.value=n.data}else if(s.value==="dynamic"){const n=await f("flow.trends.user");i.value=n.data}}finally{w.value=!1}},{immediate:!0});function a(){y.value=ke(v.value,N=>N.type===s.value).map(N=>N.id)}const b=A(()=>({checkStrictly:s.value!=="user",clearable:!0,collapseTags:!0,collapseTagsTooltip:!0,data:v.value,filterable:!0,loading:w.value,maxCollapseTags:3,multiple:!0,nodeKey:"id",props:{label:"title"},placeholder:"请选择",showCheckbox:!0})),h=A(()=>({clearable:!0,data:i.value,filterable:!0,loading:w.value,nodeKey:"value",props:{label:"title"},placeholder:"请选择"}));return(N,n)=>{const l=I("el-tree-select"),r=I("el-button"),d=I("el-input");return["dept","post","user"].includes(s.value)?(V(),R("div",yt,[L(l,se({modelValue:y.value,"onUpdate:modelValue":n[0]||(n[0]=p=>y.value=p)},b.value,{style:{width:"75%"}}),null,16,["modelValue"]),L(r,{text:"",type:"primary",icon:"el-icon-check",style:{width:"20%"},onClick:a},{default:D(()=>[M(" 全选 ")]),_:1})])):s.value==="dynamic"?(V(),T(l,se({key:1,modelValue:u.value,"onUpdate:modelValue":n[1]||(n[1]=p=>u.value=p)},h.value,{style:{width:"100%"}}),null,16,["modelValue"])):s.value==="userTask"?(V(),T(_(Je),{key:2,modelValue:u.value,"onUpdate:modelValue":n[2]||(n[2]=p=>u.value=p),"filter-type":"userTask",placeholder:"请选择"},null,8,["modelValue"])):(V(),T(d,{key:3,modelValue:u.value,"onUpdate:modelValue":n[3]||(n[3]=p=>u.value=p),clearable:"",placeholder:"请输入"},null,8,["modelValue"]))}}}),wt={key:0,class:"flow-viewer"},gt={key:0,class:"flow-status-legend"},kt={class:"legend-text"},ht=Q({__name:"index",props:{modelValue:{},view:{type:Boolean},flowFormOption:{},flowHistory:{},showLegend:{type:Boolean}},emits:["update:modelValue","nodeClick"],setup(e,{emit:t}){const o=e,y=tt();Ge(y,()=>{var l;(l=y.value)==null||l.on("node:click",r=>t("nodeClick",r))});const u=A({get(){let l=We();return typeof o.modelValue=="string"&&o.modelValue?l=JSON.parse(o.modelValue):typeof o.modelValue=="object"&&Object.keys(o.modelValue)&&(l=o.modelValue),l},set(l){t("update:modelValue",JSON.stringify(l))}}),w=A(()=>{const{column:l=[],group:r=[]}=JSON.parse(o.flowFormOption||"{}");return[...l,...r.map(p=>p.column??[]).flat()]}),{FlowDesign:s,tabs:v,request:i}=W(),{data:c}=Ke(i).useList(),k=A(()=>(v==null?void 0:v.map(l=>({...l,display:!0})))??[]),f=A(()=>{var l;return{formPropertyList:[...w.value,...k.value],buttonList:(l=c.value)==null?void 0:l.filter(r=>r.status===1),fieldsDic:w.value.map(r=>({label:r.label,value:`\${${r.prop}}`,desc:`\${${r.prop}}`})),flowButtonDisplayDic:J(ve),flowButtonApprovalDic:J(be)}}),a=j({}),b=j({});Ie(b,l=>{var r,d,p,m,C,U;l&&((p=(d=(r=l.assignee)==null?void 0:r.children)==null?void 0:d.column)!=null&&p[1]&&(l.assignee.children.column[1].component=Ne),(U=(C=(m=l.circulate)==null?void 0:m.children)==null?void 0:C.column)!=null&&U[1]&&(l.circulate.children.column[1].component=Ne))},{debounce:1});const{data:h}=ie(i).useParam("flow.task.status"),N=A(()=>{var l;return(l=o.flowHistory)==null?void 0:l.map(r=>{var p,m;const d=(m=(p=h.value)==null?void 0:p.find(C=>C.value===r.status))==null?void 0:m.style;return{id:r.taskNodeKey,style:d}})}),n=A(()=>{var l,r;return(r=(l=o.flowHistory)==null?void 0:l.filter(d=>d.taskNodeType==="userTask"))==null?void 0:r.map(d=>{var p;return{id:d.taskNodeKey,content:`<div>${d.assigneeName}</div>
        <div>${d.endTime??""}</div>
        <div>${((p=d.comment)==null?void 0:p.handleComment)??""}</div>`}})});return(l,r)=>l.view?(V(),R("div",wt,[l.showLegend!==!1?(V(),R("div",gt,[(V(!0),R(H,null,ee(_(h),d=>{var p;return V(),R("div",{key:d.label,class:"legend-item"},[q("div",{class:"legend-color",style:at({backgroundColor:(p=d.style)==null?void 0:p.fill})},null,4),q("span",kt,G(d.label),1)])}),128))])):E("",!0),L(_(s),{lf:y.value,"onUpdate:lf":r[0]||(r[0]=d=>y.value=d),"model-value":u.value,styles:N.value,tooltips:n.value,type:"viewer"},null,8,["lf","model-value","styles","tooltips"])])):(V(),T(_(s),{key:1,modelValue:u.value,"onUpdate:modelValue":r[1]||(r[1]=d=>u.value=d),formData:a.value,"onUpdate:formData":r[2]||(r[2]=d=>a.value=d),formDefaults:b.value,"onUpdate:formDefaults":r[3]||(r[3]=d=>b.value=d),"form-options":_(Qe),"data-options":f.value,"form-width":"30%"},null,8,["modelValue","formData","formDefaults","form-options","data-options"]))}});const Te=fe(ht,[["__scopeId","data-v-79c19aa8"]]),Vt=Q({__name:"node-select",props:{modelValue:{}},setup(e){const t=e,{modelValue:o}=re(t),{flowDetail:y}=F(),u=j(!1);function w({data:s}){s.type==="userTask"&&(u.value=!1,o.value=s.id)}return(s,v)=>{const i=I("el-button"),c=I("el-popover");return V(),T(c,{visible:u.value,"onUpdate:visible":v[0]||(v[0]=k=>u.value=k),placement:"bottom-start",width:"800px",trigger:"click"},{reference:D(()=>[L(i,null,{default:D(()=>[M(" 点击选择节点 ")]),_:1})]),default:D(()=>{var k,f;return[L(Te,{"model-value":(f=(k=_(y))==null?void 0:k.process)==null?void 0:f.flowData,view:"",style:{height:"600px"},onNodeClick:w},null,8,["model-value"])]}),_:1},8,["visible"])}}}),Nt=Q({__name:"approval-form",emits:["submit"],setup(e,{emit:t}){const{request:o}=W(),{getApprovalNode:y}=_e(o),{useParam:u}=ie(o),{formData:w,approvalFormData:s,activeBtn:v,approvalVisible:i,formVariables:c,flowDetail:k}=F(),f=j([]),a=j([]),b=j([]),h=j([]),N=j(!1),n=j(!1),l=j(),r=A(()=>{const S=f.value.length,g=b.value.length&&!f.value.length;return{menuBtn:!1,labelWidth:"auto",span:24,column:[{label:"指定节点",prop:"jumpTaskNodeKey",display:d("specifyNode"),rules:[{required:!0,message:"请选择指定节点"}]},{label:"审批人",prop:"assignee",display:d("assignee"),rules:S?[{required:!0,validator:p}]:[]},{label:"传阅人",prop:"circulate",display:d("circulate"),rules:g?[{required:!0,message:"请选择传阅人"}]:[]},{label:"意见",prop:"comment",display:d("comment"),rules:[{required:!0,message:"请填写意见"}]}]}});function d(S){var g,$;return($=(g=v.value)==null?void 0:g.approval)==null?void 0:$.includes(S)}function p(S,g,$){var x,Z,B;const K=((x=f.value[0])==null?void 0:x.type)==="parallelGateway",P=(B=(Z=f.value[0])==null?void 0:Z.children)==null?void 0:B.every(ce=>it([ce],ze=>a.value.some(Be=>Be.id===ze.id)));if(a.value.length){if(K&&!P)return $("请在每个节点选择审批人")}else return $("请选择审批人");return!0}const{data:m}=u("flow.approval.autocheck"),{data:C}=u("flow.approval.autocomment");ue(async()=>{var $,K;if(!i.value||!l.value)return;me(()=>{l.value.resetFields(),s.value.comment=w.value.comment||C.value==="true"&&v.value.name||""});const{taskId:S}=(($=k.value)==null?void 0:$.task)||{},{flowKey:g}=((K=k.value)==null?void 0:K.process)||{};if(U(),!!d("assignee")&&!(d("specifyNode")&&!s.value.jumpTaskNodeKey))try{n.value=!0;const P=await y({flowKey:g,taskId:S,variables:c.value,buttonType:v.value.buttonKey,jumpTaskNodeKey:s.value.jumpTaskNodeKey});f.value=P.data.approvalNodeList,b.value=P.data.circulateNodeList}finally{n.value=!1}});function U(){f.value=[],a.value=[],b.value=[],h.value=[]}async function O(){await Ae(l),N.value=!0;const{data:S,outgoing:g}=z(a.value),{data:$}=z(h.value);s.value.assignee=S,s.value.circulate=$,s.value.outgoing=[...g],t("submit")}function z(S){const g={},$={},K=new Set;return S.forEach(P=>{const{taskNodeKey:x,incoming:Z}=P;g[x]||(g[x]=new Set),P.userId&&g[x].add(P.userId),$[x]=[...g[x]].join(","),Z&&K.add(Z)}),{dataSet:g,data:$,outgoing:K}}return(S,g)=>{const $=I("el-skeleton"),K=I("avue-form"),P=I("el-button");return V(),T(xe(_(Y)()?"el-drawer":"el-dialog"),{modelValue:_(i),"onUpdate:modelValue":g[6]||(g[6]=x=>oe(i)?i.value=x:null),class:"approval-form-overlay",title:_(v).name,"append-to-body":"",width:"900px",size:"50%",direction:"btt"},{footer:D(()=>[L(P,{onClick:g[5]||(g[5]=x=>i.value=!1)},{default:D(()=>[M(" 取 消 ")]),_:1}),L(P,{type:"primary",onClick:O},{default:D(()=>[M(" 确 定 ")]),_:1})]),default:D(()=>[L(K,{ref_key:"formRef",ref:l,modelValue:_(s),"onUpdate:modelValue":g[4]||(g[4]=x=>oe(s)?s.value=x:null),class:"approval-form",option:r.value},{jumpTaskNodeKey:D(()=>[L(Vt,{modelValue:_(s).jumpTaskNodeKey,"onUpdate:modelValue":g[0]||(g[0]=x=>_(s).jumpTaskNodeKey=x)},null,8,["modelValue"])]),assignee:D(()=>[n.value?(V(),T($,{key:0})):(V(),T(Ve,{key:"AssigneeTree",modelValue:a.value,"onUpdate:modelValue":g[1]||(g[1]=x=>a.value=x),data:f.value,"auto-check":_(m)==="true",mode:_(Y)()?"vertical":"horizontal"},null,8,["modelValue","data","auto-check","mode"]))]),circulate:D(()=>[n.value?(V(),T($,{key:0})):(V(),T(Ve,{key:"CirculateTree",modelValue:h.value,"onUpdate:modelValue":g[2]||(g[2]=x=>h.value=x),data:b.value,mode:_(Y)()?"vertical":"horizontal"},null,8,["modelValue","data","mode"]))]),comment:D(()=>[L(bt,{modelValue:_(s).comment,"onUpdate:modelValue":g[3]||(g[3]=x=>_(s).comment=x)},null,8,["modelValue"])]),_:1},8,["modelValue","option"])]),_:1},8,["modelValue","title"])}}});const Dt={class:"flow-form__title"},Ct=Q({__name:"index",props:mt,emits:ft,setup(e,{emit:t}){const y=vt(e,t),{ApprovalForm:u,tabsProps:w}=W(),s=u??Nt,{title:v,detail:i,flowDetail:c,tabRefs:k,tabList:f,activeTab:a,activeBtn:b,formLoading:h,approvalVisible:N,submitLoading:n,beforeClick:l,beforeSubmit:r,afterSubmit:d,tabsRef:p}=y;async function m(O){var z,S;b.value=O;for(const g of Object.values(k.value))await((z=g==null?void 0:g.validate)==null?void 0:z.call(g));await((S=l==null?void 0:l.value)==null?void 0:S.call(l,O)),(O==null?void 0:O.approval)!=="false"?N.value=!0:U()}const C=pt(y);async function U(){var O,z;try{const{buttonKey:S}=b.value;n.value=!0,await((O=r==null?void 0:r.value)==null?void 0:O.call(r,b.value));const g=C[S];g?(await(g==null?void 0:g()),await((z=d==null?void 0:d.value)==null?void 0:z.call(d,b.value)),N.value=!1,t("complete",b.value)):le.error("无法找到相应的操作")}finally{n.value=!1}}return(O,z)=>{const S=I("el-skeleton"),g=I("el-main"),$=I("el-header"),K=I("el-tab-pane"),P=I("el-tabs"),x=I("el-footer"),Z=I("el-container");return _(h)?(V(),T(g,{key:0},{default:D(()=>[L(S)]),_:1})):(V(),T(Z,{key:1,class:"flow-form"},{default:D(()=>[L($,{class:"flow-form__header",height:"auto"},{default:D(()=>{var B;return[q("div",Dt,G(_(v)??((B=_(c).flowInstance)==null?void 0:B.title)),1),!_(i)&&!_(Y)()?(V(),T(he,{key:0,onClick:m})):E("",!0)]}),_:1}),L(g,{class:"flow-form__main"},{default:D(()=>[L(P,se({ref_key:"tabsRef",ref:p,modelValue:_(a),"onUpdate:modelValue":z[0]||(z[0]=B=>oe(a)?a.value=B:null)},_(w)),{default:D(()=>[(V(!0),R(H,null,ee(_(f),B=>(V(),T(K,{key:B.prop,label:B.label,name:B.prop,lazy:B.lazy,disabled:B.disabled,closable:B.closable},{default:D(()=>[(V(),T(xe(B.component),{ref_for:!0,ref:ce=>_(k)[B.prop]=ce},null,512))]),_:2},1032,["label","name","lazy","disabled","closable"]))),128))]),_:1},16,["modelValue"])]),_:1}),!_(i)&&_(Y)()?(V(),T(x,{key:0,class:"flow-form__footer",height:"auto"},{default:D(()=>[L(he,{onClick:m})]),_:1})):E("",!0),L(_(s),{onSubmit:U})]),_:1}))}}});const It=Q({setup(){const{flowDetail:e,formData:t,detail:o}=F(),y=dt(e.value),{proxy:u}=ot(),w=j({});ue(()=>{const{formOption:i}=e.value.process??{};w.value=Ye.bind(u)(i||'{"menuBtn":false}'),w.value.detail=!!o.value});const s=j();function v(){return Ae(s)}return{form:t,option:w,defaults:y,formRef:s,validate:v}},render(){return lt(I("avue-form"),{ref:"formRef",modelValue:this.form,defaults:this.defaults,option:this.option,class:this.option.class,"onUpdate:modelValue":e=>this.form=e,"onUpdate:defaults":e=>this.defaults=e})}}),Ut=Q({__name:"upload-table",setup(e){const{flowDetail:t,fileIds:o,detail:y}=F(),{upload:{action:u,headers:w,preview:s,download:v,props:i}={},request:c}=W(),k=typeof w=="function"?w():w,f=A(()=>{var C,U;return((U=(C=t.value)==null?void 0:C.task)==null?void 0:U.flowInstanceId)??$e()}),a=[{label:"文件名",prop:"fileName"},{label:"文件类型",prop:"fileType"},{label:"文件大小",prop:"fileSize"},{label:"版本",prop:"version"},{label:"上传时间",prop:"createTime"}],b=a.filter(C=>C.prop==="fileName"),h={rowKey:"id",align:"center",index:!1,border:!0,stripe:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuType:"menu",menuBtnTitle:"操作",column:Y()?b:a},{bindVal:N,getDataList:n,handleDel:l,handleSave:r,afterGetList:d,crudStateRefs:{tableData:p}}=Xe({crudOption:{...jt(c),saveSuccessMsg:"上传成功"},tableOption:h,queryForm:{isLatest:1,flowInstanceId:f.value}});d(()=>{o.value=p.value.map(C=>C.id).join(",")}),n();async function m(C,U){var P,x;const{fileName:O,fileType:z,fileSize:S,fileUrl:g,res:$}=i,K={fileName:ae({res:C},`${$}.${O}`),fileType:ae({res:C},`${$}.${z}`),fileSize:ae({res:C},`${$}.${S}`),fileUrl:ae({res:C},`${$}.${g}`),taskId:(x=(P=t.value)==null?void 0:P.task)==null?void 0:x.taskId,flowInstanceId:f.value,rootMark:(U==null?void 0:U.rootMark)||"",version:typeof(U==null?void 0:U.version)=="number"?U.version+1:1};await r(K,n,()=>{})}return(C,U)=>{const O=I("el-button"),z=I("el-upload"),S=I("el-dropdown-item"),g=I("avue-crud");return V(),T(g,st(nt(_(N))),{"menu-left":D(()=>[_(y)?E("",!0):(V(),T(z,{key:0,action:_(u),headers:_(k),"show-file-list":!1,onSuccess:U[0]||(U[0]=$=>m($))},{default:D(()=>[L(O,{type:"primary",icon:"el-icon-upload"},{default:D(()=>[M(" 点击上传 ")]),_:1})]),_:1},8,["action","headers"]))]),"menu-btn":D(({row:$,index:K})=>[L(S,{icon:"el-icon-view",onClick:P=>{var x;return(x=_(s))==null?void 0:x($,_(p))}},{default:D(()=>[M(" 预览 ")]),_:2},1032,["onClick"]),L(S,{icon:"el-icon-download",onClick:P=>{var x;return(x=_(v))==null?void 0:x($,_(p))}},{default:D(()=>[M(" 下载 ")]),_:2},1032,["onClick"]),_(y)?E("",!0):(V(),T(S,{key:0,icon:"el-icon-upload"},{default:D(()=>[L(z,{action:_(u),headers:_(k),"show-file-list":!1,onSuccess:P=>m(P,$)},{default:D(()=>[M(" 更新版本 ")]),_:2},1032,["action","headers","onSuccess"])]),_:2},1024)),_(y)?E("",!0):(V(),T(S,{key:1,icon:"el-icon-delete",onClick:P=>_(l)($,K)},{default:D(()=>[M(" 删除 ")]),_:2},1032,["onClick"]))]),_:1},16)}}}),xt={class:"flow-track"},$t={key:0},Lt={key:1},Tt=Q({__name:"flow-track",setup(e){const{flowDetail:t}=F(),o=j(Y()?"timeline":"table"),y=[{label:"table",icon:"ep:grid"},{label:"graph",icon:"ep:picture"},{label:"timeline",icon:"ep:finished"}],u=A(()=>{var c,k,f;return((f=(k=(c=t.value)==null?void 0:c.flowHistory)==null?void 0:k.filter(a=>a.taskNodeType==="userTask"))==null?void 0:f.map(a=>({...a,duration:Re(a.duration)})))??[]}),w={addBtn:!1,menu:!1,border:!0,column:[{label:"节点名称",prop:"taskNodeName"},{label:"处理人",prop:"assigneeName"},{label:"接收时间",prop:"startTime"},{label:"处理时间",prop:"endTime"},{label:"办理时长",prop:"duration"},{label:"操作类型",prop:"type",dicUrl:"/sapier-flow/flow-param/getParam",dicQuery:{paramKey:"flow.handle.type"}},{label:"办理意见",prop:"comment",bind:"comment.handleComment"}]},{request:s}=W(),{data:v}=ie(s).useParam("flow.handle.type");function i(c){var k;return(k=v.value)==null?void 0:k.find(f=>f.value===c)}return(c,k)=>{var r,d,p;const f=I("el-radio-button"),a=I("el-radio-group"),b=I("avue-crud"),h=I("el-card"),N=I("el-timeline-item"),n=I("el-timeline"),l=I("el-empty");return V(),R(H,null,[_(Y)()?E("",!0):(V(),T(a,{key:0,modelValue:o.value,"onUpdate:modelValue":k[0]||(k[0]=m=>o.value=m)},{default:D(()=>[(V(),R(H,null,ee(y,m=>L(f,{key:m.label,label:m.label},{default:D(()=>[L(_(Ce),{icon:m.icon},null,8,["icon"])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])),q("div",xt,[o.value==="table"?(V(),T(b,{key:0,data:u.value,option:w},null,8,["data"])):E("",!0),o.value==="graph"?(V(),T(Te,{key:1,"model-value":(d=(r=_(t))==null?void 0:r.process)==null?void 0:d.flowData,"flow-history":(p=_(t))==null?void 0:p.flowHistory,view:"","show-legend":""},null,8,["model-value","flow-history"])):E("",!0),o.value==="timeline"?(V(),R(H,{key:2},[u.value.length?(V(),T(n,{key:0},{default:D(()=>[(V(!0),R(H,null,ee([...u.value].reverse(),m=>(V(),T(N,{key:m.id,timestamp:m.endTime,placement:"top"},{default:D(()=>[L(h,null,{default:D(()=>{var C,U,O;return[q("div",null,G(m.assigneeName)+" 开始处理 ["+G(m.taskNodeName)+"] 环节 ",1),m.duration?(V(),R("div",$t," 办理时长："+G(m.duration),1)):E("",!0),m.type&&((C=m.comment)!=null&&C.handleComment)?(V(),R("div",Lt,G((U=i(m.type))==null?void 0:U.label)+"意见："+G((O=m.comment)==null?void 0:O.handleComment),1)):E("",!0)]}),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:1})):(V(),T(l,{key:1}))],64)):E("",!0)])],64)}}});const Ot=fe(Tt,[["__scopeId","data-v-a1713c28"]]),St={FlowDesign:{},FormDesign:{},FlowForm:Ct,request:{},tabs:[{label:"审批表单",prop:"formTab",component:It},{label:"附件资料",prop:"fileTab",component:Ut},{label:"流程跟踪",prop:"trackTab",component:Ot}],useFlowFormOptions:{type:"drawer",window:["","flow-form","left=0,top=0,width=1600,height=900"],overlay:{width:"80%",size:"80%",top:"100px",fullscreen:!0,destroyOnClose:!0}},tableOption:{align:"center",border:!0,card:!0,stripe:!0,searchMenuSpan:6,span:24},upload:{props:{fileName:"fileOriginalName",fileType:"fileType",fileSize:"fileSize",fileUrl:"fileUrl",res:"res.data"}}};function Kt(e){const t={list:"/sapier-flow/flow-user-common/list",save:"/sapier-flow/flow-user-common/save",update:"/sapier-flow/flow-user-common/update",remove:"/sapier-flow/flow-user-common/remove",batchUpdate:"/sapier-flow/flow-user-common/batchUpdate"},o=i=>e.get(t.list,{params:{type:i,ascs:"sort"}});return{url:t,getList:o,useList:i=>te(()=>o(i.value).then(c=>c.data.records),{refreshDeps:[i]}),create:i=>e.post(t.save,i),update:i=>e.post(t.update,i),remove:i=>e.post(t.remove,{},{params:{ids:i}}),batchUpdate:i=>e.post(t.batchUpdate,i)}}var Oe=(e=>(e.默认="default",e.主要="primary",e.成功="success",e.警告="warning",e.危险="danger",e.信息="info",e.文字="text",e))(Oe||{}),Pt=(e=>(e.保存草稿="flow_draft",e.发送="flow_pass",e.退回="flow_reject",e.终止="flow_terminate",e.撤销="flow_revoke",e.撤回到发起="flow_withdraw",e.打印="flow_print",e.转办="flow_transfer",e.加签="flow_add_instance",e.减签="flow_del_instance",e.指定回退="flow_rollback",e.绿色通道="flow_green",e))(Pt||{}),ve=(e=>(e.显示="true",e.隐藏="false",e.发起人="startUser",e.处理人="assignee",e.已办="done",e.待办="todo",e.未发起="notstarted",e.已发起="started",e.未办结="unfinished",e.已办结="finished",e))(ve||{}),be=(e=>(e.不显示="false",e.指定节点="specifyNode",e.审批人="assignee",e.传阅人="circulate",e.意见="comment",e))(be||{}),Se=(e=>(e[e.禁用=0]="禁用",e[e.正常=1]="正常",e))(Se||{});function Ke(e){const t={list:"/sapier-flow/dev-button/list",save:"/sapier-flow/dev-button/save",update:"/sapier-flow/dev-button/update",remove:"/sapier-flow/dev-button/remove"},o=v=>e.get(t.list,{params:v});return{url:t,getList:o,useList:()=>te(()=>o({size:-1,ascs:"sort"}).then(v=>v.data.records)),create:v=>e.post(t.save,v),update:v=>e.post(t.update,v),remove:v=>e.post(t.remove,{},{params:{ids:v}})}}function jt(e){const t={list:"/sapier-flow/flow-file/list",save:"/sapier-flow/flow-file/save",remove:"/sapier-flow/flow-file/remove"};return{getList:w=>e.get(t.list,{params:w}),create:w=>e.post(t.save,w),remove:w=>e.post(t.remove,{},{params:{ids:w}})}}function ie(e){const t={list:"/sapier-flow/flow-param/list",save:"/sapier-flow/flow-param/save",update:"/sapier-flow/flow-param/update",remove:"/sapier-flow/flow-param/remove",all:"/sapier-flow/flow-param/getAllParam",key:"/sapier-flow/flow-param/getParam"},o=c=>e.get(t.list,{params:c}),y=()=>e.get(t.all),u=c=>e.get(t.key,{params:{paramKey:c}});return{url:t,getList:o,getAllParam:y,getParam:u,useParam:c=>te(()=>u(c).then(k=>k.data)),create:c=>e.post(t.save,c),update:c=>e.post(t.update,c),remove:c=>e.post(t.remove,{},{params:{ids:c}})}}var ne=(e=>(e[e.已办=1]="已办",e[e.待办=2]="待办",e[e.失败=3]="失败",e[e.撤销=4]="撤销",e[e.终止=5]="终止",e))(ne||{}),pe=(e=>(e[e.已办结=1]="已办结",e[e.未办结=2]="未办结",e[e.已终止=3]="已终止",e))(pe||{}),At=(e=>(e[e.系统执行=1]="系统执行",e[e.用户办理=2]="用户办理",e[e.任务撤销=3]="任务撤销",e[e.任务退回=4]="任务退回",e[e.流程终止=5]="流程终止",e[e.任务转办=6]="任务转办",e[e.绿色通道=7]="绿色通道",e))(At||{});function _e(e){const t={publishList:"/sapier-flow/flow-run/queryPublishFlowList",taskList:"/sapier-flow/flow-run/userTaskList",detail:"/sapier-flow/flow-run/queryPublishFlowDetail",approvalNode:"/sapier-flow/flow-run/queryApprovalNode",start:"/sapier-flow/flow-run/startProcess",commit:"/sapier-flow/flow-run/commitTask",draft:"/sapier-flow/flow-run/saveDraft",revoke:"/sapier-flow/flow-run/revokeTask",terminate:"/sapier-flow/flow-run/terminateFlow",withdraw:"/sapier-flow/flow-run/withdrawToStart",transfer:"/sapier-flow/flow-run/transferTask",reject:"/sapier-flow/flow-run/rollbackTask",green:"/sapier-flow/flow-run/greenTask"},o=n=>e.get(t.detail,{params:n}),y=n=>e.post(t.approvalNode,n),u=n=>e.post(t.start,n),w=n=>e.post(t.commit,n),s=n=>e.post(t.draft,n),v=n=>e.post(t.revoke,n),i=n=>e.post(t.terminate,n),c=n=>e.post(t.withdraw,n),k=n=>e.post(t.transfer,n),f=n=>e.post(t.reject,n),a=n=>e.post(t.green,n),b=()=>e.get(t.publishList);return{url:t,getFlowDetail:o,getApprovalNode:y,startTask:u,commitTask:w,saveDraft:s,revokeTask:v,terminateTask:i,withdrawTask:c,transferTask:k,rejectTask:f,greenChannel:a,getPublishList:b,usePublishList:()=>te(()=>b().then(n=>n.data)),getTaskList:n=>e.get(t.taskList,{params:n})}}function zt(e){const t={tree:"/sapier-flow/flow-user/tree"},o=u=>e.get(t.tree,{params:{filter:u}});return{url:t,getUserTree:o,useUserTree:()=>te(()=>o().then(u=>u.data))}}var ye=(e=>(e.ASSIGN_ID="ASSIGN_ID",e.ASSIGN_UUID="ASSIGN_UUID",e.AUTO="AUTO",e.INPUT="INPUT",e.NONE="NONE",e))(ye||{}),we=(e=>(e.bigint="bigint",e.blob="blob",e.char="char",e.date="date",e.datetime="datetime",e.decimal="decimal",e.double="double",e.enum="enum",e.float="float",e.int="int",e.longblob="longblob",e.longtext="longtext",e.mediumblob="mediumblob",e.mediumint="mediumint",e.mediumtext="mediumtext",e.set="set",e.smallint="smallint",e.text="text",e.time="time",e.timestamp="timestamp",e.tinyblob="tinyblob",e.tinyint="tinyint",e.tinytext="tinytext",e.varbinary="varbinary",e.varchar="varchar",e.year="year",e))(we||{});function sa(e){const t={list:"/sapier-flow/dev-table/list",save:"/sapier-flow/dev-table/save",update:"/sapier-flow/dev-table/update",remove:"/sapier-flow/dev-table/remove",deploy:"/sapier-flow/dev-table/deploy",getFields:"/sapier-flow/dev-table/getTableFields"},o=c=>e.get(t.list,{params:c});return{url:t,getList:o,useList:()=>te(()=>o({size:-1}).then(c=>c.data.records)),create:c=>e.post(t.save,c),update:c=>e.post(t.update,c),remove:c=>e.post(t.remove,{},{params:{ids:c}}),deploy:c=>e.post(t.deploy,c),getFields:c=>e.get(t.getFields,{params:c})}}var Pe=(e=>(e[e.否=0]="否",e[e.是=1]="是",e))(Pe||{});const de=J(Pe),na=J(we),ra=J(ye),Bt=Ue(St);function W(e){return He(Bt,e)}const ua=X({rowKey:"id",labelWidth:150,column:[{label:"按钮名称",prop:"name",search:!0},{label:"按钮标识",prop:"buttonKey",search:!0},{label:"按钮图标",prop:"icon",component:"icon-select"},{label:"按钮类型",prop:"buttonType",type:"select",dicData:J(Oe)},{label:"默认显示条件",prop:"display",type:"select",multiple:!0,dataType:"string",value:"false",dicData:J(ve),tip:"选择多个时,所有条件都满足才显示",labelTip:`显示: 始终显示;<br/>隐藏: 始终隐藏;<br/>
      发起人: 用户为发起人时显示;<br/>处理人: 用户为处理人时显示;<br/>
      已办: 任务状态为已办时显示;<br/>待办: 任务状态为待办时显示;<br/>
      未发起: 流程未发起时显示;<br/>已发起: 流程已发起时显示;<br/>
      未办结: 流程未办结时显示;<br/>已办结: 流程已办结时显示;`},{label:"默认审批窗口显示",prop:"approval",type:"select",multiple:!0,dataType:"string",value:"false",dicData:J(be),labelTip:`不显示: 不显示审批窗口;<br/>指定节点: 显示指定节点选择框(常用于绿色通道等);<br/>
      审批人: 显示审批人选择框;<br/>传阅人: 显示传阅人选择框;<br/>意见: 显示意见输入框;`},{label:"排序",prop:"sort",type:"number",value:0},{label:"状态",prop:"status",type:"switch",value:1,dicData:J(Se)},{label:"按钮预览",prop:"buttonPreview",width:150}]}),je={menuBtn:!1,span:24,column:[{label:"流程名称",prop:"flowName",rules:[{required:!0,message:"请输入流程名称"}]},{label:"流程标识",prop:"flowKey",editDisabled:!0,rules:[{required:!0,message:"请输入流程标识"}]},{label:"流程分类",prop:"categoryId",type:"select",dicUrl:"/sapier-flow/flow-category/list",dicQuery:{size:-1},props:{label:"name",value:"id"}},{label:"流程图标",prop:"flowIcon",component:"icon-select"},{label:"流程描述",prop:"remarks"},{label:"自定义表单",prop:"formPath"},{label:"关联表",prop:"formDataTable",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicUrl:"/sapier-flow/dev-table/list",dicQuery:{size:-1},props:{label:"tableComment",value:"tableName",desc:"tableName",res:"data.records"}},{label:"排序",prop:"sort",type:"number",width:110},{label:"表单设计",prop:"formOption",display:!1,hide:!0},{label:"模型设计",prop:"flowData",display:!1,hide:!0}]},ia=X({rowKey:"flowModuleId",dialogFullscreen:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuWidth:100,menuType:"menu",menuBtnTitle:"操作",column:[...je.column.map((e,t)=>({...e,search:t<2})),{label:"流程主版本",prop:"mainVersion",formatter(e,t){return t?`V${t||""}`:""}}]}),ca=X({rowKey:"flowDeloyId",dialogFullscreen:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuWidth:100,menuType:"menu",menuBtnTitle:"操作",column:[...je.column,{label:"流程版本",prop:"version",formatter(e,t){return t?`V${t||""}`:""}},{label:"是否主版本",prop:"mainVersion",type:"select",dicData:[{label:"否",value:0},{label:"是",value:1}]}]}),pa=X({rowKey:"id",menu:!1,addBtn:!1,column:[{label:"流程名称",prop:"flowName"},{label:"流程标识",prop:"flowKey"},{label:"流程分类",prop:"categoryId",type:"select",search:!0,dicUrl:"/sapier-flow/flow-category/list",props:{label:"name",value:"id"}},{label:"标题",prop:"processTitle",search:!0},{label:"流水号",prop:"serialNumber"},{label:"当前节点",prop:"taskNodeName"},{label:"审批人",prop:"assigneeName"},{label:"申请人",prop:"applyUserName"},{label:"接收时间",prop:"startTime"},{label:"任务状态",prop:"status",type:"select",search:!0,searchValue:ne.待办,dicUrl:"/sapier-flow/flow-param/getParam",dicQuery:{paramKey:"flow.task.status"}}]}),da=X({rowKey:"id",column:[{label:"配置名称",prop:"paramName",search:!0},{label:"配置Key",prop:"paramKey",search:!0},{label:"备注",prop:"remark"},{label:"系统内置",prop:"paramType",type:"switch",dicData:de},{label:"配置值",prop:"paramValue",type:"textarea",maxRows:20,span:24,overHidden:!0}]}),ma=X({rowKey:"id",menu:!1,addBtn:!1,column:[{label:"流程名称",prop:"flowName"},{label:"流程标识",prop:"flowKey"},{label:"流程分类",prop:"categoryId",type:"select",search:!0,dicUrl:"/sapier-flow/flow-category/list",props:{label:"name",value:"id"}},{label:"标题",prop:"processTitle",search:!0},{label:"流水号",prop:"serialNumber"},{label:"当前节点",prop:"taskNodeName"},{label:"审批人",prop:"assigneeName"},{label:"申请人",prop:"applyUserName"},{label:"接收时间",prop:"startTime"}]});const fa=X({rowKey:"id",column:[{label:"流程标识",prop:"flowKey",search:!0},{label:"流程名称",prop:"flowName",search:!0},{label:"流程备注",prop:"remarks"},{label:"排序",prop:"sort"}]}),va=X({rowKey:"id",column:[{label:"表单标识",prop:"formKey",search:!0},{label:"表单名称",prop:"formName",search:!0},{label:"表单备注",prop:"remarks"},{label:"排序",prop:"sort",type:"number"}]}),De=[{label:"字段名称",prop:"name"},{label:"字段备注",prop:"comment"},{label:"字段类型",prop:"type",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:J(we)},{label:"字段长度",prop:"size",type:"number"},{label:"小数位",prop:"point",type:"number"},{label:"默认值",prop:"default"},{label:"是否主键",prop:"primary",type:"switch",dicData:de,value:0},{label:"是否允许为空",prop:"permitNull",type:"switch",dicData:de,value:1}],ba=X({rowKey:"id",dialogFullscreen:!0,column:[{label:"表名",prop:"tableName",search:!0},{label:"表注释",prop:"tableComment",search:!0},{label:"表引擎",prop:"tableEngine"},{label:"表主键策略",prop:"tablePrimary",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:J(ye)},{label:"数据库字段",prop:"editFields",hide:!0,type:"dynamic",children:{column:De}},{label:"默认字段",prop:"defaultFields",hide:!0,type:"dynamic",children:{addBtn:!1,delBtn:!1,column:De}}]});function Ae(e){return new Promise((t,o)=>{_(e).validate((u,w,s)=>{u?(w(),t(s)):o(s)})})}function Y(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}export{zt as A,ye as B,St as C,we as D,X as E,Te as F,de as G,At as H,na as I,ra as J,Nt as K,he as L,Ot as M,It as N,Ut as O,pt as P,mt as Q,ft as R,Le as S,ne as T,vt as U,Y as V,Pe as W,Ct as _,dt as a,Ae as b,W as c,Ke as d,ia as e,ca as f,sa as g,je as h,pa as i,da as j,ie as k,ma as l,_e as m,fa as n,va as o,ba as p,Kt as q,Oe as r,Pt as s,ua as t,F as u,ve as v,be as w,Se as x,jt as y,pe as z};
