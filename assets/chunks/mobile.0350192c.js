import{j as Re}from"./index.288677a1.js";import{I as De}from"./iconify.b68073ff.js";import{a as re,e as Ee,f as Me,w as Ce,g as Ge}from"./index.cd412afd.js";import{_ as Je,d as Qe}from"./index.b00b9483.js";import"./index.ae223fff.js";import{d as We}from"./data.4cb21f02.js";import{j as Ye}from"./tree.21d3b17d.js";import"./index.3d38e212.js";import"./vuedraggable.umd.00d46a83.js";import{u as ee,m as He}from"./index.es.e5378d01.js";import{e as J,u as Xe}from"./index.ac4ff024.js";import{ab as Ie,g as A,h as j,A as ue,l as _,E as de,$ as Ze,S as qe,Y as Fe,d as Q,J as U,c as R,L as F,K as H,o as h,b as T,w as N,N as L,a as M,t as G,B as oe,a3 as we,k as Z,R as se,_ as me,z as et,C as tt,e as E,U as at,O as Ue,a5 as lt,D as ot,a9 as st,aa as nt}from"./framework.f01dabf7.js";import{p as rt}from"./pick.2b716c9d.js";import{t as ut,b as ge,f as it}from"./index.fc3eb3b1.js";import{E as le}from"./index.22b43a78.js";import{u as xe}from"./index.386fc70b.js";import{d as ct}from"./differenceBy.7897613a.js";import{g as ae}from"./get.c8715fa2.js";function X(e){const{tableOption:t}=W();return Ie({...t,...e})}function pt(e){const{buttonHandler:t,request:o}=W(),{commitTask:y,revokeTask:u,saveDraft:w,startTask:s,terminateTask:v,transferTask:i,withdrawTask:p,rejectTask:g,greenChannel:m}=be(o),a=A(()=>{const{flowDetail:k,formVariables:V,approvalFormData:n,debug:l,fileIds:r}=e,{flowDeployId:f}=k.value.process??{},{taskId:c,flowInstanceId:d}=k.value.task??{};return{flowDeployId:f,taskId:c,flowInstanceId:d,variables:V.value,debug:l.value,fileIds:r==null?void 0:r.value,...n.value}}),b=()=>a.value.taskId&&a.value.flowInstanceId;return{flow_draft(){if(b())return w(a.value)},flow_pass(){return b()?y(a.value):s(a.value)},flow_revoke(){if(b())return u(a.value)},flow_withdraw(){if(b())return p(a.value)},flow_terminate(){if(b())return v(a.value)},flow_transfer(){if(b())return i(a.value)},flow_reject(){if(b())return g(a.value)},flow_green(){if(b())return m(a.value)},...t==null?void 0:t(e)}}function dt(e){const t=j({});return ue(async()=>{var y;const{formProperty:o}=((y=_(e))==null?void 0:y.properties)||{};o!=null&&o.length&&(await de(),Object.keys(t.value).forEach(u=>{var v,i,p,g;const w=((v=t.value[u])==null?void 0:v.label)||"",s=o==null?void 0:o.find(m=>m.prop===u);if(t.value[u].display=s==null?void 0:s.display,t.value[u].disabled=s==null?void 0:s.disabled,t.value[u].detail=s==null?void 0:s.detail,t.value[u].readonly=s==null?void 0:s.readonly,t.value[u].rules=t.value[u].rules??[],s!=null&&s.required&&((i=t.value[u].rules)!=null&&i.some(m=>m.required)))return null;s!=null&&s.required?(p=t.value[u].rules)==null||p.push({required:!0,message:`${w}为必填项`}):t.value[u].rules=(g=t.value[u].rules)==null?void 0:g.filter(m=>!m.required)}))}),t}const mt={modelValue:{type:Object,default:()=>({})},title:{type:String},flowDetail:{type:Object,default:()=>({})},formLoading:{type:Boolean},submitLoading:{type:Boolean},activeTab:{type:String,default:"formTab"},activeBtn:{type:Object,default:()=>({})},approvalVisible:{type:Boolean},approvalFormData:{type:Object,default:()=>({})},flowKey:{type:String},taskId:{type:String},instanceId:{type:String},formId:{type:String},fileIds:{type:String},permission:{type:Object},beforeClick:{type:Function},beforeSubmit:{type:Function},detail:{type:[Boolean,String],default:!1},debug:{type:[Boolean,String],default:!1}},ft={complete:e=>e},$e=Symbol("flowFormState");function vt(e,t){const o=re(e,void 0,{passive:!0,deep:!0}),{flowDetail:y,modelValue:u,formLoading:w,activeTab:s}=o,{tabs:v,customForm:i,request:p}=W(),g=j({}),m=A(()=>(v==null?void 0:v.filter(l=>{var f,c,d;const r=(d=(c=(f=y.value)==null?void 0:f.properties)==null?void 0:c.formProperty)==null?void 0:d.find(C=>C.prop===l.prop);return(r==null?void 0:r.display)!==!1}).map(l=>{var f,c;let r=l.component;if(l.prop==="formTab"){const d=i==null?void 0:i[((c=(f=y==null?void 0:y.value)==null?void 0:f.process)==null?void 0:c.formPath)??""];typeof d=="function"?r=Fe(d):d&&(r=d)}return{...l,component:r}}))??[]),a=j();Y()&&Ee(a,{onSwipeEnd(l,r){if(!["left","right"].includes(r))return;const f=m.value.findIndex(d=>d.prop===s.value),c=Me(f+(r==="right"?-1:1),0,m.value.length-1);s.value=m.value[c].prop}});const{getFlowDetail:b}=be(p);ue(()=>{const{flowKey:l,taskId:r,instanceId:f}=e;!l&&!r&&!f||(w.value=!0,b({flowKey:l,taskId:r,flowInstanceId:f}).then(c=>{y.value=c.data,u.value=c.data.formData||{}}).finally(()=>{w.value=!1}))});const k=A(()=>Object.entries(u.value||{}).filter(([l])=>!l.startsWith("$")).map(([l,r])=>({key:l,value:r}))),V=A(()=>e.detail===!0||e.detail==="true"),n={...o,formData:u,formVariables:k,tabRefs:g,tabList:m,detail:V,tabsRef:a,emit:t};return Ze($e,n),n}function q(){return qe($e)}const ke=Q({__name:"button-list",emits:["click"],setup(e,{emit:t}){const{userInfo:o,request:y}=W(),{flowDetail:u}=q(),{data:w}=Se(y).useList();function s(i,p){return i.map(g=>{const m=p.find(b=>b.buttonKey===g.buttonKey);return{...g,...rt(m,["display","approval"])}})}const v=A(()=>{var l,r,f,c;const i=typeof o=="function"?o():o,{assignee:p,status:g}=((l=u.value)==null?void 0:l.task)||{},{createUser:m,flowInstanceId:a,status:b}=((r=u.value)==null?void 0:r.flowInstance)||{},k={true:!0,false:!1,startUser:m==(i==null?void 0:i.userId),assignee:p==(i==null?void 0:i.userId),todo:g==ne.待办,done:g==ne.已办,notstarted:!a,started:!!a,finished:b===ce.已办结,unfinished:b===ce.未办结},{button:V}=((f=u.value)==null?void 0:f.properties)||{};return((c=s(w.value??[],V??[]))==null?void 0:c.filter(d=>{var C,D;return(D=(C=d.display)==null?void 0:C.split(","))==null?void 0:D.every(S=>k[S])}))??[]});return(i,p)=>{const g=U("el-button");return h(!0),R(H,null,F(v.value,m=>(h(),T(g,{key:m.buttonKey,type:m.buttonType,onClick:a=>t("click",m)},{default:N(()=>[L(_(De),{icon:m.icon},null,8,["icon"]),M(" "+G(m.name),1)]),_:2},1032,["type","onClick"]))),128)}}}),bt=Q({__name:"common-comments",props:{modelValue:{}},setup(e){const t=e,{modelValue:o}=re(t),{request:y}=W(),{batchUpdate:u,create:w,remove:s,useList:v}=Kt(y),i=j(!1),{activeBtn:p}=q(),g=A(()=>{var c;return(c=p.value)==null?void 0:c.buttonKey}),{data:m,refresh:a}=v(g),b=A(()=>{var d,C,D;const c=o.value;if(c&&!((d=m.value)!=null&&d.some(S=>S.content===c))){const S=(((D=(C=m.value)==null?void 0:C[0])==null?void 0:D.sort)||1)-1;return[{content:c,sort:S},...m.value||[]]}return m.value});async function k(c){var d;await w({...c,type:(d=p.value)==null?void 0:d.buttonKey}),le.success("添加成功"),a()}async function V(c){await s(c.id),le.success("删除成功"),a()}async function n(c,d){let C=d.parent.data;C=C.map((D,S)=>({id:D.id,sort:S+1})),await u(C),le.success("修改排序成功"),a(),i.value=!1}function l(){i.value=!0}const r=j();async function f(c){var d;o.value=c.content??"",await de(),(d=r.value)==null||d.blur()}return(c,d)=>{const C=U("el-input"),D=U("el-text"),S=U("el-col"),z=U("el-button"),O=U("el-row"),I=U("el-tree"),$=U("el-popover");return h(),T($,{visible:i.value,placement:"bottom",title:"常用意见",width:_(Y)()?"98%":"600px"},{reference:N(()=>[L(C,{ref_key:"inputRef",ref:r,modelValue:_(o),"onUpdate:modelValue":d[0]||(d[0]=K=>oe(o)?o.value=K:null),type:"textarea",placeholder:"请输入意见",rows:"5",onFocus:d[1]||(d[1]=K=>i.value=!0),onBlur:d[2]||(d[2]=K=>i.value=!1)},null,8,["modelValue"])]),default:N(()=>[L(I,{data:b.value,"node-key":"content",draggable:"","allow-drop":(K,P,x)=>x!=="inner",props:{label:"content"},onNodeClick:f,onNodeDrop:n,onNodeDragStart:l},{default:N(({data:K})=>[L(O,{style:{width:"100%"}},{default:N(()=>[L(S,{span:22},{default:N(()=>[L(D,{truncated:"",title:K.content},{default:N(()=>[M(G(K.content),1)]),_:2},1032,["title"])]),_:2},1024),L(S,{span:2},{default:N(()=>[K.id?(h(),T(z,{key:0,type:"danger",size:"small",icon:"el-icon-close",text:"",onClick:we(P=>V(K),["stop"])},null,8,["onClick"])):(h(),T(z,{key:1,type:"primary",size:"small",icon:"el-icon-plus",text:"",onClick:we(P=>k(K),["stop"])},null,8,["onClick"]))]),_:2},1024)]),_:2},1024)]),_:1},8,["data","allow-drop"])]),_:1},8,["visible","width"])}}}),_t=Q({__name:"approval-tree",props:{modelValue:{},data:{},autoCheck:{type:Boolean},mode:{}},setup(e){const t=e,{modelValue:o}=re(t),y={element:"ep:flag",post:"ep:share",dept:"ep:share",user:"ep:user"},w={defaultExpandAll:!0,lazy:!0,showCheckbox:!0,nodeKey:"id",load:(a,b)=>{a.level===0?b(v.value):b(a.data.children??[])},onCheck:p,props:{label:"title",class(a){return`node-${a.type}`}}},s=j(),v=A(()=>ut(t.data??[],(a,b,k)=>{const V=xe();return a.taskNodeKey=(k==null?void 0:k.taskNodeKey)??a.taskNodeKey,a.incoming=(k==null?void 0:k.incoming)??a.incoming,a.multiple=(k==null?void 0:k.multiple)??a.multiple,a.parentId=(k==null?void 0:k.id)??a.parentId,{...a,id:V}}));Ce(()=>[v.value,s.value],async()=>{if(!(!s.value||!v.value.length)&&t.autoCheck){const a=i(v.value);a&&m([a])}},{immediate:!0,debounce:100});function i(a){var b;if(a.length===1)return(b=a[0].children)!=null&&b.length?i(a[0].children):a[0]}async function p(a,{checkedNodes:b}){var n;let k=b.filter(l=>l.type==="user");const V=k.some(l=>l.id===a.id);if(v.value.every(l=>!l.multiple)&&V)k=[a];else if(!a.multiple&&V){const f=((n=s.value)==null?void 0:n.getNode(a)).parent.data.children.filter(c=>c.id!==a.id);k=ct(k,f,"id")}m(k)}function g(a){const b=o.value.filter(k=>k.id!==a.id);m(b)}function m(a){var b;o.value=a,(b=s.value)==null||b.setCheckedNodes(a)}return(a,b)=>{const k=U("el-tag"),V=U("Icon"),n=U("el-tree");return h(),R(H,null,[(h(!0),R(H,null,F(_(o),l=>(h(),T(k,{key:l.id,type:"info",closable:"",onClose:r=>g(l)},{default:N(()=>[M(G(l.title),1)]),_:2},1032,["onClose"]))),128)),L(n,se({ref_key:"treeRef",ref:s,class:["approval-tree",`mode-${a.mode}`],data:v.value},w),{default:N(({data:l})=>[Z("div",null,[L(V,{icon:y[l.type]||y.element,style:{display:"inline-block"}},null,8,["icon"]),Z("span",null,G(l.title),1)])]),_:1},16,["class","data"])],64)}}});const he=me(_t,[["__scopeId","data-v-9646bed9"]]),yt={key:0},Ve=Q({__name:"assignee-setter",props:{modelValue:{},tableData:{},placeholder:{}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,y=A({get(){return typeof o.modelValue=="string"?o.modelValue?o.modelValue.split(","):[]:o.modelValue},set(V){var n;t("update:modelValue",V.join(",")),(n=o.tableData)!=null&&n.row&&(o.tableData.row.values=ge(v.value,l=>V==null?void 0:V.includes(l.id)),o.tableData.row.idVal=o.tableData.row.values.map(l=>l[`${s.value}Id`]).join(","))}}),u=A({get(){return Array.isArray(o.modelValue)?o.modelValue.join(","):o.modelValue},set(V){t("update:modelValue",V)}}),w=j(!1),s=A(()=>{var V,n;return(n=(V=o.tableData)==null?void 0:V.row)==null?void 0:n.type}),v=j([]),i=j([]),{request:p}=W(),{getUserTree:g}=zt(p),{getParam:m}=ie(p);et(s,async V=>{try{if(w.value=!0,["dept","post","user"].includes(V)){const n=await g(V==="user"?"":V);v.value=n.data}else if(s.value==="dynamic"){const n=await m("flow.trends.user");i.value=n.data}}finally{w.value=!1}},{immediate:!0});function a(){y.value=ge(v.value,V=>V.type===s.value).map(V=>V.id)}const b=A(()=>({checkStrictly:s.value!=="user",clearable:!0,collapseTags:!0,collapseTagsTooltip:!0,data:v.value,filterable:!0,loading:w.value,maxCollapseTags:3,multiple:!0,nodeKey:"id",props:{label:"title"},placeholder:"请选择",showCheckbox:!0})),k=A(()=>({clearable:!0,data:i.value,filterable:!0,loading:w.value,nodeKey:"value",props:{label:"title"},placeholder:"请选择"}));return(V,n)=>{const l=U("el-tree-select"),r=U("el-button"),f=U("el-input");return["dept","post","user"].includes(s.value)?(h(),R("div",yt,[L(l,se({modelValue:y.value,"onUpdate:modelValue":n[0]||(n[0]=c=>y.value=c)},b.value,{style:{width:"75%"}}),null,16,["modelValue"]),L(r,{text:"",type:"primary",icon:"el-icon-check",style:{width:"20%"},onClick:a},{default:N(()=>[M(" 全选 ")]),_:1})])):s.value==="dynamic"?(h(),T(l,se({key:1,modelValue:u.value,"onUpdate:modelValue":n[1]||(n[1]=c=>u.value=c)},k.value,{style:{width:"100%"}}),null,16,["modelValue"])):s.value==="userTask"?(h(),T(_(Je),{key:2,modelValue:u.value,"onUpdate:modelValue":n[2]||(n[2]=c=>u.value=c),"filter-type":"userTask",placeholder:"请选择"},null,8,["modelValue"])):(h(),T(f,{key:3,modelValue:u.value,"onUpdate:modelValue":n[3]||(n[3]=c=>u.value=c),clearable:"",placeholder:"请输入"},null,8,["modelValue"]))}}}),wt={key:0,class:"flow-viewer"},gt={key:0,class:"flow-status-legend"},kt={class:"legend-text"},ht=Q({__name:"index",props:{modelValue:{},view:{type:Boolean},flowFormOption:{},flowHistory:{},showLegend:{type:Boolean}},emits:["update:modelValue","nodeClick"],setup(e,{emit:t}){const o=e,y=tt();Ge(y,()=>{var l;(l=y.value)==null||l.on("node:click",r=>t("nodeClick",r))});const u=A({get(){let l=We();return typeof o.modelValue=="string"&&o.modelValue?l=JSON.parse(o.modelValue):typeof o.modelValue=="object"&&Object.keys(o.modelValue)&&(l=o.modelValue),l},set(l){t("update:modelValue",JSON.stringify(l))}}),w=A(()=>{const{column:l=[],group:r=[]}=JSON.parse(o.flowFormOption||"{}");return[...l,...r.map(c=>c.column??[]).flat()]}),{FlowDesign:s,tabs:v,request:i}=W(),{data:p}=Se(i).useList(),g=A(()=>(v==null?void 0:v.map(l=>({...l,display:!0})))??[]),m=A(()=>{var l;return{formPropertyList:[...w.value,...g.value],buttonList:(l=p.value)==null?void 0:l.filter(r=>r.status===1),fieldsDic:w.value.map(r=>({label:r.label,value:`\${${r.prop}}`,desc:`\${${r.prop}}`})),flowButtonDisplayDic:J(fe),flowButtonApprovalDic:J(ve)}}),a=j({}),b=j({});Ce(b,l=>{var r,f,c,d,C,D;l&&((c=(f=(r=l.assignee)==null?void 0:r.children)==null?void 0:f.column)!=null&&c[1]&&(l.assignee.children.column[1].component=Ve),(D=(C=(d=l.circulate)==null?void 0:d.children)==null?void 0:C.column)!=null&&D[1]&&(l.circulate.children.column[1].component=Ve))},{debounce:1});const{data:k}=ie(i).useParam("flow.task.status"),V=A(()=>{var l;return(l=o.flowHistory)==null?void 0:l.map(r=>{var c,d;const f=(d=(c=k.value)==null?void 0:c.find(C=>C.value===r.status))==null?void 0:d.style;return{id:r.taskNodeKey,style:f}})}),n=A(()=>{var l,r;return(r=(l=o.flowHistory)==null?void 0:l.filter(f=>f.taskNodeType==="userTask"))==null?void 0:r.map(f=>{var c;return{id:f.taskNodeKey,content:`<div>${f.assigneeName}</div>
        <div>${f.endTime??""}</div>
        <div>${((c=f.comment)==null?void 0:c.handleComment)??""}</div>`}})});return(l,r)=>l.view?(h(),R("div",wt,[l.showLegend!==!1?(h(),R("div",gt,[(h(!0),R(H,null,F(_(k),f=>{var c;return h(),R("div",{key:f.label,class:"legend-item"},[Z("div",{class:"legend-color",style:at({backgroundColor:(c=f.style)==null?void 0:c.fill})},null,4),Z("span",kt,G(f.label),1)])}),128))])):E("",!0),L(_(s),{lf:y.value,"onUpdate:lf":r[0]||(r[0]=f=>y.value=f),"model-value":u.value,styles:V.value,tooltips:n.value,type:"viewer"},null,8,["lf","model-value","styles","tooltips"])])):(h(),T(_(s),{key:1,modelValue:u.value,"onUpdate:modelValue":r[1]||(r[1]=f=>u.value=f),formData:a.value,"onUpdate:formData":r[2]||(r[2]=f=>a.value=f),formDefaults:b.value,"onUpdate:formDefaults":r[3]||(r[3]=f=>b.value=f),"form-options":_(Qe),"data-options":m.value,"form-width":"30%"},null,8,["modelValue","formData","formDefaults","form-options","data-options"]))}});const Le=me(ht,[["__scopeId","data-v-79c19aa8"]]),Vt=Q({__name:"node-select",props:{modelValue:{}},setup(e){const t=e,{modelValue:o}=re(t),{flowDetail:y}=q(),u=j(!1);function w({data:s}){s.type==="userTask"&&(u.value=!1,o.value=s.id)}return(s,v)=>{const i=U("el-button"),p=U("el-popover");return h(),T(p,{visible:u.value,"onUpdate:visible":v[0]||(v[0]=g=>u.value=g),placement:"bottom-start",width:"800px",trigger:"click"},{reference:N(()=>[L(i,null,{default:N(()=>[M(" 点击选择节点 ")]),_:1})]),default:N(()=>{var g,m;return[L(Le,{"model-value":(m=(g=_(y))==null?void 0:g.process)==null?void 0:m.flowData,view:"",style:{height:"600px"},onNodeClick:w},null,8,["model-value"])]}),_:1},8,["visible"])}}}),Nt=Q({__name:"approval-form",emits:["submit"],setup(e,{emit:t}){const{request:o}=W(),{getApprovalNode:y}=be(o),{useParam:u}=ie(o),{formData:w,approvalFormData:s,activeBtn:v,approvalVisible:i,formVariables:p,flowDetail:g}=q(),m=j([]),a=j([]),b=j([]),k=j([]),V=j(!1),n=j(!1),l=j(),r=A(()=>{const O=m.value.length,I=b.value.length&&!m.value.length;return{menuBtn:!1,labelWidth:"auto",span:24,column:[{label:"指定节点",prop:"jumpTaskNodeKey",display:f("specifyNode"),rules:[{required:!0,message:"请选择指定节点"}]},{label:"审批人",prop:"assignee",display:f("assignee"),rules:O?[{required:!0,validator:c}]:[]},{label:"传阅人",prop:"circulate",display:f("circulate"),rules:I?[{required:!0,message:"请选择传阅人"}]:[]},{label:"意见",prop:"comment",display:f("comment"),rules:[{required:!0,message:"请填写意见"}]}]}});function f(O){var I,$;return($=(I=v.value)==null?void 0:I.approval)==null?void 0:$.includes(O)}function c(O,I,$){var x,B,te;const K=((x=m.value[0])==null?void 0:x.type)==="parallelGateway",P=(te=(B=m.value[0])==null?void 0:B.children)==null?void 0:te.every(Ae=>it([Ae],ze=>a.value.some(Be=>Be.id===ze.id)));if(a.value.length){if(K&&!P)return $("请在每个节点选择审批人")}else return $("请选择审批人");return!0}const{data:d}=u("flow.approval.autocheck"),{data:C}=u("flow.approval.autocomment");ue(async()=>{var $,K;if(!i.value||!l.value)return;de(()=>{l.value.resetFields(),s.value.comment=w.value.comment||C.value==="true"&&v.value.name||""});const{taskId:O}=(($=g.value)==null?void 0:$.task)||{},{flowKey:I}=((K=g.value)==null?void 0:K.process)||{};if(D(),!!f("assignee")&&!(f("specifyNode")&&!s.value.jumpTaskNodeKey))try{n.value=!0;const P=await y({flowKey:I,taskId:O,variables:p.value,buttonType:v.value.buttonKey,jumpTaskNodeKey:s.value.jumpTaskNodeKey});m.value=P.data.approvalNodeList,b.value=P.data.circulateNodeList}finally{n.value=!1}});function D(){m.value=[],a.value=[],b.value=[],k.value=[]}async function S(){await je(l),V.value=!0;const{data:O,outgoing:I}=z(a.value),{data:$}=z(k.value);s.value.assignee=O,s.value.circulate=$,s.value.outgoing=[...I],t("submit")}function z(O){const I={},$={},K=new Set;return O.forEach(P=>{const{taskNodeKey:x,incoming:B}=P;I[x]||(I[x]=new Set),P.userId&&I[x].add(P.userId),$[x]=[...I[x]].join(","),B&&K.add(B)}),{dataSet:I,data:$,outgoing:K}}return(O,I)=>{const $=U("el-skeleton"),K=U("avue-form"),P=U("el-button");return h(),T(Ue(_(Y)()?"el-drawer":"el-dialog"),{modelValue:_(i),"onUpdate:modelValue":I[6]||(I[6]=x=>oe(i)?i.value=x:null),class:"approval-form-overlay",title:_(v).name,"append-to-body":"",width:"900px",size:"50%",direction:"btt"},{footer:N(()=>[L(P,{onClick:I[5]||(I[5]=x=>i.value=!1)},{default:N(()=>[M(" 取 消 ")]),_:1}),L(P,{type:"primary",onClick:S},{default:N(()=>[M(" 确 定 ")]),_:1})]),default:N(()=>[L(K,{ref_key:"formRef",ref:l,modelValue:_(s),"onUpdate:modelValue":I[4]||(I[4]=x=>oe(s)?s.value=x:null),class:"approval-form",option:r.value},{jumpTaskNodeKey:N(()=>[L(Vt,{modelValue:_(s).jumpTaskNodeKey,"onUpdate:modelValue":I[0]||(I[0]=x=>_(s).jumpTaskNodeKey=x)},null,8,["modelValue"])]),assignee:N(()=>[n.value?(h(),T($,{key:0})):(h(),T(he,{key:"AssigneeTree",modelValue:a.value,"onUpdate:modelValue":I[1]||(I[1]=x=>a.value=x),data:m.value,"auto-check":_(d)==="true",mode:_(Y)()?"vertical":"horizontal"},null,8,["modelValue","data","auto-check","mode"]))]),circulate:N(()=>[n.value?(h(),T($,{key:0})):(h(),T(he,{key:"CirculateTree",modelValue:k.value,"onUpdate:modelValue":I[2]||(I[2]=x=>k.value=x),data:b.value,mode:_(Y)()?"vertical":"horizontal"},null,8,["modelValue","data","mode"]))]),comment:N(()=>[L(bt,{modelValue:_(s).comment,"onUpdate:modelValue":I[3]||(I[3]=x=>_(s).comment=x)},null,8,["modelValue"])]),_:1},8,["modelValue","option"])]),_:1},8,["modelValue","title"])}}});const Dt={class:"flow-form__title"},Ct=Q({__name:"index",props:mt,emits:ft,setup(e,{emit:t}){const y=vt(e,t),{ApprovalForm:u,tabsProps:w}=W(),s=u??Nt,{title:v,detail:i,flowDetail:p,tabRefs:g,tabList:m,activeTab:a,activeBtn:b,formLoading:k,approvalVisible:V,submitLoading:n,beforeClick:l,beforeSubmit:r,tabsRef:f}=y;async function c(D){var S,z;b.value=D;for(const O of Object.values(g.value))await((S=O==null?void 0:O.validate)==null?void 0:S.call(O));await((z=l==null?void 0:l.value)==null?void 0:z.call(l,D)),(D==null?void 0:D.approval)!=="false"?V.value=!0:C()}const d=pt(y);async function C(){var D;try{const{buttonKey:S}=b.value;n.value=!0,await((D=r==null?void 0:r.value)==null?void 0:D.call(r,b.value));const z=d[S];z?(await(z==null?void 0:z()),V.value=!1,t("complete",b.value)):le.error("无法找到相应的操作")}finally{n.value=!1}}return(D,S)=>{const z=U("el-skeleton"),O=U("el-main"),I=U("el-header"),$=U("el-tab-pane"),K=U("el-tabs"),P=U("el-footer"),x=U("el-container");return _(k)?(h(),T(O,{key:0},{default:N(()=>[L(z)]),_:1})):(h(),T(x,{key:1,class:"flow-form"},{default:N(()=>[L(I,{class:"flow-form__header",height:"auto"},{default:N(()=>{var B;return[Z("div",Dt,G(_(v)??((B=_(p).flowInstance)==null?void 0:B.title)),1),!_(i)&&!_(Y)()?(h(),T(ke,{key:0,onClick:c})):E("",!0)]}),_:1}),L(O,{class:"flow-form__main"},{default:N(()=>[L(K,se({ref_key:"tabsRef",ref:f,modelValue:_(a),"onUpdate:modelValue":S[0]||(S[0]=B=>oe(a)?a.value=B:null)},_(w)),{default:N(()=>[(h(!0),R(H,null,F(_(m),B=>(h(),T($,{key:B.prop,label:B.label,name:B.prop,lazy:B.lazy,disabled:B.disabled,closable:B.closable},{default:N(()=>[(h(),T(Ue(B.component),{ref_for:!0,ref:te=>_(g)[B.prop]=te},null,512))]),_:2},1032,["label","name","lazy","disabled","closable"]))),128))]),_:1},16,["modelValue"])]),_:1}),!_(i)&&_(Y)()?(h(),T(P,{key:0,class:"flow-form__footer",height:"auto"},{default:N(()=>[L(ke,{onClick:c})]),_:1})):E("",!0),L(_(s),{onSubmit:C})]),_:1}))}}});const It=Q({setup(){const{flowDetail:e,formData:t,detail:o}=q(),y=dt(e.value),{proxy:u}=ot(),w=j({});ue(()=>{const{formOption:i}=e.value.process??{};w.value=Ye.bind(u)(i||'{"menuBtn":false}'),w.value.detail=!!o.value});const s=j();function v(){return je(s)}return{form:t,option:w,defaults:y,formRef:s,validate:v}},render(){return lt(U("avue-form"),{ref:"formRef",modelValue:this.form,defaults:this.defaults,option:this.option,class:this.option.class,"onUpdate:modelValue":e=>this.form=e,"onUpdate:defaults":e=>this.defaults=e})}}),Ut=Q({__name:"upload-table",setup(e){const{flowDetail:t,fileIds:o,detail:y}=q(),{upload:{action:u,headers:w,preview:s,download:v,props:i}={},request:p}=W(),g=typeof w=="function"?w():w,m=A(()=>{var C,D;return((D=(C=t.value)==null?void 0:C.task)==null?void 0:D.flowInstanceId)??xe()}),a=[{label:"文件名",prop:"fileName"},{label:"文件类型",prop:"fileType"},{label:"文件大小",prop:"fileSize"},{label:"版本",prop:"version"},{label:"上传时间",prop:"createTime"}],b=a.filter(C=>C.prop==="fileName"),k={rowKey:"id",align:"center",index:!1,border:!0,stripe:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuType:"menu",menuBtnTitle:"操作",column:Y()?b:a},{bindVal:V,getDataList:n,handleDel:l,handleSave:r,afterGetList:f,crudStateRefs:{tableData:c}}=Xe({crudOption:{...jt(p),saveSuccessMsg:"上传成功"},tableOption:k,queryForm:{isLatest:1,flowInstanceId:m.value}});f(()=>{o.value=c.value.map(C=>C.id).join(",")}),n();async function d(C,D){var P,x;const{fileName:S,fileType:z,fileSize:O,fileUrl:I,res:$}=i,K={fileName:ae({res:C},`${$}.${S}`),fileType:ae({res:C},`${$}.${z}`),fileSize:ae({res:C},`${$}.${O}`),fileUrl:ae({res:C},`${$}.${I}`),taskId:(x=(P=t.value)==null?void 0:P.task)==null?void 0:x.taskId,flowInstanceId:m.value,rootMark:(D==null?void 0:D.rootMark)||"",version:typeof(D==null?void 0:D.version)=="number"?D.version+1:1};await r(K,n,()=>{})}return(C,D)=>{const S=U("el-button"),z=U("el-upload"),O=U("el-dropdown-item"),I=U("avue-crud");return h(),T(I,st(nt(_(V))),{"menu-left":N(()=>[_(y)?E("",!0):(h(),T(z,{key:0,action:_(u),headers:_(g),"show-file-list":!1,onSuccess:D[0]||(D[0]=$=>d($))},{default:N(()=>[L(S,{type:"primary",icon:"el-icon-upload"},{default:N(()=>[M(" 点击上传 ")]),_:1})]),_:1},8,["action","headers"]))]),"menu-btn":N(({row:$,index:K})=>[L(O,{icon:"el-icon-view",onClick:P=>{var x;return(x=_(s))==null?void 0:x($,_(c))}},{default:N(()=>[M(" 预览 ")]),_:2},1032,["onClick"]),L(O,{icon:"el-icon-download",onClick:P=>{var x;return(x=_(v))==null?void 0:x($,_(c))}},{default:N(()=>[M(" 下载 ")]),_:2},1032,["onClick"]),_(y)?E("",!0):(h(),T(O,{key:0,icon:"el-icon-upload"},{default:N(()=>[L(z,{action:_(u),headers:_(g),"show-file-list":!1,onSuccess:P=>d(P,$)},{default:N(()=>[M(" 更新版本 ")]),_:2},1032,["action","headers","onSuccess"])]),_:2},1024)),_(y)?E("",!0):(h(),T(O,{key:1,icon:"el-icon-delete",onClick:P=>_(l)($,K)},{default:N(()=>[M(" 删除 ")]),_:2},1032,["onClick"]))]),_:1},16)}}}),xt={class:"flow-track"},$t={key:0},Lt={key:1},Tt=Q({__name:"flow-track",setup(e){const{flowDetail:t}=q(),o=j(Y()?"timeline":"table"),y=[{label:"table",icon:"ep:grid"},{label:"graph",icon:"ep:picture"},{label:"timeline",icon:"ep:finished"}],u=A(()=>{var p,g,m;return((m=(g=(p=t.value)==null?void 0:p.flowHistory)==null?void 0:g.filter(a=>a.taskNodeType==="userTask"))==null?void 0:m.map(a=>({...a,duration:Re(a.duration)})))??[]}),w={addBtn:!1,menu:!1,border:!0,column:[{label:"节点名称",prop:"taskNodeName"},{label:"处理人",prop:"assigneeName"},{label:"接收时间",prop:"startTime"},{label:"处理时间",prop:"endTime"},{label:"办理时长",prop:"duration"},{label:"操作类型",prop:"type",dicUrl:"/sapier-flow/flow-param/getParam",dicQuery:{paramKey:"flow.handle.type"}},{label:"办理意见",prop:"comment",bind:"comment.handleComment"}]},{request:s}=W(),{data:v}=ie(s).useParam("flow.handle.type");function i(p){var g;return(g=v.value)==null?void 0:g.find(m=>m.value===p)}return(p,g)=>{var r,f,c;const m=U("el-radio-button"),a=U("el-radio-group"),b=U("avue-crud"),k=U("el-card"),V=U("el-timeline-item"),n=U("el-timeline"),l=U("el-empty");return h(),R(H,null,[_(Y)()?E("",!0):(h(),T(a,{key:0,modelValue:o.value,"onUpdate:modelValue":g[0]||(g[0]=d=>o.value=d)},{default:N(()=>[(h(),R(H,null,F(y,d=>L(m,{key:d.label,label:d.label},{default:N(()=>[L(_(De),{icon:d.icon},null,8,["icon"])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])),Z("div",xt,[o.value==="table"?(h(),T(b,{key:0,data:u.value,option:w},null,8,["data"])):E("",!0),o.value==="graph"?(h(),T(Le,{key:1,"model-value":(f=(r=_(t))==null?void 0:r.process)==null?void 0:f.flowData,"flow-history":(c=_(t))==null?void 0:c.flowHistory,view:"","show-legend":""},null,8,["model-value","flow-history"])):E("",!0),o.value==="timeline"?(h(),R(H,{key:2},[u.value.length?(h(),T(n,{key:0},{default:N(()=>[(h(!0),R(H,null,F([...u.value].reverse(),d=>(h(),T(V,{key:d.id,timestamp:d.endTime,placement:"top"},{default:N(()=>[L(k,null,{default:N(()=>{var C,D,S;return[Z("div",null,G(d.assigneeName)+" 开始处理 ["+G(d.taskNodeName)+"] 环节 ",1),d.duration?(h(),R("div",$t," 办理时长："+G(d.duration),1)):E("",!0),d.type&&((C=d.comment)!=null&&C.handleComment)?(h(),R("div",Lt,G((D=i(d.type))==null?void 0:D.label)+"意见："+G((S=d.comment)==null?void 0:S.handleComment),1)):E("",!0)]}),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:1})):(h(),T(l,{key:1}))],64)):E("",!0)])],64)}}});const Ot=me(Tt,[["__scopeId","data-v-a1713c28"]]),St={FlowDesign:{},FormDesign:{},FlowForm:Ct,request:{},tabs:[{label:"审批表单",prop:"formTab",component:It},{label:"附件资料",prop:"fileTab",component:Ut},{label:"流程跟踪",prop:"trackTab",component:Ot}],useFlowFormOptions:{type:"drawer",window:["","flow-form","left=0,top=0,width=1600,height=900"],overlay:{width:"80%",size:"80%",top:"100px",fullscreen:!0,destroyOnClose:!0}},tableOption:{align:"center",border:!0,card:!0,stripe:!0,searchMenuSpan:6,span:24},upload:{props:{fileName:"fileOriginalName",fileType:"fileType",fileSize:"fileSize",fileUrl:"fileUrl",res:"res.data"}}};function Kt(e){const t={list:"/sapier-flow/flow-user-common/list",save:"/sapier-flow/flow-user-common/save",update:"/sapier-flow/flow-user-common/update",remove:"/sapier-flow/flow-user-common/remove",batchUpdate:"/sapier-flow/flow-user-common/batchUpdate"},o=i=>e.get(t.list,{params:{type:i,ascs:"sort"}});return{url:t,getList:o,useList:i=>ee(()=>o(i.value).then(p=>p.data.records),{refreshDeps:[i]}),create:i=>e.post(t.save,i),update:i=>e.post(t.update,i),remove:i=>e.post(t.remove,{},{params:{ids:i}}),batchUpdate:i=>e.post(t.batchUpdate,i)}}var Te=(e=>(e.默认="default",e.主要="primary",e.成功="success",e.警告="warning",e.危险="danger",e.信息="info",e.文字="text",e))(Te||{}),Pt=(e=>(e.保存草稿="flow_draft",e.发送="flow_pass",e.退回="flow_reject",e.终止="flow_terminate",e.撤销="flow_revoke",e.撤回到发起="flow_withdraw",e.打印="flow_print",e.转办="flow_transfer",e.加签="flow_add_instance",e.减签="flow_del_instance",e.指定回退="flow_rollback",e.绿色通道="flow_green",e))(Pt||{}),fe=(e=>(e.显示="true",e.隐藏="false",e.发起人="startUser",e.处理人="assignee",e.已办="done",e.待办="todo",e.未发起="notstarted",e.已发起="started",e.未办结="unfinished",e.已办结="finished",e))(fe||{}),ve=(e=>(e.不显示="false",e.指定节点="specifyNode",e.审批人="assignee",e.传阅人="circulate",e.意见="comment",e))(ve||{}),Oe=(e=>(e[e.禁用=0]="禁用",e[e.正常=1]="正常",e))(Oe||{});function Se(e){const t={list:"/sapier-flow/dev-button/list",save:"/sapier-flow/dev-button/save",update:"/sapier-flow/dev-button/update",remove:"/sapier-flow/dev-button/remove"},o=v=>e.get(t.list,{params:v});return{url:t,getList:o,useList:()=>ee(()=>o({size:-1,ascs:"sort"}).then(v=>v.data.records)),create:v=>e.post(t.save,v),update:v=>e.post(t.update,v),remove:v=>e.post(t.remove,{},{params:{ids:v}})}}function jt(e){const t={list:"/sapier-flow/flow-file/list",save:"/sapier-flow/flow-file/save",remove:"/sapier-flow/flow-file/remove"};return{getList:w=>e.get(t.list,{params:w}),create:w=>e.post(t.save,w),remove:w=>e.post(t.remove,{},{params:{ids:w}})}}function ie(e){const t={list:"/sapier-flow/flow-param/list",save:"/sapier-flow/flow-param/save",update:"/sapier-flow/flow-param/update",remove:"/sapier-flow/flow-param/remove",all:"/sapier-flow/flow-param/getAllParam",key:"/sapier-flow/flow-param/getParam"},o=p=>e.get(t.list,{params:p}),y=()=>e.get(t.all),u=p=>e.get(t.key,{params:{paramKey:p}});return{url:t,getList:o,getAllParam:y,getParam:u,useParam:p=>ee(()=>u(p).then(g=>g.data)),create:p=>e.post(t.save,p),update:p=>e.post(t.update,p),remove:p=>e.post(t.remove,{},{params:{ids:p}})}}var ne=(e=>(e[e.已办=1]="已办",e[e.待办=2]="待办",e[e.失败=3]="失败",e[e.撤销=4]="撤销",e[e.终止=5]="终止",e))(ne||{}),ce=(e=>(e[e.已办结=1]="已办结",e[e.未办结=2]="未办结",e[e.已终止=3]="已终止",e))(ce||{}),At=(e=>(e[e.系统执行=1]="系统执行",e[e.用户办理=2]="用户办理",e[e.任务撤销=3]="任务撤销",e[e.任务退回=4]="任务退回",e[e.流程终止=5]="流程终止",e[e.任务转办=6]="任务转办",e[e.绿色通道=7]="绿色通道",e))(At||{});function be(e){const t={publishList:"/sapier-flow/flow-run/queryPublishFlowList",taskList:"/sapier-flow/flow-run/userTaskList",detail:"/sapier-flow/flow-run/queryPublishFlowDetail",approvalNode:"/sapier-flow/flow-run/queryApprovalNode",start:"/sapier-flow/flow-run/startProcess",commit:"/sapier-flow/flow-run/commitTask",draft:"/sapier-flow/flow-run/saveDraft",revoke:"/sapier-flow/flow-run/revokeTask",terminate:"/sapier-flow/flow-run/terminateFlow",withdraw:"/sapier-flow/flow-run/withdrawToStart",transfer:"/sapier-flow/flow-run/transferTask",reject:"/sapier-flow/flow-run/rollbackTask",green:"/sapier-flow/flow-run/greenTask"},o=n=>e.get(t.detail,{params:n}),y=n=>e.post(t.approvalNode,n),u=n=>e.post(t.start,n),w=n=>e.post(t.commit,n),s=n=>e.post(t.draft,n),v=n=>e.post(t.revoke,n),i=n=>e.post(t.terminate,n),p=n=>e.post(t.withdraw,n),g=n=>e.post(t.transfer,n),m=n=>e.post(t.reject,n),a=n=>e.post(t.green,n),b=()=>e.get(t.publishList);return{url:t,getFlowDetail:o,getApprovalNode:y,startTask:u,commitTask:w,saveDraft:s,revokeTask:v,terminateTask:i,withdrawTask:p,transferTask:g,rejectTask:m,greenChannel:a,getPublishList:b,usePublishList:()=>ee(()=>b().then(n=>n.data)),getTaskList:n=>e.get(t.taskList,{params:n})}}function zt(e){const t={tree:"/sapier-flow/flow-user/tree"},o=u=>e.get(t.tree,{params:{filter:u}});return{url:t,getUserTree:o,useUserTree:()=>ee(()=>o().then(u=>u.data))}}var _e=(e=>(e.ASSIGN_ID="ASSIGN_ID",e.ASSIGN_UUID="ASSIGN_UUID",e.AUTO="AUTO",e.INPUT="INPUT",e.NONE="NONE",e))(_e||{}),ye=(e=>(e.bigint="bigint",e.blob="blob",e.char="char",e.date="date",e.datetime="datetime",e.decimal="decimal",e.double="double",e.enum="enum",e.float="float",e.int="int",e.longblob="longblob",e.longtext="longtext",e.mediumblob="mediumblob",e.mediumint="mediumint",e.mediumtext="mediumtext",e.set="set",e.smallint="smallint",e.text="text",e.time="time",e.timestamp="timestamp",e.tinyblob="tinyblob",e.tinyint="tinyint",e.tinytext="tinytext",e.varbinary="varbinary",e.varchar="varchar",e.year="year",e))(ye||{});function sa(e){const t={list:"/sapier-flow/dev-table/list",save:"/sapier-flow/dev-table/save",update:"/sapier-flow/dev-table/update",remove:"/sapier-flow/dev-table/remove",deploy:"/sapier-flow/dev-table/deploy",getFields:"/sapier-flow/dev-table/getTableFields"},o=p=>e.get(t.list,{params:p});return{url:t,getList:o,useList:()=>ee(()=>o({size:-1}).then(p=>p.data.records)),create:p=>e.post(t.save,p),update:p=>e.post(t.update,p),remove:p=>e.post(t.remove,{},{params:{ids:p}}),deploy:p=>e.post(t.deploy,p),getFields:p=>e.get(t.getFields,{params:p})}}var Ke=(e=>(e[e.否=0]="否",e[e.是=1]="是",e))(Ke||{});const pe=J(Ke),na=J(ye),ra=J(_e),Bt=Ie(St);function W(e){return He(Bt,e)}const ua=X({rowKey:"id",labelWidth:150,column:[{label:"按钮名称",prop:"name",search:!0},{label:"按钮标识",prop:"buttonKey",search:!0},{label:"按钮图标",prop:"icon",component:"icon-select"},{label:"按钮类型",prop:"buttonType",type:"select",dicData:J(Te)},{label:"默认显示条件",prop:"display",type:"select",multiple:!0,dataType:"string",value:"false",dicData:J(fe),tip:"选择多个时,所有条件都满足才显示",labelTip:`显示: 始终显示;<br/>隐藏: 始终隐藏;<br/>
      发起人: 用户为发起人时显示;<br/>处理人: 用户为处理人时显示;<br/>
      已办: 任务状态为已办时显示;<br/>待办: 任务状态为待办时显示;<br/>
      未发起: 流程未发起时显示;<br/>已发起: 流程已发起时显示;<br/>
      未办结: 流程未办结时显示;<br/>已办结: 流程已办结时显示;`},{label:"默认审批窗口显示",prop:"approval",type:"select",multiple:!0,dataType:"string",value:"false",dicData:J(ve),labelTip:`不显示: 不显示审批窗口;<br/>指定节点: 显示指定节点选择框(常用于绿色通道等);<br/>
      审批人: 显示审批人选择框;<br/>传阅人: 显示传阅人选择框;<br/>意见: 显示意见输入框;`},{label:"排序",prop:"sort",type:"number",value:0},{label:"状态",prop:"status",type:"switch",value:1,dicData:J(Oe)},{label:"按钮预览",prop:"buttonPreview",width:150}]}),Pe={menuBtn:!1,span:24,column:[{label:"流程名称",prop:"flowName",rules:[{required:!0,message:"请输入流程名称"}]},{label:"流程标识",prop:"flowKey",editDisabled:!0,rules:[{required:!0,message:"请输入流程标识"}]},{label:"流程分类",prop:"categoryId",type:"select",dicUrl:"/sapier-flow/flow-category/list",dicQuery:{size:-1},props:{label:"name",value:"id"}},{label:"流程图标",prop:"flowIcon",component:"icon-select"},{label:"流程描述",prop:"remarks"},{label:"自定义表单",prop:"formPath"},{label:"关联表",prop:"formDataTable",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicUrl:"/sapier-flow/dev-table/list",dicQuery:{size:-1},props:{label:"tableComment",value:"tableName",desc:"tableName",res:"data.records"}},{label:"排序",prop:"sort",type:"number",width:110},{label:"表单设计",prop:"formOption",display:!1,hide:!0},{label:"模型设计",prop:"flowData",display:!1,hide:!0}]},ia=X({rowKey:"flowModuleId",dialogFullscreen:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuWidth:100,menuType:"menu",menuBtnTitle:"操作",column:[...Pe.column.map((e,t)=>({...e,search:t<2})),{label:"流程主版本",prop:"mainVersion",formatter(e,t){return t?`V${t||""}`:""}}]}),ca=X({rowKey:"flowDeloyId",dialogFullscreen:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuWidth:100,menuType:"menu",menuBtnTitle:"操作",column:[...Pe.column,{label:"流程版本",prop:"version",formatter(e,t){return t?`V${t||""}`:""}},{label:"是否主版本",prop:"mainVersion",type:"select",dicData:[{label:"否",value:0},{label:"是",value:1}]}]}),pa=X({rowKey:"id",menu:!1,addBtn:!1,column:[{label:"流程名称",prop:"flowName"},{label:"流程标识",prop:"flowKey"},{label:"流程分类",prop:"categoryId",type:"select",search:!0,dicUrl:"/sapier-flow/flow-category/list",props:{label:"name",value:"id"}},{label:"标题",prop:"processTitle",search:!0},{label:"流水号",prop:"serialNumber"},{label:"当前节点",prop:"taskNodeName"},{label:"审批人",prop:"assigneeName"},{label:"申请人",prop:"applyUserName"},{label:"接收时间",prop:"startTime"},{label:"任务状态",prop:"status",type:"select",search:!0,searchValue:ne.待办,dicUrl:"/sapier-flow/flow-param/getParam",dicQuery:{paramKey:"flow.task.status"}}]}),da=X({rowKey:"id",column:[{label:"配置名称",prop:"paramName",search:!0},{label:"配置Key",prop:"paramKey",search:!0},{label:"备注",prop:"remark"},{label:"系统内置",prop:"paramType",type:"switch",dicData:pe},{label:"配置值",prop:"paramValue",type:"textarea",maxRows:20,span:24,overHidden:!0}]}),ma=X({rowKey:"id",menu:!1,addBtn:!1,column:[{label:"流程名称",prop:"flowName"},{label:"流程标识",prop:"flowKey"},{label:"流程分类",prop:"categoryId",type:"select",search:!0,dicUrl:"/sapier-flow/flow-category/list",props:{label:"name",value:"id"}},{label:"标题",prop:"processTitle",search:!0},{label:"流水号",prop:"serialNumber"},{label:"当前节点",prop:"taskNodeName"},{label:"审批人",prop:"assigneeName"},{label:"申请人",prop:"applyUserName"},{label:"接收时间",prop:"startTime"}]});const fa=X({rowKey:"id",column:[{label:"流程标识",prop:"flowKey",search:!0},{label:"流程名称",prop:"flowName",search:!0},{label:"流程备注",prop:"remarks"},{label:"排序",prop:"sort"}]}),va=X({rowKey:"id",column:[{label:"表单标识",prop:"formKey",search:!0},{label:"表单名称",prop:"formName",search:!0},{label:"表单备注",prop:"remarks"},{label:"排序",prop:"sort",type:"number"}]}),Ne=[{label:"字段名称",prop:"name"},{label:"字段备注",prop:"comment"},{label:"字段类型",prop:"type",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:J(ye)},{label:"字段长度",prop:"size",type:"number"},{label:"小数位",prop:"point",type:"number"},{label:"默认值",prop:"default"},{label:"是否主键",prop:"primary",type:"switch",dicData:pe,value:0},{label:"是否允许为空",prop:"permitNull",type:"switch",dicData:pe,value:1}],ba=X({rowKey:"id",dialogFullscreen:!0,column:[{label:"表名",prop:"tableName",search:!0},{label:"表注释",prop:"tableComment",search:!0},{label:"表引擎",prop:"tableEngine"},{label:"表主键策略",prop:"tablePrimary",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:J(_e)},{label:"数据库字段",prop:"editFields",hide:!0,type:"dynamic",children:{column:Ne}},{label:"默认字段",prop:"defaultFields",hide:!0,type:"dynamic",children:{addBtn:!1,delBtn:!1,column:Ne}}]});function je(e){return new Promise((t,o)=>{_(e).validate((u,w,s)=>{u?(w(),t(s)):o(s)})})}function Y(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}export{zt as A,_e as B,St as C,ye as D,X as E,Le as F,pe as G,At as H,na as I,ra as J,Nt as K,ke as L,Ot as M,It as N,Ut as O,pt as P,mt as Q,ft as R,$e as S,ne as T,vt as U,Y as V,Ke as W,Ct as _,dt as a,je as b,W as c,Se as d,ia as e,ca as f,sa as g,Pe as h,pa as i,da as j,ie as k,ma as l,be as m,fa as n,va as o,ba as p,Kt as q,Te as r,Pt as s,ua as t,q as u,fe as v,ve as w,Oe as x,jt as y,ce as z};
