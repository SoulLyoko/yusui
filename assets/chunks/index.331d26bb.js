var qt=Object.defineProperty;var Yt=(e,t,n)=>t in e?qt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var J=(e,t,n)=>(Yt(e,typeof t!="symbol"?t+"":t,n),n);import{C as Kt,G as me,M as Xt,D as Ht,l as ft,S as Jt,a as Qt,I as Zt,B as ht,b as pt}from"./mysqlWorkbench.954a482f.js";import{E as ys,f as bs,g as ws,h as gs,t as xs,u as Es,r as ks,s as _s,N as Ns,q as Ms,i as Is,j as Os,P as Ps,c as Ls,o as Ss,p as Ts,m as Cs,n as Ds,d as Rs,e as Fs,U as js,k as Vs}from"./mysqlWorkbench.954a482f.js";import{bR as en,d3 as Ce}from"../composables_use-crud_index.md.b279084a.js";import{i as De,u as vt}from"./uniqueId.651a8aa4.js";import{d as Bs}from"./data.4cb21f02.js";import{d as tn,u as nn}from"../flow-design_flow-modeler_index.md.07d02c14.js";import{b as zs,c as $s,e as Ws,f as Us,a as qs,g as Ys,h as Ks,m as Xs,n as Hs,p as Js,i as Qs,s as Zs,j as ea,k as ta,l as na}from"../flow-design_flow-modeler_index.md.07d02c14.js";import{n as $e,h as Re,r as on,e as rn,G as Z,i as oe,C as se,D as re,k as Ie,I as de,m as sn,u as K,a6 as ae,B as an,f as mt,w as fe,aC as dn,j as ln}from"./framework.22a77fa2.js";import{u as yt}from"./theme.1d56182c.js";import"../app.ffe80b2a.js";import"../components_icon-select_index.md.dc997862.js";import"../components_index.md.d18bb5a3.js";import"../components_v-text_index.md.306fe565.js";import"../composables_index.md.1bb90be4.js";import"../flow-design_flow-viewer_index.md.e9fcc2c5.js";import"../flow-design_index.md.e062cae5.js";import"../flow-pages_index.md.d27d2c75.js";import"../flow-pages_pages_flow-button_index.md.2cf37f1f.js";import"../flow-pages_pages_flow-manage_index.md.3b729385.js";import"../flow-pages_pages_flow-ops_index.md.1351e2c2.js";import"../flow-pages_pages_flow-param_index.md.907e6ed8.js";import"../flow-pages_pages_flow-template_index.md.743ad38c.js";import"../flow-pages_pages_flow-workbench_index.md.e559c6b1.js";import"../flow-pages_pages_form-template_index.md.754d7c10.js";import"../flow-pages_pages_table-template_index.md.f196419b.js";import"../form-design_demo.md.f7fa8b02.js";import"../form-design_index.md.f8d915c9.js";import"../guide_changelog.md.71ace3ef.js";import"../guide_start.md.f25ec09d.js";import"../index.md.dedad964.js";import"../plugins_avue-patch_index.md.298f53e4.js";import"../plugins_compatible-tips_index.md.4a4a879f.js";import"../plugins_env-dts_index.md.90c505c6.js";import"../plugins_index.md.09238556.js";import"../plugins_load-proxy_index.md.8c57e468.js";import"../plugins_setup-extend_index.md.ffc97dab.js";import"../plugins_uni-ui-patch_index.md.b8a395e2.js";import"../plugins_uview-patch_index.md.e65878da.js";import"../types_avue_index.md.31e36571.js";import"../types_index.md.aa1779e7.js";import"../utils_date_dateFormat.md.24466ffd.js";import"../utils_date_durationFormat.md.a91e1175.js";import"../utils_emitter_mittAsync.md.65520a0e.js";import"../utils_index.md.99824380.js";import"../utils_math_index.md.81fb7150.js";import"../utils_object_filterObj.md.d634698f.js";import"../utils_object_filterObjDeep.md.aee85325.js";import"../utils_object_getDataType.md.4c16fa33.js";import"../utils_string_deserialize.md.49b88e4f.js";import"../utils_string_serialize.md.175ca994.js";import"../utils_string_uuid.md.1b6743be.js";import"../utils_tool_awaitTo.md.907e2bd0.js";import"../utils_tool_enumToDic.md.f0182e11.js";import"../utils_tool_sleep.md.15440607.js";import"../utils_tree_buildTree.md.b95211e7.js";import"../utils_tree_filterTree.md.753c4098.js";import"../utils_tree_findTree.md.30184861.js";import"../utils_tree_flatTree.md.cb52189f.js";import"../utils_tree_treeMap.md.168ca5df.js";const bt={rect:{radius:5,stroke:"black"},circle:{r:18,stroke:"black"},polygon:{stroke:"black"},polyline:{stroke:"black",hoverStroke:"black",selectedStroke:"black"},edgeText:{background:{fill:"white",height:14,stroke:"transparent",radius:3}},nodeText:{}},cn=[{label:"开始",value:"start"},{label:"任务",value:"task"},{label:"结束",value:"end"}],un=[{label:"类",value:"class"},{label:"表达式",value:"expression"},{label:"代理表达式",value:"delegateExpression"}],fn=[{label:"字符串",value:"string"},{label:"表达式",value:"expression"}],ls=[{label:"",labelWidth:0,prop:"executionListener",type:"dynamic",children:{type:"form",index:!1,column:[{label:"事件",prop:"eventName",type:"select",dicData:cn},{label:"类型",prop:"eventType",type:"select",dicData:un},{label:"值",prop:"eventValue",type:"textarea",minRows:1,span:24},{label:"字段",prop:"fields",type:"dynamic",span:24,children:{column:[{label:"字段名",prop:"fieldName"},{label:"类型",prop:"fieldType",type:"select",dicData:fn},{label:"值",prop:"fieldValue"}]}}]}}];function We(e,t){return e.map(n=>{const o=t.find(l=>l.buttonKey===n.buttonKey),{name:r,buttonKey:i,display:a,approval:s}=n;return{name:r,buttonKey:i,display:a,approval:s,...o}})}function Oe(e,t){return e.map(n=>{var h,p;const o=t.find(v=>v.prop===n.prop),{label:r,prop:i,display:a=!0,disabled:s=!1,detail:d=!1,readonly:l=!1,rules:c}=n,u=(c==null?void 0:c.some(v=>v.required))??!1,f={label:r,prop:i,display:a,disabled:s,detail:d,readonly:l,required:u,...o};return n.type==="dynamic"&&((p=(h=n.children)==null?void 0:h.column)!=null&&p.length)&&(f.children=Oe(n.children.column,(o==null?void 0:o.children)??[])),f})}function hn({lf:e,graphData:t,elementData:n,formData:o,formLoading:r,formOption:i,formOptions:a,editorVisible:s,formOptionFormat:d,formDataFormat:l,dataOptions:c}){var h,p,v,b,w,N,y,E,P;async function u({data:g,isForce:U}={data:void 0,isForce:!1}){var T,X,m,C,R,L,V,k;const j=(T=e.value)==null?void 0:T.graphModel.nodes.find(M=>M.type==="process");if(!g&&(j!=null&&j.id)&&(g=(X=e.value)==null?void 0:X.getNodeDataById(j.id)),(g==null?void 0:g.id)===((m=n.value)==null?void 0:m.id)&&!U)return;g.type!=="process"&&((C=e.value)==null||C.selectElementById(g.id)),r.value=!0,await $e(),n.value=g,i.value={menuBtn:!1,span:24,labelPosition:"left",group:((R=a.value)==null?void 0:R[g.type])??tn};const D={...g.properties,id:g.id,name:((L=g.text)==null?void 0:L.value)||""};f("formProperty",i.value)&&(D.formProperty=Oe(((V=c.value)==null?void 0:V.formPropertyColumn)||[],(D==null?void 0:D.formProperty)||[])),f("button",i.value)&&(D.button=We(((k=c.value)==null?void 0:k.buttonList)||[],(D==null?void 0:D.button)||[])),o.value=D,await $e(),r.value=!1}function f(g,U){var j;return(j=U.group)==null?void 0:j.some(D=>{var T;return(T=D.column)==null?void 0:T.some(X=>X.prop===g)})}(h=e.value)==null||h.on("element:click",u),(p=e.value)==null||p.on("blank:click",u),(v=e.value)==null||v.on("node:add",u),(b=e.value)==null||b.on("node:dnd-add",u),(w=e.value)==null||w.on("node:delete",()=>u()),(N=e.value)==null||N.on("history:change",()=>{var g;t.value=(g=e.value)==null?void 0:g.getGraphData()}),(y=e.value)==null||y.on("custom:edit-click",()=>{s.value=!0}),(E=e.value)==null||E.on("custom:reset-form-property",()=>{var g,U;(U=(g=t.value)==null?void 0:g.flowElementList)==null||U.forEach(j=>{var D,T;(D=j.properties)!=null&&D.formProperty&&(j.properties.formProperty=Oe(((T=c.value)==null?void 0:T.formPropertyColumn)||[],[]))}),t.value={...t.value}}),(P=e.value)==null||P.on("custom:reset-button",()=>{var g,U;(U=(g=t.value)==null?void 0:g.flowElementList)==null||U.forEach(j=>{var D,T;(D=j.properties)!=null&&D.button&&(j.properties.button=We(((T=c.value)==null?void 0:T.buttonList)||[],[]))}),t.value={...t.value}})}const pn=[{label:"创建",value:"create"},{label:"指派",value:"assignment"},{label:"完成",value:"complete"},{label:"删除",value:"delete"},{label:"更新",value:"update"},{label:"超时",value:"timeout"}],vn=[{label:"类",value:"class"},{label:"表达式",value:"expression"},{label:"代理表达式",value:"delegateExpression"}],mn=[{label:"字符串",value:"string"},{label:"表达式",value:"expression"}],cs=[{label:"",labelWidth:0,prop:"executionListener",type:"dynamic",children:{type:"form",index:!1,column:[{label:"事件",prop:"eventName",type:"select",dicData:pn},{label:"类型",prop:"eventType",type:"select",dicData:vn},{label:"值",prop:"eventValue",type:"textarea",minRows:1,span:24},{label:"字段",prop:"fields",type:"dynamic",span:24,children:{column:[{label:"字段名",prop:"fieldName"},{label:"类型",prop:"fieldType",type:"select",dicData:mn},{label:"值",prop:"fieldValue"}]}}]}}],us=[{label:"",labelWidth:0,prop:"timeLimit",type:"dynamic",children:{column:[{label:"名称",prop:"name"},{label:"最小值",prop:"min",type:"number"},{label:"最大值",prop:"max",type:"number"}]},value:[]}];class yn extends Kt{constructor({lf:t}){super({lf:t}),this.addItem({key:"clear",iconClass:"lf-control-clear",title:"清空",text:"清空",onClick:()=>t.clearData()}),this.addItem({key:"edit",iconClass:"lf-control-edit",title:"编辑",text:"编辑",onClick:()=>t.emit("custom:edit-click",{})}),this.addItem({key:"mini-map",iconClass:"lf-control-mini-map",title:"导航",text:"导航",onClick:()=>{const{isShow:n,show:o,hide:r}=t.extension.miniMap??{};n?r():o()}}),this.addItem({key:"reset",iconClass:"lf-control-reset",title:"重置",text:"重置",onClick:()=>{en.confirm("选择重置的配置","提示",{confirmButtonText:"重置表单配置",cancelButtonText:"重置按钮配置"}).then(()=>{t.emit("custom:reset-form-property",{})}).catch(()=>{t.emit("custom:reset-button",{})})}})}}class bn{constructor(){this.nodes=[],this.edges=[],this.combos=[],this.comboEdges=[],this.hiddenNodes=[],this.hiddenEdges=[],this.hiddenCombos=[],this.vedges=[],this.positions=[],this.destroyed=!1,this.onLayoutEnd=()=>{}}layout(t){return this.init(t),this.execute(!0)}init(t){this.nodes=t.nodes||[],this.edges=t.edges||[],this.combos=t.combos||[],this.comboEdges=t.comboEdges||[],this.hiddenNodes=t.hiddenNodes||[],this.hiddenEdges=t.hiddenEdges||[],this.hiddenCombos=t.hiddenCombos||[],this.vedges=t.vedges||[]}execute(t){}executeWithWorker(){}getDefaultCfg(){return{}}updateCfg(t){t&&Object.assign(this,t)}getType(){return"base"}destroy(){this.nodes=null,this.edges=null,this.combos=null,this.positions=null,this.destroyed=!0}}const wn=e=>typeof e=="string",Ue=Array.isArray,pe=e=>typeof e=="number",wt=e=>e!==null&&typeof e=="object",ve=e=>{if(e===null)return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof Array){const t=[];return e.forEach(n=>{t.push(n)}),t.map(n=>ve(n))}if(typeof e=="object"&&Object.keys(e).length){const t=Object.assign({},e);return Object.keys(t).forEach(n=>{t[n]=ve(t[n])}),t}return e},ne=(e,t)=>{const n=e[t];return wt(n)?n.cell:n},qe=(e,t,n)=>{let o;return n?o=n:pe(e)?o=()=>e:o=()=>t,o},gn=(e,t)=>{if(e!=="next"&&e!=="prev")return t},Ye=e=>{e.prev.next=e.next,e.next.prev=e.prev,delete e.next,delete e.prev};let xn=class{constructor(){const t={};t.prev=t,t.next=t.prev,this.shortcut=t}dequeue(){const t=this.shortcut,n=t.prev;if(n&&n!==t)return Ye(n),n}enqueue(t){const n=this.shortcut;t.prev&&t.next&&Ye(t),t.next=n.next,n.next.prev=t,n.next=t,t.prev=n}toString(){const t=[],n=this.shortcut;let o=n.prev;for(;o!==n;)t.push(JSON.stringify(o,gn)),o=o==null?void 0:o.prev;return`[${t.join(", ")}]`}};function Ke(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function En(e,t,n){return t&&Ke(e.prototype,t),n&&Ke(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function kn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var gt=En(function e(){var t=this;kn(this,e),this.arr=[],this.keyIndice=new Map,this.size=function(){return t.arr.length},this.keys=function(){return t.arr.map(function(n){return n.key})},this.has=function(n){return t.keyIndice.has(n)},this.priority=function(n){var o=t.keyIndice.get(n);if(o!==void 0)return t.arr[o].priority},this.swap=function(n,o){var r=t.arr,i=t.keyIndice,a=[r[n],r[o]],s=a[0],d=a[1];r[n]=d,r[o]=s,i.set(s.key,o),i.set(d.key,n)},this.innerDecrease=function(n){for(var o=t.arr,r=o[n].priority,i,a=n;a!==0;){var s;if(i=a>>1,((s=o[i])===null||s===void 0?void 0:s.priority)<r)break;t.swap(a,i),a=i}},this.heapify=function(n){var o=t.arr,r=n<<1,i=r+1,a=n;r<o.length&&(a=o[r].priority<o[a].priority?r:a,i<o.length&&(a=o[i].priority<o[a].priority?i:a),a!==n&&(t.swap(n,a),t.heapify(a)))},this.min=function(){if(t.size()===0)throw new Error("Queue underflow");return t.arr[0].key},this.add=function(n,o){var r=t.keyIndice,i=t.arr;if(!r.has(n)){var a=i.length;return r.set(n,a),i.push({key:n,priority:o}),t.innerDecrease(a),!0}return!1},this.removeMin=function(){t.swap(0,t.arr.length-1);var n=t.arr.pop();return t.keyIndice.delete(n.key),t.heapify(0),n.key},this.decrease=function(n,o){if(!t.has(n))throw new Error("There's no key named ".concat(n));var r=t.keyIndice.get(n);if(o>t.arr[r].priority)throw new Error("New priority is greater than current priority.Key: ".concat(n," Old: + ").concat(t.arr[r].priority," New: ").concat(o));t.arr[r].priority=o,t.innerDecrease(r)}}),_n=function(t,n){var o=new me,r=new Map,i=new gt,a;function s(c){var u=c.v===a?c.w:c.v,f=i.priority(u);if(f!==void 0){var h=n(c);h<f&&(r.set(u,a),i.decrease(u,h))}}if(t.nodeCount()===0)return o;t.nodes().forEach(function(c){i.add(c,Number.POSITIVE_INFINITY),o.setNode(c)}),i.decrease(t.nodes()[0],0);for(var d=!1;i.size()>0;){var l;if(a=i.removeMin(),r.has(a))o.setEdge(a,r.get(a));else{if(d)throw new Error("Input graph is not connected: "+t.graph());d=!0}(l=t.nodeEdges(a))===null||l===void 0||l.forEach(s)}return o},Nn=function(t){var n=new Set,o=[],r=t.nodes();return r.forEach(function(i){for(var a=[],s=[i];s.length>0;){var d=s.pop();if(!n.has(d)){var l,c;n.add(d),a.push(d),(l=t.successors(d))===null||l===void 0||l.forEach(function(u){return s.push(u)}),(c=t.predecessors(d))===null||c===void 0||c.forEach(function(u){return s.push(u)})}}a.length&&o.push(a)}),o},Mn=function e(t,n,o,r,i,a){r.includes(n)||(r.push(n),o||a.push(n),i(n).forEach(function(s){return e(t,s,o,r,i,a)}),o&&a.push(n))},Fe=function(t,n,o){var r=Array.isArray(n)?n:[n],i=function(l){return t.isDirected()?t.successors(l):t.neighbors(l)},a=[],s=[];return r.forEach(function(d){if(t.hasNode(d))Mn(t,d,o==="post",s,i,a);else throw new Error("Graph does not have node: "+d)}),a};function In(e,t){return Sn(e)||Ln(e,t)||Pn(e,t)||On()}function On(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pn(e,t){if(e){if(typeof e=="string")return Xe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xe(e,t)}}function Xe(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function Ln(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var o=[],r=!0,i=!1,a,s;try{for(n=n.call(e);!(r=(a=n.next()).done)&&(o.push(a.value),!(t&&o.length===t));r=!0);}catch(d){i=!0,s=d}finally{try{!r&&n.return!=null&&n.return()}finally{if(i)throw s}}return o}}function Sn(e){if(Array.isArray(e))return e}var Tn=function(){return 1},xt=function(t,n,o,r){return Cn(t,n,o||Tn,r||function(i){return t.outEdges(i)})},Cn=function(t,n,o,r){var i=new Map,a=new gt,s,d,l=function(f){var h=f.v!==s?f.v:f.w,p=i.get(h),v=o(f),b=d.distance+v;if(v<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+f+" Weight: "+v);b<p.distance&&(p.distance=b,p.predecessor=s,a.decrease(h,b))};for(t.nodes().forEach(function(u){var f=u===n?0:Number.POSITIVE_INFINITY;i.set(u,{distance:f}),a.add(u,f)});a.size()>0&&(s=a.removeMin(),d=i.get(s),!(d&&d.distance===Number.POSITIVE_INFINITY));)r(s).forEach(l);var c={};return Array.from(i.entries()).forEach(function(u){var f=In(u,2),h=f[0],p=f[1];return c[String(h)]=p,c}),c},Dn=function(t,n,o){var r={};return t.nodes().forEach(function(i){return r[String(i)]=xt(t,i,n,o),r}),r},Et=function(t){var n=0,o=[],r=new Map,i=[];function a(s){var d,l={onStack:!0,lowlink:n,index:n};if(r.set(s,l),n+=1,o.push(s),(d=t.successors(s))===null||d===void 0||d.forEach(function(h){var p;if(r.has(h)){if(!((p=r.get(h))===null||p===void 0)&&p.onStack){var b=r.get(h);l.lowlink=Math.min(l.lowlink,b.index)}}else{a(h);var v=r.get(h);l.lowlink=Math.min(l.lowlink,v.lowlink)}}),l.lowlink===l.index){var c=[],u;do{u=o.pop();var f=r.get(u);f.onStack=!1,c.push(u)}while(s!==u);i.push(c)}}return t.nodes().forEach(function(s){r.has(s)||a(s)}),i},Rn=function(t){return Et(t).filter(function(n){return n.length>1||n.length===1&&t.hasEdge(n[0],n[0])})};function Pe(e){return Pe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pe(e)}function He(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Fn(e,t,n){return t&&He(e.prototype,t),n&&He(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function jn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vn(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&le(e,t)}function An(e){var t=kt();return function(){var o=ce(e),r;if(t){var i=ce(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return Bn(this,r)}}function Bn(e,t){if(t&&(Pe(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gn(e)}function Gn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Le(e){var t=typeof Map=="function"?new Map:void 0;return Le=function(o){if(o===null||!zn(o))return o;if(typeof o!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(o))return t.get(o);t.set(o,r)}function r(){return he(o,arguments,ce(this).constructor)}return r.prototype=Object.create(o.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),le(r,o)},Le(e)}function he(e,t,n){return kt()?he=Reflect.construct:he=function(r,i,a){var s=[null];s.push.apply(s,i);var d=Function.bind.apply(r,s),l=new d;return a&&le(l,a.prototype),l},he.apply(null,arguments)}function kt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zn(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function le(e,t){return le=Object.setPrototypeOf||function(o,r){return o.__proto__=r,o},le(e,t)}function ce(e){return ce=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},ce(e)}var Se=function(e){Vn(n,e);var t=An(n);function n(){return jn(this,n),t.apply(this,arguments)}return Fn(n)}(Le(Error));function _t(e){var t=new Set,n=new Set,o=[];function r(i){if(n.has(i))throw new Se;if(!t.has(i)){var a;n.add(i),t.add(i),(a=e.predecessors(i))===null||a===void 0||a.forEach(r),n.delete(i),o.push(i)}}if(e.sinks().forEach(r),t.size!==e.nodeCount())throw new Se;return o}var $n=function(t){try{_t(t)}catch(n){if(n instanceof Se)return!1;throw n}return!0},Wn=function(t,n){return Fe(t,n,"post")},Un=function(t,n){return Fe(t,n,"pre")},qn=function(){return 1};function Yn(e,t,n){return Kn(e,t||qn,n||function(o){return e.outEdges(o)})}function Kn(e,t,n){var o={},r=e.nodes();return r.forEach(function(i){var a=String(i);o[a]={},o[a][a]={distance:0},r.forEach(function(s){i!==s&&(o[a][String(s)]={distance:Number.POSITIVE_INFINITY})}),n(i).forEach(function(s){var d=s.v===i?s.w:s.v,l=t(s);o[a][String(d)]={distance:l,predecessor:i}})}),r.forEach(function(i){var a=String(i),s=o[a];r.forEach(function(d){var l=String(d),c=o[l];r.forEach(function(u){var f=String(u),h=c[a],p=s[f],v=c[f],b=h.distance+p.distance;b<v.distance&&(v.distance=b,v.predecessor=p.predecessor)})})}),o}const Xn=Object.freeze(Object.defineProperty({__proto__:null,components:Nn,dfs:Fe,dijkstra:xt,dijkstraAll:Dn,findCycles:Rn,floydWarshall:Yn,isAcyclic:$n,postorder:Wn,preorder:Un,prim:_n,tarjan:Et,topsort:_t},Symbol.toStringTag,{value:"Module"}));class Hn extends xn{}class Jn extends me{}const Qn=()=>1,Zn=(e,t)=>{var n;if(e.nodeCount()<=1)return[];const o=to(e,t||Qn);return(n=eo(o.graph,o.buckets,o.zeroIdx).map(i=>e.outEdges(i.v,i.w)))===null||n===void 0?void 0:n.flat()},eo=(e,t,n)=>{let o=[];const r=t[t.length-1],i=t[0];let a;for(;e.nodeCount();){for(;a=i.dequeue();)we(e,t,n,a);for(;a=r.dequeue();)we(e,t,n,a);if(e.nodeCount()){for(let s=t.length-2;s>0;--s)if(a=t[s].dequeue(),a){o=o.concat(we(e,t,n,a,!0));break}}}return o},we=(e,t,n,o,r)=>{var i,a;const s=[];return(i=e.inEdges(o.v))===null||i===void 0||i.forEach(d=>{const l=e.edge(d),c=e.node(d.v);r&&s.push({v:d.v,w:d.w,in:0,out:0}),c.out===void 0&&(c.out=0),c.out-=l,Te(t,n,c)}),(a=e.outEdges(o.v))===null||a===void 0||a.forEach(d=>{const l=e.edge(d),c=d.w,u=e.node(c);u.in===void 0&&(u.in=0),u.in-=l,Te(t,n,u)}),e.removeNode(o.v),r?s:void 0},to=(e,t)=>{const n=new Jn;let o=0,r=0;e.nodes().forEach(d=>{n.setNode(d,{v:d,in:0,out:0})}),e.edges().forEach(d=>{const l=n.edge(d)||0,c=(t==null?void 0:t(d))||1,u=l+c;n.setEdge(d.v,d.w,u),r=Math.max(r,n.node(d.v).out+=c),o=Math.max(o,n.node(d.w).in+=c)});const i=[],a=r+o+3;for(let d=0;d<a;d++)i.push(new Hn);const s=o+1;return n.nodes().forEach(d=>{Te(i,s,n.node(d))}),{buckets:i,zeroIdx:s,graph:n}},Te=(e,t,n)=>{n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)},no=e=>{const t=o=>r=>{var i;return((i=o.edge(r))===null||i===void 0?void 0:i.weight)||1},n=e.graph().acyclicer==="greedy"?Zn(e,t(e)):oo(e);n==null||n.forEach(o=>{const r=e.edge(o);e.removeEdgeObj(o),r.forwardName=o.name,r.reversed=!0,e.setEdge(o.w,o.v,r,`rev-${Math.random()}`)})},oo=e=>{const t=[],n={},o={},r=i=>{var a;o[i]||(o[i]=!0,n[i]=!0,(a=e.outEdges(i))===null||a===void 0||a.forEach(s=>{n[s.w]?t.push(s):r(s.w)}),delete n[i])};return e.nodes().forEach(r),t},ro=e=>{e.edges().forEach(t=>{const n=e.edge(t);if(n.reversed){e.removeEdgeObj(t);const o=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,o)}})},Je={run:no,undo:ro};class ee extends me{}const io=(e,t)=>Number(e)-Number(t),ie=(e,t,n,o)=>{let r;do r=`${o}${Math.random()}`;while(e.hasNode(r));return n.dummy=t,e.setNode(r,n),r},so=e=>{const t=new ee().setGraph(e.graph());return e.nodes().forEach(n=>{t.setNode(n,e.node(n))}),e.edges().forEach(n=>{const o=t.edgeFromArgs(n.v,n.w)||{weight:0,minlen:1},r=e.edge(n);t.setEdge(n.v,n.w,{weight:o.weight+r.weight,minlen:Math.max(o.minlen,r.minlen)})}),t},Nt=e=>{const t=new ee({multigraph:e.isMultigraph()}).setGraph(e.graph());return e.nodes().forEach(n=>{var o;!((o=e.children(n))===null||o===void 0)&&o.length||t.setNode(n,e.node(n))}),e.edges().forEach(n=>{t.setEdgeObj(n,e.edge(n))}),t},ao=(e,t)=>e==null?void 0:e.reduce((n,o,r)=>(n[o]=t[r],n),{}),Qe=(e,t)=>{const n=Number(e.x),o=Number(e.y),r=Number(t.x)-n,i=Number(t.y)-o;let a=Number(e.width)/2,s=Number(e.height)/2;if(!r&&!i)return{x:0,y:0};let d,l;return Math.abs(i)*a>Math.abs(r)*s?(i<0&&(s=-s),d=s*r/i,l=s):(r<0&&(a=-a),d=a,l=a*i/r),{x:n+d,y:o+l}},ue=e=>{const t=[],n=Mt(e)+1;for(let o=0;o<n;o++)t.push([]);e.nodes().forEach(o=>{const r=e.node(o);if(!r)return;const i=r.rank;i!==void 0&&t[i]&&t[i].push(o)});for(let o=0;o<n;o++)t[o]=t[o].sort((r,i)=>{var a,s;return io((a=e.node(r))===null||a===void 0?void 0:a.order,(s=e.node(i))===null||s===void 0?void 0:s.order)});return t},lo=e=>{const t=e.nodes().filter(o=>{var r;return((r=e.node(o))===null||r===void 0?void 0:r.rank)!==void 0}).map(o=>e.node(o).rank),n=Math.min(...t);e.nodes().forEach(o=>{const r=e.node(o);r.hasOwnProperty("rank")&&n!==1/0&&(r.rank-=n)})},co=e=>{const t=e.nodes(),n=t.filter(s=>{var d;return((d=e.node(s))===null||d===void 0?void 0:d.rank)!==void 0}).map(s=>e.node(s).rank),o=Math.min(...n),r=[];t.forEach(s=>{var d;const l=(((d=e.node(s))===null||d===void 0?void 0:d.rank)||0)-o;r[l]||(r[l]=[]),r[l].push(s)});let i=0;const a=e.graph().nodeRankFactor||0;for(let s=0;s<r.length;s++){const d=r[s];d===void 0?s%a!==0&&(i-=1):i&&(d==null||d.forEach(l=>{const c=e.node(l);c&&(c.rank=c.rank||0,c.rank+=i)}))}},Ze=(e,t,n,o)=>{const r={width:0,height:0};return pe(n)&&pe(o)&&(r.rank=n,r.order=o),ie(e,"border",r,t)},Mt=e=>{let t;return e.nodes().forEach(n=>{var o;const r=(o=e.node(n))===null||o===void 0?void 0:o.rank;r!==void 0&&(t===void 0||r>t)&&(t=r)}),t||(t=0),t},uo=(e,t)=>{const n={lhs:[],rhs:[]};return e==null||e.forEach(o=>{t(o)?n.lhs.push(o):n.rhs.push(o)}),n},It=(e,t)=>{const n=Date.now();try{return t()}finally{console.log(`${e} time: ${Date.now()-n}ms`)}},Ot=(e,t)=>t(),je=(e,t)=>e.reduce((n,o)=>{const r=t(n),i=t(o);return r>i?o:n}),fo=e=>{e.graph().dummyChains=[],e.edges().forEach(t=>ho(e,t))},ho=(e,t)=>{let n=t.v,o=e.node(n).rank;const r=t.w,i=e.node(r).rank,a=t.name,s=e.edge(t),d=s.labelRank;if(i===o+1)return;e.removeEdgeObj(t);const l=e.graph();let c,u,f;for(f=0,++o;o<i;++f,++o)s.points=[],u={edgeLabel:s,width:0,height:0,edgeObj:t,rank:o},c=ie(e,"edge",u,"_d"),o===d&&(u.width=s.width,u.height=s.height,u.dummy="edge-label",u.labelpos=s.labelpos),e.setEdge(n,c,{weight:s.weight},a),f===0&&(l.dummyChains||(l.dummyChains=[]),l.dummyChains.push(c)),n=c;e.setEdge(n,r,{weight:s.weight},a)},po=e=>{var t;(t=e.graph().dummyChains)===null||t===void 0||t.forEach(n=>{let o=e.node(n);const r=o.edgeLabel;let i;o.edgeObj&&e.setEdgeObj(o.edgeObj,r);let a=n;for(;o.dummy;)i=e.successors(a)[0],e.removeNode(a),r.points.push({x:o.x,y:o.y}),o.dummy==="edge-label"&&(r.x=o.x,r.y=o.y,r.width=o.width,r.height=o.height),a=i,o=e.node(a)})},et={run:fo,undo:po},Pt=e=>{var t;const n={},o=r=>{var i;const a=e.node(r);if(!a)return 0;if(n[r])return a.rank;n[r]=!0;let s;return(i=e.outEdges(r))===null||i===void 0||i.forEach(d=>{const l=o(d.w),c=e.edge(d).minlen,u=l-c;u&&(s===void 0||u<s)&&(s=u)}),s||(s=0),a.rank=s,s};(t=e.sources())===null||t===void 0||t.forEach(r=>o(r))},vo=e=>{var t;const n={};let o;const r=s=>{var d;const l=e.node(s);if(!l)return 0;if(n[s])return l.rank;n[s]=!0;let c;return(d=e.outEdges(s))===null||d===void 0||d.forEach(u=>{const f=r(u.w),h=e.edge(u).minlen,p=f-h;p&&(c===void 0||p<c)&&(c=p)}),c||(c=0),(o===void 0||c<o)&&(o=c),l.rank=c,c};(t=e.sources())===null||t===void 0||t.forEach(s=>{e.node(s)&&r(s)}),o===void 0&&(o=0);const i={},a=(s,d)=>{var l;const c=e.node(s),u=isNaN(c.layer)?d:c.layer;(c.rank===void 0||c.rank<u)&&(c.rank=u),!i[s]&&(i[s]=!0,(l=e.outEdges(s))===null||l===void 0||l.map(f=>{a(f.w,u+e.edge(f).minlen)}))};e.nodes().forEach(s=>{const d=e.node(s);d&&(isNaN(d.layer)?d.rank-=o:a(s,d.layer))})},te=(e,t)=>e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen,mo=e=>{const t=new ee({directed:!1}),n=e.nodes()[0],o=e.nodeCount();t.setNode(n,{});let r,i;for(;yo(t,e)<o;)r=Lt(t,e),i=t.hasNode(r.v)?te(e,r):-te(e,r),St(t,e,i);return t},yo=(e,t)=>{const n=o=>{t.nodeEdges(o).forEach(r=>{const i=r.v,a=o===i?r.w:i;!e.hasNode(a)&&!te(t,r)&&(e.setNode(a,{}),e.setEdge(o,a,{}),n(a))})};return e.nodes().forEach(n),e.nodeCount()},bo=e=>{const t=new ee({directed:!1}),n=e.nodes()[0],o=e.nodes().filter(a=>!!e.node(a)).length;t.setNode(n,{});let r,i;for(;wo(t,e)<o;)r=Lt(t,e),i=t.hasNode(r.v)?te(e,r):-te(e,r),St(t,e,i);return t},wo=(e,t)=>{const n=o=>{var r;(r=t.nodeEdges(o))===null||r===void 0||r.forEach(i=>{const a=i.v,s=o===a?i.w:a;!e.hasNode(s)&&(t.node(s).layer!==void 0||!te(t,i))&&(e.setNode(s,{}),e.setEdge(o,s,{}),n(s))})};return e.nodes().forEach(n),e.nodeCount()},Lt=(e,t)=>je(t.edges(),n=>e.hasNode(n.v)!==e.hasNode(n.w)?te(t,n):1/0),St=(e,t,n)=>{e.nodes().forEach(o=>{t.node(o).rank||(t.node(o).rank=0),t.node(o).rank+=n})},{preorder:go,postorder:xo}=Xn,Eo=e=>{const t=so(e);Pt(t);const n=mo(t);Ct(n),Tt(n,t);let o,r;for(;o=No(n);)r=Mo(n,t,o),Io(n,t,o,r)},Tt=(e,t)=>{let n=xo(e,e.nodes());n=n==null?void 0:n.slice(0,(n==null?void 0:n.length)-1),n==null||n.forEach(o=>{ko(e,t,o)})},ko=(e,t,n)=>{const r=e.node(n).parent;e.edgeFromArgs(n,r).cutvalue=_o(e,t,n)},_o=(e,t,n)=>{var o;const i=e.node(n).parent;let a=!0,s=t.edgeFromArgs(n,i),d=0;return s||(a=!1,s=t.edgeFromArgs(i,n)),d=s.weight,(o=t.nodeEdges(n))===null||o===void 0||o.forEach(l=>{const c=l.v===n,u=c?l.w:l.v;if(u!==i){const f=c===a,h=t.edge(l).weight;if(d+=f?h:-h,Po(e,n,u)){const p=e.edgeFromArgs(n,u).cutvalue;d+=f?-p:p}}}),d},Ct=(e,t=e.nodes()[0])=>{Dt(e,{},1,t)},Dt=(e,t,n,o,r)=>{var i;const a=n;let s=n;const d=e.node(o);return t[o]=!0,(i=e.neighbors(o))===null||i===void 0||i.forEach(l=>{t[l]||(s=Dt(e,t,s,l,o))}),d.low=a,d.lim=s++,r?d.parent=r:delete d.parent,s},No=e=>e.edges().find(t=>e.edge(t).cutvalue<0),Mo=(e,t,n)=>{let o=n.v,r=n.w;t.hasEdge(o,r)||(o=n.w,r=n.v);const i=e.node(o),a=e.node(r);let s=i,d=!1;i.lim>a.lim&&(s=a,d=!0);const l=t.edges().filter(c=>d===tt(e,e.node(c.v),s)&&d!==tt(e,e.node(c.w),s));return je(l,c=>te(t,c))},Io=(e,t,n,o)=>{const r=n.v,i=n.w;e.removeEdge(r,i),e.setEdge(o.v,o.w,{}),Ct(e),Tt(e,t),Oo(e,t)},Oo=(e,t)=>{const n=e.nodes().find(r=>{var i;return!(!((i=t.node(r))===null||i===void 0)&&i.parent)});let o=go(e,n);o=o==null?void 0:o.slice(1),o==null||o.forEach(r=>{const i=e.node(r).parent;let a=t.edgeFromArgs(r,i),s=!1;a||(a=t.edgeFromArgs(i,r),s=!0),t.node(r).rank=t.node(i).rank+(s?a.minlen:-a.minlen)})},Po=(e,t,n)=>e.hasEdge(t,n),tt=(e,t,n)=>n.low<=t.lim&&t.lim<=n.lim,Lo=e=>{switch(e.graph().ranker){case"network-simplex":To(e);break;case"tight-tree":nt(e);break;case"longest-path":So(e);break;default:nt(e)}},So=Pt,nt=e=>{vo(e),bo(e)},To=e=>{Eo(e)},Co=e=>{var t;const n={};let o=0;const r=i=>{var a;const s=o;(a=e.children(i))===null||a===void 0||a.forEach(r),n[i]={low:s,lim:o++}};return(t=e.children())===null||t===void 0||t.forEach(r),n},Do=(e,t,n,o)=>{const r=[],i=[],a=Math.min(t[n].low,t[o].low),s=Math.max(t[n].lim,t[o].lim);let d,l;d=n;do d=e.parent(d),r.push(d);while(d&&(t[d].low>a||s>t[d].lim));for(l=d,d=o;d&&d!==l;)i.push(d),d=e.parent(d);return{lca:l,path:r.concat(i.reverse())}},Ro=e=>{var t;const n=Co(e);(t=e.graph().dummyChains)===null||t===void 0||t.forEach(o=>{var r,i;let a=o,s=e.node(a);const d=s.edgeObj;if(!d)return;const l=Do(e,n,d.v,d.w),c=l.path,u=l.lca;let f=0,h=c[f],p=!0;for(;a!==d.w;){if(s=e.node(a),p){for(;h!==u&&((r=e.node(h))===null||r===void 0?void 0:r.maxRank)<s.rank;)f++,h=c[f];h===u&&(p=!1)}if(!p){for(;f<c.length-1&&((i=e.node(c[f+1]))===null||i===void 0?void 0:i.minRank)<=s.rank;)f++;h=c[f]}e.setParent(a,h),a=e.successors(a)[0]}})},Fo=e=>{var t;const n=ie(e,"root",{},"_root"),o=jo(e);let r=Math.max(...Object.values(o));Math.abs(r)===1/0&&(r=1);const i=r-1,a=2*i+1;e.graph().nestingRoot=n,e.edges().forEach(d=>{e.edge(d).minlen*=a});const s=Vo(e)+1;(t=e.children())===null||t===void 0||t.forEach(d=>{Rt(e,n,a,s,i,o,d)}),e.graph().nodeRankFactor=a},Rt=(e,t,n,o,r,i,a)=>{const s=e.children(a);if(!(s!=null&&s.length)){a!==t&&e.setEdge(t,a,{weight:0,minlen:n});return}const d=Ze(e,"_bt"),l=Ze(e,"_bb"),c=e.node(a);e.setParent(d,a),c.borderTop=d,e.setParent(l,a),c.borderBottom=l,s==null||s.forEach(u=>{Rt(e,t,n,o,r,i,u);const f=e.node(u),h=f.borderTop?f.borderTop:u,p=f.borderBottom?f.borderBottom:u,v=f.borderTop?o:2*o,b=h!==p?1:r-i[a]+1;e.setEdge(d,h,{minlen:b,weight:v,nestingEdge:!0}),e.setEdge(p,l,{minlen:b,weight:v,nestingEdge:!0})}),e.parent(a)||e.setEdge(t,d,{weight:0,minlen:r+i[a]})},jo=e=>{var t;const n={},o=(r,i)=>{const a=e.children(r);a==null||a.forEach(s=>o(s,i+1)),n[r]=i};return(t=e.children())===null||t===void 0||t.forEach(r=>o(r,1)),n},Vo=e=>{let t=0;return e.edges().forEach(n=>{t+=e.edge(n).weight}),t},Ao=e=>{const t=e.graph();t.nestingRoot&&e.removeNode(t.nestingRoot),delete t.nestingRoot,e.edges().forEach(n=>{e.edge(n).nestingEdge&&e.removeEdgeObj(n)})},ot={run:Fo,cleanup:Ao},Bo=e=>{var t;const n=o=>{const r=e.children(o),i=e.node(o);if(r!=null&&r.length&&r.forEach(a=>n(a)),i.hasOwnProperty("minRank")){i.borderLeft=[],i.borderRight=[];for(let a=i.minRank,s=i.maxRank+1;a<s;a+=1)rt(e,"borderLeft","_bl",o,i,a),rt(e,"borderRight","_br",o,i,a)}};(t=e.children())===null||t===void 0||t.forEach(o=>n(o))},rt=(e,t,n,o,r,i)=>{const a={rank:i,borderType:t,width:0,height:0},s=r[t][i-1],d=ie(e,"border",a,n);r[t][i]=d,e.setParent(d,o),s&&e.setEdge(s,d,{weight:1})},Go=e=>{var t;const n=(t=e.graph().rankdir)===null||t===void 0?void 0:t.toLowerCase();(n==="lr"||n==="rl")&&Ft(e)},zo=e=>{var t;const n=(t=e.graph().rankdir)===null||t===void 0?void 0:t.toLowerCase();(n==="bt"||n==="rl")&&$o(e),(n==="lr"||n==="rl")&&(Wo(e),Ft(e))},Ft=e=>{e.nodes().forEach(t=>{it(e.node(t))}),e.edges().forEach(t=>{it(e.edge(t))})},it=e=>{const t=e.width;e.width=e.height,e.height=t},$o=e=>{e.nodes().forEach(t=>{ge(e.node(t))}),e.edges().forEach(t=>{var n;const o=e.edge(t);(n=o.points)===null||n===void 0||n.forEach(r=>ge(r)),o.hasOwnProperty("y")&&ge(o)})},ge=e=>{e!=null&&e.y&&(e.y=-e.y)},Wo=e=>{e.nodes().forEach(t=>{xe(e.node(t))}),e.edges().forEach(t=>{var n;const o=e.edge(t);(n=o.points)===null||n===void 0||n.forEach(r=>xe(r)),o.hasOwnProperty("x")&&xe(o)})},xe=e=>{const t=e.x;e.x=e.y,e.y=t},st={adjust:Go,undo:zo},at=e=>{const t={},n=e.nodes().filter(c=>{var u;return!(!((u=e.children(c))===null||u===void 0)&&u.length)}),o=n.map(c=>e.node(c).rank),r=Math.max(...o),i=[];for(let c=0;c<r+1;c++)i.push([]);const a=c=>{var u;if(t.hasOwnProperty(c))return;t[c]=!0;const f=e.node(c);isNaN(f.rank)||i[f.rank].push(c),(u=e.successors(c))===null||u===void 0||u.forEach(h=>a(h))},s=n.sort((c,u)=>e.node(c).rank-e.node(u).rank),l=s.filter(c=>e.node(c).fixorder!==void 0).sort((c,u)=>e.node(c).fixorder-e.node(u).fixorder);return l==null||l.forEach(c=>{isNaN(e.node(c).rank)||i[e.node(c).rank].push(c),t[c]=!0}),s==null||s.forEach(a),i},Uo=(e,t,n)=>{const o=ao(n,n.map((c,u)=>u)),i=t.map(c=>{var u;const f=(u=e.outEdges(c))===null||u===void 0?void 0:u.map(h=>({pos:o[h.w]||0,weight:e.edge(h).weight}));return f==null?void 0:f.sort((h,p)=>h.pos-p.pos)}).flat().filter(c=>c!==void 0);let a=1;for(;a<n.length;)a<<=1;const s=2*a-1;a-=1;const d=Array(s).fill(0,0,s);let l=0;return i==null||i.forEach(c=>{if(c){let u=c.pos+a;d[u]+=c.weight;let f=0;for(;u>0;)u%2&&(f+=d[u+1]),u=u-1>>1,d[u]+=c.weight;l+=c.weight*f}}),l},dt=(e,t)=>{let n=0;for(let o=1;o<(t==null?void 0:t.length);o+=1)n+=Uo(e,t[o-1],t[o]);return n},qo=(e,t,n)=>{const o=Yo(e),r=new ee({compound:!0}).setGraph({root:o}).setDefaultNodeLabel(i=>e.node(i));return e.nodes().forEach(i=>{var a;const s=e.node(i),d=e.parent(i);(s.rank===t||s.minRank<=t&&t<=s.maxRank)&&(r.setNode(i),r.setParent(i,d||o),(a=e[n](i))===null||a===void 0||a.forEach(l=>{const c=l.v===i?l.w:l.v,u=r.edgeFromArgs(c,i),f=u!==void 0?u.weight:0;r.setEdge(c,i,{weight:e.edge(l).weight+f})}),s.hasOwnProperty("minRank")&&r.setNode(i,{borderLeft:s.borderLeft[t],borderRight:s.borderRight[t]}))}),r},Yo=e=>{let t;for(;e.hasNode(t=`_root${Math.random()}`););return t},Ko=(e,t,n)=>{const o={};let r;n==null||n.forEach(i=>{let a=e.parent(i),s,d;for(;a;){if(s=e.parent(a),s?(d=o[s],o[s]=a):(d=r,r=a),d&&d!==a){t.setEdge(d,a);return}a=s}})},Xo=(e,t)=>t.map(n=>{const o=e.inEdges(n);if(!(o!=null&&o.length))return{v:n};{const r={sum:0,weight:0};return o==null||o.forEach(i=>{const a=e.edge(i),s=e.node(i.v);r.sum+=a.weight*s.order,r.weight+=a.weight}),{v:n,barycenter:r.sum/r.weight,weight:r.weight}}}),Ho=(e,t)=>{var n,o,r;const i={};e==null||e.forEach((s,d)=>{i[s.v]={i:d,indegree:0,in:[],out:[],vs:[s.v]};const l=i[s.v];s.barycenter!==void 0&&(l.barycenter=s.barycenter,l.weight=s.weight)}),(n=t.edges())===null||n===void 0||n.forEach(s=>{const d=i[s.v],l=i[s.w];d!==void 0&&l!==void 0&&(l.indegree++,d.out.push(i[s.w]))});const a=(r=(o=Object.values(i)).filter)===null||r===void 0?void 0:r.call(o,s=>!s.indegree);return Jo(a)},Jo=e=>{var t,n;const o=[],r=d=>l=>{l.merged||(l.barycenter===void 0||d.barycenter===void 0||l.barycenter>=d.barycenter)&&Qo(d,l)},i=d=>l=>{l.in.push(d),--l.indegree===0&&e.push(l)};for(;e!=null&&e.length;){const d=e.pop();o.push(d),(t=d.in.reverse())===null||t===void 0||t.forEach(l=>r(d)(l)),(n=d.out)===null||n===void 0||n.forEach(l=>i(d)(l))}const a=o.filter(d=>!d.merged),s=["vs","i","barycenter","weight"];return a.map(d=>{const l={};return s==null||s.forEach(c=>{d[c]!==void 0&&(l[c]=d[c])}),l})},Qo=(e,t)=>{var n;let o=0,r=0;e.weight&&(o+=e.barycenter*e.weight,r+=e.weight),t.weight&&(o+=t.barycenter*t.weight,r+=t.weight),e.vs=(n=t.vs)===null||n===void 0?void 0:n.concat(e.vs),e.barycenter=o/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0},Zo=(e,t,n,o)=>{const r=uo(e,f=>{const h=f.hasOwnProperty("fixorder")&&!isNaN(f.fixorder);return o?!h&&f.hasOwnProperty("barycenter"):h||f.hasOwnProperty("barycenter")}),i=r.lhs,a=r.rhs.sort((f,h)=>-f.i- -h.i),s=[];let d=0,l=0,c=0;i==null||i.sort(er(!!t,!!n)),c=lt(s,a,c),i==null||i.forEach(f=>{var h;c+=(h=f.vs)===null||h===void 0?void 0:h.length,s.push(f.vs),d+=f.barycenter*f.weight,l+=f.weight,c=lt(s,a,c)});const u={vs:s.flat()};return l&&(u.barycenter=d/l,u.weight=l),u},lt=(e,t,n)=>{let o=n,r;for(;t.length&&(r=t[t.length-1]).i<=o;)t.pop(),e==null||e.push(r.vs),o++;return o},er=(e,t)=>(n,o)=>{if(n.fixorder!==void 0&&o.fixorder!==void 0)return n.fixorder-o.fixorder;if(n.barycenter<o.barycenter)return-1;if(n.barycenter>o.barycenter)return 1;if(t&&n.order!==void 0&&o.order!==void 0){if(n.order<o.order)return-1;if(n.order>o.order)return 1}return e?o.i-n.i:n.i-o.i},jt=(e,t,n,o,r,i)=>{var a,s,d,l;let c=e.children(t);const u=e.node(t),f=u?u.borderLeft:void 0,h=u?u.borderRight:void 0,p={};f&&(c=c==null?void 0:c.filter(N=>N!==f&&N!==h));const v=Xo(e,c||[]);v==null||v.forEach(N=>{var y;if(!((y=e.children(N.v))===null||y===void 0)&&y.length){const E=jt(e,N.v,n,o,i);p[N.v]=E,E.hasOwnProperty("barycenter")&&nr(N,E)}});const b=Ho(v,n);tr(b,p),(a=b.filter(N=>N.vs.length>0))===null||a===void 0||a.forEach(N=>{const y=e.node(N.vs[0]);y&&(N.fixorder=y.fixorder,N.order=y.order)});const w=Zo(b,o,r,i);if(f&&(w.vs=[f,w.vs,h].flat(),!((s=e.predecessors(f))===null||s===void 0)&&s.length)){const N=e.node(((d=e.predecessors(f))===null||d===void 0?void 0:d[0])||""),y=e.node(((l=e.predecessors(h))===null||l===void 0?void 0:l[0])||"");w.hasOwnProperty("barycenter")||(w.barycenter=0,w.weight=0),w.barycenter=(w.barycenter*w.weight+N.order+y.order)/(w.weight+2),w.weight+=2}return w},tr=(e,t)=>{e==null||e.forEach(n=>{var o;const r=(o=n.vs)===null||o===void 0?void 0:o.map(i=>t[i]?t[i].vs:i);n.vs=r.flat()})},nr=(e,t)=>{e.barycenter!==void 0?(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight):(e.barycenter=t.barycenter,e.weight=t.weight)},or=(e,t)=>{const n=Mt(e),o=[],r=[];for(let c=1;c<n+1;c++)o.push(c);for(let c=n-1;c>-1;c--)r.push(c);const i=ct(e,o,"inEdges"),a=ct(e,r,"outEdges");let s=at(e);Ee(e,s);let d=Number.POSITIVE_INFINITY,l;for(let c=0,u=0;u<4;++c,++u){ut(c%2?i:a,c%4>=2,!1,t),s=ue(e);const f=dt(e,s);f<d&&(u=0,l=ve(s),d=f)}s=at(e),Ee(e,s);for(let c=0,u=0;u<4;++c,++u){ut(c%2?i:a,c%4>=2,!0,t),s=ue(e);const f=dt(e,s);f<d&&(u=0,l=ve(s),d=f)}Ee(e,l)},ct=(e,t,n)=>t.map(o=>qo(e,o,n)),ut=(e,t,n,o)=>{const r=new ee;e==null||e.forEach(i=>{var a;const s=i.graph().root,d=jt(i,s,r,t,n,o);for(let l=0;l<((a=d.vs)===null||a===void 0?void 0:a.length);l++){const c=i.node(d.vs[l]);c&&(c.order=l)}Ko(i,r,d.vs)})},Ee=(e,t)=>{t==null||t.forEach(n=>{n==null||n.forEach((o,r)=>{e.node(o).order=r})})};class rr extends me{}const ir=(e,t)=>{const n={},o=(r,i)=>{let a=0,s=0;const d=r.length,l=i==null?void 0:i[(i==null?void 0:i.length)-1];return i==null||i.forEach((c,u)=>{var f;const h=ar(e,c),p=h?e.node(h).order:d;(h||c===l)&&((f=i.slice(s,u+1))===null||f===void 0||f.forEach(v=>{var b;(b=e.predecessors(v))===null||b===void 0||b.forEach(w=>{var N;const y=e.node(w),E=y.order;(E<a||p<E)&&!(y.dummy&&(!((N=e.node(v))===null||N===void 0)&&N.dummy))&&Vt(n,w,v)})}),s=u+1,a=p)}),i};return t!=null&&t.length&&t.reduce(o),n},sr=(e,t)=>{const n={};function o(s,d,l,c,u){var f,h;let p;for(let v=d;v<l;v++)p=s[v],!((f=e.node(p))===null||f===void 0)&&f.dummy&&((h=e.predecessors(p))===null||h===void 0||h.forEach(b=>{const w=e.node(b);w.dummy&&(w.order<c||w.order>u)&&Vt(n,b,p)}))}function r(s){return JSON.stringify(s.slice(1))}function i(s,d){const l=r(s);d.get(l)||(o(...s),d.set(l,!0))}const a=(s,d)=>{let l=-1,c,u=0;const f=new Map;return d==null||d.forEach((h,p)=>{var v;if(((v=e.node(h))===null||v===void 0?void 0:v.dummy)==="border"){const b=e.predecessors(h)||[];b.length&&(c=e.node(b[0]).order,i([d,u,p,l,c],f),u=p,l=c)}i([d,u,d.length,c,s.length],f)}),d};return t!=null&&t.length&&t.reduce(a),n},ar=(e,t)=>{var n,o;if(!((n=e.node(t))===null||n===void 0)&&n.dummy)return(o=e.predecessors(t))===null||o===void 0?void 0:o.find(r=>e.node(r).dummy)},Vt=(e,t,n)=>{let o=t,r=n;if(o>r){const a=o;o=r,r=a}let i=e[o];i||(e[o]=i={}),i[r]=!0},dr=(e,t,n)=>{let o=t,r=n;if(o>r){const i=t;o=r,r=i}return!!e[o]},lr=(e,t,n,o)=>{const r={},i={},a={};return t==null||t.forEach(s=>{s==null||s.forEach((d,l)=>{r[d]=d,i[d]=d,a[d]=l})}),t==null||t.forEach(s=>{let d=-1;s==null||s.forEach(l=>{let c=o(l);if(c.length){c=c.sort((f,h)=>a[f]-a[h]);const u=(c.length-1)/2;for(let f=Math.floor(u),h=Math.ceil(u);f<=h;++f){const p=c[f];i[l]===l&&d<a[p]&&!dr(n,l,p)&&(i[p]=l,i[l]=r[l]=r[p],d=a[p])}}})}),{root:r,align:i}},cr=(e,t,n,o,r)=>{var i;const a={},s=ur(e,t,n,r),d=r?"borderLeft":"borderRight",l=(f,h)=>{let p=s.nodes(),v=p.pop();const b={};for(;v;)b[v]?f(v):(b[v]=!0,p.push(v),p=p.concat(h(v))),v=p.pop()},c=f=>{a[f]=(s.inEdges(f)||[]).reduce((h,p)=>Math.max(h,(a[p.v]||0)+s.edge(p)),0)},u=f=>{const h=(s.outEdges(f)||[]).reduce((v,b)=>Math.min(v,(a[b.w]||0)-s.edge(b)),Number.POSITIVE_INFINITY),p=e.node(f);h!==Number.POSITIVE_INFINITY&&p.borderType!==d&&(a[f]=Math.max(a[f],h))};return l(c,s.predecessors.bind(s)),l(u,s.successors.bind(s)),(i=Object.values(o))===null||i===void 0||i.forEach(f=>{a[f]=a[n[f]]}),a},ur=(e,t,n,o)=>{const r=new rr,i=e.graph(),a=vr(i.nodesep,i.edgesep,o);return t==null||t.forEach(s=>{let d;s==null||s.forEach(l=>{const c=n[l];if(r.setNode(c),d){const u=n[d],f=r.edgeFromArgs(u,c);r.setEdge(u,c,Math.max(a(e,l,d),f||0))}d=l})}),r},fr=(e,t)=>je(Object.values(t),n=>{var o;let r=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return(o=Object.keys(n))===null||o===void 0||o.forEach(a=>{const s=n[a],d=mr(e,a)/2;r=Math.max(s+d,r),i=Math.min(s-d,i)}),r-i});function hr(e,t){const n=Object.values(t),o=Math.min(...n),r=Math.max(...n);["u","d"].forEach(i=>{["l","r"].forEach(a=>{const s=i+a,d=e[s];let l;if(d===t)return;const c=Object.values(d);l=a==="l"?o-Math.min(...c):r-Math.max(...c),l&&(e[s]={},Object.keys(d).forEach(u=>{e[s][u]=d[u]+l}))})})}const pr=(e,t)=>{const n={};return Object.keys(e.ul).forEach(o=>{if(t)n[o]=e[t.toLowerCase()][o];else{const r=Object.values(e).map(i=>i[o]);n[o]=(r[0]+r[1])/2}}),n},vr=(e,t,n)=>(o,r,i)=>{const a=o.node(r),s=o.node(i);let d=0,l;if(d+=a.width/2,a.hasOwnProperty("labelpos"))switch((a.labelpos||"").toLowerCase()){case"l":l=-a.width/2;break;case"r":l=a.width/2;break}if(l&&(d+=n?l:-l),l=0,d+=(a.dummy?t:e)/2,d+=(s.dummy?t:e)/2,d+=s.width/2,s.labelpos)switch((s.labelpos||"").toLowerCase()){case"l":l=s.width/2;break;case"r":l=-s.width/2;break}return l&&(d+=n?l:-l),l=0,d},mr=(e,t)=>e.node(t).width||0,yr=e=>{const t=ue(e),n=e.graph().ranksep;let o=0;t==null||t.forEach(r=>{const i=r.map(s=>e.node(s).height),a=Math.max(...i,0);r==null||r.forEach(s=>{e.node(s).y=o+a/2}),o+=a+n})},br=e=>{const t=ue(e),n=Object.assign(ir(e,t),sr(e,t)),o={};let r=[];["u","d"].forEach(a=>{r=a==="u"?t:Object.values(t).reverse(),["l","r"].forEach(s=>{s==="r"&&(r=r.map(u=>Object.values(u).reverse()));const d=(a==="u"?e.predecessors:e.successors).bind(e),l=lr(e,r,n,d),c=cr(e,r,l.root,l.align,s==="r");s==="r"&&Object.keys(c).forEach(u=>c[u]=-c[u]),o[a+s]=c})});const i=fr(e,o);return i&&hr(o,i),pr(o,e.graph().align)},wr=e=>{var t;const n=Nt(e);yr(n);const o=br(n);(t=Object.keys(o))===null||t===void 0||t.forEach(r=>{n.node(r).x=o[r]})},gr=(e,t)=>{const o=e.nodes().filter(a=>{var s;return!(!((s=e.children(a))===null||s===void 0)&&s.length)}).map(a=>e.node(a).rank),r=Math.max(...o),i=[];for(let a=0;a<r+1;a++)i[a]=[];t==null||t.forEach(a=>{const s=e.node(a);!s||s!=null&&s.dummy||isNaN(s.rank)||(s.fixorder=i[s.rank].length,i[s.rank].push(a))})},xr=(e,t)=>{const n=t&&t.debugTiming?It:Ot;n("layout",()=>{t&&!t.keepNodeOrder&&t.prevGraph&&n("  inheritOrder",()=>{kr(e,t.prevGraph)});const o=n("  buildLayoutGraph",()=>Sr(e));t&&t.edgeLabelSpace===!1||n("  makeSpaceForEdgeLabels",()=>{Tr(o)});try{n("  runLayout",()=>{Er(o,n,t)})}catch(r){if(r.message==="Not possible to find intersection inside of the rectangle"){console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`,r);return}throw r}n("  updateInputGraph",()=>{_r(e,o)})})},Er=(e,t,n)=>{t("    removeSelfEdges",()=>{Gr(e)}),t("    acyclic",()=>{Je.run(e)}),t("    nestingGraph.run",()=>{ot.run(e)}),t("    rank",()=>{Lo(Nt(e))}),t("    injectEdgeLabelProxies",()=>{Cr(e)}),t("    removeEmptyRanks",()=>{co(e)}),t("    nestingGraph.cleanup",()=>{ot.cleanup(e)}),t("    normalizeRanks",()=>{lo(e)}),t("    assignRankMinMax",()=>{Dr(e)}),t("    removeEdgeLabelProxies",()=>{Rr(e)}),t("    normalize.run",()=>{et.run(e)}),t("    parentDummyChains",()=>{Ro(e)}),t("    addBorderSegments",()=>{Bo(e)}),n&&n.keepNodeOrder&&t("    initDataOrder",()=>{gr(e,n.nodeOrder)}),t("    order",()=>{or(e,n==null?void 0:n.keepNodeOrder)}),t("    insertSelfEdges",()=>{zr(e)}),t("    adjustCoordinateSystem",()=>{st.adjust(e)}),t("    position",()=>{wr(e)}),t("    positionSelfEdges",()=>{$r(e)}),t("    removeBorderNodes",()=>{Br(e)}),t("    normalize.undo",()=>{et.undo(e)}),t("    fixupEdgeLabelCoords",()=>{Vr(e)}),t("    undoCoordinateSystem",()=>{st.undo(e)}),t("    translateGraph",()=>{Fr(e)}),t("    assignNodeIntersects",()=>{jr(e)}),t("    reversePoints",()=>{Ar(e)}),t("    acyclic.undo",()=>{Je.undo(e)})},kr=(e,t)=>{e.nodes().forEach(n=>{const o=e.node(n),r=t.node(n);r!==void 0?(o.fixorder=r._order,delete r._order):delete o.fixorder})},_r=(e,t)=>{e.nodes().forEach(n=>{var o;const r=e.node(n);if(r){const i=t.node(n);r.x=i.x,r.y=i.y,r._order=i.order,r._rank=i.rank,!((o=t.children(n))===null||o===void 0)&&o.length&&(r.width=i.width,r.height=i.height)}}),e.edges().forEach(n=>{const o=e.edge(n),r=t.edge(n);o.points=r?r.points:[],r&&r.hasOwnProperty("x")&&(o.x=r.x,o.y=r.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height},Nr=["nodesep","edgesep","ranksep","marginx","marginy"],Mr={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},ke=["acyclicer","ranker","rankdir","align"],Ir=["width","height","layer","fixorder"],Or={width:0,height:0},Pr=["minlen","weight","width","height","labeloffset"],Lr={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},_e=["labelpos"],Sr=e=>{const t=new ee({multigraph:!0,compound:!0}),n=Me(e.graph()),o={};return ke==null||ke.forEach(r=>{n[r]!==void 0&&(o[r]=n[r])}),t.setGraph(Object.assign({},Mr,Ne(n,Nr),o)),e.nodes().forEach(r=>{const i=Me(e.node(r)),a=Object.assign(Object.assign({},Or),i),s=Ne(a,Ir);t.setNode(r,s),t.setParent(r,e.parent(r))}),e.edges().forEach(r=>{const i=Me(e.edge(r)),a={};_e==null||_e.forEach(s=>{i[s]!==void 0&&(a[s]=i[s])}),t.setEdgeObj(r,Object.assign({},Lr,Ne(i,Pr),a))}),t},Tr=e=>{const t=e.graph();t.ranksep||(t.ranksep=0),t.ranksep/=2,e.nodes().forEach(n=>{const o=e.node(n);isNaN(o.layer)||o.layer||(o.layer=0)}),e.edges().forEach(n=>{var o;const r=e.edge(n);r.minlen*=2,((o=r.labelpos)===null||o===void 0?void 0:o.toLowerCase())!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?r.width+=r.labeloffset:r.height+=r.labeloffset)})},Cr=e=>{e.edges().forEach(t=>{const n=e.edge(t);if(n.width&&n.height){const o=e.node(t.v),r=e.node(t.w),i={e:t,rank:(r.rank-o.rank)/2+o.rank};ie(e,"edge-proxy",i,"_ep")}})},Dr=e=>{let t=0;e.nodes().forEach(n=>{var o,r;const i=e.node(n);i.borderTop&&(i.minRank=(o=e.node(i.borderTop))===null||o===void 0?void 0:o.rank,i.maxRank=(r=e.node(i.borderBottom))===null||r===void 0?void 0:r.rank,t=Math.max(t,i.maxRank||-1/0))}),e.graph().maxRank=t},Rr=e=>{e.nodes().forEach(t=>{const n=e.node(t);n.dummy==="edge-proxy"&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})},Fr=e=>{let t,n=0,o,r=0;const i=e.graph(),a=i.marginx||0,s=i.marginy||0,d=l=>{if(!l)return;const c=l.x,u=l.y,f=l.width,h=l.height;!isNaN(c)&&!isNaN(f)&&(t===void 0&&(t=c-f/2),t=Math.min(t,c-f/2),n=Math.max(n,c+f/2)),!isNaN(u)&&!isNaN(h)&&(o===void 0&&(o=u-h/2),o=Math.min(o,u-h/2),r=Math.max(r,u+h/2))};e.nodes().forEach(l=>{d(e.node(l))}),e.edges().forEach(l=>{const c=e.edge(l);c!=null&&c.hasOwnProperty("x")&&d(c)}),t-=a,o-=s,e.nodes().forEach(l=>{const c=e.node(l);c&&(c.x-=t,c.y-=o)}),e.edges().forEach(l=>{var c;const u=e.edge(l);(c=u.points)===null||c===void 0||c.forEach(f=>{f.x-=t,f.y-=o}),u.hasOwnProperty("x")&&(u.x-=t),u.hasOwnProperty("y")&&(u.y-=o)}),i.width=n-t+a,i.height=r-o+s},jr=e=>{e.edges().forEach(t=>{const n=e.edge(t),o=e.node(t.v),r=e.node(t.w);let i,a;n.points?(i=n.points[0],a=n.points[n.points.length-1]):(n.points=[],i=r,a=o),n.points.unshift(Qe(o,i)),n.points.push(Qe(r,a))})},Vr=e=>{e.edges().forEach(t=>{const n=e.edge(t);if(n!=null&&n.hasOwnProperty("x"))switch((n.labelpos==="l"||n.labelpos==="r")&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset;break}})},Ar=e=>{e.edges().forEach(t=>{var n;const o=e.edge(t);o.reversed&&((n=o.points)===null||n===void 0||n.reverse())})},Br=e=>{e.nodes().forEach(t=>{var n,o,r;if(!((n=e.children(t))===null||n===void 0)&&n.length){const i=e.node(t),a=e.node(i.borderTop),s=e.node(i.borderBottom),d=e.node(i.borderLeft[((o=i.borderLeft)===null||o===void 0?void 0:o.length)-1]),l=e.node(i.borderRight[((r=i.borderRight)===null||r===void 0?void 0:r.length)-1]);i.width=Math.abs((l==null?void 0:l.x)-(d==null?void 0:d.x))||10,i.height=Math.abs((s==null?void 0:s.y)-(a==null?void 0:a.y))||10,i.x=((d==null?void 0:d.x)||0)+i.width/2,i.y=((a==null?void 0:a.y)||0)+i.height/2}}),e.nodes().forEach(t=>{var n;((n=e.node(t))===null||n===void 0?void 0:n.dummy)==="border"&&e.removeNode(t)})},Gr=e=>{e.edges().forEach(t=>{if(t.v===t.w){const n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdgeObj(t)}})},zr=e=>{const t=ue(e);t==null||t.forEach(n=>{let o=0;n==null||n.forEach((r,i)=>{var a;const s=e.node(r);s.order=i+o,(a=s.selfEdges)===null||a===void 0||a.forEach(d=>{ie(e,"selfedge",{width:d.label.width,height:d.label.height,rank:s.rank,order:i+ ++o,e:d.e,label:d.label},"_se")}),delete s.selfEdges})})},$r=e=>{e.nodes().forEach(t=>{const n=e.node(t);if(n.dummy==="selfedge"){const o=e.node(n.e.v),r=o.x+o.width/2,i=o.y,a=n.x-r,s=o.height/2;e.setEdgeObj(n.e,n.label),e.removeNode(t),n.label.points=[{x:r+2*a/3,y:i-s},{x:r+5*a/6,y:i-s},{y:i,x:r+a},{x:r+5*a/6,y:i+s},{x:r+2*a/3,y:i+s}],n.label.x=n.x,n.label.y=n.y}})},Ne=(e,t)=>{const n={};return t==null||t.forEach(o=>{e[o]!==void 0&&(n[o]=+e[o])}),n},Me=(e={})=>{const t={};return Object.keys(e).forEach(n=>{t[n.toLowerCase()]=e[n]}),t},Wr={layout:xr,util:{time:It,notime:Ot}};class Ur extends bn{constructor(t){super(),this.rankdir="TB",this.nodesep=50,this.ranksep=50,this.controlPoints=!1,this.sortByCombo=!1,this.edgeLabelSpace=!0,this.radial=!1,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.layoutNode=n=>{const o=this,{nodes:r}=o,i=r.find(a=>a.id===n);return i?i.layout!==!1:!0},this.updateCfg(t)}getDefaultCfg(){return{rankdir:"TB",align:void 0,nodeSize:void 0,nodesepFunc:void 0,ranksepFunc:void 0,nodesep:50,ranksep:50,controlPoints:!1,radial:!1,focusNode:null}}execute(){var t,n,o,r;const i=this,{nodes:a,nodeSize:s,rankdir:d,combos:l,begin:c,radial:u,comboEdges:f=[],vedges:h=[]}=i;if(!a)return;const p=i.edges||[],v=new ee({multigraph:!0,compound:!0});i.nodeMap={};const b={};a.forEach(m=>{i.nodeMap[m.id]=m,m.comboId&&(b[m.comboId]=b[m.comboId]||[],b[m.comboId].push(m.id))});let w=[];const N={};!((t=i.nodeOrder)===null||t===void 0)&&t.length?(i.nodeOrder.forEach(m=>{N[m]=!0,w.push(i.nodeMap[m])}),a.forEach(m=>{N[m.id]||w.push(m)})):w=a;let y;s?Ue(s)?y=()=>s:y=()=>[s,s]:y=m=>m.size?Ue(m.size)?m.size:wt(m.size)?[m.size.width||40,m.size.height||40]:[m.size,m.size]:[40,40];const E=qe(i.ranksep,50,i.ranksepFunc),P=qe(i.nodesep,50,i.nodesepFunc);let g=P,U=E;(d==="LR"||d==="RL")&&(g=E,U=P),v.setDefaultEdgeLabel(()=>({})),v.setGraph(i);const j={};this.sortByCombo&&l&&l.forEach(m=>{if(j[m.id]=m,m.collapsed){const C=y(m),R=U(m),L=g(m),V=C[0]+2*L,k=C[1]+2*R;v.setNode(m.id,{width:V,height:k})}m.parentId&&(j[m.parentId]||v.setNode(m.parentId,{}),v.setParent(m.id,m.parentId))}),w.filter(m=>m.layout!==!1).forEach(m=>{const C=y(m),R=U(m),L=g(m),V=C[0]+2*L,k=C[1]+2*R,M=m.layer;pe(M)?v.setNode(m.id,{width:V,height:k,layer:M}):v.setNode(m.id,{width:V,height:k}),this.sortByCombo&&m.comboId&&(j[m.comboId]||(j[m.comboId]={id:m.comboId},v.setNode(m.comboId,{})),v.setParent(m.id,m.comboId))}),p.forEach(m=>{const C=ne(m,"source"),R=ne(m,"target");this.layoutNode(C)&&this.layoutNode(R)&&v.setEdge(C,R,{weight:m.weight||1})}),(n=f==null?void 0:f.concat(h||[]))===null||n===void 0||n.forEach(m=>{var C,R;const{source:L,target:V}=m,k=!((C=j[L])===null||C===void 0)&&C.collapsed?[L]:b[L]||[L],M=!((R=j[V])===null||R===void 0)&&R.collapsed?[V]:b[V]||[V];k.forEach(I=>{M.forEach(O=>{v.setEdge(I,O,{weight:m.weight||1})})})});let D;!((o=i.preset)===null||o===void 0)&&o.nodes&&(D=new ee({multigraph:!0,compound:!0}),i.preset.nodes.forEach(m=>{D==null||D.setNode(m.id,m)})),Wr.layout(v,{prevGraph:D,edgeLabelSpace:i.edgeLabelSpace,keepNodeOrder:!!i.nodeOrder,nodeOrder:i.nodeOrder});const T=[0,0];if(c){let m=1/0,C=1/0;v.nodes().forEach(R=>{const L=v.node(R);m>L.x&&(m=L.x),C>L.y&&(C=L.y)}),v.edges().forEach(R=>{var L;(L=v.edge(R).points)===null||L===void 0||L.forEach(k=>{m>k.x&&(m=k.x),C>k.y&&(C=k.y)})}),T[0]=c[0]-m,T[1]=c[1]-C}const X=d==="LR"||d==="RL";if(u){const{focusNode:m,ranksep:C,getRadialPos:R}=this,L=wn(m)?m:m==null?void 0:m.id,V=L?(r=v.node(L))===null||r===void 0?void 0:r._rank:0,k=[],M=X?"y":"x",I=X?"height":"width";let O=1/0,B=-1/0;v.nodes().forEach(x=>{const _=v.node(x);if(!i.nodeMap[x])return;const G=P(i.nodeMap[x]);if(V===0)k[_._rank]||(k[_._rank]={nodes:[],totalWidth:0,maxSize:-1/0}),k[_._rank].nodes.push(x),k[_._rank].totalWidth+=G*2+_[I],k[_._rank].maxSize<Math.max(_.width,_.height)&&(k[_._rank].maxSize=Math.max(_.width,_.height));else{const S=_._rank-V;if(S===0)k[S]||(k[S]={nodes:[],totalWidth:0,maxSize:-1/0}),k[S].nodes.push(x),k[S].totalWidth+=G*2+_[I],k[S].maxSize<Math.max(_.width,_.height)&&(k[S].maxSize=Math.max(_.width,_.height));else{const F=Math.abs(S);k[F]||(k[F]={left:[],right:[],totalWidth:0,maxSize:-1/0}),k[F].totalWidth+=G*2+_[I],k[F].maxSize<Math.max(_.width,_.height)&&(k[F].maxSize=Math.max(_.width,_.height)),S<0?k[F].left.push(x):k[F].right.push(x)}}const Y=_[M]-_[I]/2-G,z=_[M]+_[I]/2+G;Y<O&&(O=Y),z>B&&(B=z)});let A=C||50;const $={},Q=(B-O)/.9,Ae=[(O+B-Q)*.5,(O+B+Q)*.5],ye=(x,_,G=-1/0,Y=[0,1])=>{let z=G;return x.forEach(S=>{const F=v.node(S);$[S]=_;const{x:H,y:W}=R(F[M],Ae,Q,_,Y);if(!i.nodeMap[S])return;i.nodeMap[S].x=H+T[0],i.nodeMap[S].y=W+T[1],i.nodeMap[S]._order=F._order;const q=E(i.nodeMap[S]);z<q&&(z=q)}),z};let be=!0;const zt=0;k.forEach(x=>{var _,G,Y,z,S,F,H;if(!(!((_=x==null?void 0:x.nodes)===null||_===void 0)&&_.length)&&!(!((G=x==null?void 0:x.left)===null||G===void 0)&&G.length)&&!(!((Y=x==null?void 0:x.right)===null||Y===void 0)&&Y.length))return;if(be&&x.nodes.length===1){const q=x.nodes[0];if(!i.nodeMap[q])return;i.nodeMap[q].x=T[0],i.nodeMap[q].y=T[1],$[x.nodes[0]]=0,A=E(i.nodeMap[q]),be=!1;return}A=Math.max(A,x.totalWidth/(2*Math.PI));let W=-1/0;if(V===0||!((z=x.nodes)===null||z===void 0)&&z.length)W=ye(x.nodes,A,W,[0,1]);else{const q=((S=x.left)===null||S===void 0?void 0:S.length)/(((F=x.left)===null||F===void 0?void 0:F.length)+((H=x.right)===null||H===void 0?void 0:H.length));W=ye(x.left,A,W,[0,q]),W=ye(x.right,A,W,[q+.05,1])}A+=W,be=!1,zt-x.maxSize}),v.edges().forEach(x=>{var _,G,Y;const z=v.edge(x),S=p.findIndex(F=>{const H=ne(F,"source"),W=ne(F,"target");return H===x.v&&W===x.w});if(!(S<=-1)&&i.edgeLabelSpace&&i.controlPoints&&p[S].type!=="loop"){const F=M==="x"?"y":"x",H=(_=z==null?void 0:z.points)===null||_===void 0?void 0:_.slice(1,z.points.length-1),W=[],q=(G=v.node(x.v))===null||G===void 0?void 0:G[F],$t=q-((Y=v.node(x.w))===null||Y===void 0?void 0:Y[F]),Be=$[x.v],Wt=Be-$[x.w];H==null||H.forEach(Ge=>{const Ut=(Ge[F]-q)/$t*Wt+Be,ze=R(Ge[M],Ae,Q,Ut);W.push({x:ze.x+T[0],y:ze.y+T[1]})}),p[S].controlPoints=W}})}else{const m=new Set,R=d==="BT"||d==="RL"?(M,I)=>I-M:(M,I)=>M-I;v.nodes().forEach(M=>{const I=v.node(M);if(!I)return;let O=this.nodeMap[M];O||(O=l==null?void 0:l.find(B=>B.id===M)),O&&(O.x=I.x+T[0],O.y=I.y+T[1],O._order=I._order,m.add(X?O.x:O.y))});const L=Array.from(m).sort(R),V=X?(M,I)=>M.x!==I.x:(M,I)=>M.y!==I.y,k=X?(M,I,O)=>{const B=Math.max(I.y,O.y),A=Math.min(I.y,O.y);return M.filter($=>$.y<=B&&$.y>=A)}:(M,I,O)=>{const B=Math.max(I.x,O.x),A=Math.min(I.x,O.x);return M.filter($=>$.x<=B&&$.x>=A)};v.edges().forEach(M=>{var I;const O=v.edge(M),B=p.findIndex(A=>{const $=ne(A,"source"),Q=ne(A,"target");return $===M.v&&Q===M.w});if(!(B<=-1)&&i.edgeLabelSpace&&i.controlPoints&&p[B].type!=="loop"){(I=O==null?void 0:O.points)===null||I===void 0||I.forEach(Q=>{Q.x+=T[0],Q.y+=T[1]});const A=i.nodeMap[M.v],$=i.nodeMap[M.w];p[B].controlPoints=qr(O==null?void 0:O.points,A,$,L,X,V,k)}})}return i.onLayoutEnd&&i.onLayoutEnd(),{nodes:a,edges:p}}getRadialPos(t,n,o,r,i=[0,1]){let a=(t-n[0])/o;a=a*(i[1]-i[0])+i[0];const s=a*2*Math.PI;return{x:Math.cos(s)*r,y:Math.sin(s)*r}}getType(){return"dagre"}}const qr=(e,t,n,o,r,i,a)=>{let s=(e==null?void 0:e.slice(1,e.length-1))||[];if(t&&n){let{x:d,y:l}=t,{x:c,y:u}=n;if(r&&(d=t.y,l=t.x,c=n.y,u=n.x),u!==l&&d!==c){const f=o.indexOf(l),h=o[f+1];if(h){const b=s[0],w=r?{x:(l+h)/2,y:(b==null?void 0:b.y)||c}:{x:(b==null?void 0:b.x)||c,y:(l+h)/2};(!b||i(b,w))&&s.unshift(w)}const p=o.indexOf(u),v=Math.abs(p-f);if(v===1)s=a(s,t,n),s.length||s.push(r?{x:(l+u)/2,y:d}:{x:d,y:(l+u)/2});else if(v>1){const b=o[p-1];if(b){const w=s[s.length-1],N=r?{x:(u+b)/2,y:(w==null?void 0:w.y)||c}:{x:(w==null?void 0:w.x)||d,y:(u+b)/2};(!w||i(w,N))&&s.push(N)}}}}return s};class At{constructor(){J(this,"lf");J(this,"option")}render(t){this.lf=t}getBytesLength(t){if(!t)return 0;let n=0;for(let o=0;o<t.length;o++){const r=t.charCodeAt(o);t.match(/[A-Z]/)?n+=1.5:r>=1&&r<=126||r>=65376&&r<=65439?n+=1:n+=2}return n}layout(t={}){const{nodes:n,edges:o,gridSize:r}=this.lf.graphModel;let i=40,a=40;r>20&&(i=r*2,a=r*2),this.option={type:"dagre",rankdir:"LR",align:"DR",nodesep:i,ranksep:a,begin:[120,120],...t};const d=new Ur(this.option).layout({nodes:n.map(c=>({id:c.id,size:{width:c.width,height:c.height},model:c})),edges:o.map(c=>({source:c.sourceNodeId,target:c.targetNodeId,model:c}))}),l={nodes:[],edges:[]};d.nodes.forEach(c=>{const{model:u}=c,f=u.getData();f.x=c.x,f.y=c.y,l.nodes.push(f)}),d.edges.forEach(c=>{const{model:u}=c,f=u.getData();if(f.pointsList=this.calcPointsList(u,l.nodes),f.pointsList){const h=f.pointsList[0],p=f.pointsList[f.pointsList.length-1];f.startPoint={x:h.x,y:h.y},f.endPoint={x:p.x,y:p.y},f.text&&f.text.value&&(f.text={x:p.x-this.getBytesLength(f.text.value)*6-10,y:p.y,value:f.text.value})}else f.startPoint=void 0,f.endPoint=void 0,f.text&&f.text.value&&(f.text=f.text.value);l.edges.push(f)}),this.lf.renderRawData(l)}pointFilter(t){const n=t;let o=1;for(;o<n.length-1;){const r=n[o-1],i=n[o],a=n[o+1];r.x===i.x&&i.x===a.x||r.y===i.y&&i.y===a.y?n.splice(o,1):o++}return n}calcPointsList(t,n){const o=[];if(this.option.rankdir==="LR"&&t.modelType==="polyline-edge"){const r=this.lf.getNodeModelById(t.sourceNodeId),i=this.lf.getNodeModelById(t.targetNodeId),a=n.find(d=>d.id===t.sourceNodeId),s=n.find(d=>d.id===t.targetNodeId);if(a.x<s.x)return o.push({x:a.x+r.width/2,y:a.y}),o.push({x:a.x+r.width/2+(t.offset||50),y:a.y}),o.push({x:a.x+r.width/2+(t.offset||50),y:s.y}),o.push({x:s.x-i.width/2,y:s.y}),this.pointFilter(o);if(a.x>s.x)return a.y>=s.y?(o.push({x:a.x,y:a.y+r.height/2}),o.push({x:a.x,y:a.y+r.height/2+(t.offset||50)}),o.push({x:s.x,y:a.y+r.height/2+(t.offset||50)}),o.push({x:s.x,y:s.y+i.height/2})):(o.push({x:a.x,y:a.y-r.height/2}),o.push({x:a.x,y:a.y-r.height/2-(t.offset||50)}),o.push({x:s.x,y:a.y-r.height/2-(t.offset||50)}),o.push({x:s.x,y:s.y-i.height/2})),this.pointFilter(o)}}}J(At,"pluginName","dagre");class Yr extends Xt{constructor({lf:t}){super({lf:t});const n={text:"复制",icon:!0,className:"lf-menu-copy",callback:y=>t.cloneNode(y.id)},o={text:"删除",icon:!0,className:"lf-menu-delete",callback:y=>{t.deleteNode(y.id),t.deleteEdge(y.id)}},r={text:"编辑文本",icon:!0,className:"lf-menu-edit",callback:y=>t.graphModel.editText(y.id)},i={text:"删除文本",icon:!0,className:"lf-menu-delete",callback:y=>t.updateText(y.id,"")},a={text:"框选",icon:!0,className:"lf-menu-select",callback(){t.openSelectionSelect(),t.once("selection:selected",t.closeSelectionSelect)}},s={text:"清空",icon:!0,className:"lf-menu-clear",callback(){t.clearData()}},d={text:"添加",icon:!0,className:"lf-menu-add",callback:y=>{console.log("🚀 ~ file: menu.ts:66 ~ Menu ~ constructor ~ ele:",y),["endEvent","serviceTask","note"].includes(y.type)?b(y,[l]):b(y,N.nodeMenu)}},l={text:"",icon:!0,className:"lf-menu-back",callback:y=>{b(y,w.nodeMenu)}},c={text:"用户任务",icon:!0,className:"lf-menu-user-task",callback:y=>{const{x:E,y:P}=y,g=t.addNode({type:"userTask",x:E+200,y:P});t.addEdge({sourceNodeId:y.id,targetNodeId:g.id})}},u={text:"服务任务",icon:!0,className:"lf-menu-service-task",callback:y=>{const{x:E,y:P}=y,g=t.addNode({type:"serviceTask",x:E+200,y:P});t.addEdge({type:"noteFlow",sourceNodeId:y.id,targetNodeId:g.id})}},f={text:"结束",icon:!0,className:"lf-menu-end-event",callback:y=>{const{x:E,y:P}=y,g=t.addNode({type:"endEvent",x:E+150,y:P});t.addEdge({sourceNodeId:y.id,targetNodeId:g.id})}},h={text:"互斥网关",icon:!0,className:"lf-menu-exclusive-gateway",callback:y=>{const{x:E,y:P}=y,g=t.addNode({type:"exclusiveGateway",x:E+150,y:P});t.addEdge({sourceNodeId:y.id,targetNodeId:g.id})}},p={text:"并行网关",icon:!0,className:"lf-menu-parallel-gateway",callback:y=>{const{x:E,y:P}=y,g=t.addNode({type:"parallelGateway",x:E+150,y:P});t.addEdge({sourceNodeId:y.id,targetNodeId:g.id})}},v={text:"注释",icon:!0,className:"lf-menu-note",callback:y=>{const{x:E,y:P}=y,g=t.addNode({type:"note",x:E,y:P-150});t.addEdge({type:"noteFlow",sourceNodeId:y.id,targetNodeId:g.id})}},b=(y,E)=>{setTimeout(()=>{this.__currentData=y;const{left:P,top:g}=this.__menuDOM.style;this.showMenu(P,g,E)})},w={nodeMenu:[d,n,o,r,i],edgeMenu:[o,r,i],graphMenu:[a,s]},N={nodeMenu:[l,c,u,h,p,f,v]};this.setMenuConfig(w)}}class Kr extends Ht{constructor({lf:t}){super({lf:t}),this.setPatternItems([{label:"框选",icon:"https://api.iconify.design/bpmn/lasso-tool.svg?width=24&height=24",callback(){t.openSelectionSelect(),t.once("selection:selected",t.closeSelectionSelect)}},{type:"group",label:"子流程",icon:"https://api.iconify.design/bpmn/subprocess-expanded.svg?width=24&height=24"},{type:"startEvent",text:"开始",label:"开始节点",icon:"https://api.iconify.design/bpmn/start-event.svg?width=24&height=24"},{type:"endEvent",text:"结束",label:"结束节点",icon:"https://api.iconify.design/bpmn/end-event.svg?width=24&height=24"},{type:"userTask",label:"用户任务",icon:"https://api.iconify.design/bpmn/user-task.svg?width=24&height=24"},{type:"serviceTask",label:"服务任务",icon:"https://api.iconify.design/bpmn/service-task.svg?width=24&height=24"},{type:"exclusiveGateway",label:"互斥网关",icon:"https://api.iconify.design/bpmn/gateway-xor.svg?width=24&height=24"},{type:"parallelGateway",label:"并行网关",icon:"https://api.iconify.design/bpmn/gateway-parallel.svg?width=24&height=24"},{type:"note",label:"注释",icon:"https://api.iconify.design/bpmn/text-annotation.svg?width=24&height=24"}])}}const Bt={type:"process",key:"Process",properties:{}};function Xr(e){const{id:t,type:n,x:o,y:r,properties:i,children:a,text:s}=e;return{incoming:[],outgoing:[],children:a,type:n,key:t,groupKey:i==null?void 0:i.groupKey,properties:{...i,name:De(s)?s:(s==null?void 0:s.value)??"",x:o,y:r,text:s}}}function Hr(e){const{id:t,type:n,sourceNodeId:o,targetNodeId:r,startPoint:i,endPoint:a,pointsList:s,properties:d,text:l}=e;return{incoming:[o],outgoing:[r],type:n,key:t,groupKey:d==null?void 0:d.groupKey,properties:{...d,name:De(l)?l:(l==null?void 0:l.value)??"",text:l,startPoint:i,endPoint:a,pointsList:s}}}function Jr(e){const{id:t,type:n,properties:o,text:r}=e;return{type:n,key:t,properties:{...o,name:De(r)?r:(r==null?void 0:r.value)??""}}}function Qr(e){const t=new Map,n={processData:Bt,flowElementList:[]};return e.nodes.forEach(o=>{var r;if(o.type==="process")n.processData=Jr(o);else{const i=Xr(o);(r=n.flowElementList)==null||r.push(i),t.set(o.id,i)}}),e.edges.forEach(o=>{var s;const r=Hr(o);t.get(o.sourceNodeId).outgoing.push(r.key),t.get(o.targetNodeId).incoming.push(r.key),(s=n.flowElementList)==null||s.push(r)}),n}function Zr(e){const{incoming:t,outgoing:n,properties:o,key:r,type:i}=e,{text:a,name:s,startPoint:d,endPoint:l,pointsList:c}=o??{},u={id:r,type:i,sourceNodeId:(t==null?void 0:t[0])??"",targetNodeId:(n==null?void 0:n[0])??"",text:a||s,startPoint:d,endPoint:l,pointsList:c,properties:{}},f=["startPoint","endPoint","pointsList","text"];return u.properties=Ce(o,f),u}function ei(e){const{properties:t,key:n,type:o,children:r}=e,{x:i,y:a,text:s,name:d}=t??{},l={id:n,type:o??"",x:i,y:a,text:s||d,children:r,properties:{}},c=["x","y","text"];return l.properties=Ce(t,c),l}function ti(e){const{properties:t,key:n,type:o}=e,{name:r}=t??{},i={id:n,type:o??"",text:r,x:0,y:0},a=["x","y","text"];return i.properties=Ce(t,a),i}function ni(e){const{flowElementList:t}=e,n=a=>["sequenceFlow","noteFlow"].includes(a),o=(t==null?void 0:t.filter(a=>!n(a.type)).map(ei))??[],r=(t==null?void 0:t.filter(a=>n(a.type)).map(Zr))??[];return o.unshift(ti(e.processData??Bt)),{nodes:o,edges:r}}class Ve{constructor({lf:t}){t.adapterIn=this.adapterIn,t.adapterOut=this.adapterOut}adapterOut(t){return Qr(t)}adapterIn(t){return ni(t)}}J(Ve,"pluginName","turboAdapter");class Gt{constructor({lf:t}){J(this,"lf");J(this,"container");J(this,"__tooltipDOM");J(this,"__currentData");J(this,"__tooltips",[]);this.__tooltipDOM=document.createElement("div"),this.__tooltipDOM.className="lf-tooltip",this.__tooltipDOM.style.position="absolute",this.__tooltipDOM.style.display="none",this.lf=t}render(t,n){this.container=n,n.appendChild(this.__tooltipDOM),t.on("node:mouseenter,edge:mouseenter",({data:o,e:r})=>{var l;const i=(l=this.__tooltips.find(c=>c.id===o.id))==null?void 0:l.content;if(!i)return;this.__tooltipDOM.innerHTML=i;const a=t.getPointByClient(r.x,r.y),{domOverlayPosition:{x:s,y:d}}=a;this.__tooltipDOM.style.top=`${d+10}px`,this.__tooltipDOM.style.left=`${s+10}px`,this.__tooltipDOM.style.display="block"}),t.on("node:mouseleave,edge:mouseleave",()=>{this.__tooltipDOM.style.display="none"})}setTooltips(t){this.__tooltips=t}}J(Gt,"pluginName","tooltip");const oi=an("span",null,"编辑JSON",-1),ri=Re({__name:"flow-editor",props:{modelValue:{},visible:{type:Boolean}},emits:["confirm"],setup(e,{emit:t}){const o=yt(e),{modelValue:r,visible:i}=o,a=on("");function s(){const d=JSON.parse(a.value);r.value=d,t("confirm",d),i.value=!1}return rn(()=>{a.value=JSON.stringify(r.value,null,2)}),(d,l)=>{const c=Z("el-input"),u=Z("el-button"),f=Z("el-drawer");return oe(),se(f,{modelValue:K(i),"onUpdate:modelValue":l[1]||(l[1]=h=>ae(i)?i.value=h:null)},{header:re(()=>[oi,Ie(d.$slots,"header")]),default:re(()=>[de(c,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=h=>a.value=h),class:"flow-editor__textarea",type:"textarea"},null,8,["modelValue"]),de(u,{class:"flow-editor__confirm-btn",type:"primary",onClick:s},{default:re(()=>[sn(" 确定 ")]),_:1})]),_:3},8,["modelValue"])}}}),hs=Re({__name:"index",props:{lf:{},initOptions:{},modelValue:{},elementData:{},formOptions:{},formData:{},formOption:{},formDefaults:{},formWidth:{},formOptionFormat:{type:Function},formDataFormat:{type:Function},dataOptions:{}},setup(e){const t=e,n=nn(t),{lf:o,graphData:r,formData:i,formOption:a,formDefaults:s,formLoading:d,editorVisible:l,onUpdateFormData:c}=n,u=vt("container");return mt(()=>{var f;o.value=new ft.LogicFlow({container:document.querySelector(`#${u}`),grid:{type:"dot",size:10},nodeTextDraggable:!0,edgeTextDraggable:!0,nodeTextEdit:!0,edgeTextEdit:!0,plugins:[yn,Kr,Jt,Yr,Qt,Zt,ht,pt,Ve,At],edgeGenerator:(h,p)=>{if(["note","serviceTask"].includes(p.type))return"noteFlow"},...t.initOptions}),(f=o.value)==null||f.setTheme(bt),hn(n),fe(r,h=>{var w,N,y;const p=JSON.stringify(h),v=JSON.stringify((w=o.value)==null?void 0:w.getGraphData());p!==v&&((N=o.value)==null||N.render(h),(y=o.value)==null||y.emit("element:click",{isForce:!0}))},{immediate:!0})}),(f,h)=>{const p=Z("el-main"),v=Z("el-empty"),b=Z("el-skeleton"),w=Z("avue-form"),N=Z("el-aside"),y=Z("el-container");return oe(),se(y,{class:"lf-container"},{default:re(()=>[de(p,{id:K(u),class:"lf-main"},null,8,["id"]),de(N,{width:f.formWidth,class:"lf-aside"},{default:re(()=>{var E,P;return[Ie(f.$slots,"form-top"),(P=(E=K(a))==null?void 0:E.group)!=null&&P.length?K(d)?(oe(),se(b,{key:1})):(oe(),se(w,{key:2,modelValue:K(i),"onUpdate:modelValue":[h[0]||(h[0]=g=>ae(i)?i.value=g:null),K(c)],defaults:K(s),"onUpdate:defaults":h[1]||(h[1]=g=>ae(s)?s.value=g:null),option:K(a)},null,8,["modelValue","defaults","option","onUpdate:modelValue"])):(oe(),se(v,{key:0,description:"选择元素以编辑数据"}))]}),_:3},8,["width"]),de(ri,{modelValue:K(r),"onUpdate:modelValue":h[2]||(h[2]=E=>ae(r)?r.value=E:null),visible:K(l),"onUpdate:visible":h[3]||(h[3]=E=>ae(l)?l.value=E:null),onConfirm:h[4]||(h[4]=E=>{var P;return(P=K(o))==null?void 0:P.render(E)})},dn({_:2},[f.$slots["editor-header"]?{name:"header",fn:re(()=>[Ie(f.$slots,"editor-header")]),key:"0"}:void 0]),1032,["modelValue","visible"])]),_:3})}}}),ii=["id"],ps=Re({__name:"index",props:{lf:{},initOptions:{},modelValue:{},styles:{},tooltips:{}},setup(e){const t=e,n=yt(t,void 0,{passive:!0}),{lf:o,modelValue:r}=n,i=vt("container");return mt(()=>{var a;o.value=new ft.LogicFlow({container:document.querySelector(`#${i}`),grid:{type:"dot",size:10},isSilentMode:!0,plugins:[ht,pt,Ve,Gt],...t.initOptions}),(a=o.value)==null||a.setTheme(bt),fe(r,s=>{var d;(d=o.value)==null||d.render(s)},{immediate:!0}),fe(()=>t.styles,s=>{s==null||s.forEach(({id:d,style:l})=>{var c,u;d&&((u=(c=o.value)==null?void 0:c.graphModel)==null||u.updateAttributes(d,{style:l}))})},{immediate:!0}),fe(()=>t.tooltips,s=>{var d,l;(l=(d=o.value)==null?void 0:d.extension.tooltip)==null||l.setTooltips(s??[])},{immediate:!0})}),(a,s)=>(oe(),ln("div",{id:K(i),class:"lf-container"},null,8,ii))}});export{ht as BpmnExtend,yn as Control,At as Dagre,ys as EndEventModel,bs as EndEventView,ws as ExclusiveGatewayModel,gs as ExclusiveGatewayView,hs as FlowModeler,ps as FlowViewer,pt as Group,xs as GroupModel,Es as GroupView,Yr as Menu,ks as NoteFlowModel,_s as NoteFlowView,Ns as NoteModel,Ms as NoteView,Kr as Panel,Is as ParallelGatewayModel,Os as ParallelGatewayView,Ps as ProcessModel,Ls as ProcessView,Ss as SequenceFlowModel,Ts as SequenceFlowView,Cs as ServiceTaskModel,Ds as ServiceTaskView,Rs as StartEventModel,Fs as StartEventView,Gt as Tooltip,Ve as TurboAdapter,js as UserTaskModel,Vs as UserTaskView,zs as assigneeColumn,$s as baseColumn,Ws as buttonColumn,Us as circulateColumn,Bs as defaultGraphData,tn as defaultGroup,qs as defaultOptions,bt as defaultTheme,ls as executionListenerColumn,Ys as formPropertyColumn,Ks as gatewayColumn,Xs as multiInstanceColumn,Hs as noteColumn,Js as processColumn,Qs as propertyColumn,Zs as sequenceFlowColumn,ea as serialColumn,ta as serviceTaskColumn,cs as taskListenerColumn,us as timeLimitColumn,ni as toLogicflowData,Qr as toTurboData,na as userTaskColumn};
