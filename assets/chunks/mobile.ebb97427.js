import{j as Re}from"./index.288677a1.js";import{I as Ce}from"./iconify.b68073ff.js";import{a as re,e as Ee,f as Me,w as Ie,g as Ge}from"./index.cd412afd.js";import{_ as Je,d as Qe}from"./index.b00b9483.js";import"./index.c7dc2ef3.js";import{d as We}from"./data.4cb21f02.js";import{j as He}from"./tree.21d3b17d.js";import"./index.3d38e212.js";import"./vuedraggable.umd.00d46a83.js";import{u as te,m as Ye}from"./index.es.e5378d01.js";import{e as J,u as Xe}from"./index.ac4ff024.js";import{ab as Ue,g as A,h as j,A as ue,l as y,E as me,$ as Ze,S as qe,Y as Fe,d as Q,J as U,c as R,L as ee,K as Y,o as V,b as O,w as C,N as L,a as M,t as G,B as oe,a3 as ge,k as q,R as se,_ as fe,z as et,C as tt,e as E,U as at,O as xe,a5 as lt,D as ot,a9 as st,aa as nt}from"./framework.f01dabf7.js";import{p as rt}from"./pick.2b716c9d.js";import{t as ut,b as ke,f as it}from"./index.fc3eb3b1.js";import{E as le}from"./index.22b43a78.js";import{u as $e}from"./index.386fc70b.js";import{d as ct}from"./differenceBy.d5bb1ce8.js";import{g as ae}from"./get.c8715fa2.js";function X(e){const{tableOption:t}=W();return Ue({...t,...e})}function pt(e){const{buttonHandler:t,request:l}=W(),{commitTask:_,revokeTask:r,saveDraft:w,startTask:o,terminateTask:f,transferTask:u,withdrawTask:i,rejectTask:k,greenChannel:v}=_e(l),a=A(()=>{const{flowDetail:h,formVariables:D,approvalFormData:n,debug:s,fileIds:d}=e,{flowDeployId:c}=h.value.process??{},{taskId:p,flowInstanceId:m}=h.value.task??{};return{flowDeployId:c,taskId:p,flowInstanceId:m,variables:D.value,debug:s.value,fileIds:d==null?void 0:d.value,...n.value}}),b=()=>a.value.taskId&&a.value.flowInstanceId;return{flow_draft(){if(b())return w(a.value)},flow_pass(){return b()?_(a.value):o(a.value)},flow_revoke(){if(b())return r(a.value)},flow_withdraw(){if(b())return i(a.value)},flow_terminate(){if(b())return f(a.value)},flow_transfer(){if(b())return u(a.value)},flow_reject(){if(b())return k(a.value)},flow_green(){if(b())return v(a.value)},...t==null?void 0:t(e)}}function dt(e){const t=j({});return ue(async()=>{var _;const{formProperty:l}=((_=y(e))==null?void 0:_.properties)||{};l!=null&&l.length&&(await me(),Object.keys(t.value).forEach(r=>{var f,u,i,k;const w=((f=t.value[r])==null?void 0:f.label)||"",o=l==null?void 0:l.find(v=>v.prop===r);if(t.value[r].display=o==null?void 0:o.display,t.value[r].disabled=o==null?void 0:o.disabled,t.value[r].detail=o==null?void 0:o.detail,t.value[r].readonly=o==null?void 0:o.readonly,t.value[r].rules=t.value[r].rules??[],o!=null&&o.required&&((u=t.value[r].rules)!=null&&u.some(v=>v.required)))return null;o!=null&&o.required?(i=t.value[r].rules)==null||i.push({required:!0,message:`${w}为必填项`}):t.value[r].rules=(k=t.value[r].rules)==null?void 0:k.filter(v=>!v.required)}))}),t}const mt={modelValue:{type:Object,default:()=>({})},title:{type:String},flowDetail:{type:Object,default:()=>({})},formLoading:{type:Boolean},submitLoading:{type:Boolean},activeTab:{type:String,default:"formTab"},activeBtn:{type:Object,default:()=>({})},approvalVisible:{type:Boolean},approvalFormData:{type:Object,default:()=>({})},flowKey:{type:String},taskId:{type:String},instanceId:{type:String},formId:{type:String},fileIds:{type:String},permission:{type:Object},afterGetDetail:{type:Function},beforeClick:{type:Function},beforeSubmit:{type:Function},afterSubmit:{type:Function},detail:{type:[Boolean,String],default:!1},debug:{type:[Boolean,String],default:!1}},ft={complete:e=>e},Le=Symbol("flowFormState");function vt(e,t){const l=re(e,void 0,{passive:!0,deep:!0}),{flowDetail:_,modelValue:r,formLoading:w,activeTab:o,afterGetDetail:f}=l,{tabs:u,customForm:i,request:k}=W(),v=j({}),a=A(()=>{const d=typeof u=="function"?u(_.value):u;return(d==null?void 0:d.filter(c=>{var m,N,I;const p=(I=(N=(m=_.value)==null?void 0:m.properties)==null?void 0:N.formProperty)==null?void 0:I.find(T=>T.prop===c.prop);return(p==null?void 0:p.display)!==!1}).map(c=>{var m,N;let p=c.component;if(c.prop==="formTab"){const I=i==null?void 0:i[((N=(m=_==null?void 0:_.value)==null?void 0:m.process)==null?void 0:N.formPath)??""];typeof I=="function"?p=Fe(I):I&&(p=I)}return{...c,component:p}}))??[]}),b=j();H()&&Ee(b,{onSwipeEnd(d,c){if(!["left","right"].includes(c))return;const p=a.value.findIndex(N=>N.prop===o.value),m=Me(p+(c==="right"?-1:1),0,a.value.length-1);o.value=a.value[m].prop}});const{getFlowDetail:h}=_e(k);ue(()=>{const{flowKey:d,taskId:c,instanceId:p}=e;!d&&!c&&!p||(w.value=!0,h({flowKey:d,taskId:c,flowInstanceId:p}).then(async m=>{var N;_.value=m.data,r.value=m.data.formData||{},await((N=f==null?void 0:f.value)==null?void 0:N.call(f))}).finally(()=>{w.value=!1}))});const D=A(()=>Object.entries(r.value||{}).filter(([d])=>!d.startsWith("$")).map(([d,c])=>({key:d,value:c}))),n=A(()=>e.detail===!0||e.detail==="true"),s={...l,formData:r,formVariables:D,tabRefs:v,tabList:a,detail:n,tabsRef:b,emit:t};return Ze(Le,s),s}function F(){return qe(Le)}const he=Q({__name:"button-list",emits:["click"],setup(e,{emit:t}){const{userInfo:l,request:_}=W(),{flowDetail:r}=F(),{data:w}=Ke(_).useList();function o(u,i){return u.map(k=>{const v=i.find(b=>b.buttonKey===k.buttonKey);return{...k,...rt(v,["display","approval"])}})}const f=A(()=>{var s,d,c,p;const u=typeof l=="function"?l():l,{assignee:i,status:k}=((s=r.value)==null?void 0:s.task)||{},{createUser:v,flowInstanceId:a,status:b}=((d=r.value)==null?void 0:d.flowInstance)||{},h={true:!0,false:!1,startUser:v==(u==null?void 0:u.userId),assignee:i==(u==null?void 0:u.userId),todo:k==ne.待办,done:k==ne.已办,notstarted:!a,started:!!a,finished:b===pe.已办结,unfinished:b===pe.未办结},{button:D}=((c=r.value)==null?void 0:c.properties)||{};return((p=o(w.value??[],D??[]))==null?void 0:p.filter(m=>{var N,I;return(I=(N=m.display)==null?void 0:N.split(","))==null?void 0:I.every(T=>h[T])}))??[]});return(u,i)=>{const k=U("el-button");return V(!0),R(Y,null,ee(f.value,v=>(V(),O(k,{key:v.buttonKey,type:v.buttonType,onClick:a=>t("click",v)},{default:C(()=>[L(y(Ce),{icon:v.icon},null,8,["icon"]),M(" "+G(v.name),1)]),_:2},1032,["type","onClick"]))),128)}}}),bt=Q({__name:"common-comments",props:{modelValue:{}},setup(e){const t=e,{modelValue:l}=re(t),{request:_}=W(),{batchUpdate:r,create:w,remove:o,useList:f}=Kt(_),u=j(!1),{activeBtn:i}=F(),k=A(()=>{var p;return(p=i.value)==null?void 0:p.buttonKey}),{data:v,refresh:a}=f(k),b=A(()=>{var m,N,I;const p=l.value;if(p&&!((m=v.value)!=null&&m.some(T=>T.content===p))){const T=(((I=(N=v.value)==null?void 0:N[0])==null?void 0:I.sort)||1)-1;return[{content:p,sort:T},...v.value||[]]}return v.value});async function h(p){var m;await w({...p,type:(m=i.value)==null?void 0:m.buttonKey}),le.success("添加成功"),a()}async function D(p){await o(p.id),le.success("删除成功"),a()}async function n(p,m){let N=m.parent.data;N=N.map((I,T)=>({id:I.id,sort:T+1})),await r(N),le.success("修改排序成功"),a(),u.value=!1}function s(){u.value=!0}const d=j();async function c(p){var m;l.value=p.content??"",await me(),(m=d.value)==null||m.blur()}return(p,m)=>{const N=U("el-input"),I=U("el-text"),T=U("el-col"),z=U("el-button"),S=U("el-row"),g=U("el-tree"),$=U("el-popover");return V(),O($,{visible:u.value,placement:"bottom",title:"常用意见",width:y(H)()?"98%":"600px"},{reference:C(()=>[L(N,{ref_key:"inputRef",ref:d,modelValue:y(l),"onUpdate:modelValue":m[0]||(m[0]=K=>oe(l)?l.value=K:null),type:"textarea",placeholder:"请输入意见",rows:"5",onFocus:m[1]||(m[1]=K=>u.value=!0),onBlur:m[2]||(m[2]=K=>u.value=!1)},null,8,["modelValue"])]),default:C(()=>[L(g,{data:b.value,"node-key":"content",draggable:"","allow-drop":(K,P,x)=>x!=="inner",props:{label:"content"},onNodeClick:c,onNodeDrop:n,onNodeDragStart:s},{default:C(({data:K})=>[L(S,{style:{width:"100%"}},{default:C(()=>[L(T,{span:22},{default:C(()=>[L(I,{truncated:"",title:K.content},{default:C(()=>[M(G(K.content),1)]),_:2},1032,["title"])]),_:2},1024),L(T,{span:2},{default:C(()=>[K.id?(V(),O(z,{key:0,type:"danger",size:"small",icon:"el-icon-close",text:"",onClick:ge(P=>D(K),["stop"])},null,8,["onClick"])):(V(),O(z,{key:1,type:"primary",size:"small",icon:"el-icon-plus",text:"",onClick:ge(P=>h(K),["stop"])},null,8,["onClick"]))]),_:2},1024)]),_:2},1024)]),_:1},8,["data","allow-drop"])]),_:1},8,["visible","width"])}}}),_t=Q({__name:"approval-tree",props:{modelValue:{},data:{},autoCheck:{type:Boolean},mode:{}},setup(e){const t=e,{modelValue:l}=re(t),_={element:"ep:flag",post:"ep:share",dept:"ep:share",user:"ep:user"},w={defaultExpandAll:!0,lazy:!0,showCheckbox:!0,nodeKey:"id",load:(a,b)=>{a.level===0?b(f.value):b(a.data.children??[])},onCheck:i,props:{label:"title",class(a){return`node-${a.type}`}}},o=j(),f=A(()=>ut(t.data??[],(a,b,h)=>{const D=$e();return a.taskNodeKey=(h==null?void 0:h.taskNodeKey)??a.taskNodeKey,a.incoming=(h==null?void 0:h.incoming)??a.incoming,a.multiple=(h==null?void 0:h.multiple)??a.multiple,a.parentId=(h==null?void 0:h.id)??a.parentId,{...a,id:D}}));Ie(()=>[f.value,o.value],async()=>{if(!(!o.value||!f.value.length)&&t.autoCheck){const a=u(f.value);a&&v([a])}},{immediate:!0,debounce:100});function u(a){var b;if(a.length===1)return(b=a[0].children)!=null&&b.length?u(a[0].children):a[0]}async function i(a,{checkedNodes:b}){var n;let h=b.filter(s=>s.type==="user");const D=h.some(s=>s.id===a.id);if(f.value.every(s=>!s.multiple)&&D)h=[a];else if(!a.multiple&&D){const c=((n=o.value)==null?void 0:n.getNode(a)).parent.data.children.filter(p=>p.id!==a.id);h=ct(h,c,"id")}v(h)}function k(a){const b=l.value.filter(h=>h.id!==a.id);v(b)}function v(a){var b;l.value=a,(b=o.value)==null||b.setCheckedNodes(a)}return(a,b)=>{const h=U("el-tag"),D=U("Icon"),n=U("el-tree");return V(),R(Y,null,[(V(!0),R(Y,null,ee(y(l),s=>(V(),O(h,{key:s.id,type:"info",closable:"",onClose:d=>k(s)},{default:C(()=>[M(G(s.title),1)]),_:2},1032,["onClose"]))),128)),L(n,se({ref_key:"treeRef",ref:o,class:["approval-tree",`mode-${a.mode}`],data:f.value},w),{default:C(({data:s})=>[q("div",null,[L(D,{icon:_[s.type]||_.element,style:{display:"inline-block"}},null,8,["icon"]),q("span",null,G(s.title),1)])]),_:1},16,["class","data"])],64)}}});const Ne=fe(_t,[["__scopeId","data-v-9646bed9"]]),yt={key:0},Ve=Q({__name:"assignee-setter",props:{modelValue:{},tableData:{},placeholder:{}},emits:["update:modelValue"],setup(e,{emit:t}){const l=e,_=A({get(){return typeof l.modelValue=="string"?l.modelValue?l.modelValue.split(","):[]:l.modelValue},set(D){var n;t("update:modelValue",D.join(",")),(n=l.tableData)!=null&&n.row&&(l.tableData.row.values=ke(f.value,s=>D==null?void 0:D.includes(s.id)),l.tableData.row.idVal=l.tableData.row.values.map(s=>s[`${o.value}Id`]).join(","))}}),r=A({get(){return Array.isArray(l.modelValue)?l.modelValue.join(","):l.modelValue},set(D){t("update:modelValue",D)}}),w=j(!1),o=A(()=>{var D,n;return(n=(D=l.tableData)==null?void 0:D.row)==null?void 0:n.type}),f=j([]),u=j([]),{request:i}=W(),{getUserTree:k}=zt(i),{getParam:v}=ie(i);et(o,async D=>{try{if(w.value=!0,["dept","post","user"].includes(D)){const n=await k(D==="user"?"":D);f.value=n.data}else if(o.value==="dynamic"){const n=await v("flow.trends.user");u.value=n.data}}finally{w.value=!1}},{immediate:!0});function a(){_.value=ke(f.value,D=>D.type===o.value).map(D=>D.id)}const b=A(()=>({checkStrictly:o.value!=="user",clearable:!0,collapseTags:!0,collapseTagsTooltip:!0,data:f.value,filterable:!0,loading:w.value,maxCollapseTags:3,multiple:!0,nodeKey:"id",props:{label:"title"},placeholder:"请选择",showCheckbox:!0})),h=A(()=>({clearable:!0,data:u.value,filterable:!0,loading:w.value,nodeKey:"value",props:{label:"title"},placeholder:"请选择"}));return(D,n)=>{const s=U("el-tree-select"),d=U("el-button"),c=U("el-input");return["dept","post","user"].includes(o.value)?(V(),R("div",yt,[L(s,se({modelValue:_.value,"onUpdate:modelValue":n[0]||(n[0]=p=>_.value=p)},b.value,{style:{width:"75%"}}),null,16,["modelValue"]),L(d,{text:"",type:"primary",icon:"el-icon-check",style:{width:"20%"},onClick:a},{default:C(()=>[M(" 全选 ")]),_:1})])):o.value==="dynamic"?(V(),O(s,se({key:1,modelValue:r.value,"onUpdate:modelValue":n[1]||(n[1]=p=>r.value=p)},h.value,{style:{width:"100%"}}),null,16,["modelValue"])):o.value==="userTask"?(V(),O(y(Je),{key:2,modelValue:r.value,"onUpdate:modelValue":n[2]||(n[2]=p=>r.value=p),"filter-type":"userTask",placeholder:"请选择"},null,8,["modelValue"])):(V(),O(c,{key:3,modelValue:r.value,"onUpdate:modelValue":n[3]||(n[3]=p=>r.value=p),clearable:"",placeholder:"请输入"},null,8,["modelValue"]))}}}),wt={key:0,class:"flow-viewer"},gt={key:0,class:"flow-status-legend"},kt={class:"legend-text"},ht=Q({__name:"index",props:{modelValue:{},view:{type:Boolean},flowFormOption:{},flowHistory:{},showLegend:{type:Boolean}},emits:["update:modelValue","nodeClick"],setup(e,{emit:t}){const l=e,_=tt();Ge(_,()=>{var s;(s=_.value)==null||s.on("node:click",d=>t("nodeClick",d))});const r=A({get(){let s=We();return typeof l.modelValue=="string"&&l.modelValue?s=JSON.parse(l.modelValue):typeof l.modelValue=="object"&&Object.keys(l.modelValue)&&(s=l.modelValue),s},set(s){t("update:modelValue",JSON.stringify(s))}}),w=A(()=>{const{column:s=[],group:d=[]}=JSON.parse(l.flowFormOption||"{}");return[...s,...d.map(p=>p.column??[]).flat()]}),{FlowDesign:o,tabs:f,request:u}=W(),{data:i}=Ke(u).useList(),k=A(()=>(f==null?void 0:f.map(s=>({...s,display:!0})))??[]),v=A(()=>{var s;return{formPropertyList:[...w.value,...k.value],buttonList:(s=i.value)==null?void 0:s.filter(d=>d.status===1),fieldsDic:w.value.map(d=>({label:d.label,value:`\${${d.prop}}`,desc:`\${${d.prop}}`})),flowButtonDisplayDic:J(ve),flowButtonApprovalDic:J(be)}}),a=j({}),b=j({});Ie(b,s=>{var d,c,p,m,N,I;s&&((p=(c=(d=s.assignee)==null?void 0:d.children)==null?void 0:c.column)!=null&&p[1]&&(s.assignee.children.column[1].component=Ve),(I=(N=(m=s.circulate)==null?void 0:m.children)==null?void 0:N.column)!=null&&I[1]&&(s.circulate.children.column[1].component=Ve))},{debounce:1});const{data:h}=ie(u).useParam("flow.task.status"),D=A(()=>{var s;return(s=l.flowHistory)==null?void 0:s.map(d=>{var p,m;const c=(m=(p=h.value)==null?void 0:p.find(N=>N.value===d.status))==null?void 0:m.style;return{id:d.taskNodeKey,style:c}})}),n=A(()=>{var s,d;return(d=(s=l.flowHistory)==null?void 0:s.filter(c=>c.taskNodeType==="userTask"))==null?void 0:d.map(c=>{var p;return{id:c.taskNodeKey,content:`<div>${c.assigneeName}</div>
        <div>${c.endTime??""}</div>
        <div>${((p=c.comment)==null?void 0:p.handleComment)??""}</div>`}})});return(s,d)=>s.view?(V(),R("div",wt,[s.showLegend!==!1?(V(),R("div",gt,[(V(!0),R(Y,null,ee(y(h),c=>{var p;return V(),R("div",{key:c.label,class:"legend-item"},[q("div",{class:"legend-color",style:at({backgroundColor:(p=c.style)==null?void 0:p.fill})},null,4),q("span",kt,G(c.label),1)])}),128))])):E("",!0),L(y(o),{lf:_.value,"onUpdate:lf":d[0]||(d[0]=c=>_.value=c),"model-value":r.value,styles:D.value,tooltips:n.value,type:"viewer"},null,8,["lf","model-value","styles","tooltips"])])):(V(),O(y(o),{key:1,modelValue:r.value,"onUpdate:modelValue":d[1]||(d[1]=c=>r.value=c),formData:a.value,"onUpdate:formData":d[2]||(d[2]=c=>a.value=c),formDefaults:b.value,"onUpdate:formDefaults":d[3]||(d[3]=c=>b.value=c),"form-options":y(Qe),"data-options":v.value,"form-width":"30%"},null,8,["modelValue","formData","formDefaults","form-options","data-options"]))}});const Te=fe(ht,[["__scopeId","data-v-79c19aa8"]]),Nt=Q({__name:"node-select",props:{modelValue:{}},setup(e){const t=e,{modelValue:l}=re(t),{flowDetail:_}=F(),r=j(!1);function w({data:o}){o.type==="userTask"&&(r.value=!1,l.value=o.id)}return(o,f)=>{const u=U("el-button"),i=U("el-popover");return V(),O(i,{visible:r.value,"onUpdate:visible":f[0]||(f[0]=k=>r.value=k),placement:"bottom-start",width:"800px",trigger:"click"},{reference:C(()=>[L(u,null,{default:C(()=>[M(" 点击选择节点 ")]),_:1})]),default:C(()=>{var k,v;return[L(Te,{"model-value":(v=(k=y(_))==null?void 0:k.process)==null?void 0:v.flowData,view:"",style:{height:"600px"},onNodeClick:w},null,8,["model-value"])]}),_:1},8,["visible"])}}}),Vt=Q({__name:"approval-form",emits:["submit"],setup(e,{emit:t}){const{request:l}=W(),{getApprovalNode:_}=_e(l),{useParam:r}=ie(l),{formData:w,approvalFormData:o,activeBtn:f,approvalVisible:u,formVariables:i,flowDetail:k}=F(),v=j([]),a=j([]),b=j([]),h=j([]),D=j(!1),n=j(!1),s=j(),d=A(()=>{const S=v.value.length,g=b.value.length&&!v.value.length;return{menuBtn:!1,labelWidth:"auto",span:24,column:[{label:"指定节点",prop:"jumpTaskNodeKey",display:c("specifyNode"),rules:[{required:!0,message:"请选择指定节点"}]},{label:"审批人",prop:"assignee",display:c("assignee"),rules:S?[{required:!0,validator:p}]:[]},{label:"传阅人",prop:"circulate",display:c("circulate"),rules:g?[{required:!0,message:"请选择传阅人"}]:[]},{label:"意见",prop:"comment",display:c("comment"),rules:[{required:!0,message:"请填写意见"}]}]}});function c(S){var g,$;return($=(g=f.value)==null?void 0:g.approval)==null?void 0:$.includes(S)}function p(S,g,$){var x,Z,B;const K=((x=v.value[0])==null?void 0:x.type)==="parallelGateway",P=(B=(Z=v.value[0])==null?void 0:Z.children)==null?void 0:B.every(ce=>it([ce],ze=>a.value.some(Be=>Be.id===ze.id)));if(a.value.length){if(K&&!P)return $("请在每个节点选择审批人")}else return $("请选择审批人");return!0}const{data:m}=r("flow.approval.autocheck"),{data:N}=r("flow.approval.autocomment");ue(async()=>{var $,K;if(!u.value||!s.value)return;me(()=>{s.value.resetFields(),o.value.comment=w.value.comment||N.value==="true"&&f.value.name||""});const{taskId:S}=(($=k.value)==null?void 0:$.task)||{},{flowKey:g}=((K=k.value)==null?void 0:K.process)||{};if(I(),!!c("assignee")&&!(c("specifyNode")&&!o.value.jumpTaskNodeKey))try{n.value=!0;const P=await _({flowKey:g,taskId:S,variables:i.value,buttonType:f.value.buttonKey,jumpTaskNodeKey:o.value.jumpTaskNodeKey});v.value=P.data.approvalNodeList,b.value=P.data.circulateNodeList}finally{n.value=!1}});function I(){v.value=[],a.value=[],b.value=[],h.value=[]}async function T(){await Ae(s),D.value=!0;const{data:S,outgoing:g}=z(a.value),{data:$}=z(h.value);o.value.assignee=S,o.value.circulate=$,o.value.outgoing=[...g],t("submit")}function z(S){const g={},$={},K=new Set;return S.forEach(P=>{const{taskNodeKey:x,incoming:Z}=P;g[x]||(g[x]=new Set),P.userId&&g[x].add(P.userId),$[x]=[...g[x]].join(","),Z&&K.add(Z)}),{dataSet:g,data:$,outgoing:K}}return(S,g)=>{const $=U("el-skeleton"),K=U("avue-form"),P=U("el-button");return V(),O(xe(y(H)()?"el-drawer":"el-dialog"),{modelValue:y(u),"onUpdate:modelValue":g[6]||(g[6]=x=>oe(u)?u.value=x:null),class:"approval-form-overlay",title:y(f).name,"append-to-body":"",width:"900px",size:"50%",direction:"btt"},{footer:C(()=>[L(P,{onClick:g[5]||(g[5]=x=>u.value=!1)},{default:C(()=>[M(" 取 消 ")]),_:1}),L(P,{type:"primary",onClick:T},{default:C(()=>[M(" 确 定 ")]),_:1})]),default:C(()=>[L(K,{ref_key:"formRef",ref:s,modelValue:y(o),"onUpdate:modelValue":g[4]||(g[4]=x=>oe(o)?o.value=x:null),class:"approval-form",option:d.value},{jumpTaskNodeKey:C(()=>[L(Nt,{modelValue:y(o).jumpTaskNodeKey,"onUpdate:modelValue":g[0]||(g[0]=x=>y(o).jumpTaskNodeKey=x)},null,8,["modelValue"])]),assignee:C(()=>[n.value?(V(),O($,{key:0})):(V(),O(Ne,{key:"AssigneeTree",modelValue:a.value,"onUpdate:modelValue":g[1]||(g[1]=x=>a.value=x),data:v.value,"auto-check":y(m)==="true",mode:y(H)()?"vertical":"horizontal"},null,8,["modelValue","data","auto-check","mode"]))]),circulate:C(()=>[n.value?(V(),O($,{key:0})):(V(),O(Ne,{key:"CirculateTree",modelValue:h.value,"onUpdate:modelValue":g[2]||(g[2]=x=>h.value=x),data:b.value,mode:y(H)()?"vertical":"horizontal"},null,8,["modelValue","data","mode"]))]),comment:C(()=>[L(bt,{modelValue:y(o).comment,"onUpdate:modelValue":g[3]||(g[3]=x=>y(o).comment=x)},null,8,["modelValue"])]),_:1},8,["modelValue","option"])]),_:1},8,["modelValue","title"])}}});const Dt={class:"flow-form__title"},Ct=Q({__name:"index",props:mt,emits:ft,setup(e,{emit:t}){const _=vt(e,t),{ApprovalForm:r,tabsProps:w}=W(),o=r??Vt,{title:f,detail:u,flowDetail:i,tabRefs:k,tabList:v,activeTab:a,activeBtn:b,formLoading:h,approvalVisible:D,submitLoading:n,beforeClick:s,beforeSubmit:d,afterSubmit:c,tabsRef:p}=_;async function m(T){var z,S;b.value=T;for(const g of Object.values(k.value))await((z=g==null?void 0:g.validate)==null?void 0:z.call(g));await((S=s==null?void 0:s.value)==null?void 0:S.call(s,T)),(T==null?void 0:T.approval)!=="false"?D.value=!0:I()}const N=pt(_);async function I(){var T,z;try{const{buttonKey:S}=b.value;n.value=!0,await((T=d==null?void 0:d.value)==null?void 0:T.call(d,b.value));const g=N[S];g?(await(g==null?void 0:g()),await((z=c==null?void 0:c.value)==null?void 0:z.call(c,b.value)),D.value=!1,t("complete",b.value)):le.error("无法找到相应的操作")}finally{n.value=!1}}return(T,z)=>{const S=U("el-skeleton"),g=U("el-main"),$=U("el-header"),K=U("el-tab-pane"),P=U("el-tabs"),x=U("el-footer"),Z=U("el-container");return y(h)?(V(),O(g,{key:0},{default:C(()=>[L(S)]),_:1})):(V(),O(Z,{key:1,class:"flow-form"},{default:C(()=>[L($,{class:"flow-form__header",height:"auto"},{default:C(()=>{var B;return[q("div",Dt,G(y(f)??((B=y(i).flowInstance)==null?void 0:B.title)),1),!y(u)&&!y(H)()?(V(),O(he,{key:0,onClick:m})):E("",!0)]}),_:1}),L(g,{class:"flow-form__main"},{default:C(()=>[L(P,se({ref_key:"tabsRef",ref:p,modelValue:y(a),"onUpdate:modelValue":z[0]||(z[0]=B=>oe(a)?a.value=B:null)},y(w)),{default:C(()=>[(V(!0),R(Y,null,ee(y(v),B=>(V(),O(K,{key:B.prop,label:B.label,name:B.prop,lazy:B.lazy,disabled:B.disabled,closable:B.closable},{default:C(()=>[(V(),O(xe(B.component),{ref_for:!0,ref:ce=>y(k)[B.prop]=ce},null,512))]),_:2},1032,["label","name","lazy","disabled","closable"]))),128))]),_:1},16,["modelValue"])]),_:1}),!y(u)&&y(H)()?(V(),O(x,{key:0,class:"flow-form__footer",height:"auto"},{default:C(()=>[L(he,{onClick:m})]),_:1})):E("",!0),L(y(o),{onSubmit:I})]),_:1}))}}});const It=Q({setup(){const{flowDetail:e,formData:t,detail:l}=F(),_=dt(e.value),{proxy:r}=ot(),w=j({});ue(()=>{const{formOption:u}=e.value.process??{};w.value=He.bind(r)(u||'{"menuBtn":false}'),w.value.detail=!!l.value});const o=j();function f(){return Ae(o)}return{form:t,option:w,defaults:_,formRef:o,validate:f}},render(){return lt(U("avue-form"),{ref:"formRef",modelValue:this.form,defaults:this.defaults,option:this.option,class:this.option.class,"onUpdate:modelValue":e=>this.form=e,"onUpdate:defaults":e=>this.defaults=e})}}),Ut=Q({__name:"upload-table",setup(e){const{flowDetail:t,fileIds:l,detail:_}=F(),{upload:{action:r,headers:w,preview:o,download:f,props:u}={},request:i}=W(),k=typeof w=="function"?w():w,v=A(()=>{var N,I;return((I=(N=t.value)==null?void 0:N.task)==null?void 0:I.flowInstanceId)??$e()}),a=[{label:"文件名",prop:"fileName"},{label:"文件类型",prop:"fileType"},{label:"文件大小",prop:"fileSize"},{label:"版本",prop:"version"},{label:"上传时间",prop:"createTime"}],b=a.filter(N=>N.prop==="fileName"),h={rowKey:"id",align:"center",index:!1,border:!0,stripe:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuType:"menu",menuBtnTitle:"操作",column:H()?b:a},{bindVal:D,getDataList:n,handleDel:s,handleSave:d,afterGetList:c,crudStateRefs:{tableData:p}}=Xe({crudOption:{...jt(i),saveSuccessMsg:"上传成功"},tableOption:h,queryForm:{isLatest:1,flowInstanceId:v.value}});c(()=>{l.value=p.value.map(N=>N.id).join(",")}),n();async function m(N,I){var P,x;const{fileName:T,fileType:z,fileSize:S,fileUrl:g,res:$}=u,K={fileName:ae({res:N},`${$}.${T}`),fileType:ae({res:N},`${$}.${z}`),fileSize:ae({res:N},`${$}.${S}`),fileUrl:ae({res:N},`${$}.${g}`),taskId:(x=(P=t.value)==null?void 0:P.task)==null?void 0:x.taskId,flowInstanceId:v.value,rootMark:(I==null?void 0:I.rootMark)||"",version:typeof(I==null?void 0:I.version)=="number"?I.version+1:1};await d(K,n,()=>{})}return(N,I)=>{const T=U("el-button"),z=U("el-upload"),S=U("el-dropdown-item"),g=U("avue-crud");return V(),O(g,st(nt(y(D))),{"menu-left":C(()=>[y(_)?E("",!0):(V(),O(z,{key:0,action:y(r),headers:y(k),"show-file-list":!1,onSuccess:I[0]||(I[0]=$=>m($))},{default:C(()=>[L(T,{type:"primary",icon:"el-icon-upload"},{default:C(()=>[M(" 点击上传 ")]),_:1})]),_:1},8,["action","headers"]))]),"menu-btn":C(({row:$,index:K})=>[L(S,{icon:"el-icon-view",onClick:P=>{var x;return(x=y(o))==null?void 0:x($,y(p))}},{default:C(()=>[M(" 预览 ")]),_:2},1032,["onClick"]),L(S,{icon:"el-icon-download",onClick:P=>{var x;return(x=y(f))==null?void 0:x($,y(p))}},{default:C(()=>[M(" 下载 ")]),_:2},1032,["onClick"]),y(_)?E("",!0):(V(),O(S,{key:0,icon:"el-icon-upload"},{default:C(()=>[L(z,{action:y(r),headers:y(k),"show-file-list":!1,onSuccess:P=>m(P,$)},{default:C(()=>[M(" 更新版本 ")]),_:2},1032,["action","headers","onSuccess"])]),_:2},1024)),y(_)?E("",!0):(V(),O(S,{key:1,icon:"el-icon-delete",onClick:P=>y(s)($,K)},{default:C(()=>[M(" 删除 ")]),_:2},1032,["onClick"]))]),_:1},16)}}}),xt={class:"flow-track"},$t={key:0},Lt={key:1},Tt=Q({__name:"flow-track",setup(e){const{flowDetail:t}=F(),l=j(H()?"timeline":"table"),_=[{label:"table",icon:"ep:grid"},{label:"graph",icon:"ep:picture"},{label:"timeline",icon:"ep:finished"}],r=A(()=>{var i,k,v;return((v=(k=(i=t.value)==null?void 0:i.flowHistory)==null?void 0:k.filter(a=>a.taskNodeType==="userTask"))==null?void 0:v.map(a=>({...a,duration:Re(a.duration)})))??[]}),w={addBtn:!1,menu:!1,border:!0,column:[{label:"节点名称",prop:"taskNodeName"},{label:"处理人",prop:"assigneeName"},{label:"接收时间",prop:"startTime"},{label:"处理时间",prop:"endTime"},{label:"办理时长",prop:"duration"},{label:"操作类型",prop:"type",dicUrl:"/sapier-flow/flow-param/getParam",dicQuery:{paramKey:"flow.handle.type"}},{label:"办理意见",prop:"comment",bind:"comment.handleComment"}]},{request:o}=W(),{data:f}=ie(o).useParam("flow.handle.type");function u(i){var k;return(k=f.value)==null?void 0:k.find(v=>v.value===i)}return(i,k)=>{var d,c,p;const v=U("el-radio-button"),a=U("el-radio-group"),b=U("avue-crud"),h=U("el-card"),D=U("el-timeline-item"),n=U("el-timeline"),s=U("el-empty");return V(),R(Y,null,[y(H)()?E("",!0):(V(),O(a,{key:0,modelValue:l.value,"onUpdate:modelValue":k[0]||(k[0]=m=>l.value=m)},{default:C(()=>[(V(),R(Y,null,ee(_,m=>L(v,{key:m.label,label:m.label},{default:C(()=>[L(y(Ce),{icon:m.icon},null,8,["icon"])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])),q("div",xt,[l.value==="table"?(V(),O(b,{key:0,data:r.value,option:w},null,8,["data"])):E("",!0),l.value==="graph"?(V(),O(Te,{key:1,"model-value":(c=(d=y(t))==null?void 0:d.process)==null?void 0:c.flowData,"flow-history":(p=y(t))==null?void 0:p.flowHistory,view:"","show-legend":""},null,8,["model-value","flow-history"])):E("",!0),l.value==="timeline"?(V(),R(Y,{key:2},[r.value.length?(V(),O(n,{key:0},{default:C(()=>[(V(!0),R(Y,null,ee([...r.value].reverse(),m=>(V(),O(D,{key:m.id,timestamp:m.endTime,placement:"top"},{default:C(()=>[L(h,null,{default:C(()=>{var N,I,T;return[q("div",null,G(m.assigneeName)+" 开始处理 ["+G(m.taskNodeName)+"] 环节 ",1),m.duration?(V(),R("div",$t," 办理时长："+G(m.duration),1)):E("",!0),m.type&&((N=m.comment)!=null&&N.handleComment)?(V(),R("div",Lt,G((I=u(m.type))==null?void 0:I.label)+"意见："+G((T=m.comment)==null?void 0:T.handleComment),1)):E("",!0)]}),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:1})):(V(),O(s,{key:1}))],64)):E("",!0)])],64)}}});const Ot=fe(Tt,[["__scopeId","data-v-a1713c28"]]),St={FlowDesign:{},FormDesign:{},FlowForm:Ct,request:{},tabs:[{label:"审批表单",prop:"formTab",component:It},{label:"附件资料",prop:"fileTab",component:Ut},{label:"流程跟踪",prop:"trackTab",component:Ot}],useFlowFormOptions:{type:"drawer",window:["","flow-form","left=0,top=0,width=1600,height=900"],overlay:{width:"80%",size:"80%",top:"100px",fullscreen:!0,destroyOnClose:!0}},tableOption:{align:"center",border:!0,card:!0,stripe:!0,searchMenuSpan:6,span:24},upload:{props:{fileName:"fileOriginalName",fileType:"fileType",fileSize:"fileSize",fileUrl:"fileUrl",res:"res.data"}}};function Kt(e){const t={list:"/sapier-flow/flow-user-common/list",save:"/sapier-flow/flow-user-common/save",update:"/sapier-flow/flow-user-common/update",remove:"/sapier-flow/flow-user-common/remove",batchUpdate:"/sapier-flow/flow-user-common/batchUpdate"},l=u=>e.get(t.list,{params:{type:u,ascs:"sort"}});return{url:t,getList:l,useList:u=>te(()=>l(u.value).then(i=>i.data.records),{refreshDeps:[u]}),create:u=>e.post(t.save,u),update:u=>e.post(t.update,u),remove:u=>e.post(t.remove,{},{params:{ids:u}}),batchUpdate:u=>e.post(t.batchUpdate,u)}}var Oe=(e=>(e.默认="default",e.主要="primary",e.成功="success",e.警告="warning",e.危险="danger",e.信息="info",e.文字="text",e))(Oe||{}),Pt=(e=>(e.保存草稿="flow_draft",e.发送="flow_pass",e.退回="flow_reject",e.终止="flow_terminate",e.撤销="flow_revoke",e.撤回到发起="flow_withdraw",e.打印="flow_print",e.转办="flow_transfer",e.加签="flow_add_instance",e.减签="flow_del_instance",e.指定回退="flow_rollback",e.绿色通道="flow_green",e))(Pt||{}),ve=(e=>(e.显示="true",e.隐藏="false",e.发起人="startUser",e.处理人="assignee",e.已办="done",e.待办="todo",e.未发起="notstarted",e.已发起="started",e.未办结="unfinished",e.已办结="finished",e))(ve||{}),be=(e=>(e.不显示="false",e.指定节点="specifyNode",e.审批人="assignee",e.传阅人="circulate",e.意见="comment",e))(be||{}),Se=(e=>(e[e.禁用=0]="禁用",e[e.正常=1]="正常",e))(Se||{});function Ke(e){const t={list:"/sapier-flow/dev-button/list",save:"/sapier-flow/dev-button/save",update:"/sapier-flow/dev-button/update",remove:"/sapier-flow/dev-button/remove"},l=f=>e.get(t.list,{params:f});return{url:t,getList:l,useList:()=>te(()=>l({size:-1,ascs:"sort"}).then(f=>f.data.records)),create:f=>e.post(t.save,f),update:f=>e.post(t.update,f),remove:f=>e.post(t.remove,{},{params:{ids:f}})}}function jt(e){const t={list:"/sapier-flow/flow-file/list",save:"/sapier-flow/flow-file/save",remove:"/sapier-flow/flow-file/remove"};return{getList:w=>e.get(t.list,{params:w}),create:w=>e.post(t.save,w),remove:w=>e.post(t.remove,{},{params:{ids:w}})}}function ie(e){const t={list:"/sapier-flow/flow-param/list",save:"/sapier-flow/flow-param/save",update:"/sapier-flow/flow-param/update",remove:"/sapier-flow/flow-param/remove",all:"/sapier-flow/flow-param/getAllParam",key:"/sapier-flow/flow-param/getParam"},l=i=>e.get(t.list,{params:i}),_=()=>e.get(t.all),r=i=>e.get(t.key,{params:{paramKey:i}});return{url:t,getList:l,getAllParam:_,getParam:r,useParam:i=>te(()=>r(i).then(k=>k.data)),create:i=>e.post(t.save,i),update:i=>e.post(t.update,i),remove:i=>e.post(t.remove,{},{params:{ids:i}})}}var ne=(e=>(e[e.已办=1]="已办",e[e.待办=2]="待办",e[e.失败=3]="失败",e[e.撤销=4]="撤销",e[e.终止=5]="终止",e))(ne||{}),pe=(e=>(e[e.已办结=1]="已办结",e[e.未办结=2]="未办结",e[e.已终止=3]="已终止",e))(pe||{}),At=(e=>(e[e.系统执行=1]="系统执行",e[e.用户办理=2]="用户办理",e[e.任务撤销=3]="任务撤销",e[e.任务退回=4]="任务退回",e[e.流程终止=5]="流程终止",e[e.任务转办=6]="任务转办",e[e.绿色通道=7]="绿色通道",e))(At||{});function _e(e){const t={publishList:"/sapier-flow/flow-run/queryPublishFlowList",taskList:"/sapier-flow/flow-run/userTaskList",detail:"/sapier-flow/flow-run/queryPublishFlowDetail",approvalNode:"/sapier-flow/flow-run/queryApprovalNode",start:"/sapier-flow/flow-run/startProcess",commit:"/sapier-flow/flow-run/commitTask",draft:"/sapier-flow/flow-run/saveDraft",revoke:"/sapier-flow/flow-run/revokeTask",terminate:"/sapier-flow/flow-run/terminateFlow",withdraw:"/sapier-flow/flow-run/withdrawToStart",transfer:"/sapier-flow/flow-run/transferTask",reject:"/sapier-flow/flow-run/rollbackTask",green:"/sapier-flow/flow-run/greenTask"},l=n=>e.get(t.detail,{params:n}),_=n=>e.post(t.approvalNode,n),r=n=>e.post(t.start,n),w=n=>e.post(t.commit,n),o=n=>e.post(t.draft,n),f=n=>e.post(t.revoke,n),u=n=>e.post(t.terminate,n),i=n=>e.post(t.withdraw,n),k=n=>e.post(t.transfer,n),v=n=>e.post(t.reject,n),a=n=>e.post(t.green,n),b=()=>e.get(t.publishList);return{url:t,getFlowDetail:l,getApprovalNode:_,startTask:r,commitTask:w,saveDraft:o,revokeTask:f,terminateTask:u,withdrawTask:i,transferTask:k,rejectTask:v,greenChannel:a,getPublishList:b,usePublishList:()=>te(()=>b().then(n=>n.data)),getTaskList:n=>e.get(t.taskList,{params:n})}}function zt(e){const t={tree:"/sapier-flow/flow-user/tree"},l=r=>e.get(t.tree,{params:{filter:r}});return{url:t,getUserTree:l,useUserTree:()=>te(()=>l().then(r=>r.data))}}var ye=(e=>(e.ASSIGN_ID="ASSIGN_ID",e.ASSIGN_UUID="ASSIGN_UUID",e.AUTO="AUTO",e.INPUT="INPUT",e.NONE="NONE",e))(ye||{}),we=(e=>(e.bigint="bigint",e.blob="blob",e.char="char",e.date="date",e.datetime="datetime",e.decimal="decimal",e.double="double",e.enum="enum",e.float="float",e.int="int",e.longblob="longblob",e.longtext="longtext",e.mediumblob="mediumblob",e.mediumint="mediumint",e.mediumtext="mediumtext",e.set="set",e.smallint="smallint",e.text="text",e.time="time",e.timestamp="timestamp",e.tinyblob="tinyblob",e.tinyint="tinyint",e.tinytext="tinytext",e.varbinary="varbinary",e.varchar="varchar",e.year="year",e))(we||{});function sa(e){const t={list:"/sapier-flow/dev-table/list",save:"/sapier-flow/dev-table/save",update:"/sapier-flow/dev-table/update",remove:"/sapier-flow/dev-table/remove",deploy:"/sapier-flow/dev-table/deploy",getFields:"/sapier-flow/dev-table/getTableFields"},l=i=>e.get(t.list,{params:i});return{url:t,getList:l,useList:()=>te(()=>l({size:-1}).then(i=>i.data.records)),create:i=>e.post(t.save,i),update:i=>e.post(t.update,i),remove:i=>e.post(t.remove,{},{params:{ids:i}}),deploy:i=>e.post(t.deploy,i),getFields:i=>e.get(t.getFields,{params:i})}}var Pe=(e=>(e[e.否=0]="否",e[e.是=1]="是",e))(Pe||{});const de=J(Pe),na=J(we),ra=J(ye),Bt=Ue(St);function W(e){return Ye(Bt,e)}const ua=X({rowKey:"id",labelWidth:150,column:[{label:"按钮名称",prop:"name",search:!0},{label:"按钮标识",prop:"buttonKey",search:!0},{label:"按钮图标",prop:"icon",component:"icon-select"},{label:"按钮类型",prop:"buttonType",type:"select",dicData:J(Oe)},{label:"默认显示条件",prop:"display",type:"select",multiple:!0,dataType:"string",value:"false",dicData:J(ve),tip:"选择多个时,所有条件都满足才显示",labelTip:`显示: 始终显示;<br/>隐藏: 始终隐藏;<br/>
      发起人: 用户为发起人时显示;<br/>处理人: 用户为处理人时显示;<br/>
      已办: 任务状态为已办时显示;<br/>待办: 任务状态为待办时显示;<br/>
      未发起: 流程未发起时显示;<br/>已发起: 流程已发起时显示;<br/>
      未办结: 流程未办结时显示;<br/>已办结: 流程已办结时显示;`},{label:"默认审批窗口显示",prop:"approval",type:"select",multiple:!0,dataType:"string",value:"false",dicData:J(be),labelTip:`不显示: 不显示审批窗口;<br/>指定节点: 显示指定节点选择框(常用于绿色通道等);<br/>
      审批人: 显示审批人选择框;<br/>传阅人: 显示传阅人选择框;<br/>意见: 显示意见输入框;`},{label:"备注",prop:"remarks",overHidden:!0},{label:"排序",prop:"sort",type:"number",value:0},{label:"状态",prop:"status",type:"switch",value:1,dicData:J(Se)},{label:"按钮预览",prop:"buttonPreview",width:150}]}),je={menuBtn:!1,span:24,column:[{label:"流程名称",prop:"flowName",rules:[{required:!0,message:"请输入流程名称"}]},{label:"流程标识",prop:"flowKey",editDisabled:!0,rules:[{required:!0,message:"请输入流程标识"}]},{label:"流程分类",prop:"categoryId",type:"select",dicUrl:"/sapier-flow/flow-category/list",dicQuery:{size:-1},props:{label:"name",value:"id"}},{label:"流程图标",prop:"flowIcon",component:"icon-select"},{label:"流程描述",prop:"remarks"},{label:"自定义表单",prop:"formPath"},{label:"关联表",prop:"formDataTable",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicUrl:"/sapier-flow/dev-table/list",dicQuery:{size:-1},props:{label:"tableComment",value:"tableName",desc:"tableName",res:"data.records"}},{label:"排序",prop:"sort",type:"number",width:110},{label:"表单设计",prop:"formOption",display:!1,hide:!0},{label:"模型设计",prop:"flowData",display:!1,hide:!0}]},ia=X({rowKey:"flowModuleId",dialogFullscreen:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuWidth:100,menuType:"menu",menuBtnTitle:"操作",column:[...je.column.map((e,t)=>({...e,search:t<2})),{label:"流程主版本",prop:"mainVersion",formatter(e,t){return t?`V${t||""}`:""}}]}),ca=X({rowKey:"flowDeloyId",dialogFullscreen:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuWidth:100,menuType:"menu",menuBtnTitle:"操作",column:[...je.column,{label:"流程版本",prop:"version",formatter(e,t){return t?`V${t||""}`:""}},{label:"是否主版本",prop:"mainVersion",type:"select",dicData:[{label:"否",value:0},{label:"是",value:1}]}]}),pa=X({rowKey:"id",menu:!1,addBtn:!1,column:[{label:"流程名称",prop:"flowName"},{label:"流程标识",prop:"flowKey"},{label:"流程分类",prop:"categoryId",type:"select",search:!0,dicUrl:"/sapier-flow/flow-category/list",props:{label:"name",value:"id"}},{label:"标题",prop:"processTitle",search:!0},{label:"流水号",prop:"serialNumber"},{label:"当前节点",prop:"taskNodeName"},{label:"审批人",prop:"assigneeName"},{label:"申请人",prop:"applyUserName"},{label:"接收时间",prop:"startTime"},{label:"任务状态",prop:"status",type:"select",search:!0,searchValue:ne.待办,dicUrl:"/sapier-flow/flow-param/getParam",dicQuery:{paramKey:"flow.task.status"}}]}),da=X({rowKey:"id",column:[{label:"配置名称",prop:"paramName",search:!0},{label:"配置Key",prop:"paramKey",search:!0},{label:"备注",prop:"remark"},{label:"系统内置",prop:"paramType",type:"switch",dicData:de},{label:"配置值",prop:"paramValue",type:"textarea",maxRows:20,span:24,overHidden:!0}]}),ma=X({rowKey:"id",menu:!1,addBtn:!1,column:[{label:"流程名称",prop:"flowName"},{label:"流程标识",prop:"flowKey"},{label:"流程分类",prop:"categoryId",type:"select",search:!0,dicUrl:"/sapier-flow/flow-category/list",props:{label:"name",value:"id"}},{label:"标题",prop:"processTitle",search:!0},{label:"流水号",prop:"serialNumber"},{label:"当前节点",prop:"taskNodeName"},{label:"审批人",prop:"assigneeName"},{label:"申请人",prop:"applyUserName"},{label:"接收时间",prop:"startTime"}]});const fa=X({rowKey:"id",column:[{label:"流程标识",prop:"flowKey",search:!0},{label:"流程名称",prop:"flowName",search:!0},{label:"流程备注",prop:"remarks"},{label:"排序",prop:"sort"}]}),va=X({rowKey:"id",column:[{label:"表单标识",prop:"formKey",search:!0},{label:"表单名称",prop:"formName",search:!0},{label:"表单备注",prop:"remarks"},{label:"排序",prop:"sort",type:"number"}]}),De=[{label:"字段名称",prop:"name"},{label:"字段备注",prop:"comment"},{label:"字段类型",prop:"type",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:J(we)},{label:"字段长度",prop:"size",type:"number"},{label:"小数位",prop:"point",type:"number"},{label:"默认值",prop:"default"},{label:"是否主键",prop:"primary",type:"switch",dicData:de,value:0},{label:"是否允许为空",prop:"permitNull",type:"switch",dicData:de,value:1}],ba=X({rowKey:"id",dialogFullscreen:!0,column:[{label:"表名",prop:"tableName",search:!0},{label:"表注释",prop:"tableComment",search:!0},{label:"表引擎",prop:"tableEngine"},{label:"表主键策略",prop:"tablePrimary",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:J(ye)},{label:"数据库字段",prop:"editFields",hide:!0,type:"dynamic",children:{column:De}},{label:"默认字段",prop:"defaultFields",hide:!0,type:"dynamic",children:{addBtn:!1,delBtn:!1,column:De}}]});function Ae(e){return new Promise((t,l)=>{y(e).validate((r,w,o)=>{r?(w(),t(o)):l(o)})})}function H(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}export{zt as A,ye as B,St as C,we as D,X as E,Te as F,de as G,At as H,na as I,ra as J,Vt as K,he as L,Ot as M,It as N,Ut as O,pt as P,mt as Q,ft as R,Le as S,ne as T,vt as U,H as V,Pe as W,Ct as _,dt as a,Ae as b,W as c,Ke as d,ia as e,ca as f,sa as g,je as h,pa as i,da as j,ie as k,ma as l,_e as m,fa as n,va as o,ba as p,Kt as q,Oe as r,Pt as s,ua as t,F as u,ve as v,be as w,Se as x,jt as y,pe as z};
