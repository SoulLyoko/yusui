import{j as Re}from"./index.288677a1.js";import{I as Ce}from"./iconify.b68073ff.js";import{a as re,e as Ee,f as Me,w as Ie,g as Ge}from"./index.cd412afd.js";import{_ as Je,d as Qe}from"./index.b00b9483.js";import"./index.7473bcc5.js";import{d as We}from"./data.4cb21f02.js";import{j as He}from"./tree.21d3b17d.js";import"./index.3d38e212.js";import"./vuedraggable.umd.00d46a83.js";import{u as te,m as Ye}from"./index.es.e5378d01.js";import{e as J,u as Xe}from"./index.ac4ff024.js";import{ab as Ue,g as A,h as j,A as ue,l as _,E as me,$ as Ze,S as qe,Y as Fe,d as Q,J as U,c as R,L as ee,K as Y,o as V,b as O,w as C,N as L,a as M,t as G,B as oe,a3 as ge,k as q,R as ne,_ as fe,z as et,C as tt,e as E,U as at,O as xe,a5 as lt,D as ot,a9 as nt,aa as st}from"./framework.f01dabf7.js";import{p as rt}from"./pick.2b716c9d.js";import{t as ut,b as ke,f as it}from"./index.fc3eb3b1.js";import{E as le}from"./index.22b43a78.js";import{u as $e}from"./index.386fc70b.js";import{d as ct}from"./differenceBy.c603f003.js";import{g as ae}from"./get.c8715fa2.js";function X(e){const{tableOption:t}=W();return Ue({...t,...e})}function pt(e){const{buttonHandler:t,request:l}=W(),{commitTask:y,revokeTask:r,saveDraft:w,startTask:o,terminateTask:m,transferTask:i,withdrawTask:c,rejectTask:k,greenChannel:v}=_e(l),a=A(()=>{const{flowDetail:h,formVariables:D,approvalFormData:s,debug:n,fileIds:u}=e,{flowDeployId:p}=h.value.process??{},{taskId:d,flowInstanceId:f}=h.value.task??{};return{flowDeployId:p,taskId:d,flowInstanceId:f,variables:D.value,debug:n.value,fileIds:u==null?void 0:u.value,...s.value}}),b=()=>a.value.taskId&&a.value.flowInstanceId;return{flow_draft(){if(b())return w(a.value)},flow_pass(){return b()?y(a.value):o(a.value)},flow_revoke(){if(b())return r(a.value)},flow_withdraw(){if(b())return c(a.value)},flow_terminate(){if(b())return m(a.value)},flow_transfer(){if(b())return i(a.value)},flow_reject(){if(b())return k(a.value)},flow_green(){if(b())return v(a.value)},...t==null?void 0:t(e)}}function dt(e){const t=j({});return ue(async()=>{var y;const{formProperty:l}=((y=_(e))==null?void 0:y.properties)||{};l!=null&&l.length&&(await me(),Object.keys(t.value).forEach(r=>{var m,i,c,k;const w=((m=t.value[r])==null?void 0:m.label)||"",o=l==null?void 0:l.find(v=>v.prop===r);if(t.value[r].display=o==null?void 0:o.display,t.value[r].disabled=o==null?void 0:o.disabled,t.value[r].detail=o==null?void 0:o.detail,t.value[r].readonly=o==null?void 0:o.readonly,t.value[r].rules=t.value[r].rules??[],o!=null&&o.required&&((i=t.value[r].rules)!=null&&i.some(v=>v.required)))return null;o!=null&&o.required?(c=t.value[r].rules)==null||c.push({required:!0,message:`${w}为必填项`}):t.value[r].rules=(k=t.value[r].rules)==null?void 0:k.filter(v=>!v.required)}))}),t}const mt={modelValue:{type:Object,default:()=>({})},title:{type:String},flowDetail:{type:Object,default:()=>({})},formLoading:{type:Boolean},submitLoading:{type:Boolean},activeTab:{type:String,default:"formTab"},activeBtn:{type:Object,default:()=>({})},approvalVisible:{type:Boolean},approvalFormData:{type:Object,default:()=>({})},flowKey:{type:String},taskId:{type:String},instanceId:{type:String},formId:{type:String},fileIds:{type:String},permission:{type:Object},afterGetDetail:{type:Function},beforeClick:{type:Function},beforeSubmit:{type:Function},afterSubmit:{type:Function},detail:{type:[Boolean,String],default:!1},debug:{type:[Boolean,String],default:!1}},ft={complete:e=>e},Le=Symbol("flowFormState");function vt(e,t){const l=re(e,void 0,{passive:!0,deep:!0}),{flowDetail:y,modelValue:r,formLoading:w,activeTab:o,afterGetDetail:m}=l,{tabs:i,customForm:c,request:k}=W(),v=j({}),a=A(()=>{const u=typeof i=="function"?i({...l}):i;return(u==null?void 0:u.filter(p=>{var f,N,I;const d=(I=(N=(f=y.value)==null?void 0:f.properties)==null?void 0:N.formProperty)==null?void 0:I.find(T=>T.prop===p.prop);return(d==null?void 0:d.display)!==!1}).map(p=>{var f,N;let d=p.component;if(p.prop==="formTab"){const I=c==null?void 0:c[((N=(f=y==null?void 0:y.value)==null?void 0:f.process)==null?void 0:N.formPath)??""];typeof I=="function"?d=Fe(I):I&&(d=I)}return{...p,component:d}}))??[]}),b=j();H()&&Ee(b,{onSwipeEnd(u,p){if(!["left","right"].includes(p))return;const d=a.value.findIndex(N=>N.prop===o.value),f=Me(d+(p==="right"?-1:1),0,a.value.length-1);o.value=a.value[f].prop}});const{getFlowDetail:h}=_e(k);ue(()=>{const{flowKey:u,taskId:p,instanceId:d}=e;!u&&!p&&!d||(w.value=!0,h({flowKey:u,taskId:p,flowInstanceId:d}).then(async f=>{var N;y.value=f.data,r.value=f.data.formData||{},await((N=m==null?void 0:m.value)==null?void 0:N.call(m))}).finally(()=>{w.value=!1}))});const D=A(()=>Object.entries(r.value||{}).filter(([u])=>!u.startsWith("$")).map(([u,p])=>({key:u,value:p}))),s=A(()=>e.detail===!0||e.detail==="true"),n={...l,formData:r,formVariables:D,tabRefs:v,tabList:a,detail:s,tabsRef:b,emit:t};return Ze(Le,n),n}function F(){return qe(Le)}const he=Q({__name:"button-list",emits:["click"],setup(e,{emit:t}){const{userInfo:l,request:y}=W(),{flowDetail:r}=F(),{data:w}=Ke(y).useList();function o(i,c){return i.map(k=>{const v=c.find(b=>b.buttonKey===k.buttonKey);return{...k,...rt(v,["display","approval"])}})}const m=A(()=>{var n,u,p,d;const i=typeof l=="function"?l():l,{assignee:c,status:k}=((n=r.value)==null?void 0:n.task)||{},{createUser:v,flowInstanceId:a,status:b}=((u=r.value)==null?void 0:u.flowInstance)||{},h={true:!0,false:!1,startUser:v==(i==null?void 0:i.userId),assignee:c==(i==null?void 0:i.userId),todo:k==se.待办,done:k==se.已办,notstarted:!a,started:!!a,finished:b===pe.已办结,unfinished:b===pe.未办结},{button:D}=((p=r.value)==null?void 0:p.properties)||{};return((d=o(w.value??[],D??[]))==null?void 0:d.filter(f=>{var N,I;return(I=(N=f.display)==null?void 0:N.split(","))==null?void 0:I.every(T=>h[T])}))??[]});return(i,c)=>{const k=U("el-button");return V(!0),R(Y,null,ee(m.value,v=>(V(),O(k,{key:v.buttonKey,type:v.buttonType,onClick:a=>t("click",v)},{default:C(()=>[L(_(Ce),{icon:v.icon},null,8,["icon"]),M(" "+G(v.name),1)]),_:2},1032,["type","onClick"]))),128)}}}),bt=Q({__name:"common-comments",props:{modelValue:{}},setup(e){const t=e,{modelValue:l}=re(t),{request:y}=W(),{batchUpdate:r,create:w,remove:o,useList:m}=Kt(y),i=j(!1),{activeBtn:c}=F(),k=A(()=>{var d;return(d=c.value)==null?void 0:d.buttonKey}),{data:v,refresh:a}=m(k),b=A(()=>{var f,N,I;const d=l.value;if(d&&!((f=v.value)!=null&&f.some(T=>T.content===d))){const T=(((I=(N=v.value)==null?void 0:N[0])==null?void 0:I.sort)||1)-1;return[{content:d,sort:T},...v.value||[]]}return v.value});async function h(d){var f;await w({...d,type:(f=c.value)==null?void 0:f.buttonKey}),le.success("添加成功"),a()}async function D(d){await o(d.id),le.success("删除成功"),a()}async function s(d,f){let N=f.parent.data;N=N.map((I,T)=>({id:I.id,sort:T+1})),await r(N),le.success("修改排序成功"),a(),i.value=!1}function n(){i.value=!0}const u=j();async function p(d){var f;l.value=d.content??"",await me(),(f=u.value)==null||f.blur()}return(d,f)=>{const N=U("el-input"),I=U("el-text"),T=U("el-col"),z=U("el-button"),S=U("el-row"),g=U("el-tree"),$=U("el-popover");return V(),O($,{visible:i.value,placement:"bottom",title:"常用意见",width:_(H)()?"98%":"600px"},{reference:C(()=>[L(N,{ref_key:"inputRef",ref:u,modelValue:_(l),"onUpdate:modelValue":f[0]||(f[0]=K=>oe(l)?l.value=K:null),type:"textarea",placeholder:"请输入意见",rows:"5",onFocus:f[1]||(f[1]=K=>i.value=!0),onBlur:f[2]||(f[2]=K=>i.value=!1)},null,8,["modelValue"])]),default:C(()=>[L(g,{data:b.value,"node-key":"content",draggable:"","allow-drop":(K,P,x)=>x!=="inner",props:{label:"content"},onNodeClick:p,onNodeDrop:s,onNodeDragStart:n},{default:C(({data:K})=>[L(S,{style:{width:"100%"}},{default:C(()=>[L(T,{span:22},{default:C(()=>[L(I,{truncated:"",title:K.content},{default:C(()=>[M(G(K.content),1)]),_:2},1032,["title"])]),_:2},1024),L(T,{span:2},{default:C(()=>[K.id?(V(),O(z,{key:0,type:"danger",size:"small",icon:"el-icon-close",text:"",onClick:ge(P=>D(K),["stop"])},null,8,["onClick"])):(V(),O(z,{key:1,type:"primary",size:"small",icon:"el-icon-plus",text:"",onClick:ge(P=>h(K),["stop"])},null,8,["onClick"]))]),_:2},1024)]),_:2},1024)]),_:1},8,["data","allow-drop"])]),_:1},8,["visible","width"])}}}),_t=Q({__name:"approval-tree",props:{modelValue:{},data:{},autoCheck:{type:Boolean},mode:{}},setup(e){const t=e,{modelValue:l}=re(t),y={element:"ep:flag",post:"ep:share",dept:"ep:share",user:"ep:user"},w={defaultExpandAll:!0,lazy:!0,showCheckbox:!0,nodeKey:"id",load:(a,b)=>{a.level===0?b(m.value):b(a.data.children??[])},onCheck:c,props:{label:"title",class(a){return`node-${a.type}`}}},o=j(),m=A(()=>ut(t.data??[],(a,b,h)=>{const D=$e();return a.taskNodeKey=(h==null?void 0:h.taskNodeKey)??a.taskNodeKey,a.incoming=(h==null?void 0:h.incoming)??a.incoming,a.multiple=(h==null?void 0:h.multiple)??a.multiple,a.parentId=(h==null?void 0:h.id)??a.parentId,{...a,id:D}}));Ie(()=>[m.value,o.value],async()=>{if(!(!o.value||!m.value.length)&&t.autoCheck){const a=i(m.value);a&&v([a])}},{immediate:!0,debounce:100});function i(a){var b;if(a.length===1)return(b=a[0].children)!=null&&b.length?i(a[0].children):a[0]}async function c(a,{checkedNodes:b}){var s;let h=b.filter(n=>n.type==="user");const D=h.some(n=>n.id===a.id);if(m.value.every(n=>!n.multiple)&&D)h=[a];else if(!a.multiple&&D){const p=((s=o.value)==null?void 0:s.getNode(a)).parent.data.children.filter(d=>d.id!==a.id);h=ct(h,p,"id")}v(h)}function k(a){const b=l.value.filter(h=>h.id!==a.id);v(b)}function v(a){var b;l.value=a,(b=o.value)==null||b.setCheckedNodes(a)}return(a,b)=>{const h=U("el-tag"),D=U("Icon"),s=U("el-tree");return V(),R(Y,null,[(V(!0),R(Y,null,ee(_(l),n=>(V(),O(h,{key:n.id,type:"info",closable:"",onClose:u=>k(n)},{default:C(()=>[M(G(n.title),1)]),_:2},1032,["onClose"]))),128)),L(s,ne({ref_key:"treeRef",ref:o,class:["approval-tree",`mode-${a.mode}`],data:m.value},w),{default:C(({data:n})=>[q("div",null,[L(D,{icon:y[n.type]||y.element,style:{display:"inline-block"}},null,8,["icon"]),q("span",null,G(n.title),1)])]),_:1},16,["class","data"])],64)}}});const Ne=fe(_t,[["__scopeId","data-v-9646bed9"]]),yt={key:0},Ve=Q({__name:"assignee-setter",props:{modelValue:{},tableData:{},placeholder:{}},emits:["update:modelValue"],setup(e,{emit:t}){const l=e,y=A({get(){return typeof l.modelValue=="string"?l.modelValue?l.modelValue.split(","):[]:l.modelValue},set(D){var s;t("update:modelValue",D.join(",")),(s=l.tableData)!=null&&s.row&&(l.tableData.row.values=ke(m.value,n=>D==null?void 0:D.includes(n.id)),l.tableData.row.idVal=l.tableData.row.values.map(n=>n[`${o.value}Id`]).join(","))}}),r=A({get(){return Array.isArray(l.modelValue)?l.modelValue.join(","):l.modelValue},set(D){t("update:modelValue",D)}}),w=j(!1),o=A(()=>{var D,s;return(s=(D=l.tableData)==null?void 0:D.row)==null?void 0:s.type}),m=j([]),i=j([]),{request:c}=W(),{getUserTree:k}=zt(c),{getParam:v}=ie(c);et(o,async D=>{try{if(w.value=!0,["dept","post","user"].includes(D)){const s=await k(D==="user"?"":D);m.value=s.data}else if(o.value==="dynamic"){const s=await v("flow.trends.user");i.value=s.data}}finally{w.value=!1}},{immediate:!0});function a(){y.value=ke(m.value,D=>D.type===o.value).map(D=>D.id)}const b=A(()=>({checkStrictly:o.value!=="user",clearable:!0,collapseTags:!0,collapseTagsTooltip:!0,data:m.value,filterable:!0,loading:w.value,maxCollapseTags:3,multiple:!0,nodeKey:"id",props:{label:"title"},placeholder:"请选择",showCheckbox:!0})),h=A(()=>({clearable:!0,data:i.value,filterable:!0,loading:w.value,nodeKey:"value",props:{label:"title"},placeholder:"请选择"}));return(D,s)=>{const n=U("el-tree-select"),u=U("el-button"),p=U("el-input");return["dept","post","user"].includes(o.value)?(V(),R("div",yt,[L(n,ne({modelValue:y.value,"onUpdate:modelValue":s[0]||(s[0]=d=>y.value=d)},b.value,{style:{width:"75%"}}),null,16,["modelValue"]),L(u,{text:"",type:"primary",icon:"el-icon-check",style:{width:"20%"},onClick:a},{default:C(()=>[M(" 全选 ")]),_:1})])):o.value==="dynamic"?(V(),O(n,ne({key:1,modelValue:r.value,"onUpdate:modelValue":s[1]||(s[1]=d=>r.value=d)},h.value,{style:{width:"100%"}}),null,16,["modelValue"])):o.value==="userTask"?(V(),O(_(Je),{key:2,modelValue:r.value,"onUpdate:modelValue":s[2]||(s[2]=d=>r.value=d),"filter-type":"userTask",placeholder:"请选择"},null,8,["modelValue"])):(V(),O(p,{key:3,modelValue:r.value,"onUpdate:modelValue":s[3]||(s[3]=d=>r.value=d),clearable:"",placeholder:"请输入"},null,8,["modelValue"]))}}}),wt={key:0,class:"flow-viewer"},gt={key:0,class:"flow-status-legend"},kt={class:"legend-text"},ht=Q({__name:"index",props:{modelValue:{},view:{type:Boolean},flowFormOption:{},flowHistory:{},showLegend:{type:Boolean}},emits:["update:modelValue","nodeClick"],setup(e,{emit:t}){const l=e,y=tt();Ge(y,()=>{var n;(n=y.value)==null||n.on("node:click",u=>t("nodeClick",u))});const r=A({get(){let n=We();return typeof l.modelValue=="string"&&l.modelValue?n=JSON.parse(l.modelValue):typeof l.modelValue=="object"&&Object.keys(l.modelValue)&&(n=l.modelValue),n},set(n){t("update:modelValue",JSON.stringify(n))}}),w=A(()=>{const{column:n=[],group:u=[]}=JSON.parse(l.flowFormOption||"{}");return[...n,...u.map(d=>d.column??[]).flat()]}),{FlowDesign:o,tabs:m,request:i}=W(),{data:c}=Ke(i).useList(),k=A(()=>{const n=typeof m=="function"?m==null?void 0:m({}):m;return(n==null?void 0:n.map(u=>({display:!0,...u})))??[]}),v=A(()=>{var n;return{formPropertyList:[...w.value,...k.value],buttonList:(n=c.value)==null?void 0:n.filter(u=>u.status===1),fieldsDic:w.value.map(u=>({label:u.label,value:`\${${u.prop}}`,desc:`\${${u.prop}}`})),flowButtonDisplayDic:J(ve),flowButtonApprovalDic:J(be)}}),a=j({}),b=j({});Ie(b,n=>{var u,p,d,f,N,I;n&&((d=(p=(u=n.assignee)==null?void 0:u.children)==null?void 0:p.column)!=null&&d[1]&&(n.assignee.children.column[1].component=Ve),(I=(N=(f=n.circulate)==null?void 0:f.children)==null?void 0:N.column)!=null&&I[1]&&(n.circulate.children.column[1].component=Ve))},{debounce:1});const{data:h}=ie(i).useParam("flow.task.status"),D=A(()=>{var n;return(n=l.flowHistory)==null?void 0:n.map(u=>{var d,f;const p=(f=(d=h.value)==null?void 0:d.find(N=>N.value===u.status))==null?void 0:f.style;return{id:u.taskNodeKey,style:p}})}),s=A(()=>{var n,u;return(u=(n=l.flowHistory)==null?void 0:n.filter(p=>p.taskNodeType==="userTask"))==null?void 0:u.map(p=>{var d;return{id:p.taskNodeKey,content:`<div>${p.assigneeName}</div>
        <div>${p.endTime??""}</div>
        <div>${((d=p.comment)==null?void 0:d.handleComment)??""}</div>`}})});return(n,u)=>n.view?(V(),R("div",wt,[n.showLegend!==!1?(V(),R("div",gt,[(V(!0),R(Y,null,ee(_(h),p=>{var d;return V(),R("div",{key:p.label,class:"legend-item"},[q("div",{class:"legend-color",style:at({backgroundColor:(d=p.style)==null?void 0:d.fill})},null,4),q("span",kt,G(p.label),1)])}),128))])):E("",!0),L(_(o),{lf:y.value,"onUpdate:lf":u[0]||(u[0]=p=>y.value=p),"model-value":r.value,styles:D.value,tooltips:s.value,type:"viewer"},null,8,["lf","model-value","styles","tooltips"])])):(V(),O(_(o),{key:1,modelValue:r.value,"onUpdate:modelValue":u[1]||(u[1]=p=>r.value=p),formData:a.value,"onUpdate:formData":u[2]||(u[2]=p=>a.value=p),formDefaults:b.value,"onUpdate:formDefaults":u[3]||(u[3]=p=>b.value=p),"form-options":_(Qe),"data-options":v.value,"form-width":"30%"},null,8,["modelValue","formData","formDefaults","form-options","data-options"]))}});const Te=fe(ht,[["__scopeId","data-v-59ecc4be"]]),Nt=Q({__name:"node-select",props:{modelValue:{}},setup(e){const t=e,{modelValue:l}=re(t),{flowDetail:y}=F(),r=j(!1);function w({data:o}){o.type==="userTask"&&(r.value=!1,l.value=o.id)}return(o,m)=>{const i=U("el-button"),c=U("el-popover");return V(),O(c,{visible:r.value,"onUpdate:visible":m[0]||(m[0]=k=>r.value=k),placement:"bottom-start",width:"800px",trigger:"click"},{reference:C(()=>[L(i,null,{default:C(()=>[M(" 点击选择节点 ")]),_:1})]),default:C(()=>{var k,v;return[L(Te,{"model-value":(v=(k=_(y))==null?void 0:k.process)==null?void 0:v.flowData,view:"",style:{height:"600px"},onNodeClick:w},null,8,["model-value"])]}),_:1},8,["visible"])}}}),Vt=Q({__name:"approval-form",emits:["submit"],setup(e,{emit:t}){const{request:l}=W(),{getApprovalNode:y}=_e(l),{useParam:r}=ie(l),{formData:w,approvalFormData:o,activeBtn:m,approvalVisible:i,formVariables:c,flowDetail:k}=F(),v=j([]),a=j([]),b=j([]),h=j([]),D=j(!1),s=j(!1),n=j(),u=A(()=>{const S=v.value.length,g=b.value.length&&!v.value.length;return{menuBtn:!1,labelWidth:"auto",span:24,column:[{label:"指定节点",prop:"jumpTaskNodeKey",display:p("specifyNode"),rules:[{required:!0,message:"请选择指定节点"}]},{label:"审批人",prop:"assignee",display:p("assignee"),rules:S?[{required:!0,validator:d}]:[]},{label:"传阅人",prop:"circulate",display:p("circulate"),rules:g?[{required:!0,message:"请选择传阅人"}]:[]},{label:"意见",prop:"comment",display:p("comment"),rules:[{required:!0,message:"请填写意见"}]}]}});function p(S){var g,$;return($=(g=m.value)==null?void 0:g.approval)==null?void 0:$.includes(S)}function d(S,g,$){var x,Z,B;const K=((x=v.value[0])==null?void 0:x.type)==="parallelGateway",P=(B=(Z=v.value[0])==null?void 0:Z.children)==null?void 0:B.every(ce=>it([ce],ze=>a.value.some(Be=>Be.id===ze.id)));if(a.value.length){if(K&&!P)return $("请在每个节点选择审批人")}else return $("请选择审批人");return!0}const{data:f}=r("flow.approval.autocheck"),{data:N}=r("flow.approval.autocomment");ue(async()=>{var $,K;if(!i.value||!n.value)return;me(()=>{n.value.resetFields(),o.value.comment=w.value.comment||N.value==="true"&&m.value.name||""});const{taskId:S}=(($=k.value)==null?void 0:$.task)||{},{flowKey:g}=((K=k.value)==null?void 0:K.process)||{};if(I(),!!p("assignee")&&!(p("specifyNode")&&!o.value.jumpTaskNodeKey))try{s.value=!0;const P=await y({flowKey:g,taskId:S,variables:c.value,buttonType:m.value.buttonKey,jumpTaskNodeKey:o.value.jumpTaskNodeKey});v.value=P.data.approvalNodeList,b.value=P.data.circulateNodeList}finally{s.value=!1}});function I(){v.value=[],a.value=[],b.value=[],h.value=[]}async function T(){await Ae(n),D.value=!0;const{data:S,outgoing:g}=z(a.value),{data:$}=z(h.value);o.value.assignee=S,o.value.circulate=$,o.value.outgoing=[...g],t("submit")}function z(S){const g={},$={},K=new Set;return S.forEach(P=>{const{taskNodeKey:x,incoming:Z}=P;g[x]||(g[x]=new Set),P.userId&&g[x].add(P.userId),$[x]=[...g[x]].join(","),Z&&K.add(Z)}),{dataSet:g,data:$,outgoing:K}}return(S,g)=>{const $=U("el-skeleton"),K=U("avue-form"),P=U("el-button");return V(),O(xe(_(H)()?"el-drawer":"el-dialog"),{modelValue:_(i),"onUpdate:modelValue":g[6]||(g[6]=x=>oe(i)?i.value=x:null),class:"approval-form-overlay",title:_(m).name,"append-to-body":"",width:"900px",size:"50%",direction:"btt"},{footer:C(()=>[L(P,{onClick:g[5]||(g[5]=x=>i.value=!1)},{default:C(()=>[M(" 取 消 ")]),_:1}),L(P,{type:"primary",onClick:T},{default:C(()=>[M(" 确 定 ")]),_:1})]),default:C(()=>[L(K,{ref_key:"formRef",ref:n,modelValue:_(o),"onUpdate:modelValue":g[4]||(g[4]=x=>oe(o)?o.value=x:null),class:"approval-form",option:u.value},{jumpTaskNodeKey:C(()=>[L(Nt,{modelValue:_(o).jumpTaskNodeKey,"onUpdate:modelValue":g[0]||(g[0]=x=>_(o).jumpTaskNodeKey=x)},null,8,["modelValue"])]),assignee:C(()=>[s.value?(V(),O($,{key:0})):(V(),O(Ne,{key:"AssigneeTree",modelValue:a.value,"onUpdate:modelValue":g[1]||(g[1]=x=>a.value=x),data:v.value,"auto-check":_(f)==="true",mode:_(H)()?"vertical":"horizontal"},null,8,["modelValue","data","auto-check","mode"]))]),circulate:C(()=>[s.value?(V(),O($,{key:0})):(V(),O(Ne,{key:"CirculateTree",modelValue:h.value,"onUpdate:modelValue":g[2]||(g[2]=x=>h.value=x),data:b.value,mode:_(H)()?"vertical":"horizontal"},null,8,["modelValue","data","mode"]))]),comment:C(()=>[L(bt,{modelValue:_(o).comment,"onUpdate:modelValue":g[3]||(g[3]=x=>_(o).comment=x)},null,8,["modelValue"])]),_:1},8,["modelValue","option"])]),_:1},8,["modelValue","title"])}}});const Dt={class:"flow-form__title"},Ct=Q({__name:"index",props:mt,emits:ft,setup(e,{emit:t}){const y=vt(e,t),{ApprovalForm:r,tabsProps:w}=W(),o=r??Vt,{title:m,detail:i,flowDetail:c,tabRefs:k,tabList:v,activeTab:a,activeBtn:b,formLoading:h,approvalVisible:D,submitLoading:s,beforeClick:n,beforeSubmit:u,afterSubmit:p,tabsRef:d}=y;async function f(T){var z,S;b.value=T;for(const g of Object.values(k.value))await((z=g==null?void 0:g.validate)==null?void 0:z.call(g));await((S=n==null?void 0:n.value)==null?void 0:S.call(n,T)),(T==null?void 0:T.approval)!=="false"?D.value=!0:I()}const N=pt(y);async function I(){var T,z;try{const{buttonKey:S}=b.value;s.value=!0,await((T=u==null?void 0:u.value)==null?void 0:T.call(u,b.value));const g=N[S];g?(await(g==null?void 0:g()),await((z=p==null?void 0:p.value)==null?void 0:z.call(p,b.value)),D.value=!1,t("complete",b.value)):le.error("无法找到相应的操作")}finally{s.value=!1}}return(T,z)=>{const S=U("el-skeleton"),g=U("el-main"),$=U("el-header"),K=U("el-tab-pane"),P=U("el-tabs"),x=U("el-footer"),Z=U("el-container");return _(h)?(V(),O(g,{key:0},{default:C(()=>[L(S)]),_:1})):(V(),O(Z,{key:1,class:"flow-form"},{default:C(()=>[L($,{class:"flow-form__header",height:"auto"},{default:C(()=>{var B;return[q("div",Dt,G(_(m)??((B=_(c).flowInstance)==null?void 0:B.title)),1),!_(i)&&!_(H)()?(V(),O(he,{key:0,onClick:f})):E("",!0)]}),_:1}),L(g,{class:"flow-form__main"},{default:C(()=>[L(P,ne({ref_key:"tabsRef",ref:d,modelValue:_(a),"onUpdate:modelValue":z[0]||(z[0]=B=>oe(a)?a.value=B:null)},_(w)),{default:C(()=>[(V(!0),R(Y,null,ee(_(v),B=>(V(),O(K,{key:B.prop,label:B.label,name:B.prop,lazy:B.lazy,disabled:B.disabled,closable:B.closable},{default:C(()=>[(V(),O(xe(B.component),{ref_for:!0,ref:ce=>_(k)[B.prop]=ce},null,512))]),_:2},1032,["label","name","lazy","disabled","closable"]))),128))]),_:1},16,["modelValue"])]),_:1}),!_(i)&&_(H)()?(V(),O(x,{key:0,class:"flow-form__footer",height:"auto"},{default:C(()=>[L(he,{onClick:f})]),_:1})):E("",!0),L(_(o),{onSubmit:I})]),_:1}))}}});const It=Q({setup(){const{flowDetail:e,formData:t,detail:l}=F(),y=dt(e.value),{proxy:r}=ot(),w=j({});ue(()=>{const{formOption:i}=e.value.process??{};w.value=He.bind(r)(i||'{"menuBtn":false}'),w.value.detail=!!l.value});const o=j();function m(){return Ae(o)}return{form:t,option:w,defaults:y,formRef:o,validate:m}},render(){return lt(U("avue-form"),{ref:"formRef",modelValue:this.form,defaults:this.defaults,option:this.option,class:this.option.class,"onUpdate:modelValue":e=>this.form=e,"onUpdate:defaults":e=>this.defaults=e})}}),Ut=Q({__name:"upload-table",setup(e){const{flowDetail:t,fileIds:l,detail:y}=F(),{upload:{action:r,headers:w,preview:o,download:m,props:i}={},request:c}=W(),k=typeof w=="function"?w():w,v=A(()=>{var N,I;return((I=(N=t.value)==null?void 0:N.task)==null?void 0:I.flowInstanceId)??$e()}),a=[{label:"文件名",prop:"fileName"},{label:"文件类型",prop:"fileType"},{label:"文件大小",prop:"fileSize"},{label:"版本",prop:"version"},{label:"上传时间",prop:"createTime"}],b=a.filter(N=>N.prop==="fileName"),h={rowKey:"id",align:"center",index:!1,border:!0,stripe:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuType:"menu",menuBtnTitle:"操作",column:H()?b:a},{bindVal:D,getDataList:s,handleDel:n,handleSave:u,afterGetList:p,crudStateRefs:{tableData:d}}=Xe({crudOption:{...jt(c),saveSuccessMsg:"上传成功"},tableOption:h,queryForm:{isLatest:1,flowInstanceId:v.value}});p(()=>{l.value=d.value.map(N=>N.id).join(",")}),s();async function f(N,I){var P,x;const{fileName:T,fileType:z,fileSize:S,fileUrl:g,res:$}=i,K={fileName:ae({res:N},`${$}.${T}`),fileType:ae({res:N},`${$}.${z}`),fileSize:ae({res:N},`${$}.${S}`),fileUrl:ae({res:N},`${$}.${g}`),taskId:(x=(P=t.value)==null?void 0:P.task)==null?void 0:x.taskId,flowInstanceId:v.value,rootMark:(I==null?void 0:I.rootMark)||"",version:typeof(I==null?void 0:I.version)=="number"?I.version+1:1};await u(K,s,()=>{})}return(N,I)=>{const T=U("el-button"),z=U("el-upload"),S=U("el-dropdown-item"),g=U("avue-crud");return V(),O(g,nt(st(_(D))),{"menu-left":C(()=>[_(y)?E("",!0):(V(),O(z,{key:0,action:_(r),headers:_(k),"show-file-list":!1,onSuccess:I[0]||(I[0]=$=>f($))},{default:C(()=>[L(T,{type:"primary",icon:"el-icon-upload"},{default:C(()=>[M(" 点击上传 ")]),_:1})]),_:1},8,["action","headers"]))]),"menu-btn":C(({row:$,index:K})=>[L(S,{icon:"el-icon-view",onClick:P=>{var x;return(x=_(o))==null?void 0:x($,_(d))}},{default:C(()=>[M(" 预览 ")]),_:2},1032,["onClick"]),L(S,{icon:"el-icon-download",onClick:P=>{var x;return(x=_(m))==null?void 0:x($,_(d))}},{default:C(()=>[M(" 下载 ")]),_:2},1032,["onClick"]),_(y)?E("",!0):(V(),O(S,{key:0,icon:"el-icon-upload"},{default:C(()=>[L(z,{action:_(r),headers:_(k),"show-file-list":!1,onSuccess:P=>f(P,$)},{default:C(()=>[M(" 更新版本 ")]),_:2},1032,["action","headers","onSuccess"])]),_:2},1024)),_(y)?E("",!0):(V(),O(S,{key:1,icon:"el-icon-delete",onClick:P=>_(n)($,K)},{default:C(()=>[M(" 删除 ")]),_:2},1032,["onClick"]))]),_:1},16)}}}),xt={class:"flow-track"},$t={key:0},Lt={key:1},Tt=Q({__name:"flow-track",setup(e){const{flowDetail:t}=F(),l=j(H()?"timeline":"table"),y=[{label:"table",icon:"ep:grid"},{label:"graph",icon:"ep:picture"},{label:"timeline",icon:"ep:finished"}],r=A(()=>{var c,k,v;return((v=(k=(c=t.value)==null?void 0:c.flowHistory)==null?void 0:k.filter(a=>a.taskNodeType==="userTask"))==null?void 0:v.map(a=>({...a,duration:Re(a.duration)})))??[]}),w={addBtn:!1,menu:!1,border:!0,column:[{label:"节点名称",prop:"taskNodeName"},{label:"处理人",prop:"assigneeName"},{label:"接收时间",prop:"startTime"},{label:"处理时间",prop:"endTime"},{label:"办理时长",prop:"duration"},{label:"操作类型",prop:"type",dicUrl:"/sapier-flow/flow-param/getParam",dicQuery:{paramKey:"flow.handle.type"}},{label:"办理意见",prop:"comment",bind:"comment.handleComment"}]},{request:o}=W(),{data:m}=ie(o).useParam("flow.handle.type");function i(c){var k;return(k=m.value)==null?void 0:k.find(v=>v.value===c)}return(c,k)=>{var u,p,d;const v=U("el-radio-button"),a=U("el-radio-group"),b=U("avue-crud"),h=U("el-card"),D=U("el-timeline-item"),s=U("el-timeline"),n=U("el-empty");return V(),R(Y,null,[_(H)()?E("",!0):(V(),O(a,{key:0,modelValue:l.value,"onUpdate:modelValue":k[0]||(k[0]=f=>l.value=f)},{default:C(()=>[(V(),R(Y,null,ee(y,f=>L(v,{key:f.label,label:f.label},{default:C(()=>[L(_(Ce),{icon:f.icon},null,8,["icon"])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])),q("div",xt,[l.value==="table"?(V(),O(b,{key:0,data:r.value,option:w},null,8,["data"])):E("",!0),l.value==="graph"?(V(),O(Te,{key:1,"model-value":(p=(u=_(t))==null?void 0:u.process)==null?void 0:p.flowData,"flow-history":(d=_(t))==null?void 0:d.flowHistory,view:"","show-legend":""},null,8,["model-value","flow-history"])):E("",!0),l.value==="timeline"?(V(),R(Y,{key:2},[r.value.length?(V(),O(s,{key:0},{default:C(()=>[(V(!0),R(Y,null,ee([...r.value].reverse(),f=>(V(),O(D,{key:f.id,timestamp:f.endTime,placement:"top"},{default:C(()=>[L(h,null,{default:C(()=>{var N,I,T;return[q("div",null,G(f.assigneeName)+" 开始处理 ["+G(f.taskNodeName)+"] 环节 ",1),f.duration?(V(),R("div",$t," 办理时长："+G(f.duration),1)):E("",!0),f.type&&((N=f.comment)!=null&&N.handleComment)?(V(),R("div",Lt,G((I=i(f.type))==null?void 0:I.label)+"意见："+G((T=f.comment)==null?void 0:T.handleComment),1)):E("",!0)]}),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:1})):(V(),O(n,{key:1}))],64)):E("",!0)])],64)}}});const Ot=fe(Tt,[["__scopeId","data-v-a1713c28"]]),St={FlowDesign:{},FormDesign:{},FlowForm:Ct,request:{},tabs:[{label:"审批表单",prop:"formTab",component:It},{label:"附件资料",prop:"fileTab",component:Ut},{label:"流程跟踪",prop:"trackTab",component:Ot}],useFlowFormOptions:{type:"drawer",window:["","flow-form","left=0,top=0,width=1600,height=900"],overlay:{width:"80%",size:"80%",top:"100px",fullscreen:!0,destroyOnClose:!0}},tableOption:{align:"center",border:!0,card:!0,stripe:!0,searchMenuSpan:6,span:24},upload:{props:{fileName:"fileOriginalName",fileType:"fileType",fileSize:"fileSize",fileUrl:"fileUrl",res:"res.data"}}};function Kt(e){const t={list:"/sapier-flow/flow-user-common/list",save:"/sapier-flow/flow-user-common/save",update:"/sapier-flow/flow-user-common/update",remove:"/sapier-flow/flow-user-common/remove",batchUpdate:"/sapier-flow/flow-user-common/batchUpdate"},l=i=>e.get(t.list,{params:{type:i,ascs:"sort"}});return{url:t,getList:l,useList:i=>te(()=>l(i.value).then(c=>c.data.records),{refreshDeps:[i]}),create:i=>e.post(t.save,i),update:i=>e.post(t.update,i),remove:i=>e.post(t.remove,{},{params:{ids:i}}),batchUpdate:i=>e.post(t.batchUpdate,i)}}var Oe=(e=>(e.默认="default",e.主要="primary",e.成功="success",e.警告="warning",e.危险="danger",e.信息="info",e.文字="text",e))(Oe||{}),Pt=(e=>(e.保存草稿="flow_draft",e.发送="flow_pass",e.退回="flow_reject",e.终止="flow_terminate",e.撤销="flow_revoke",e.撤回到发起="flow_withdraw",e.打印="flow_print",e.转办="flow_transfer",e.加签="flow_add_instance",e.减签="flow_del_instance",e.指定回退="flow_rollback",e.绿色通道="flow_green",e))(Pt||{}),ve=(e=>(e.显示="true",e.隐藏="false",e.发起人="startUser",e.处理人="assignee",e.已办="done",e.待办="todo",e.未发起="notstarted",e.已发起="started",e.未办结="unfinished",e.已办结="finished",e))(ve||{}),be=(e=>(e.不显示="false",e.指定节点="specifyNode",e.审批人="assignee",e.传阅人="circulate",e.意见="comment",e))(be||{}),Se=(e=>(e[e.禁用=0]="禁用",e[e.正常=1]="正常",e))(Se||{});function Ke(e){const t={list:"/sapier-flow/dev-button/list",save:"/sapier-flow/dev-button/save",update:"/sapier-flow/dev-button/update",remove:"/sapier-flow/dev-button/remove"},l=m=>e.get(t.list,{params:m});return{url:t,getList:l,useList:()=>te(()=>l({size:-1,ascs:"sort"}).then(m=>m.data.records)),create:m=>e.post(t.save,m),update:m=>e.post(t.update,m),remove:m=>e.post(t.remove,{},{params:{ids:m}})}}function jt(e){const t={list:"/sapier-flow/flow-file/list",save:"/sapier-flow/flow-file/save",remove:"/sapier-flow/flow-file/remove"};return{getList:w=>e.get(t.list,{params:w}),create:w=>e.post(t.save,w),remove:w=>e.post(t.remove,{},{params:{ids:w}})}}function ie(e){const t={list:"/sapier-flow/flow-param/list",save:"/sapier-flow/flow-param/save",update:"/sapier-flow/flow-param/update",remove:"/sapier-flow/flow-param/remove",all:"/sapier-flow/flow-param/getAllParam",key:"/sapier-flow/flow-param/getParam"},l=c=>e.get(t.list,{params:c}),y=()=>e.get(t.all),r=c=>e.get(t.key,{params:{paramKey:c}});return{url:t,getList:l,getAllParam:y,getParam:r,useParam:c=>te(()=>r(c).then(k=>k.data)),create:c=>e.post(t.save,c),update:c=>e.post(t.update,c),remove:c=>e.post(t.remove,{},{params:{ids:c}})}}var se=(e=>(e[e.已办=1]="已办",e[e.待办=2]="待办",e[e.失败=3]="失败",e[e.撤销=4]="撤销",e[e.终止=5]="终止",e))(se||{}),pe=(e=>(e[e.已办结=1]="已办结",e[e.未办结=2]="未办结",e[e.已终止=3]="已终止",e))(pe||{}),At=(e=>(e[e.系统执行=1]="系统执行",e[e.用户办理=2]="用户办理",e[e.任务撤销=3]="任务撤销",e[e.任务退回=4]="任务退回",e[e.流程终止=5]="流程终止",e[e.任务转办=6]="任务转办",e[e.绿色通道=7]="绿色通道",e))(At||{});function _e(e){const t={publishList:"/sapier-flow/flow-run/queryPublishFlowList",taskList:"/sapier-flow/flow-run/userTaskList",detail:"/sapier-flow/flow-run/queryPublishFlowDetail",approvalNode:"/sapier-flow/flow-run/queryApprovalNode",start:"/sapier-flow/flow-run/startProcess",commit:"/sapier-flow/flow-run/commitTask",draft:"/sapier-flow/flow-run/saveDraft",revoke:"/sapier-flow/flow-run/revokeTask",terminate:"/sapier-flow/flow-run/terminateFlow",withdraw:"/sapier-flow/flow-run/withdrawToStart",transfer:"/sapier-flow/flow-run/transferTask",reject:"/sapier-flow/flow-run/rollbackTask",green:"/sapier-flow/flow-run/greenTask"},l=s=>e.get(t.detail,{params:s}),y=s=>e.post(t.approvalNode,s),r=s=>e.post(t.start,s),w=s=>e.post(t.commit,s),o=s=>e.post(t.draft,s),m=s=>e.post(t.revoke,s),i=s=>e.post(t.terminate,s),c=s=>e.post(t.withdraw,s),k=s=>e.post(t.transfer,s),v=s=>e.post(t.reject,s),a=s=>e.post(t.green,s),b=()=>e.get(t.publishList);return{url:t,getFlowDetail:l,getApprovalNode:y,startTask:r,commitTask:w,saveDraft:o,revokeTask:m,terminateTask:i,withdrawTask:c,transferTask:k,rejectTask:v,greenChannel:a,getPublishList:b,usePublishList:()=>te(()=>b().then(s=>s.data)),getTaskList:s=>e.get(t.taskList,{params:s})}}function zt(e){const t={tree:"/sapier-flow/flow-user/tree"},l=r=>e.get(t.tree,{params:{filter:r}});return{url:t,getUserTree:l,useUserTree:()=>te(()=>l().then(r=>r.data))}}var ye=(e=>(e.ASSIGN_ID="ASSIGN_ID",e.ASSIGN_UUID="ASSIGN_UUID",e.AUTO="AUTO",e.INPUT="INPUT",e.NONE="NONE",e))(ye||{}),we=(e=>(e.bigint="bigint",e.blob="blob",e.char="char",e.date="date",e.datetime="datetime",e.decimal="decimal",e.double="double",e.enum="enum",e.float="float",e.int="int",e.longblob="longblob",e.longtext="longtext",e.mediumblob="mediumblob",e.mediumint="mediumint",e.mediumtext="mediumtext",e.set="set",e.smallint="smallint",e.text="text",e.time="time",e.timestamp="timestamp",e.tinyblob="tinyblob",e.tinyint="tinyint",e.tinytext="tinytext",e.varbinary="varbinary",e.varchar="varchar",e.year="year",e))(we||{});function na(e){const t={list:"/sapier-flow/dev-table/list",save:"/sapier-flow/dev-table/save",update:"/sapier-flow/dev-table/update",remove:"/sapier-flow/dev-table/remove",deploy:"/sapier-flow/dev-table/deploy",getFields:"/sapier-flow/dev-table/getTableFields"},l=c=>e.get(t.list,{params:c});return{url:t,getList:l,useList:()=>te(()=>l({size:-1}).then(c=>c.data.records)),create:c=>e.post(t.save,c),update:c=>e.post(t.update,c),remove:c=>e.post(t.remove,{},{params:{ids:c}}),deploy:c=>e.post(t.deploy,c),getFields:c=>e.get(t.getFields,{params:c})}}var Pe=(e=>(e[e.否=0]="否",e[e.是=1]="是",e))(Pe||{});const de=J(Pe),sa=J(we),ra=J(ye),Bt=Ue(St);function W(e){return Ye(Bt,e)}const ua=X({rowKey:"id",labelWidth:150,column:[{label:"按钮名称",prop:"name",search:!0},{label:"按钮标识",prop:"buttonKey",search:!0},{label:"按钮图标",prop:"icon",component:"icon-select"},{label:"按钮类型",prop:"buttonType",type:"select",dicData:J(Oe)},{label:"默认显示条件",prop:"display",type:"select",multiple:!0,dataType:"string",value:"false",dicData:J(ve),tip:"选择多个时,所有条件都满足才显示",labelTip:`显示: 始终显示;<br/>隐藏: 始终隐藏;<br/>
      发起人: 用户为发起人时显示;<br/>处理人: 用户为处理人时显示;<br/>
      已办: 任务状态为已办时显示;<br/>待办: 任务状态为待办时显示;<br/>
      未发起: 流程未发起时显示;<br/>已发起: 流程已发起时显示;<br/>
      未办结: 流程未办结时显示;<br/>已办结: 流程已办结时显示;`},{label:"默认审批窗口显示",prop:"approval",type:"select",multiple:!0,dataType:"string",value:"false",dicData:J(be),labelTip:`不显示: 不显示审批窗口;<br/>指定节点: 显示指定节点选择框(常用于绿色通道等);<br/>
      审批人: 显示审批人选择框;<br/>传阅人: 显示传阅人选择框;<br/>意见: 显示意见输入框;`},{label:"备注",prop:"remarks",overHidden:!0},{label:"排序",prop:"sort",type:"number",value:0},{label:"状态",prop:"status",type:"switch",value:1,dicData:J(Se)},{label:"按钮预览",prop:"buttonPreview",width:150}]}),je={menuBtn:!1,span:24,column:[{label:"流程名称",prop:"flowName",rules:[{required:!0,message:"请输入流程名称"}]},{label:"流程标识",prop:"flowKey",editDisabled:!0,rules:[{required:!0,message:"请输入流程标识"}]},{label:"流程分类",prop:"categoryId",type:"select",dicUrl:"/sapier-flow/flow-category/list",dicQuery:{size:-1},props:{label:"name",value:"id"}},{label:"流程图标",prop:"flowIcon",component:"icon-select"},{label:"流程描述",prop:"remarks"},{label:"自定义表单",prop:"formPath"},{label:"关联表",prop:"formDataTable",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicUrl:"/sapier-flow/dev-table/list",dicQuery:{size:-1},props:{label:"tableComment",value:"tableName",desc:"tableName",res:"data.records"}},{label:"排序",prop:"sort",type:"number",width:110},{label:"表单设计",prop:"formOption",display:!1,hide:!0},{label:"模型设计",prop:"flowData",display:!1,hide:!0}]},ia=X({rowKey:"flowModuleId",dialogFullscreen:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuWidth:100,menuType:"menu",menuBtnTitle:"操作",column:[...je.column.map((e,t)=>({...e,search:t<2})),{label:"流程主版本",prop:"mainVersion",formatter(e,t){return t?`V${t||""}`:""}}]}),ca=X({rowKey:"flowDeloyId",dialogFullscreen:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuWidth:100,menuType:"menu",menuBtnTitle:"操作",column:[...je.column,{label:"流程版本",prop:"version",formatter(e,t){return t?`V${t||""}`:""}},{label:"是否主版本",prop:"mainVersion",type:"select",dicData:[{label:"否",value:0},{label:"是",value:1}]}]}),pa=X({rowKey:"id",menu:!1,addBtn:!1,column:[{label:"流程名称",prop:"flowName"},{label:"流程标识",prop:"flowKey"},{label:"流程分类",prop:"categoryId",type:"select",search:!0,dicUrl:"/sapier-flow/flow-category/list",props:{label:"name",value:"id"}},{label:"标题",prop:"processTitle",search:!0},{label:"流水号",prop:"serialNumber"},{label:"当前节点",prop:"taskNodeName"},{label:"审批人",prop:"assigneeName"},{label:"申请人",prop:"applyUserName"},{label:"接收时间",prop:"startTime"},{label:"任务状态",prop:"status",type:"select",search:!0,searchValue:se.待办,dicUrl:"/sapier-flow/flow-param/getParam",dicQuery:{paramKey:"flow.task.status"}}]}),da=X({rowKey:"id",column:[{label:"配置名称",prop:"paramName",search:!0},{label:"配置Key",prop:"paramKey",search:!0},{label:"备注",prop:"remark"},{label:"系统内置",prop:"paramType",type:"switch",dicData:de},{label:"配置值",prop:"paramValue",type:"textarea",maxRows:20,span:24,overHidden:!0}]}),ma=X({rowKey:"id",menu:!1,addBtn:!1,column:[{label:"流程名称",prop:"flowName"},{label:"流程标识",prop:"flowKey"},{label:"流程分类",prop:"categoryId",type:"select",search:!0,dicUrl:"/sapier-flow/flow-category/list",props:{label:"name",value:"id"}},{label:"标题",prop:"processTitle",search:!0},{label:"流水号",prop:"serialNumber"},{label:"当前节点",prop:"taskNodeName"},{label:"审批人",prop:"assigneeName"},{label:"申请人",prop:"applyUserName"},{label:"接收时间",prop:"startTime"}]});const fa=X({rowKey:"id",column:[{label:"流程标识",prop:"flowKey",search:!0},{label:"流程名称",prop:"flowName",search:!0},{label:"流程备注",prop:"remarks"},{label:"排序",prop:"sort"}]}),va=X({rowKey:"id",column:[{label:"表单标识",prop:"formKey",search:!0},{label:"表单名称",prop:"formName",search:!0},{label:"表单备注",prop:"remarks"},{label:"排序",prop:"sort",type:"number"}]}),De=[{label:"字段名称",prop:"name"},{label:"字段备注",prop:"comment"},{label:"字段类型",prop:"type",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:J(we)},{label:"字段长度",prop:"size",type:"number"},{label:"小数位",prop:"point",type:"number"},{label:"默认值",prop:"default"},{label:"是否主键",prop:"primary",type:"switch",dicData:de,value:0},{label:"是否允许为空",prop:"permitNull",type:"switch",dicData:de,value:1}],ba=X({rowKey:"id",dialogFullscreen:!0,column:[{label:"表名",prop:"tableName",search:!0},{label:"表注释",prop:"tableComment",search:!0},{label:"表引擎",prop:"tableEngine"},{label:"表主键策略",prop:"tablePrimary",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:J(ye)},{label:"数据库字段",prop:"editFields",hide:!0,type:"dynamic",children:{column:De}},{label:"默认字段",prop:"defaultFields",hide:!0,type:"dynamic",children:{addBtn:!1,delBtn:!1,column:De}}]});function Ae(e){return new Promise((t,l)=>{_(e).validate((r,w,o)=>{r?(w(),t(o)):l(o)})})}function H(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}export{zt as A,ye as B,St as C,we as D,X as E,Te as F,de as G,At as H,sa as I,ra as J,Vt as K,he as L,Ot as M,It as N,Ut as O,pt as P,mt as Q,ft as R,Le as S,se as T,vt as U,H as V,Pe as W,Ct as _,dt as a,Ae as b,W as c,Ke as d,ia as e,ca as f,na as g,je as h,pa as i,da as j,ie as k,ma as l,_e as m,fa as n,va as o,ba as p,Kt as q,Oe as r,Pt as s,ua as t,F as u,ve as v,be as w,Se as x,jt as y,pe as z};
