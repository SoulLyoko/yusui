import{u as L,d as M,v as h,C as x,N as n,M as k,r as G,b as S,E as m,O as g,x as j,y as A,F as R,L as Y,X as W,H as re,V as ee,a3 as F,j as P,a as N,I as ce,B as q,a8 as te,al as ne,n as oe,q as ue}from"./framework.8186f3e6.js";import{u as H,D as le,_ as pe,a as de,b as me,c as _e}from"./preview.vue_vue_type_script_lang.665084c2.js";import{m as xt,o as Ot,d as Et,e as Tt,f as Lt,g as St,i as Mt,n as Rt,p as Ht,r as It,s as Ut,h as jt,t as At,j as Bt,k as Ft,l as zt}from"./preview.vue_vue_type_script_lang.665084c2.js";import{a as fe,c as X,d as ae,j as Z,e as ve,h as he}from"./tree.e5db9369.js";import{J as Pt,K as Nt,_ as qt,L as Gt,l as Jt,n as Kt,b as Xt,q as Zt,r as Qt,t as Yt,A as en,x as tn,B as nn,C as on,m as ln,f as an,g as sn,D as rn,i as cn,o as un,M as pn,v as dn,z as mn,p as _n,k as fn,E as vn,F as hn,s as yn,G as bn,H as gn,I as kn,u as wn,w as Cn,y as $n}from"./tree.e5db9369.js";import{c as J}from"./cloneDeep.db6cf4d9.js";import{E as ye}from"./index.vue_vue_type_script_setup_true_lang.aec2c666.js";import{a as se,b as be,w as ge}from"./index.ada82d55.js";import{DiffEditor as ke}from"./index.d9796dc0.js";import{o as we}from"./omitBy.aafcb0f1.js";import{l as Ce}from"./baseGet.e83040d0.js";import"./index.b942cce0.js";import{d as $e}from"./union.9f83690a.js";import{s as Q}from"./set.ad1c0b91.js";import{i as De}from"./isEqual.96b99e0b.js";import{g as Ve}from"./get.5593a79f.js";import"./vue.runtime.esm-browser.prod.fe8ce6c7.js";import"./index.ad30fe90.js";import"./merge.15f42ebb.js";import"./Uint8Array.39e9cc9e.js";import"./baseSet.d668f401.js";import"./initCloneObject.aeaec503.js";import"./basePickBy.d0280f3c.js";import"./omit.0173e042.js";import"./getTag.6fa85dac.js";import"./index.7688d0ba.js";import"./use-form-item.dfa88de6.js";import"./isNil.c75b1b34.js";import"./fromPairs.e099444b.js";import"./kebabCase.1b42c686.js";import"./createCompounder.4d4aabd3.js";import"./pick.59b93e05.js";import"./pickBy.80d84980.js";function K($,l){const{parentWhiteList:_,parentBlackList:i}=($==null?void 0:$.rules)??{},{childWhiteList:u,childBlackList:a}=(l==null?void 0:l.rules)??{},p=[];if(_&&l){const s=_.includes((l==null?void 0:l.name)??"");p.push(s)}if(i&&l){const s=i.includes((l==null?void 0:l.name)??"");p.push(!s)}if(u){const s=u.includes(($==null?void 0:$.name)??"");p.push(s)}if(a){const s=a.includes(($==null?void 0:$.name)??"");p.push(!s)}return p.every(s=>s)}const wt=L({__name:"index",props:{modelValue:{},setterType:{}},setup($){const _=se($),{modelValue:i}=_,u={column:[{label:"名称",prop:"label"},{label:"值",prop:"value"}]},a={props:{value:"id"},formOption:{column:[{label:"名称",prop:"label"},{label:"值",prop:"value"}]}},p=M({});function s(r,c){r(),setTimeout(()=>{(c==="add"||c==="parentAdd")&&(p.value.id=fe())},100)}const D=(r,c,d)=>d(),y=(r,c,d)=>d(),E=(r,c)=>c();return(r,c)=>{const d=k("avue-tree"),f=k("avue-dynamic");return r.setterType=="tree"?(h(),x(d,{key:0,modelValue:p.value,"onUpdate:modelValue":c[0]||(c[0]=C=>p.value=C),data:n(i),option:a,"before-open":s,onSave:D,onUpdate:y,onDel:E},null,8,["modelValue","data"])):(h(),x(f,{key:1,children:u,"model-value":n(i)||[],"onUpdate:modelValue":c[1]||(c[1]=C=>i.value=C)},null,8,["model-value"]))}}}),xe={class:"resource-list"},Oe={class:"resource-item"},Ee=L({__name:"resource",setup($){const{groupList:l,resources:_,elementTree:i,workType:u,setActiveElement:a,recordHistory:p,getResource:s}=H(),D=M(""),y=G(()=>{const c=Object.values(_.value).filter(d=>{const{name:f,title:C,keywords:V}=d,w=[f,C,V].filter(b=>b).join(",");return!d.disabled&&(w==null?void 0:w.includes(D.value))});return l.value.map(d=>({label:d,children:c.filter(f=>f.group===d).map((f,C)=>({...f,priority:f.priority??C})).sort((f,C)=>f.priority-C.priority)})).filter(d=>d.children.length)});function E(c){var f,C;if(u.value!=="design")return;const d=X(c);(C=(f=i.value)==null?void 0:f.children)==null||C.push(d),a(d),p("added")}function r({draggedContext:c,relatedContext:d}){var f;return K(s(c.element.name),s((f=d.component.componentData)==null?void 0:f.name))}return(c,d)=>{const f=k("el-input"),C=k("el-button"),V=k("el-collapse-item"),w=k("el-collapse");return h(),S("div",xe,[m(f,{modelValue:D.value,"onUpdate:modelValue":d[0]||(d[0]=b=>D.value=b),"suffix-icon":"el-icon-search",placeholder:"搜索组件"},null,8,["modelValue"]),m(w,{"model-value":y.value.map(b=>b.label)},{default:g(()=>[(h(!0),S(j,null,A(y.value,b=>(h(),x(V,{key:b.label,title:b.label,name:b.label},{default:g(()=>[m(n(le),{list:b.children,group:{name:"components",pull:"clone",put:!1},clone:n(X),sort:!1,"item-key":"name",move:r},{item:g(({element:t})=>[R("div",Oe,[m(C,{icon:t.icon,onClick:e=>E(t)},{default:g(()=>[Y(W(t.title),1)]),_:2},1032,["icon","onClick"])])]),_:2},1032,["list","clone"])]),_:2},1032,["title","name"]))),128))]),_:1},8,["model-value"])])}}}),Te=["onMouseover"],Le={class:"item-label"},Se={class:"item-actions"},Me=L({__name:"tree",setup($){const{elementTree:l,activeElement:_,hoverElement:i,setActiveElement:u,recordHistory:a,getResource:p}=H(),s=G(()=>[J(l.value)]);function D(t,e,o){return e.data.isRoot?!1:o==="inner"?K(p(t.data.name),p(e.data.name)):!0}const y=M();re(()=>{var t,e;(e=y.value)==null||e.setCurrentKey((t=_.value)==null?void 0:t.id)});function E(t){u(t)}function r(){l.value=s.value[0]}function c(t){var o;const e=ae(t.data);(o=y.value)==null||o.append(e,t.parent),r(),u(e),a("added")}function d(t){var e;(e=y.value)==null||e.remove(t),r(),u(),a("removed")}function f(t){var e;(e=t.data.children)!=null&&e.length&&(t.data.children.forEach(o=>{var v;return(v=y.value)==null?void 0:v.remove(o)}),r(),u(t.data),a("clear"))}function C(){r(),a("moved")}const V=[{name:"copy",type:"primary",icon:"el-icon-copy-document",handler:c},{name:"delete",type:"danger",icon:"el-icon-delete",handler:d},{name:"clear",type:"warning",icon:"el-icon-folder-delete",handler:f}];function w(t){return V.filter(e=>b(t,e.name))}function b(t,e){const{disabledActions:o,isContainer:v}=p(t.name)??{},T=!(o!=null&&o.includes(e));return e==="clear"?v&&T:T}return(t,e)=>{const o=k("el-link");return h(),x(n(ye),{ref_key:"treeRef",ref:y,class:"component-tree","node-key":"id",data:s.value,"default-expand-all":"",draggable:"","expand-on-click-node":!1,"allow-drop":D,onNodeClick:E,onNodeDrop:C},{default:g(({node:v,data:T})=>{var I,O;return[R("div",{class:"tree-item",onMouseover:U=>i.value=T||{},onMouseleave:e[0]||(e[0]=U=>i.value={})},[R("div",Le,W(((I=T.props)==null?void 0:I.label)||((O=n(p)(T.name))==null?void 0:O.title)),1),R("div",Se,[(h(!0),S(j,null,A(w(T),U=>(h(),x(o,ee({key:U.name,underline:!1},U,{onClick:F(B=>U.handler(v),["stop"])}),null,16,["onClick"]))),128))])],40,Te)]}),_:1},8,["data"])}}}),Re={init:"初始化",added:"添加组件",moved:"移动组件",removed:"删除组件",property:"修改属性",clear:"清空子组件"},Ct={copy:"复制",delete:"删除",clear:"清空"},He={class:"history-list"},Ie=["onClick"],Ue=L({__name:"history",setup($){const{historyList:l,historyIndex:_,restoreHistory:i}=H(),u=be("history-show-source",!1),a={renderValidationDecorations:"off",readOnly:!0},p=G(()=>document.documentElement.className.includes("dark")?"vs-dark":"light");return(s,D)=>{const y=k("el-switch"),E=k("el-tooltip");return h(),S("div",He,[Y(" 显示源码："),m(y,{modelValue:n(u),"onUpdate:modelValue":D[0]||(D[0]=r=>P(u)?u.value=r:null)},null,8,["modelValue"]),(h(!0),S(j,null,A(n(l),(r,c)=>(h(),x(E,{key:r.timestamp,disabled:!n(u),effect:"light",placement:"right"},{content:g(()=>[m(n(ke),{original:n(Z)(n(l)[c-1]),modified:n(Z)(r),theme:p.value,options:a,language:"javascript",width:"800px",height:"600px"},null,8,["original","modified","theme"])]),default:g(()=>[R("div",{class:N(["history-item",{"is-active":c===n(_)}]),onClick:d=>n(i)(c)},[R("span",null,W(n(Re)[r.type]),1),R("span",null,W(new Date(r.timestamp).toLocaleString()),1)],10,Ie)]),_:2},1032,["disabled"]))),128))])}}}),je=L({__name:"index",setup($){const l=[{title:"组件",icon:"el-icon-menu",component:Ee},{title:"大纲",icon:"el-icon-operation",component:Me},{title:"历史",icon:"el-icon-clock",component:Ue}];return(_,i)=>{const u=k("el-link"),a=k("el-tab-pane"),p=k("el-tabs");return h(),x(p,{"tab-position":"top",stretch:""},{default:g(()=>[(h(),S(j,null,A(l,s=>m(a,{key:s.title},{label:g(()=>[m(u,{title:s.title,icon:s.icon,underline:!1,style:{color:"inherit"}},null,8,["title","icon"])]),default:g(()=>[(h(),x(ce(s.component)))]),_:2},1024)),64))]),_:1})}}}),Ae={class:"item-actions"},ie=L({__name:"design",props:{list:{},componentData:{}},emits:["update:active","update:list"],setup($,{emit:l}){const _=$,{list:i}=se(_,l,{passive:!0,deep:!0}),{activeElement:u,hoverElement:a,formOption:p,setActiveElement:s,recordHistory:D,getResource:y}=H();function E(e){const o={...J(p.value),span:24,menuBtn:!1},{designOption:v}=y(e.name)??{};if(typeof v=="object")return{...o,...v};if(typeof v=="function")return{...o,...v(e)};{const T=[];return e.props&&T.push({...we(e.props,Ce),span:24}),{...o,column:T}}}function r(e){var o,v;return(o=y(e.name))!=null&&o.isContainer?24:((v=e.props)==null?void 0:v.span)||p.value.span||24}async function c(e){var v;const o=Object.keys(e)[0];o&&(s(),await oe(),s((v=e[o])==null?void 0:v.element),D(o))}function d(e){const o=ae(e);i.value.push(o),s(o),D("added")}function f(e,o){i.value.splice(o,1),s(i.value[o]??i.value[o-1]),D("removed")}function C(e){var o;(o=e.children)!=null&&o.length&&(e.children=[],s(e),D("clear"))}function V({draggedContext:e,relatedContext:o}){var v;return K(y(e.element.name),y((v=o.component.componentData)==null?void 0:v.name))}const w=[{name:"copy",type:"primary",icon:"el-icon-copy-document",handler:d},{name:"delete",type:"danger",icon:"el-icon-delete",handler:f},{name:"clear",type:"warning",icon:"el-icon-folder-delete",handler:C}];function b(e){return w.filter(o=>t(e,o.name))}function t(e,o){const{disabledActions:v,isContainer:T}=y(e.name)??{},I=!(v!=null&&v.includes(o));return o==="clear"?T&&I:I}return(e,o)=>{const v=k("avue-form"),T=k("el-button"),I=k("el-col");return h(),x(n(le),{list:n(i),class:N(["el-row draggable-list",{"is-empty":!n(i).length,"is-root":e.componentData.isRoot}]),group:{name:"components"},"component-data":e.componentData,"item-key":"id",move:V,onChange:c},{item:g(({element:O,index:U})=>[m(I,{class:N(["draggable-item",{"is-active":n(u).id===O.id,"is-hover":n(a).name&&n(a).id===O.id}]),span:r(O),onClick:F(B=>n(s)(O),["stop"]),onMouseover:F(B=>a.value=O||{},["stop"]),onMouseleave:o[0]||(o[0]=F(B=>a.value={},["stop"]))},{default:g(()=>{var B;return[O.name!=="form"?(h(),x(v,{key:0,option:E(O)},null,8,["option"])):q("",!0),(B=n(y)(O.name))!=null&&B.isContainer?(h(),x(ie,{key:1,class:"is-container","component-data":O,list:O.children??[],"onUpdate:list":z=>O.children=z},null,8,["component-data","list","onUpdate:list"])):q("",!0),te(R("div",Ae,[(h(!0),S(j,null,A(b(O),z=>(h(),x(T,ee({key:z.name},z,{circle:"",plain:"",onClick:F(Pe=>z.handler(O,U),["stop"])}),null,16,["onClick"]))),128))],512),[[ne,n(u).id===O.id]])]}),_:2},1032,["class","span","onClick","onMouseover"])]),_:1},8,["list","class","component-data"])}}}),Be=L({__name:"source",setup($){const{modelValue:l,setActiveElement:_}=H();return(i,u)=>(h(),x(n(ve),{modelValue:n(l),"onUpdate:modelValue":[u[0]||(u[0]=a=>P(l)?l.value=a:null),u[1]||(u[1]=a=>n(_)())],"value-type":"object"},null,8,["modelValue"]))}}),Fe=L({__name:"index",setup($){const{elementTree:l,workType:_,setActiveElement:i}=H();return(u,a)=>n(_)==="preview"?(h(),x(pe,{key:0})):n(_)==="source"?(h(),x(Be,{key:1})):(h(),x(ie,{key:2,"component-data":n(l),list:n(l).children??[],"onUpdate:list":a[0]||(a[0]=p=>n(l).children=p),onClick:a[1]||(a[1]=F(p=>n(i)(),["stop"]))},null,8,["component-data","list"]))}}),ze=L({__name:"index",setup($){const l=H(),{elementTree:_,activeElement:i,baseOption:u,advanceOption:a,resolveSettings:p,recordHistory:s,getResource:D}=l,y=M(!1),E=M(""),r=M(0),c=M({}),d=M({labelPosition:"left",labelWidth:100,menuBtn:!1,span:24,tabs:!0,group:[]});ue(()=>i.value.id,async()=>{y.value=!0,r.value=0,await oe();const{settings:V,disabledSettings:w}=D(i.value.name)??{},b={label:"基础",prop:"base",column:u.value},t={label:"属性",prop:"component",column:p(V)},e={label:"高级",prop:"advance",column:a.value},o=[b,t,e].filter(v=>!(w!=null&&w.includes(v.prop)));d.value.group=o,E.value=o[0].prop,c.value=J(i.value.props),y.value=!1},{immediate:!0});const f=$e(()=>s("property"),1e3);ge(c,V=>{const w=he(V,[void 0,null,""],["$"]);if(i.value.isRoot)Q(_.value,"props",w);else{const b=C(_.value,i.value.id)??[];b.length&&!De(w,Ve(_.value,b.concat("props")))&&Q(_.value,b.concat("props"),w)}r.value&&f(),r.value++},{deep:!0,debounce:100});function C(V,w){if(V.id===w)return[];if(V.children)for(const b in V.children){const t=C(V.children[b],w);if(t)return["children",b].concat(t)}}return(V,w)=>{const b=k("avue-form");return y.value?q("",!0):(h(),x(b,{key:0,modelValue:c.value,"onUpdate:modelValue":w[0]||(w[0]=t=>c.value=t),class:"settings-form",option:d.value},null,8,["modelValue","option"]))}}}),We=L({__name:"index",setup($){const{elementTree:l,workType:_,deviceType:i,historyList:u,historyIndex:a,restoreHistory:p,resetHistory:s}=H(),D=[{label:"PC端",value:"pc",icon:"el-icon-monitor"},{label:"移动端",value:"mobile",icon:"el-icon-cellphone"}],y=[{label:"设计",value:"design",icon:"el-icon-brush"},{label:"源码",value:"source",icon:"el-icon-more"},{label:"预览",value:"preview",icon:"el-icon-view"}];return(E,r)=>{const c=k("el-button"),d=k("el-button-group"),f=k("el-col"),C=k("el-link"),V=k("el-radio-button"),w=k("el-radio-group"),b=k("el-row");return h(),x(b,{gutter:20},{default:g(()=>[m(f,{span:8,style:{"align-self":"center"}},{default:g(()=>[m(d,{size:"small"},{default:g(()=>{var t;return[m(c,{disabled:n(a)===0,title:"撤回",icon:"el-icon-arrow-left",onClick:r[0]||(r[0]=e=>n(p)(n(a)-1))},null,8,["disabled"]),m(c,{disabled:n(a)===n(u).length-1,title:"重做",icon:"el-icon-arrow-right",onClick:r[1]||(r[1]=e=>n(p)(n(a)+1))},null,8,["disabled"]),m(c,{disabled:!((t=n(l).children)!=null&&t.length),title:"清空",icon:"el-icon-delete",onClick:r[2]||(r[2]=e=>n(s)())},null,8,["disabled"])]}),_:1})]),_:1}),m(f,{span:8,style:{"text-align":"center"}},{default:g(()=>[m(w,{modelValue:n(i),"onUpdate:modelValue":r[3]||(r[3]=t=>P(i)?i.value=t:null),size:"small",style:{"font-size":"unset"}},{default:g(()=>[(h(),S(j,null,A(D,t=>m(V,{key:t.value,label:t.value},{default:g(()=>[m(C,{title:t.label,icon:t.icon,underline:!1,style:{color:"inherit"},onClick:e=>i.value=t.value},null,8,["title","icon","onClick"])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1}),m(f,{span:8,style:{"text-align":"right"}},{default:g(()=>[m(w,{modelValue:n(_),"onUpdate:modelValue":r[4]||(r[4]=t=>P(_)?_.value=t:null),size:"small",style:{"font-size":"unset"}},{default:g(()=>[(h(),S(j,null,A(y,t=>m(V,{key:t.value,label:t.value},{default:g(()=>[m(C,{title:t.label,icon:t.icon,underline:!1,style:{color:"inherit"},onClick:e=>_.value=t.value},null,8,["title","icon","onClick"])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),$t=L({__name:"index",props:{modelValue:{},groupList:{},resources:{},baseOption:{},advanceOption:{},leftWidth:{},rightWidth:{},adapterIn:{type:Function,default:de},adapterOut:{type:Function,default:me}},emits:["reset"],setup($,{emit:l}){const _=$,{workType:i,deviceType:u}=_e(_,l);return(a,p)=>{const s=k("el-aside"),D=k("el-header"),y=k("el-main"),E=k("el-container");return h(),x(E,{class:"form-design"},{default:g(()=>[m(s,{class:"left-panel",width:a.leftWidth},{default:g(()=>[m(je)]),_:1},8,["width"]),m(E,null,{default:g(()=>[m(D,{class:"main-header",height:"auto"},{default:g(()=>[m(We)]),_:1}),m(y,{class:"main-workspace"},{default:g(()=>[m(Fe,{class:N(`device-${n(u)}`)},null,8,["class"])]),_:1})]),_:1}),te(m(s,{class:"right-panel",width:a.rightWidth},{default:g(()=>[m(ze)]),_:1},8,["width"]),[[ne,n(i)=="design"]])]),_:1})}}});export{xt as ControlSetter,Ct as DesignActionMap,wt as DicDataSetter,Pt as DicTreeSetter,ve as EditorSetter,$t as FormDesign,Re as HistoryTypeMap,Ot as OnLoadSetter,Nt as RulesSetter,qt as SwitchSetter,Gt as ValueSetter,de as adapterIn,me as adapterOut,Et as advance,Jt as alignDic,Kt as array,Xt as base,Zt as cascader,K as checkRules,Qt as checkbox,X as cloneItem,Tt as color,ae as copyItem,Yt as date,en as daterange,tn as dates,nn as datetime,on as datetimerange,ln as dic,Lt as dynamic,an as form,fe as getRandomId,St as group,sn as groupList,rn as icon,cn as iconList,un as img,Mt as input,pn as jsonParse,Z as jsonStringify,dn as month,mn as monthrange,Rt as number,Ht as password,_n as placementDic,fn as positionDic,vn as radio,It as rate,hn as select,yn as sizeDic,Ut as slider,jt as switch,At as table,Bt as textarea,bn as time,gn as timerange,Ft as title,kn as tree,zt as upload,wn as url,Cn as week,$n as year};
