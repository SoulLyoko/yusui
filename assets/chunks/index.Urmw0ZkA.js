import{g as P,h as E,y as H,$ as ke,N as xe,d as W,D as V,o as T,b as I,c as U,I as _,w as x,F as B,a as J,m as f,a5 as N,t as ee,k as M,E as q,z as Te,a2 as K,M as de,n as te,J as De,e as ae,aa as me,ao as fe,P as be,a4 as Ce,a7 as $e}from"./framework.Zz1SbNKh.js";import{a as Z,e as Se,w as Oe}from"./index.8UZGHsZ4.js";import{e as ie,g as Le,a as $,f as Ee,h as Ie,_ as C,c as le,i as A,b as je,k as We,l as Re,m as Pe,n as Ae,o as Ue,q as ze,r as Be,t as Fe,u as Me,v as He,w as Ne,x as qe,y as Ge,z as Ke,A as Je,B as Qe,C as Xe,D as Ye,E as Ze,F as et,G as se,H as ve,d as ne,j as tt}from"./tree.oD2qG2eZ.js";import{J as Al,I as Ul,p as zl,s as Bl}from"./tree.oD2qG2eZ.js";import"./index.o5MRxqVR.js";import{DiffEditor as lt}from"./index.dun7Vczt.js";import{b as ot,f as at,a as nt}from"./form.E9ZHrNWz.js";import{_ as Ml,c as Hl}from"./form.E9ZHrNWz.js";import{c as R}from"./cloneDeep.r1x5-OIa.js";import{a as rt,b as it}from"./index.qJIJBhna.js";import{i as ye}from"./isEqual.GBRS_oe3.js";import{m as oe}from"./merge.etFcUWJt.js";import{o as pt}from"./omit.pAQ7TWyz.js";import{D as he}from"./vuedraggable.umd.ByMyj2qT.js";import{E as ut}from"./index.vue_vue_type_script_setup_true_lang.F2UiKoC9.js";import{o as st}from"./omitBy.5Vl3Jw6n.js";import{l as ct}from"./baseGet.aXQPWsrt.js";import{d as dt}from"./union.yiA3EQr_.js";import{s as ce}from"./set.trCNu2cT.js";import{g as mt}from"./get.ibBWnMyK.js";import"./index.-UPDG9fq.js";import"./fromPairs.E3iD47Fd.js";import"./isNil.-q_uwI5T.js";import"./kebabCase.e_ZWS89_.js";import"./createCompounder.UcKAPtLe.js";import"./index.S7m6xfB8.js";import"./use-global-config.Y-AjjM1T.js";import"./use-form-item.vuA-B32v.js";import"./Uint8Array.fNwniHUy.js";import"./arrayPush.9gUpYHDz.js";import"./baseSet.mp4sGx_T.js";import"./initCloneObject.MjDVq9Sj.js";import"./getTag.9nUBxPXw.js";import"./pickBy.firGk55j.js";import"./basePickBy.r2fGlmFx.js";import"./vue.runtime.esm-bundler._bGFGbU0.js";import"./typescript.cgwlg1u4.js";import"./pick.hwSZBMEn.js";const ft=Object.freeze(Object.defineProperty({__proto__:null,get array(){return We},get cascader(){return Re},get checkbox(){return Pe},get color(){return _t},get date(){return Ae},get daterange(){return Ue},get dates(){return ze},get datetime(){return Be},get datetimerange(){return Fe},get dynamic(){return Vt},get form(){return at},get group(){return wt},get icon(){return Me},get img(){return He},get input(){return kt},get month(){return Ne},get monthrange(){return qe},get number(){return xt},get password(){return Tt},get radio(){return Ge},get rate(){return Dt},get select(){return Ke},get slider(){return Ct},get switch(){return $t},get table(){return St},get textarea(){return Ot},get time(){return Je},get timerange(){return Qe},get title(){return Lt},get tree(){return Xe},get upload(){return Et},get url(){return Ye},get week(){return Ze},get year(){return et}},Symbol.toStringTag,{value:"Module"}));function Y(t){return t.map(o=>{var a;const e=R(o);e.name=e.name||e.component||e.type,e.id=e.id||ie(e.name);const u={name:e.name,id:e.id,isRoot:e.isRoot,props:e};return e.name==="form"?u.children=Y([...e.column??[],...e.group??[]]):e.name==="group"?u.children=Y(e.column??[]):["dynamic","table"].includes(e.name)?u.children=Y(((a=e.children)==null?void 0:a.column)??[]):Array.isArray(e.children)&&(u.children=Y(e.children)),u})}function re(t){return Y([{isRoot:!0,name:"form",id:ie("form"),...t}])[0]}function G(t){return t.map(o=>{var u,a,i;const e=R(o);if(e.props&&(e.props.prop=e.props.prop??e.id),e.name==="form"){const s=G(((u=e.children)==null?void 0:u.filter(p=>p.name!=="group"))??[]),n=G(((a=e.children)==null?void 0:a.filter(p=>p.name==="group"))??[]);return{...e.props,column:s.length?s:void 0,group:n.length?n:void 0}}if(e.name==="group"){const s=G(e.children??[]);return{...e.props,column:s}}else if(["dynamic","table"].includes(e.name??"")){const s=G(e.children??[]),n={...(i=e.props)==null?void 0:i.children,column:s};return{...e.props,children:n}}else if(Array.isArray(e.children))return{...e.props,children:G(e.children)};return{...e.props}})}function ge(t){return G([t])[0]??{}}function pe(t,o){const{parentWhiteList:e,parentBlackList:u}=(t==null?void 0:t.rules)??{},{childWhiteList:a,childBlackList:i}=(o==null?void 0:o.rules)??{},s=[];if(e&&o){const n=e.includes((o==null?void 0:o.name)??"");s.push(n)}if(u&&o){const n=u.includes((o==null?void 0:o.name)??"");s.push(!n)}if(a){const n=a.includes((t==null?void 0:t.name)??"");s.push(n)}if(i){const n=i.includes((t==null?void 0:t.name)??"");s.push(!n)}return s.every(n=>n)}const _e=Symbol("form-design-state");function bt(t,o){const e=Z(t),{modelValue:u}=e,a=P(()=>t.groupList||Le),i=P(()=>oe(R({...ft}),t.resources)),s=P(()=>oe(k(ot),k(t.baseOption))),n=P(()=>oe(k(gt),k(t.advanceOption))),p=E({}),r=E({}),b=E({}),l=P(()=>{var v;return pt((v=p.value)==null?void 0:v.props,["column","group"])??{}}),c=E([]),m=E(0),h=E("design"),S=E("pc");H(u,v=>{ye(p.value,re(v||{}))||(p.value=re(v||{}),Object.keys(r.value).length||D(),c.value.length||d("init"))},{immediate:!0,deep:!0}),H(p,()=>{u.value=ge(p.value)},{deep:!0});function O(v){if(v)return i.value[v]}function D(v){r.value=v??p.value??{}}function k(v){if(typeof v=="function"){const j={elementTree:p.value,activeElement:r.value};return R(v(j)??[])}else return R(v??[])}async function d(v){c.value.push({type:v,timestamp:Date.now(),active:R(r.value),tree:R(p.value),option:R(u.value??{})}),m.value=c.value.length-1}function w(v){const j=c.value.find((F,L)=>L===v);j&&(p.value=R(j.tree),r.value=R(j.active),m.value=v)}function y(){c.value=[],m.value=0,p.value={},r.value={},o("reset")}const g={groupList:a,resources:i,elementTree:p,activeElement:r,hoverElement:b,formOption:l,historyList:c,historyIndex:m,workType:h,deviceType:S,modelValue:u,baseOption:s,advanceOption:n,resolveSettings:k,setActiveElement:D,recordHistory:d,restoreHistory:w,resetHistory:y,getResource:O};return ke(_e,g),g}function z(){return xe(_e)}const vt=W({__name:"property-select",props:{tableData:{},dic:{}},setup(t){const o=t,{elementTree:e,baseOption:u,resolveSettings:a,getResource:i}=z(),s=P(()=>{var r;const n=rt([e.value],b=>{var l,c,m;return((l=b.props)==null?void 0:l.prop)===((m=(c=o.tableData)==null?void 0:c.row)==null?void 0:m.field)}),p=((r=i(n==null?void 0:n.name))==null?void 0:r.settings)??[];return[...u.value,...a(p)].filter(b=>b.prop).map(b=>({label:b.label,value:b.prop,desc:b.prop}))});return(n,p)=>{const r=V("avue-select");return T(),I(r,{dic:s.value,"allow-create":"",filterable:"","default-first-option":""},null,8,["dic"])}}}),yt=W({__name:"index",props:{modelValue:{default:""}},setup(t){const o=t,{modelValue:e}=Z(o),{elementTree:u}=z(),a=E(!1),i=E([]);H(e,()=>{var p,r,b;if(!e.value){i.value=[];return}try{const c=((b=(r=(p=Ee(e.value,{ecmaVersion:"latest"}).body[0])==null?void 0:p.expression)==null?void 0:r.body)==null?void 0:b.properties)??[];c!=null&&c.length&&(i.value=c.map(m=>m.value.properties.map(h=>{const S=Ie(h.value);return{field:m.key.name,property:h.key.name,value:S}})).flat())}catch{}},{immediate:!0}),H(i,()=>{var b;if(!a.value)return;const r=`(val, form) => ({
    ${[...new Set((b=i.value)==null?void 0:b.map(l=>l.field))].map(l=>{var m;const c=(m=i.value)==null?void 0:m.filter(h=>h.field===l);return`${l}: { ${c==null?void 0:c.map(h=>`${h.property}: ${h.value}`).join(", ")} }`}).join(`,
    `)}
})`;e.value=r},{deep:!0});const s=P(()=>{var r;return it(((r=u.value)==null?void 0:r.children)??[]).map(b=>{const{label:l,prop:c}=b.props??{};return{label:l,value:c,desc:c}})}),n=P(()=>({column:[{label:"受控字段",prop:"field",type:"select",dicData:s.value,rules:{required:!0}},{label:"受控属性",prop:"property",component:vt,rules:{required:!0}},{label:"表达式/值",prop:"value",component:$,tooltip:!0,rules:{required:!0}}]}));return(p,r)=>{const b=V("el-button"),l=V("avue-dynamic"),c=V("el-dialog");return T(),U(B,null,[_(b,{onClick:r[0]||(r[0]=m=>a.value=!0)},{default:x(()=>[J(" 编辑代码 ")]),_:1}),_(c,{modelValue:a.value,"onUpdate:modelValue":r[3]||(r[3]=m=>a.value=m),title:"控制字段属性"},{default:x(()=>[_(l,{modelValue:i.value,"onUpdate:modelValue":r[1]||(r[1]=m=>i.value=m),children:n.value},null,8,["modelValue","children"]),J(" 代码： "),_($,{modelValue:f(e),"onUpdate:modelValue":r[2]||(r[2]=m=>N(e)?e.value=m:null),"value-type":"function",height:"200px"},null,8,["modelValue"])]),_:1},8,["modelValue"])],64)}}}),jl=W({__name:"index",props:{modelValue:{default:()=>[]},setterType:{}},setup(t){const o=t,{modelValue:e}=Z(o),u={column:[{label:"名称",prop:"label"},{label:"值",prop:"value"}]},a={props:{value:"id"},formOption:{column:[{label:"名称",prop:"label"},{label:"值",prop:"value"}]}},i=E({});function s(b,l){b(),setTimeout(()=>{(l==="add"||l==="parentAdd")&&(i.value.id=ie())},100)}const n=(b,l,c)=>c(),p=(b,l,c)=>c(),r=(b,l)=>l();return(b,l)=>{const c=V("avue-tree"),m=V("avue-dynamic");return b.setterType==="tree"?(T(),I(c,{key:0,modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=h=>i.value=h),data:f(e),option:a,"before-open":s,onSave:n,onUpdate:p,onDel:r},null,8,["modelValue","data"])):(T(),I(m,{key:1,modelValue:f(e),"onUpdate:modelValue":l[1]||(l[1]=h=>N(e)?e.value=h:null),children:u},null,8,["modelValue"]))}}}),ht=W({__name:"index",props:{modelValue:{default:""},tableData:{}},setup(t){const o=t,{modelValue:e}=Z(o),u=E(!1),a=E({});H(e,()=>{var s,n;e.value&&(a.value=((n=(s=o.tableData)==null?void 0:s.row)==null?void 0:n.onLoadData)??{})},{immediate:!0}),H(a,()=>{var h;if(!u.value||!((h=o.tableData)!=null&&h.row)||(o.tableData.row.onLoadData=a.value,a.value.codeMode))return;const{url:s,method:n,isPage:p,currentPageKey:r,pageSizeKey:b,totalPath:l,dataPath:c}=a.value,m=`({ page, value, data }, callback) => {
    const params = page && ${p} ? { ${r}: page.currentPage, ${b}: page.pageSize } : {};
    this.$axios({ url: "${s}", method: "${n}", params }).then(res => {
        const data = this.getAsVal({ res }, "${c}");
        const total = this.getAsVal({ res }, "${l}");
        callback({ data, total });
    });
}`;e.value=m},{deep:!0});const i={span:24,menuBtn:!1,labelWidth:100,column:[{label:"请求地址",prop:"url"},{label:"请求方法",prop:"method",type:"radio",button:!0,value:"get",dicData:[{label:"GET",value:"get"},{label:"POST",value:"post"}]},{label:"是否分页",prop:"isPage",type:"switch",value:!0},{label:"当前页键名",prop:"currentPageKey",value:"current"},{label:"每页条数键名",prop:"pageSizeKey",value:"size"},{label:"总条数路径",prop:"totalPath",value:"res.data.total"},{label:"返回数据路径",prop:"dataPath",value:"res.data.records"},{label:"编辑代码模式",prop:"codeMode",type:"switch",value:!1,span:4,tip:"关闭时，代码根据以上参数自动生成。开启时，可自由编辑代码"}]};return(s,n)=>{const p=V("el-button"),r=V("avue-form"),b=V("el-dialog");return T(),U(B,null,[_(p,{onClick:n[0]||(n[0]=l=>u.value=!0)},{default:x(()=>[J(" 编辑代码 ")]),_:1}),_(b,{modelValue:u.value,"onUpdate:modelValue":n[3]||(n[3]=l=>u.value=l),title:"加载数据函数"},{default:x(()=>[_(r,{modelValue:a.value,"onUpdate:modelValue":n[1]||(n[1]=l=>a.value=l),option:i},null,8,["modelValue"]),J(" 代码： "),_($,{modelValue:f(e),"onUpdate:modelValue":n[2]||(n[2]=l=>N(e)?e.value=l:null),"value-type":"function",height:"200px",disabled:""},null,8,["modelValue"])]),_:1},8,["modelValue"])],64)}}}),gt=[{label:"控制其它字段",prop:"control",component:yt},{label:"值变化事件",prop:"change",component:$,tooltip:!0,defaultValue:"({ value, row }) => {}"},{label:"点击事件",prop:"click",component:$,tooltip:!0,defaultValue:"({ value, row  }) => {}"},{label:"获取焦点事件",prop:"focus",component:$,tooltip:!0,defaultValue:"({ value, row  }) => {}"},{label:"失去焦点事件",prop:"blur",component:$,tooltip:!0,defaultValue:"({ value, row  }) => {}"},{label:"其他属性",prop:"params",component:$,valueType:"object",tooltip:!0,defaultValue:"{}"},{label:"其他事件",prop:"event",component:$,valueType:"object",tooltip:!0,defaultValue:"{}"}],_t={name:"color",title:"颜色",icon:"el-icon-brush",group:"表单组件",props:{type:"color",label:"颜色"},settings:[{label:"支持透明度选择",prop:"showAlpha",component:C,defaultValue:!1,labelWidth:120},{label:"颜色格式",prop:"colorFormat",type:"select",dicData:[{label:"hsl",value:"hsl"},{label:"hsv",value:"hsv"},{label:"hex",value:"hex"},{label:"rgb",value:"rgb"}]},{label:"预定义颜色",prop:"predefine",type:"array"}]},Vt={name:"dynamic",title:"子表单",icon:"el-icon-grid",group:"表单组件",isContainer:!0,rules:{parentWhiteList:["form","group"],childBlackList:["group","dynamic"]},designOption:t=>{const{label:o,prop:e}=t.props??{};return{column:[{label:o,prop:e,type:"text"}]}},props:{type:"dynamic",label:"子表单",children:{column:[]}},settings:[{prop:"children",labelWidth:0,component:"avue-form",option:{labelWidth:100,menuBtn:!1,span:24,column:[{label:"展示类型",prop:"type",type:"radio",button:!0,value:"crud",dicData:[{label:"表格",value:"crud"},{label:"表单",value:"form"}],control(t){const o=t==="form",e=t==="crud";return{showHeader:{display:e},stripe:{display:e},border:{display:e},headerAlign:{display:e},align:{display:e},span:{display:o}}}},{label:"显示新增按钮",prop:"addBtn",component:C,defaultValue:!0},{label:"显示删除按钮",prop:"delBtn",component:C,defaultValue:!0},{label:"显示序号",prop:"index",type:"switch",control(t,o){return o.type==="crud"&&typeof t=="boolean"&&(o.index=t?"":!1),{}}},{label:"显示表头",prop:"showHeader",component:C,defaultValue:!0},{label:"表格边框",prop:"border",component:C,defaultValue:!0},{label:"斑马纹",prop:"stripe",component:C,defaultValue:!1},{label:"表头对齐方式",prop:"headerAlign",type:"radio",button:!0,dicData:le},{label:"对齐方式",prop:"align",type:"radio",button:!0,dicData:le},{label:"表单项栅格",prop:"span",type:"number"},{label:"空数据文字",prop:"emptyText",type:"number"}]}}]},wt={name:"group",title:"分组",icon:"el-icon-menu",group:"布局组件",isContainer:!0,rules:{parentWhiteList:["form"],childBlackList:["group"]},designOption:t=>{const{label:o,prop:e}=t.props??{};return{column:[{prop:e,labelWidth:0,type:"title",modelValue:o,styles:{fontWeight:500,fontSize:"16px"}}]}},props:{type:"group",label:"分组",column:[]},settings:[{label:"图标",prop:"icon",type:"icon",iconList:A},{label:"是否默认展开",prop:"collapse",component:C,defaultValue:!0},{label:"是否显示箭头",prop:"arrow",component:C,defaultValue:!0}]},kt={name:"input",title:"输入框",icon:"el-icon-chat-dot-square",group:"表单组件",props:{type:"input",label:"输入框"},settings:[{label:"最大长度",prop:"maxlength",type:"number"},{label:"显示统计字数",prop:"showWordLimit",component:C,defaultValue:!1,tip:"仅在最大长度大于0时有效"},{label:"前缀文字",prop:"prepend"},{label:"后缀文字",prop:"append"},{label:"前缀图标",prop:"prefixIcon",type:"icon",iconList:A},{label:"后缀图标",prop:"suffixIcon",type:"icon",iconList:A},{label:"输入值格式化",prop:"formatter",component:$,valueType:"function",tooltip:!0,defaultValue:"(value) => value"},{label:"返回值格式化",prop:"parser",component:$,valueType:"function",tooltip:!0,defaultValue:"(value) => value"},{label:"输入框样式",prop:"inputStyle",component:$,valueType:"object",tooltip:!0,defaultValue:"{}"}]},xt={name:"number",title:"数字输入框",icon:"el-icon-more",group:"表单组件",props:{type:"number",label:"数字输入框"},settings:[{label:"最小值",prop:"min",type:"number"},{label:"最大值",prop:"max",type:"number"},{label:"计数器步长",prop:"step",type:"number"},{label:"只能输入步长倍数",prop:"stepStrictly",component:C,defaultValue:!1,labelWidth:130},{label:"数值精度",prop:"precision",type:"number"},{label:"是否使用控制按钮",prop:"controls",type:"switch",value:!0,labelWidth:130,control(t){return{controlsPosition:{display:!!t}}}},{label:"控制按钮位置",prop:"controlsPosition",type:"radio",button:!0,dicData:[{label:"两边",value:"default"},{label:"右",value:"right"}]},{label:"清空时显示值",prop:"valueOnClear",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:[{label:"最小值",value:"min"},{label:"最大值",value:"max"}],control(t,o){return t&&!["min","max"].includes(t)&&(o.valueOnClear=Number(t)),{}}}]},Tt={name:"password",title:"密码输入框",icon:"el-icon-lock",group:"表单组件",props:{type:"password",label:"密码输入框"},settings:[{label:"最大长度",prop:"maxlength",type:"number"},{label:"前缀图标",prop:"prefixIcon",type:"icon",iconList:A},{label:"后缀图标",prop:"suffixIcon",type:"icon",iconList:A},{label:"是否显示切换密码",prop:"showPassword",component:C,defaultValue:!1,labelWidth:130}]},Dt={name:"rate",title:"评分",icon:"el-icon-star",group:"表单组件",props:{type:"rate",label:"评分",max:5,lowThreshold:2,highThreshold:4},settings:[{label:"是否允许半选",prop:"allowHalf",component:C,defaultValue:!1},{label:"最大分值",prop:"max",type:"number"},{label:"低分界限值",prop:"lowThreshold",type:"number",labelTip:"低分和中等分数的界限值，值本身被划分在低分中"},{label:"高分界限值",prop:"highThreshold",type:"number",labelTip:"高分和中等分数的界限值，值本身被划分在高分中"},{label:"颜色数组",prop:"colors",component:$,valueType:"object",tooltip:!0,defaultValue:"[]",labelTip:"若传入数组，共有 3 个元素，为 3 个分段所对应的颜色；若传入对象，可自定义分段，键名为分段的界限值，键值为对应的颜色"},{label:"未选中颜色",prop:"voidColor",type:"color"},{label:"未选颜色(禁用)",prop:"disabledVoidColor",type:"color",labelWidth:110},{label:"图标数组",prop:"icons",component:$,valueType:"object",tooltip:!0,defaultValue:"[]",labelTip:"若传入数组，则需要传入 3 个元素，分别为 3 个部分所对应的图标；若传入对象，则可自定义分段，键名为分段的界限值，键值为对应的图标"},{label:"未选中图标",prop:"voidIcon",type:"icon",iconList:A},{label:"未选图标(禁用)",prop:"disabledVoidIcon",type:"icon",iconList:A,labelWidth:110},{label:"显示辅助文字",prop:"showText",component:C,defaultValue:!1,labelWidth:120,labelTip:"是否显示辅助文字，若为是，则会从 辅助文字数组 中选取当前分数对应的文字内容"},{label:"辅助文字数组",prop:"texts",type:"array",labelWidth:120,labelTip:"通过设置辅助文字数组可以为每一个分值指定对应的辅助文字"},{label:"显示当前分数",prop:"showScore",component:C,defaultValue:!1,labelWidth:120,labelTip:"是否显示当前分数，当前分数 和 辅助文字 不能同时显示"},{label:"分数显示模板",prop:"scoreTemplate",labelWidth:120,labelTip:'模板为一个包含了 {value} 的字符串，{value} 会被替换为当前分值。如: "当前分数：{value}"'}]},Ct={name:"slider",title:"滑块",icon:"el-icon-operation",group:"表单组件",props:{type:"slider",label:"滑块"},settings:[{label:"最小值",prop:"min",type:"number"},{label:"最大值",prop:"max",type:"number"},{label:"步长",prop:"step",type:"number"},{label:"显示输入框",prop:"showInput",component:C,defaultValue:!1},{label:"输入控制按钮",prop:"showInputControls",component:C,defaultValue:!0},{label:"显示间断点",prop:"showStops",component:C,defaultValue:!1},{label:"显示提示信息",prop:"showTooltip",component:C,defaultValue:!0},{label:"提示信息类名",prop:"tooltipClase"},{label:"提示信息位置",prop:"placement",type:"select",dicData:je},{label:"格式化提示",prop:"formatTooltip",component:$,valueType:"function",tooltip:!0,defaultValue:"(value) => value"},{label:"开启选择范围",prop:"range",component:C,defaultValue:!1},{label:"垂直模式",prop:"vertical",component:C,defaultValue:!1},{label:"滑块高度",prop:"height",type:"number",labelTip:"垂直模式必填"},{label:"标记",prop:"marks",component:$,valueType:"object",tooltip:!0,defaultValue:"{}",labelTip:"标记， key 的类型必须为 number 且取值在闭区间 [min, max] 内，每个标记可以单独设置样式"}]},$t={name:"switch",title:"开关",icon:"el-icon-switch",group:"表单组件",props:{type:"switch",label:"开关"},settings:[{label:"开关数据",prop:"dicData",type:"dynamic",labelPosition:"top",children:{column:[{label:"_index",prop:"_index",hide:!0},{label:"文字",prop:"label"},{label:"值",prop:"value",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:[{label:"true",value:!0},{label:"false",value:!1}]}]},value:[{label:"",value:!1},{label:"",value:!0}]},{label:"开关宽度",prop:"len"},{label:"文字在点内",prop:"inlinePrompt",component:C,defaultValue:!1},{label:"开启时图标",prop:"activeIcon",type:"icon",iconList:A},{label:"关闭时图标",prop:"inactiveIcon",type:"icon",iconList:A},{label:"开启动作图标",prop:"activeActionIcon",type:"icon",iconList:A},{label:"关闭动作图标",prop:"inactiveActionIcon",type:"icon",iconList:A},{label:"改变前钩子",prop:"beforeChange",labelTip:"回调 false 则停止切换",component:$,tooltip:!0,defaultValue:"(cb) => cb(true)"}]},St={name:"table",title:"表格选择",icon:"el-icon-grid",group:"表单组件",isContainer:!0,props:{type:"table",label:"表格选择",children:{column:[]}},settings:[{label:"显示表头",prop:"showHeader",component:C,defaultValue:!0},{label:"斑马纹",prop:"stripe",component:C,defaultValue:!1},{label:"表格边框",prop:"border",component:C,defaultValue:!1},{label:"表头对齐方式",prop:"headerAlign",type:"radio",button:!0,dicData:le},{label:"整体对齐方式",prop:"align",type:"radio",button:!0,dicData:le},{label:"显示序号",prop:"index",type:"switch"},{label:"键值配置",prop:"props",component:$,valueType:"object",tooltip:!0,value:{label:"name",value:"id"}},{label:"格式化函数",prop:"formatter",component:$,valueType:"function",tooltip:!0,defaultValue:"(row) => row.name"},{label:"加载数据函数",prop:"onLoad",component:ht}]},Ot={name:"textarea",title:"文本域",icon:"el-icon-chat-line-square",group:"表单组件",props:{type:"textarea",label:"文本域"},settings:[{label:"最小行数",prop:"minRows",type:"number"},{label:"最大行数",prop:"maxRows",type:"number"},{label:"最大长度",prop:"maxlength",type:"number"},{label:"显示统计字数",prop:"showWordLimit",component:C,defaultValue:!1,tip:"仅在最大长度大于0时有效"},{label:"是否能被缩放",prop:"resize",type:"select",dicData:[{label:"不可缩放",value:"none"},{label:"可水平缩放",value:"horizontal"},{label:"可垂直缩放",value:"vertical"},{label:"可自由缩放",value:"both"}]},{label:"输入框样式",prop:"inputStyle",component:$,valueType:"object",tooltip:!0,defaultValue:"{}"}]},Lt={name:"title",title:"标题",icon:"el-icon-minus",group:"布局组件",props:{type:"title",labelWidth:0,modelValue:"标题",styles:{textAlign:"center"}},settings:[{label:"标题内容",prop:"modelValue",type:"textarea",labelPosition:"top"},{label:"样式",prop:"styles",component:$,valueType:"object",tooltip:!0}]},Et={name:"upload",title:"上传",icon:"el-icon-upload",group:"表单组件",props:{type:"upload",label:"上传"},settings:[{label:"上传地址",prop:"action"},{label:"请求头",prop:"headers",component:$,valueType:"object",tooltip:!0,defaultValue:"{}"},{label:"请求方法",prop:"method",type:"radio",button:!0,dicData:[{label:"POST",value:"post"},{label:"GET",value:"get"}]},{label:"是否支持多选",prop:"multiple",component:C,defaultValue:!1},{label:"额外参数",prop:"data",component:$,valueType:"object",tooltip:!0,defaultValue:"{}"},{label:"显示文件列表",prop:"showFileList",component:C,defaultValue:!0},{label:"拖拽排序",prop:"drag",component:C,defaultValue:!1},{label:"拖拽上传",prop:"dragFile",component:C,defaultValue:!1},{label:"接受上传类型",prop:"accept"},{label:"文件列表类型",prop:"listType",type:"select",dicData:[{label:"文本",value:"text"},{label:"图片",value:"picture"},{label:"图片卡片",value:"picture-card"},{label:"图片图片",value:"picture-img"}]},{label:"最大上传数量",prop:"limit",type:"number"},{label:"最大上传大小",prop:"fileSize",type:"number"},{label:"上传按钮文字",prop:"fileText"},{label:"上传等待文字",prop:"loadText"},{label:"上传请求配置",prop:"propsHttp",component:$,valueType:"object",tooltip:!0,defaultValue:`{
  home: "",
  res: "",
  url: "",
  name: "",
  fileName: "file"
}`},{label:"图片水印配置",prop:"canvasOption",component:$,valueType:"object",tooltip:!0,defaultValue:`{
  text: "",
  fontFamily: "microsoft yahei",
  color: "#999",
  fontSize: 16,
  opacity: 100,
  bottom: 10,
  right: 10,
  ratio: 1
}`}]},It={class:"resource-list"},jt={class:"resource-item"},Wt=W({__name:"resource",setup(t){const{groupList:o,resources:e,elementTree:u,workType:a,setActiveElement:i,recordHistory:s,getResource:n}=z(),p=E(""),r=P(()=>{const c=Object.values(e.value).filter(m=>{const{name:h,title:S,keywords:O}=m,D=[h,S,O].filter(k=>k).join(",");return!m.disabled&&(D==null?void 0:D.includes(p.value))});return o.value.map(m=>({label:m,children:c.filter(h=>h.group===m).map((h,S)=>({...h,priority:h.priority??S})).sort((h,S)=>h.priority-S.priority)})).filter(m=>m.children.length)});function b(c){var h,S;if(a.value!=="design")return;const m=se(c);(S=(h=u.value)==null?void 0:h.children)==null||S.push(m),i(m),s("added")}function l({draggedContext:c,relatedContext:m}){var h;return pe(n(c.element.name),n((h=m.component.componentData)==null?void 0:h.name))}return(c,m)=>{const h=V("el-input"),S=V("el-button"),O=V("el-collapse-item"),D=V("el-collapse");return T(),U("div",It,[_(h,{modelValue:p.value,"onUpdate:modelValue":m[0]||(m[0]=k=>p.value=k),"suffix-icon":"el-icon-search",placeholder:"搜索组件"},null,8,["modelValue"]),_(D,{"model-value":r.value.map(k=>k.label)},{default:x(()=>[(T(!0),U(B,null,q(r.value,k=>(T(),I(O,{key:k.label,title:k.label,name:k.label},{default:x(()=>[_(f(he),{list:k.children,group:{name:"components",pull:"clone",put:!1},clone:f(se),sort:!1,"item-key":"name",move:l},{item:x(({element:d})=>[M("div",jt,[_(S,{icon:d.icon,onClick:w=>b(d)},{default:x(()=>[J(ee(d.title),1)]),_:2},1032,["icon","onClick"])])]),_:2},1032,["list","clone"])]),_:2},1032,["title","name"]))),128))]),_:1},8,["model-value"])])}}}),Rt=["onMouseover"],Pt={class:"item-label"},At={class:"item-actions"},Ut=W({__name:"tree",setup(t){const{elementTree:o,activeElement:e,hoverElement:u,setActiveElement:a,recordHistory:i,getResource:s}=z(),n=P(()=>[R(o.value)]);function p(d,w,y){return w.data.isRoot?!1:y==="inner"?pe(s(d.data.name),s(w.data.name)):!0}const r=E();Te(()=>{var d,w;(w=r.value)==null||w.setCurrentKey((d=e.value)==null?void 0:d.id)});function b(d){a(d)}function l(){o.value=n.value[0]}function c(d){var y;const w=ve(d.data);(y=r.value)==null||y.append(w,d.parent),l(),a(w),i("added")}function m(d){var w;(w=r.value)==null||w.remove(d),l(),a(),i("removed")}function h(d){var w;(w=d.data.children)!=null&&w.length&&(d.data.children.forEach(y=>{var g;return(g=r.value)==null?void 0:g.remove(y)}),l(),a(d.data),i("clear"))}function S(){l(),i("moved")}const O=[{name:"copy",type:"primary",icon:"el-icon-copy-document",handler:c},{name:"delete",type:"danger",icon:"el-icon-delete",handler:m},{name:"clear",type:"warning",icon:"el-icon-folder-delete",handler:h}];function D(d){return O.filter(w=>k(d,w.name))}function k(d,w){const{disabledActions:y,isContainer:g}=s(d.name)??{},v=!(y!=null&&y.includes(w));return w==="clear"?g&&v:v}return(d,w)=>{const y=V("el-link");return T(),I(f(ut),{ref_key:"treeRef",ref:r,class:"component-tree","node-key":"id",data:n.value,"default-expand-all":"",draggable:"","expand-on-click-node":!1,"allow-drop":p,onNodeClick:b,onNodeDrop:S},{default:x(({node:g,data:v})=>{var j,F;return[M("div",{class:"tree-item",onMouseover:L=>u.value=v||{},onMouseleave:w[0]||(w[0]=L=>u.value={})},[M("div",Pt,ee(((j=v.props)==null?void 0:j.label)||((F=f(s)(v.name))==null?void 0:F.title)),1),M("div",At,[(T(!0),U(B,null,q(D(v),L=>(T(),I(y,de({key:L.name,underline:!1},L,{onClick:K(ue=>L.handler(g),["stop"])}),null,16,["onClick"]))),128))])],40,Rt)]}),_:1},8,["data"])}}});var zt=(t=>(t.copy="复制",t.delete="删除",t.clear="清空",t))(zt||{}),Ve=(t=>(t.init="初始化",t.added="添加组件",t.moved="移动组件",t.removed="删除组件",t.property="修改属性",t.clear="清空子组件",t))(Ve||{});const Bt={class:"history-list"},Ft=["onClick"],Mt=W({__name:"history",setup(t){const{historyList:o,historyIndex:e,restoreHistory:u}=z(),a=Se("history-show-source",!1),i={renderValidationDecorations:"off",readOnly:!0},s=P(()=>document.documentElement.className.includes("dark")?"vs-dark":"light");return(n,p)=>{const r=V("el-switch"),b=V("el-tooltip");return T(),U("div",Bt,[J(" 显示源码："),_(r,{modelValue:f(a),"onUpdate:modelValue":p[0]||(p[0]=l=>N(a)?a.value=l:null)},null,8,["modelValue"]),(T(!0),U(B,null,q(f(o),(l,c)=>(T(),I(b,{key:l.timestamp,disabled:!f(a),effect:"light",placement:"right"},{content:x(()=>[_(f(lt),{original:f(ne)(f(o)[c-1]),modified:f(ne)(l),theme:s.value,options:i,language:"javascript",width:"800px",height:"600px"},null,8,["original","modified","theme"])]),default:x(()=>[M("div",{class:te(["history-item",{"is-active":c===f(e)}]),onClick:m=>f(u)(c)},[M("span",null,ee(f(Ve)[l.type]),1),M("span",null,ee(new Date(l.timestamp).toLocaleString()),1)],10,Ft)]),_:2},1032,["disabled"]))),128))])}}}),Ht=W({__name:"index",setup(t){const o=[{title:"组件",icon:"el-icon-menu",component:Wt},{title:"大纲",icon:"el-icon-operation",component:Ut},{title:"历史",icon:"el-icon-clock",component:Mt}];return(e,u)=>{const a=V("el-link"),i=V("el-tab-pane"),s=V("el-tabs");return T(),I(s,{"tab-position":"top",stretch:""},{default:x(()=>[(T(),U(B,null,q(o,n=>_(i,{key:n.title},{label:x(()=>[_(a,{title:n.title,icon:n.icon,underline:!1,style:{color:"inherit"}},null,8,["title","icon"])]),default:x(()=>[(T(),I(De(n.component)))]),_:2},1024)),64))]),_:1})}}}),Nt={class:"item-actions"},we=W({__name:"design",props:{list:{},componentData:{}},emits:["update:active","update:list"],setup(t,{emit:o}){const e=t,u=o,{list:a}=Z(e,u,{passive:!0,deep:!0}),{activeElement:i,hoverElement:s,formOption:n,setActiveElement:p,recordHistory:r,getResource:b}=z();function l(y){const g={...R(n.value),span:24,menuBtn:!1},{designOption:v}=b(y.name)??{};if(typeof v=="object")return{...g,...v};if(typeof v=="function")return{...g,...v(y)};{const j=[];return y.props&&j.push({...st(y.props,ct),span:24,display:!0,style:{opacity:y.props.display===!1?.3:1}}),{...g,column:j}}}function c(y){var g,v;return(g=b(y.name))!=null&&g.isContainer?24:((v=y.props)==null?void 0:v.span)||n.value.span||24}async function m(y){var v;const g=Object.keys(y)[0];g&&(p(),await be(),p((v=y[g])==null?void 0:v.element),r(g))}function h(y){const g=ve(y);a.value.push(g),p(g),r("added")}function S(y,g){a.value.splice(g,1),p(a.value[g]??a.value[g-1]),r("removed")}function O(y){var g;(g=y.children)!=null&&g.length&&(y.children=[],p(y),r("clear"))}function D({draggedContext:y,relatedContext:g}){var v;return pe(b(y.element.name),b((v=g.component.componentData)==null?void 0:v.name))}const k=[{name:"copy",type:"primary",icon:"el-icon-copy-document",handler:h},{name:"delete",type:"danger",icon:"el-icon-delete",handler:S},{name:"clear",type:"warning",icon:"el-icon-folder-delete",handler:O}];function d(y){return k.filter(g=>w(y,g.name))}function w(y,g){const{disabledActions:v,isContainer:j}=b(y.name)??{},F=!(v!=null&&v.includes(g));return g==="clear"?j&&F:F}return(y,g)=>{const v=V("avue-form"),j=V("el-button"),F=V("el-col");return T(),I(f(he),{list:f(a),class:te(["el-row draggable-list",{"is-empty":!f(a).length,"is-root":y.componentData.isRoot}]),group:{name:"components"},"component-data":y.componentData,"item-key":"id",move:D,onChange:m},{item:x(({element:L,index:ue})=>[_(F,{class:te(["draggable-item",{"is-active":f(i).id===L.id,"is-hover":f(s).name&&f(s).id===L.id}]),span:c(L),onClick:K(Q=>f(p)(L),["stop"]),onMouseover:K(Q=>s.value=L||{},["stop"]),onMouseleave:g[0]||(g[0]=K(Q=>s.value={},["stop"]))},{default:x(()=>{var Q;return[L.name!=="form"?(T(),I(v,{key:0,option:l(L)},null,8,["option"])):ae("",!0),(Q=f(b)(L.name))!=null&&Q.isContainer?(T(),I(we,{key:1,class:"is-container","component-data":L,list:L.children??[],"onUpdate:list":X=>L.children=X},null,8,["component-data","list","onUpdate:list"])):ae("",!0),me(M("div",Nt,[(T(!0),U(B,null,q(d(L),X=>(T(),I(j,de({key:X.name},X,{circle:"",plain:"",onClick:K(Xt=>X.handler(L,ue),["stop"])}),null,16,["onClick"]))),128))],512),[[fe,f(i).id===L.id]])]}),_:2},1032,["class","span","onClick","onMouseover"])]),_:1},8,["list","class","component-data"])}}}),qt=W({setup(){const{proxy:t}=$e(),{modelValue:o}=z(),e=E({}),u=E({}),a=P(()=>tt.bind(t)(ne(o.value))),i=E();function s(n,p){console.log(n),p==null||p()}return{form:e,defaults:u,option:a,formRef:i,onSubmit:s}},render(){return Ce(V("avue-form"),{ref:"formRef",modelValue:this.form,option:this.option,defaults:this.defaults,"onUpdate:modelValue":t=>this.form=t,"onUpdate:defaults":t=>this.defaults=t,onSubmit:this.onSubmit})}}),Gt=W({__name:"source",setup(t){const{modelValue:o,setActiveElement:e}=z();return(u,a)=>(T(),I(f($),{modelValue:f(o),"onUpdate:modelValue":[a[0]||(a[0]=i=>N(o)?o.value=i:null),a[1]||(a[1]=i=>f(e)())],"value-type":"object"},null,8,["modelValue"]))}}),Kt=W({__name:"index",setup(t){const{elementTree:o,workType:e,setActiveElement:u}=z();return(a,i)=>f(e)==="preview"?(T(),I(qt,{key:0})):f(e)==="source"?(T(),I(Gt,{key:1})):(T(),I(we,{key:2,"component-data":f(o),list:f(o).children??[],"onUpdate:list":i[0]||(i[0]=s=>f(o).children=s),onClick:i[1]||(i[1]=K(s=>f(u)(),["stop"]))},null,8,["component-data","list"]))}}),Jt=W({__name:"index",setup(t){const o=z(),{elementTree:e,activeElement:u,baseOption:a,advanceOption:i,resolveSettings:s,recordHistory:n,getResource:p}=o,r=E(!1),b=E(""),l=E(0),c=E({}),m=E({labelPosition:"left",labelWidth:100,menuBtn:!1,span:24,tabs:!0,group:[]});H(()=>u.value.id,async()=>{r.value=!0,l.value=0,await be();const{settings:O,disabledSettings:D}=p(u.value.name)??{},k={label:"基础",prop:"base",column:a.value},d={label:"属性",prop:"component",column:s(O)},w={label:"高级",prop:"advance",column:i.value},y=[k,d,w].filter(g=>!(D!=null&&D.includes(g.prop)));m.value.group=y,b.value=y[0].prop,c.value=R(u.value.props),r.value=!1},{immediate:!0});const h=dt(()=>n("property"),1e3);Oe(c,O=>{const D=nt(O,[void 0,null,""],["$"]);if(u.value.isRoot)ce(e.value,"props",D);else{const k=S(e.value,u.value.id)??[];k.length&&!ye(D,mt(e.value,k.concat("props")))&&ce(e.value,k.concat("props"),D)}l.value&&h(),l.value++},{deep:!0,debounce:100});function S(O,D){if(O.id===D)return[];if(O.children)for(const k in O.children){const d=S(O.children[k],D);if(d)return["children",k].concat(d)}}return(O,D)=>{const k=V("avue-form");return r.value?ae("",!0):(T(),I(k,{key:0,modelValue:c.value,"onUpdate:modelValue":D[0]||(D[0]=d=>c.value=d),class:"settings-form",option:m.value},null,8,["modelValue","option"]))}}}),Qt=W({__name:"index",setup(t){const{elementTree:o,workType:e,deviceType:u,historyList:a,historyIndex:i,restoreHistory:s,resetHistory:n}=z(),p=[{label:"PC端",value:"pc",icon:"el-icon-monitor"},{label:"移动端",value:"mobile",icon:"el-icon-cellphone"}],r=[{label:"设计",value:"design",icon:"el-icon-brush"},{label:"源码",value:"source",icon:"el-icon-more"},{label:"预览",value:"preview",icon:"el-icon-view"}];return(b,l)=>{const c=V("el-button"),m=V("el-button-group"),h=V("el-col"),S=V("el-link"),O=V("el-radio-button"),D=V("el-radio-group"),k=V("el-row");return T(),I(k,{gutter:20},{default:x(()=>[_(h,{span:8,style:{"align-self":"center"}},{default:x(()=>[_(m,{size:"small"},{default:x(()=>{var d;return[_(c,{disabled:f(i)===0,title:"撤回",icon:"el-icon-arrow-left",onClick:l[0]||(l[0]=w=>f(s)(f(i)-1))},null,8,["disabled"]),_(c,{disabled:f(i)===f(a).length-1,title:"重做",icon:"el-icon-arrow-right",onClick:l[1]||(l[1]=w=>f(s)(f(i)+1))},null,8,["disabled"]),_(c,{disabled:!((d=f(o).children)!=null&&d.length),title:"清空",icon:"el-icon-delete",onClick:l[2]||(l[2]=w=>f(n)())},null,8,["disabled"])]}),_:1})]),_:1}),_(h,{span:8,style:{"text-align":"center"}},{default:x(()=>[_(D,{modelValue:f(u),"onUpdate:modelValue":l[3]||(l[3]=d=>N(u)?u.value=d:null),size:"small",style:{"font-size":"unset"}},{default:x(()=>[(T(),U(B,null,q(p,d=>_(O,{key:d.value,label:d.value},{default:x(()=>[_(S,{title:d.label,icon:d.icon,underline:!1,style:{color:"inherit"},onClick:w=>u.value=d.value},null,8,["title","icon","onClick"])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1}),_(h,{span:8,style:{"text-align":"right"}},{default:x(()=>[_(D,{modelValue:f(e),"onUpdate:modelValue":l[4]||(l[4]=d=>N(e)?e.value=d:null),size:"small",style:{"font-size":"unset"}},{default:x(()=>[(T(),U(B,null,q(r,d=>_(O,{key:d.value,label:d.value},{default:x(()=>[_(S,{title:d.label,icon:d.icon,underline:!1,style:{color:"inherit"},onClick:w=>e.value=d.value},null,8,["title","icon","onClick"])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),Wl=W({__name:"index",props:{modelValue:{},groupList:{},resources:{},baseOption:{},advanceOption:{},leftWidth:{},rightWidth:{},adapterIn:{type:Function,default:re},adapterOut:{type:Function,default:ge}},emits:["reset"],setup(t,{emit:o}){const e=t,u=o,{workType:a,deviceType:i}=bt(e,u);return(s,n)=>{const p=V("el-aside"),r=V("el-header"),b=V("el-main"),l=V("el-container");return T(),I(l,{class:"form-design"},{default:x(()=>[_(p,{class:"left-panel",width:s.leftWidth},{default:x(()=>[_(Ht)]),_:1},8,["width"]),_(l,null,{default:x(()=>[_(r,{class:"main-header",height:"auto"},{default:x(()=>[_(Qt)]),_:1}),_(b,{class:"main-workspace"},{default:x(()=>[_(Kt,{class:te(`device-${f(i)}`)},null,8,["class"])]),_:1})]),_:1}),me(_(p,{class:"right-panel",width:s.rightWidth},{default:x(()=>[_(Jt)]),_:1},8,["width"]),[[fe,f(a)==="design"]])]),_:1})}}});export{yt as ControlSetter,zt as DesignAction,jl as DicDataSetter,Al as DicTreeSetter,$ as EditorSetter,Wl as FormDesign,Ve as HistoryType,ht as OnLoadSetter,Ml as RulesSetter,C as SwitchSetter,Hl as ValueSetter,re as adapterIn,ge as adapterOut,gt as advance,le as alignDic,We as array,ot as base,Re as cascader,pe as checkRules,Pe as checkbox,se as cloneItem,_t as color,ve as copyItem,Ae as date,Ue as daterange,ze as dates,Be as datetime,Fe as datetimerange,Ul as dic,Vt as dynamic,at as form,ie as getRandomId,wt as group,Le as groupList,Me as icon,A as iconList,He as img,kt as input,tt as jsonParse,ne as jsonStringify,Ne as month,qe as monthrange,xt as number,Tt as password,je as placementDic,zl as positionDic,Ge as radio,Dt as rate,Ke as select,Bl as sizeDic,Ct as slider,$t as switch,St as table,Ot as textarea,Je as time,Qe as timerange,Lt as title,Xe as tree,Et as upload,Ye as url,Ze as week,et as year};
