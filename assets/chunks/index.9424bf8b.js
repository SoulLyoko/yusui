var qt=Object.defineProperty;var Yt=(e,t,o)=>t in e?qt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var J=(e,t,o)=>(Yt(e,typeof t!="symbol"?t+"":t,o),o);import{C as Kt,G as be,M as Xt,D as Ht,l as ft,S as Jt,a as Qt,I as Zt,B as ht,b as pt}from"./mysqlWorkbench.3afe459a.js";import{E as ys,f as bs,g as ws,h as gs,t as xs,u as Es,r as ks,s as _s,N as Ns,q as Ms,i as Is,j as Os,P as Ps,c as Ls,o as Ss,p as Ts,m as Ds,n as Cs,d as Rs,e as Fs,U as js,k as Vs}from"./mysqlWorkbench.3afe459a.js";import{bR as eo,d3 as Ce}from"../composables_use-crud_index.md.b279084a.js";import{i as Re,u as vt}from"./uniqueId.651a8aa4.js";import{d as As}from"./data.4cb21f02.js";import{d as to,u as oo}from"../flow-design_flow-modeler_index.md.e755d908.js";import{b as zs,c as $s,e as Ws,f as Us,a as qs,g as Ys,h as Ks,m as Xs,n as Hs,p as Js,i as Qs,s as Zs,j as ea,k as ta,l as oa}from"../flow-design_flow-modeler_index.md.e755d908.js";import{n as $e,h as Fe,r as no,e as ro,G as Z,i as ne,C as de,D as re,k as Oe,I as ce,m as io,u as K,a6 as le,B as so,f as mt,w as pe,aC as ao,j as lo}from"./framework.22a77fa2.js";import{u as yt}from"./theme.1d56182c.js";import"../app.11d90cc6.js";import"../components_icon-select_index.md.dc997862.js";import"../components_index.md.366cb56b.js";import"../components_v-text_index.md.306fe565.js";import"../composables_index.md.1bb90be4.js";import"../flow-design_flow-viewer_index.md.e9fcc2c5.js";import"../flow-design_index.md.e062cae5.js";import"../flow-pages_index.md.9ad8d77c.js";import"../flow-pages_pages_flow-button_index.md.2cf37f1f.js";import"../flow-pages_pages_flow-manage_index.md.3b729385.js";import"../flow-pages_pages_flow-ops_index.md.1351e2c2.js";import"../flow-pages_pages_flow-param_index.md.907e6ed8.js";import"../flow-pages_pages_flow-template_index.md.743ad38c.js";import"../flow-pages_pages_flow-workbench_index.md.e559c6b1.js";import"../flow-pages_pages_form-template_index.md.754d7c10.js";import"../flow-pages_pages_table-template_index.md.f196419b.js";import"../form-design_demo.md.f7fa8b02.js";import"../form-design_index.md.f8d915c9.js";import"../guide_changelog.md.71ace3ef.js";import"../guide_start.md.f25ec09d.js";import"../index.md.dedad964.js";import"../plugins_avue-patch_index.md.9a4d5705.js";import"../plugins_compatible-tips_index.md.3602f3a2.js";import"../plugins_env-dts_index.md.14017d50.js";import"../plugins_index.md.09238556.js";import"../plugins_load-proxy_index.md.1d58f036.js";import"../plugins_setup-extend_index.md.176ed99f.js";import"../plugins_uni-ui-patch_index.md.de2a1873.js";import"../plugins_uview-patch_index.md.a13b4ad1.js";import"../types_avue_index.md.31e36571.js";import"../types_index.md.aa1779e7.js";import"../utils_date_dateFormat.md.24466ffd.js";import"../utils_date_durationFormat.md.a91e1175.js";import"../utils_emitter_mittAsync.md.65520a0e.js";import"../utils_index.md.99824380.js";import"../utils_math_index.md.81fb7150.js";import"../utils_object_filterObj.md.d634698f.js";import"../utils_object_filterObjDeep.md.aee85325.js";import"../utils_object_getDataType.md.4c16fa33.js";import"../utils_string_deserialize.md.49b88e4f.js";import"../utils_string_serialize.md.175ca994.js";import"../utils_string_uuid.md.1b6743be.js";import"../utils_tool_awaitTo.md.907e2bd0.js";import"../utils_tool_enumToDic.md.f0182e11.js";import"../utils_tool_sleep.md.15440607.js";import"../utils_tree_buildTree.md.b95211e7.js";import"../utils_tree_filterTree.md.753c4098.js";import"../utils_tree_findTree.md.30184861.js";import"../utils_tree_flatTree.md.cb52189f.js";import"../utils_tree_treeMap.md.168ca5df.js";const bt={rect:{radius:5,stroke:"black"},circle:{r:18,stroke:"black"},polygon:{stroke:"black"},polyline:{stroke:"black",hoverStroke:"black",selectedStroke:"black"},edgeText:{background:{fill:"white",height:14,stroke:"transparent",radius:3}},nodeText:{}},co=[{label:"开始",value:"start"},{label:"任务",value:"task"},{label:"结束",value:"end"}],uo=[{label:"类",value:"class"},{label:"表达式",value:"expression"},{label:"代理表达式",value:"delegateExpression"}],fo=[{label:"字符串",value:"string"},{label:"表达式",value:"expression"}],ls=[{label:"",labelWidth:0,prop:"executionListener",type:"dynamic",children:{type:"form",index:!1,column:[{label:"事件",prop:"eventName",type:"select",dicData:co},{label:"类型",prop:"eventType",type:"select",dicData:uo},{label:"值",prop:"eventValue",type:"textarea",minRows:1,span:24},{label:"字段",prop:"fields",type:"dynamic",span:24,children:{column:[{label:"字段名",prop:"fieldName"},{label:"类型",prop:"fieldType",type:"select",dicData:fo},{label:"值",prop:"fieldValue"}]}}]}}];function We(e,t){return e.map(o=>{const n=t.find(l=>l.buttonKey===o.buttonKey),{name:r,buttonKey:i,display:a,approval:s}=o;return{name:r,buttonKey:i,display:a,approval:s,...n}})}function Pe(e,t){return e.map(o=>{var h,p;const n=t.find(m=>m.prop===o.prop),{label:r,prop:i,display:a=!0,disabled:s=!1,detail:d=!1,readonly:l=!1,rules:c}=o,u=(c==null?void 0:c.some(m=>m.required))??!1,f={label:r,prop:i,display:a,disabled:s,detail:d,readonly:l,required:u,...n};return o.type==="dynamic"&&((p=(h=o.children)==null?void 0:h.column)!=null&&p.length)&&(f.children=Pe(o.children.column,(n==null?void 0:n.children)??[])),f})}function ho({lf:e,graphData:t,elementData:o,formData:n,formLoading:r,formOption:i,formOptions:a,editorVisible:s,formOptionFormat:d,formDataFormat:l,dataOptions:c,formRef:u,formDefaults:f}){var m,b,w,k,y,N,P,T,Q;async function h({data:O,isForce:z}={data:void 0,isForce:!1}){var A,v,L,C,S,F;const D=(A=e.value)==null?void 0:A.graphModel.nodes.find(g=>g.type==="process");!O&&(D!=null&&D.id)&&(O=(v=e.value)==null?void 0:v.getNodeDataById(D.id)),!((O==null?void 0:O.id)===((L=o.value)==null?void 0:L.id)&&!z)&&(O.type!=="process"&&((C=e.value)==null||C.selectElementById(O.id)),r.value=!0,await $e(),o.value=O,i.value={menuBtn:!1,span:24,labelPosition:"left",group:((S=a.value)==null?void 0:S[O.type])??to},n.value={...O.properties,id:O.id,name:((F=O.text)==null?void 0:F.value)||""},r.value=!1,await $e(),p())}async function p(){var C,S,F,g,_,M,I;const{formPropertyList:O,buttonList:z,fieldsDic:D,flowButtonDisplayDic:A,flowButtonApprovalDic:v}=c.value??{},L=j=>{var B,G;return(G=(B=i.value)==null?void 0:B.group)==null?void 0:G.some(X=>{var se;return(se=X.column)==null?void 0:se.some(ae=>ae.prop===j)})};L("button")&&(n.value.button=We(z||[],((C=n.value)==null?void 0:C.button)||[]),(g=(F=(S=f.value)==null?void 0:S.button.children)==null?void 0:F.column)==null||g.forEach(j=>{j.prop==="display"&&(j.dicData=A),j.prop==="approval"&&(j.dicData=v)})),L("formProperty")&&(n.value.formProperty=Pe(O||[],((_=n.value)==null?void 0:_.formProperty)||[])),L("priority")&&((M=u.value)==null||M.updateDic("priority",D)),L("formTitle")&&((I=u.value)==null||I.updateDic("formTitle",D))}(m=e.value)==null||m.on("element:click",h),(b=e.value)==null||b.on("blank:click",h),(w=e.value)==null||w.on("node:add",h),(k=e.value)==null||k.on("node:dnd-add",h),(y=e.value)==null||y.on("node:delete",()=>h()),(N=e.value)==null||N.on("history:change",()=>{var O;t.value=(O=e.value)==null?void 0:O.getGraphData()}),(P=e.value)==null||P.on("custom:edit-click",()=>{s.value=!0}),(T=e.value)==null||T.on("custom:reset-form-property",()=>{var O,z;(z=(O=t.value)==null?void 0:O.flowElementList)==null||z.forEach(D=>{var A,v;(A=D.properties)!=null&&A.formProperty&&(D.properties.formProperty=Pe(((v=c.value)==null?void 0:v.formPropertyList)||[],[]))}),t.value={...t.value}}),(Q=e.value)==null||Q.on("custom:reset-button",()=>{var O,z;(z=(O=t.value)==null?void 0:O.flowElementList)==null||z.forEach(D=>{var A,v;(A=D.properties)!=null&&A.button&&(D.properties.button=We(((v=c.value)==null?void 0:v.buttonList)||[],[]))}),t.value={...t.value}})}const po=[{label:"创建",value:"create"},{label:"指派",value:"assignment"},{label:"完成",value:"complete"},{label:"删除",value:"delete"},{label:"更新",value:"update"},{label:"超时",value:"timeout"}],vo=[{label:"类",value:"class"},{label:"表达式",value:"expression"},{label:"代理表达式",value:"delegateExpression"}],mo=[{label:"字符串",value:"string"},{label:"表达式",value:"expression"}],cs=[{label:"",labelWidth:0,prop:"executionListener",type:"dynamic",children:{type:"form",index:!1,column:[{label:"事件",prop:"eventName",type:"select",dicData:po},{label:"类型",prop:"eventType",type:"select",dicData:vo},{label:"值",prop:"eventValue",type:"textarea",minRows:1,span:24},{label:"字段",prop:"fields",type:"dynamic",span:24,children:{column:[{label:"字段名",prop:"fieldName"},{label:"类型",prop:"fieldType",type:"select",dicData:mo},{label:"值",prop:"fieldValue"}]}}]}}],us=[{label:"",labelWidth:0,prop:"timeLimit",type:"dynamic",children:{column:[{label:"名称",prop:"name"},{label:"最小值",prop:"min",type:"number"},{label:"最大值",prop:"max",type:"number"}]},value:[]}];class yo extends Kt{constructor({lf:t}){super({lf:t}),this.addItem({key:"clear",iconClass:"lf-control-clear",title:"清空",text:"清空",onClick:()=>t.clearData()}),this.addItem({key:"edit",iconClass:"lf-control-edit",title:"编辑",text:"编辑",onClick:()=>t.emit("custom:edit-click",{})}),this.addItem({key:"mini-map",iconClass:"lf-control-mini-map",title:"导航",text:"导航",onClick:()=>{const{isShow:o,show:n,hide:r}=t.extension.miniMap??{};o?r():n()}}),this.addItem({key:"reset",iconClass:"lf-control-reset",title:"重置",text:"重置",onClick:()=>{eo.confirm("选择重置的配置","提示",{confirmButtonText:"重置表单配置",cancelButtonText:"重置按钮配置"}).then(()=>{t.emit("custom:reset-form-property",{})}).catch(()=>{t.emit("custom:reset-button",{})})}})}}class bo{constructor(){this.nodes=[],this.edges=[],this.combos=[],this.comboEdges=[],this.hiddenNodes=[],this.hiddenEdges=[],this.hiddenCombos=[],this.vedges=[],this.positions=[],this.destroyed=!1,this.onLayoutEnd=()=>{}}layout(t){return this.init(t),this.execute(!0)}init(t){this.nodes=t.nodes||[],this.edges=t.edges||[],this.combos=t.combos||[],this.comboEdges=t.comboEdges||[],this.hiddenNodes=t.hiddenNodes||[],this.hiddenEdges=t.hiddenEdges||[],this.hiddenCombos=t.hiddenCombos||[],this.vedges=t.vedges||[]}execute(t){}executeWithWorker(){}getDefaultCfg(){return{}}updateCfg(t){t&&Object.assign(this,t)}getType(){return"base"}destroy(){this.nodes=null,this.edges=null,this.combos=null,this.positions=null,this.destroyed=!0}}const wo=e=>typeof e=="string",Ue=Array.isArray,me=e=>typeof e=="number",wt=e=>e!==null&&typeof e=="object",ye=e=>{if(e===null)return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof Array){const t=[];return e.forEach(o=>{t.push(o)}),t.map(o=>ye(o))}if(typeof e=="object"&&Object.keys(e).length){const t=Object.assign({},e);return Object.keys(t).forEach(o=>{t[o]=ye(t[o])}),t}return e},oe=(e,t)=>{const o=e[t];return wt(o)?o.cell:o},qe=(e,t,o)=>{let n;return o?n=o:me(e)?n=()=>e:n=()=>t,n},go=(e,t)=>{if(e!=="next"&&e!=="prev")return t},Ye=e=>{e.prev.next=e.next,e.next.prev=e.prev,delete e.next,delete e.prev};let xo=class{constructor(){const t={};t.prev=t,t.next=t.prev,this.shortcut=t}dequeue(){const t=this.shortcut,o=t.prev;if(o&&o!==t)return Ye(o),o}enqueue(t){const o=this.shortcut;t.prev&&t.next&&Ye(t),t.next=o.next,o.next.prev=t,o.next=t,t.prev=o}toString(){const t=[],o=this.shortcut;let n=o.prev;for(;n!==o;)t.push(JSON.stringify(n,go)),n=n==null?void 0:n.prev;return`[${t.join(", ")}]`}};function Ke(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Eo(e,t,o){return t&&Ke(e.prototype,t),o&&Ke(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function ko(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var gt=Eo(function e(){var t=this;ko(this,e),this.arr=[],this.keyIndice=new Map,this.size=function(){return t.arr.length},this.keys=function(){return t.arr.map(function(o){return o.key})},this.has=function(o){return t.keyIndice.has(o)},this.priority=function(o){var n=t.keyIndice.get(o);if(n!==void 0)return t.arr[n].priority},this.swap=function(o,n){var r=t.arr,i=t.keyIndice,a=[r[o],r[n]],s=a[0],d=a[1];r[o]=d,r[n]=s,i.set(s.key,n),i.set(d.key,o)},this.innerDecrease=function(o){for(var n=t.arr,r=n[o].priority,i,a=o;a!==0;){var s;if(i=a>>1,((s=n[i])===null||s===void 0?void 0:s.priority)<r)break;t.swap(a,i),a=i}},this.heapify=function(o){var n=t.arr,r=o<<1,i=r+1,a=o;r<n.length&&(a=n[r].priority<n[a].priority?r:a,i<n.length&&(a=n[i].priority<n[a].priority?i:a),a!==o&&(t.swap(o,a),t.heapify(a)))},this.min=function(){if(t.size()===0)throw new Error("Queue underflow");return t.arr[0].key},this.add=function(o,n){var r=t.keyIndice,i=t.arr;if(!r.has(o)){var a=i.length;return r.set(o,a),i.push({key:o,priority:n}),t.innerDecrease(a),!0}return!1},this.removeMin=function(){t.swap(0,t.arr.length-1);var o=t.arr.pop();return t.keyIndice.delete(o.key),t.heapify(0),o.key},this.decrease=function(o,n){if(!t.has(o))throw new Error("There's no key named ".concat(o));var r=t.keyIndice.get(o);if(n>t.arr[r].priority)throw new Error("New priority is greater than current priority.Key: ".concat(o," Old: + ").concat(t.arr[r].priority," New: ").concat(n));t.arr[r].priority=n,t.innerDecrease(r)}}),_o=function(t,o){var n=new be,r=new Map,i=new gt,a;function s(c){var u=c.v===a?c.w:c.v,f=i.priority(u);if(f!==void 0){var h=o(c);h<f&&(r.set(u,a),i.decrease(u,h))}}if(t.nodeCount()===0)return n;t.nodes().forEach(function(c){i.add(c,Number.POSITIVE_INFINITY),n.setNode(c)}),i.decrease(t.nodes()[0],0);for(var d=!1;i.size()>0;){var l;if(a=i.removeMin(),r.has(a))n.setEdge(a,r.get(a));else{if(d)throw new Error("Input graph is not connected: "+t.graph());d=!0}(l=t.nodeEdges(a))===null||l===void 0||l.forEach(s)}return n},No=function(t){var o=new Set,n=[],r=t.nodes();return r.forEach(function(i){for(var a=[],s=[i];s.length>0;){var d=s.pop();if(!o.has(d)){var l,c;o.add(d),a.push(d),(l=t.successors(d))===null||l===void 0||l.forEach(function(u){return s.push(u)}),(c=t.predecessors(d))===null||c===void 0||c.forEach(function(u){return s.push(u)})}}a.length&&n.push(a)}),n},Mo=function e(t,o,n,r,i,a){r.includes(o)||(r.push(o),n||a.push(o),i(o).forEach(function(s){return e(t,s,n,r,i,a)}),n&&a.push(o))},je=function(t,o,n){var r=Array.isArray(o)?o:[o],i=function(l){return t.isDirected()?t.successors(l):t.neighbors(l)},a=[],s=[];return r.forEach(function(d){if(t.hasNode(d))Mo(t,d,n==="post",s,i,a);else throw new Error("Graph does not have node: "+d)}),a};function Io(e,t){return So(e)||Lo(e,t)||Po(e,t)||Oo()}function Oo(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Po(e,t){if(e){if(typeof e=="string")return Xe(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);if(o==="Object"&&e.constructor&&(o=e.constructor.name),o==="Map"||o==="Set")return Array.from(e);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return Xe(e,t)}}function Xe(e,t){(t==null||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function Lo(e,t){var o=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(o!=null){var n=[],r=!0,i=!1,a,s;try{for(o=o.call(e);!(r=(a=o.next()).done)&&(n.push(a.value),!(t&&n.length===t));r=!0);}catch(d){i=!0,s=d}finally{try{!r&&o.return!=null&&o.return()}finally{if(i)throw s}}return n}}function So(e){if(Array.isArray(e))return e}var To=function(){return 1},xt=function(t,o,n,r){return Do(t,o,n||To,r||function(i){return t.outEdges(i)})},Do=function(t,o,n,r){var i=new Map,a=new gt,s,d,l=function(f){var h=f.v!==s?f.v:f.w,p=i.get(h),m=n(f),b=d.distance+m;if(m<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+f+" Weight: "+m);b<p.distance&&(p.distance=b,p.predecessor=s,a.decrease(h,b))};for(t.nodes().forEach(function(u){var f=u===o?0:Number.POSITIVE_INFINITY;i.set(u,{distance:f}),a.add(u,f)});a.size()>0&&(s=a.removeMin(),d=i.get(s),!(d&&d.distance===Number.POSITIVE_INFINITY));)r(s).forEach(l);var c={};return Array.from(i.entries()).forEach(function(u){var f=Io(u,2),h=f[0],p=f[1];return c[String(h)]=p,c}),c},Co=function(t,o,n){var r={};return t.nodes().forEach(function(i){return r[String(i)]=xt(t,i,o,n),r}),r},Et=function(t){var o=0,n=[],r=new Map,i=[];function a(s){var d,l={onStack:!0,lowlink:o,index:o};if(r.set(s,l),o+=1,n.push(s),(d=t.successors(s))===null||d===void 0||d.forEach(function(h){var p;if(r.has(h)){if(!((p=r.get(h))===null||p===void 0)&&p.onStack){var b=r.get(h);l.lowlink=Math.min(l.lowlink,b.index)}}else{a(h);var m=r.get(h);l.lowlink=Math.min(l.lowlink,m.lowlink)}}),l.lowlink===l.index){var c=[],u;do{u=n.pop();var f=r.get(u);f.onStack=!1,c.push(u)}while(s!==u);i.push(c)}}return t.nodes().forEach(function(s){r.has(s)||a(s)}),i},Ro=function(t){return Et(t).filter(function(o){return o.length>1||o.length===1&&t.hasEdge(o[0],o[0])})};function Le(e){return Le=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Le(e)}function He(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Fo(e,t,o){return t&&He(e.prototype,t),o&&He(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function jo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vo(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ue(e,t)}function Bo(e){var t=kt();return function(){var n=fe(e),r;if(t){var i=fe(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ao(this,r)}}function Ao(e,t){if(t&&(Le(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Go(e)}function Go(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Se(e){var t=typeof Map=="function"?new Map:void 0;return Se=function(n){if(n===null||!zo(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(n))return t.get(n);t.set(n,r)}function r(){return ve(n,arguments,fe(this).constructor)}return r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),ue(r,n)},Se(e)}function ve(e,t,o){return kt()?ve=Reflect.construct:ve=function(r,i,a){var s=[null];s.push.apply(s,i);var d=Function.bind.apply(r,s),l=new d;return a&&ue(l,a.prototype),l},ve.apply(null,arguments)}function kt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zo(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function ue(e,t){return ue=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n},ue(e,t)}function fe(e){return fe=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)},fe(e)}var Te=function(e){Vo(o,e);var t=Bo(o);function o(){return jo(this,o),t.apply(this,arguments)}return Fo(o)}(Se(Error));function _t(e){var t=new Set,o=new Set,n=[];function r(i){if(o.has(i))throw new Te;if(!t.has(i)){var a;o.add(i),t.add(i),(a=e.predecessors(i))===null||a===void 0||a.forEach(r),o.delete(i),n.push(i)}}if(e.sinks().forEach(r),t.size!==e.nodeCount())throw new Te;return n}var $o=function(t){try{_t(t)}catch(o){if(o instanceof Te)return!1;throw o}return!0},Wo=function(t,o){return je(t,o,"post")},Uo=function(t,o){return je(t,o,"pre")},qo=function(){return 1};function Yo(e,t,o){return Ko(e,t||qo,o||function(n){return e.outEdges(n)})}function Ko(e,t,o){var n={},r=e.nodes();return r.forEach(function(i){var a=String(i);n[a]={},n[a][a]={distance:0},r.forEach(function(s){i!==s&&(n[a][String(s)]={distance:Number.POSITIVE_INFINITY})}),o(i).forEach(function(s){var d=s.v===i?s.w:s.v,l=t(s);n[a][String(d)]={distance:l,predecessor:i}})}),r.forEach(function(i){var a=String(i),s=n[a];r.forEach(function(d){var l=String(d),c=n[l];r.forEach(function(u){var f=String(u),h=c[a],p=s[f],m=c[f],b=h.distance+p.distance;b<m.distance&&(m.distance=b,m.predecessor=p.predecessor)})})}),n}const Xo=Object.freeze(Object.defineProperty({__proto__:null,components:No,dfs:je,dijkstra:xt,dijkstraAll:Co,findCycles:Ro,floydWarshall:Yo,isAcyclic:$o,postorder:Wo,preorder:Uo,prim:_o,tarjan:Et,topsort:_t},Symbol.toStringTag,{value:"Module"}));class Ho extends xo{}class Jo extends be{}const Qo=()=>1,Zo=(e,t)=>{var o;if(e.nodeCount()<=1)return[];const n=tn(e,t||Qo);return(o=en(n.graph,n.buckets,n.zeroIdx).map(i=>e.outEdges(i.v,i.w)))===null||o===void 0?void 0:o.flat()},en=(e,t,o)=>{let n=[];const r=t[t.length-1],i=t[0];let a;for(;e.nodeCount();){for(;a=i.dequeue();)ge(e,t,o,a);for(;a=r.dequeue();)ge(e,t,o,a);if(e.nodeCount()){for(let s=t.length-2;s>0;--s)if(a=t[s].dequeue(),a){n=n.concat(ge(e,t,o,a,!0));break}}}return n},ge=(e,t,o,n,r)=>{var i,a;const s=[];return(i=e.inEdges(n.v))===null||i===void 0||i.forEach(d=>{const l=e.edge(d),c=e.node(d.v);r&&s.push({v:d.v,w:d.w,in:0,out:0}),c.out===void 0&&(c.out=0),c.out-=l,De(t,o,c)}),(a=e.outEdges(n.v))===null||a===void 0||a.forEach(d=>{const l=e.edge(d),c=d.w,u=e.node(c);u.in===void 0&&(u.in=0),u.in-=l,De(t,o,u)}),e.removeNode(n.v),r?s:void 0},tn=(e,t)=>{const o=new Jo;let n=0,r=0;e.nodes().forEach(d=>{o.setNode(d,{v:d,in:0,out:0})}),e.edges().forEach(d=>{const l=o.edge(d)||0,c=(t==null?void 0:t(d))||1,u=l+c;o.setEdge(d.v,d.w,u),r=Math.max(r,o.node(d.v).out+=c),n=Math.max(n,o.node(d.w).in+=c)});const i=[],a=r+n+3;for(let d=0;d<a;d++)i.push(new Ho);const s=n+1;return o.nodes().forEach(d=>{De(i,s,o.node(d))}),{buckets:i,zeroIdx:s,graph:o}},De=(e,t,o)=>{o.out?o.in?e[o.out-o.in+t].enqueue(o):e[e.length-1].enqueue(o):e[0].enqueue(o)},on=e=>{const t=n=>r=>{var i;return((i=n.edge(r))===null||i===void 0?void 0:i.weight)||1},o=e.graph().acyclicer==="greedy"?Zo(e,t(e)):nn(e);o==null||o.forEach(n=>{const r=e.edge(n);e.removeEdgeObj(n),r.forwardName=n.name,r.reversed=!0,e.setEdge(n.w,n.v,r,`rev-${Math.random()}`)})},nn=e=>{const t=[],o={},n={},r=i=>{var a;n[i]||(n[i]=!0,o[i]=!0,(a=e.outEdges(i))===null||a===void 0||a.forEach(s=>{o[s.w]?t.push(s):r(s.w)}),delete o[i])};return e.nodes().forEach(r),t},rn=e=>{e.edges().forEach(t=>{const o=e.edge(t);if(o.reversed){e.removeEdgeObj(t);const n=o.forwardName;delete o.reversed,delete o.forwardName,e.setEdge(t.w,t.v,o,n)}})},Je={run:on,undo:rn};class ee extends be{}const sn=(e,t)=>Number(e)-Number(t),ie=(e,t,o,n)=>{let r;do r=`${n}${Math.random()}`;while(e.hasNode(r));return o.dummy=t,e.setNode(r,o),r},an=e=>{const t=new ee().setGraph(e.graph());return e.nodes().forEach(o=>{t.setNode(o,e.node(o))}),e.edges().forEach(o=>{const n=t.edgeFromArgs(o.v,o.w)||{weight:0,minlen:1},r=e.edge(o);t.setEdge(o.v,o.w,{weight:n.weight+r.weight,minlen:Math.max(n.minlen,r.minlen)})}),t},Nt=e=>{const t=new ee({multigraph:e.isMultigraph()}).setGraph(e.graph());return e.nodes().forEach(o=>{var n;!((n=e.children(o))===null||n===void 0)&&n.length||t.setNode(o,e.node(o))}),e.edges().forEach(o=>{t.setEdgeObj(o,e.edge(o))}),t},dn=(e,t)=>e==null?void 0:e.reduce((o,n,r)=>(o[n]=t[r],o),{}),Qe=(e,t)=>{const o=Number(e.x),n=Number(e.y),r=Number(t.x)-o,i=Number(t.y)-n;let a=Number(e.width)/2,s=Number(e.height)/2;if(!r&&!i)return{x:0,y:0};let d,l;return Math.abs(i)*a>Math.abs(r)*s?(i<0&&(s=-s),d=s*r/i,l=s):(r<0&&(a=-a),d=a,l=a*i/r),{x:o+d,y:n+l}},he=e=>{const t=[],o=Mt(e)+1;for(let n=0;n<o;n++)t.push([]);e.nodes().forEach(n=>{const r=e.node(n);if(!r)return;const i=r.rank;i!==void 0&&t[i]&&t[i].push(n)});for(let n=0;n<o;n++)t[n]=t[n].sort((r,i)=>{var a,s;return sn((a=e.node(r))===null||a===void 0?void 0:a.order,(s=e.node(i))===null||s===void 0?void 0:s.order)});return t},ln=e=>{const t=e.nodes().filter(n=>{var r;return((r=e.node(n))===null||r===void 0?void 0:r.rank)!==void 0}).map(n=>e.node(n).rank),o=Math.min(...t);e.nodes().forEach(n=>{const r=e.node(n);r.hasOwnProperty("rank")&&o!==1/0&&(r.rank-=o)})},cn=e=>{const t=e.nodes(),o=t.filter(s=>{var d;return((d=e.node(s))===null||d===void 0?void 0:d.rank)!==void 0}).map(s=>e.node(s).rank),n=Math.min(...o),r=[];t.forEach(s=>{var d;const l=(((d=e.node(s))===null||d===void 0?void 0:d.rank)||0)-n;r[l]||(r[l]=[]),r[l].push(s)});let i=0;const a=e.graph().nodeRankFactor||0;for(let s=0;s<r.length;s++){const d=r[s];d===void 0?s%a!==0&&(i-=1):i&&(d==null||d.forEach(l=>{const c=e.node(l);c&&(c.rank=c.rank||0,c.rank+=i)}))}},Ze=(e,t,o,n)=>{const r={width:0,height:0};return me(o)&&me(n)&&(r.rank=o,r.order=n),ie(e,"border",r,t)},Mt=e=>{let t;return e.nodes().forEach(o=>{var n;const r=(n=e.node(o))===null||n===void 0?void 0:n.rank;r!==void 0&&(t===void 0||r>t)&&(t=r)}),t||(t=0),t},un=(e,t)=>{const o={lhs:[],rhs:[]};return e==null||e.forEach(n=>{t(n)?o.lhs.push(n):o.rhs.push(n)}),o},It=(e,t)=>{const o=Date.now();try{return t()}finally{console.log(`${e} time: ${Date.now()-o}ms`)}},Ot=(e,t)=>t(),Ve=(e,t)=>e.reduce((o,n)=>{const r=t(o),i=t(n);return r>i?n:o}),fn=e=>{e.graph().dummyChains=[],e.edges().forEach(t=>hn(e,t))},hn=(e,t)=>{let o=t.v,n=e.node(o).rank;const r=t.w,i=e.node(r).rank,a=t.name,s=e.edge(t),d=s.labelRank;if(i===n+1)return;e.removeEdgeObj(t);const l=e.graph();let c,u,f;for(f=0,++n;n<i;++f,++n)s.points=[],u={edgeLabel:s,width:0,height:0,edgeObj:t,rank:n},c=ie(e,"edge",u,"_d"),n===d&&(u.width=s.width,u.height=s.height,u.dummy="edge-label",u.labelpos=s.labelpos),e.setEdge(o,c,{weight:s.weight},a),f===0&&(l.dummyChains||(l.dummyChains=[]),l.dummyChains.push(c)),o=c;e.setEdge(o,r,{weight:s.weight},a)},pn=e=>{var t;(t=e.graph().dummyChains)===null||t===void 0||t.forEach(o=>{let n=e.node(o);const r=n.edgeLabel;let i;n.edgeObj&&e.setEdgeObj(n.edgeObj,r);let a=o;for(;n.dummy;)i=e.successors(a)[0],e.removeNode(a),r.points.push({x:n.x,y:n.y}),n.dummy==="edge-label"&&(r.x=n.x,r.y=n.y,r.width=n.width,r.height=n.height),a=i,n=e.node(a)})},et={run:fn,undo:pn},Pt=e=>{var t;const o={},n=r=>{var i;const a=e.node(r);if(!a)return 0;if(o[r])return a.rank;o[r]=!0;let s;return(i=e.outEdges(r))===null||i===void 0||i.forEach(d=>{const l=n(d.w),c=e.edge(d).minlen,u=l-c;u&&(s===void 0||u<s)&&(s=u)}),s||(s=0),a.rank=s,s};(t=e.sources())===null||t===void 0||t.forEach(r=>n(r))},vn=e=>{var t;const o={};let n;const r=s=>{var d;const l=e.node(s);if(!l)return 0;if(o[s])return l.rank;o[s]=!0;let c;return(d=e.outEdges(s))===null||d===void 0||d.forEach(u=>{const f=r(u.w),h=e.edge(u).minlen,p=f-h;p&&(c===void 0||p<c)&&(c=p)}),c||(c=0),(n===void 0||c<n)&&(n=c),l.rank=c,c};(t=e.sources())===null||t===void 0||t.forEach(s=>{e.node(s)&&r(s)}),n===void 0&&(n=0);const i={},a=(s,d)=>{var l;const c=e.node(s),u=isNaN(c.layer)?d:c.layer;(c.rank===void 0||c.rank<u)&&(c.rank=u),!i[s]&&(i[s]=!0,(l=e.outEdges(s))===null||l===void 0||l.map(f=>{a(f.w,u+e.edge(f).minlen)}))};e.nodes().forEach(s=>{const d=e.node(s);d&&(isNaN(d.layer)?d.rank-=n:a(s,d.layer))})},te=(e,t)=>e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen,mn=e=>{const t=new ee({directed:!1}),o=e.nodes()[0],n=e.nodeCount();t.setNode(o,{});let r,i;for(;yn(t,e)<n;)r=Lt(t,e),i=t.hasNode(r.v)?te(e,r):-te(e,r),St(t,e,i);return t},yn=(e,t)=>{const o=n=>{t.nodeEdges(n).forEach(r=>{const i=r.v,a=n===i?r.w:i;!e.hasNode(a)&&!te(t,r)&&(e.setNode(a,{}),e.setEdge(n,a,{}),o(a))})};return e.nodes().forEach(o),e.nodeCount()},bn=e=>{const t=new ee({directed:!1}),o=e.nodes()[0],n=e.nodes().filter(a=>!!e.node(a)).length;t.setNode(o,{});let r,i;for(;wn(t,e)<n;)r=Lt(t,e),i=t.hasNode(r.v)?te(e,r):-te(e,r),St(t,e,i);return t},wn=(e,t)=>{const o=n=>{var r;(r=t.nodeEdges(n))===null||r===void 0||r.forEach(i=>{const a=i.v,s=n===a?i.w:a;!e.hasNode(s)&&(t.node(s).layer!==void 0||!te(t,i))&&(e.setNode(s,{}),e.setEdge(n,s,{}),o(s))})};return e.nodes().forEach(o),e.nodeCount()},Lt=(e,t)=>Ve(t.edges(),o=>e.hasNode(o.v)!==e.hasNode(o.w)?te(t,o):1/0),St=(e,t,o)=>{e.nodes().forEach(n=>{t.node(n).rank||(t.node(n).rank=0),t.node(n).rank+=o})},{preorder:gn,postorder:xn}=Xo,En=e=>{const t=an(e);Pt(t);const o=mn(t);Dt(o),Tt(o,t);let n,r;for(;n=Nn(o);)r=Mn(o,t,n),In(o,t,n,r)},Tt=(e,t)=>{let o=xn(e,e.nodes());o=o==null?void 0:o.slice(0,(o==null?void 0:o.length)-1),o==null||o.forEach(n=>{kn(e,t,n)})},kn=(e,t,o)=>{const r=e.node(o).parent;e.edgeFromArgs(o,r).cutvalue=_n(e,t,o)},_n=(e,t,o)=>{var n;const i=e.node(o).parent;let a=!0,s=t.edgeFromArgs(o,i),d=0;return s||(a=!1,s=t.edgeFromArgs(i,o)),d=s.weight,(n=t.nodeEdges(o))===null||n===void 0||n.forEach(l=>{const c=l.v===o,u=c?l.w:l.v;if(u!==i){const f=c===a,h=t.edge(l).weight;if(d+=f?h:-h,Pn(e,o,u)){const p=e.edgeFromArgs(o,u).cutvalue;d+=f?-p:p}}}),d},Dt=(e,t=e.nodes()[0])=>{Ct(e,{},1,t)},Ct=(e,t,o,n,r)=>{var i;const a=o;let s=o;const d=e.node(n);return t[n]=!0,(i=e.neighbors(n))===null||i===void 0||i.forEach(l=>{t[l]||(s=Ct(e,t,s,l,n))}),d.low=a,d.lim=s++,r?d.parent=r:delete d.parent,s},Nn=e=>e.edges().find(t=>e.edge(t).cutvalue<0),Mn=(e,t,o)=>{let n=o.v,r=o.w;t.hasEdge(n,r)||(n=o.w,r=o.v);const i=e.node(n),a=e.node(r);let s=i,d=!1;i.lim>a.lim&&(s=a,d=!0);const l=t.edges().filter(c=>d===tt(e,e.node(c.v),s)&&d!==tt(e,e.node(c.w),s));return Ve(l,c=>te(t,c))},In=(e,t,o,n)=>{const r=o.v,i=o.w;e.removeEdge(r,i),e.setEdge(n.v,n.w,{}),Dt(e),Tt(e,t),On(e,t)},On=(e,t)=>{const o=e.nodes().find(r=>{var i;return!(!((i=t.node(r))===null||i===void 0)&&i.parent)});let n=gn(e,o);n=n==null?void 0:n.slice(1),n==null||n.forEach(r=>{const i=e.node(r).parent;let a=t.edgeFromArgs(r,i),s=!1;a||(a=t.edgeFromArgs(i,r),s=!0),t.node(r).rank=t.node(i).rank+(s?a.minlen:-a.minlen)})},Pn=(e,t,o)=>e.hasEdge(t,o),tt=(e,t,o)=>o.low<=t.lim&&t.lim<=o.lim,Ln=e=>{switch(e.graph().ranker){case"network-simplex":Tn(e);break;case"tight-tree":ot(e);break;case"longest-path":Sn(e);break;default:ot(e)}},Sn=Pt,ot=e=>{vn(e),bn(e)},Tn=e=>{En(e)},Dn=e=>{var t;const o={};let n=0;const r=i=>{var a;const s=n;(a=e.children(i))===null||a===void 0||a.forEach(r),o[i]={low:s,lim:n++}};return(t=e.children())===null||t===void 0||t.forEach(r),o},Cn=(e,t,o,n)=>{const r=[],i=[],a=Math.min(t[o].low,t[n].low),s=Math.max(t[o].lim,t[n].lim);let d,l;d=o;do d=e.parent(d),r.push(d);while(d&&(t[d].low>a||s>t[d].lim));for(l=d,d=n;d&&d!==l;)i.push(d),d=e.parent(d);return{lca:l,path:r.concat(i.reverse())}},Rn=e=>{var t;const o=Dn(e);(t=e.graph().dummyChains)===null||t===void 0||t.forEach(n=>{var r,i;let a=n,s=e.node(a);const d=s.edgeObj;if(!d)return;const l=Cn(e,o,d.v,d.w),c=l.path,u=l.lca;let f=0,h=c[f],p=!0;for(;a!==d.w;){if(s=e.node(a),p){for(;h!==u&&((r=e.node(h))===null||r===void 0?void 0:r.maxRank)<s.rank;)f++,h=c[f];h===u&&(p=!1)}if(!p){for(;f<c.length-1&&((i=e.node(c[f+1]))===null||i===void 0?void 0:i.minRank)<=s.rank;)f++;h=c[f]}e.setParent(a,h),a=e.successors(a)[0]}})},Fn=e=>{var t;const o=ie(e,"root",{},"_root"),n=jn(e);let r=Math.max(...Object.values(n));Math.abs(r)===1/0&&(r=1);const i=r-1,a=2*i+1;e.graph().nestingRoot=o,e.edges().forEach(d=>{e.edge(d).minlen*=a});const s=Vn(e)+1;(t=e.children())===null||t===void 0||t.forEach(d=>{Rt(e,o,a,s,i,n,d)}),e.graph().nodeRankFactor=a},Rt=(e,t,o,n,r,i,a)=>{const s=e.children(a);if(!(s!=null&&s.length)){a!==t&&e.setEdge(t,a,{weight:0,minlen:o});return}const d=Ze(e,"_bt"),l=Ze(e,"_bb"),c=e.node(a);e.setParent(d,a),c.borderTop=d,e.setParent(l,a),c.borderBottom=l,s==null||s.forEach(u=>{Rt(e,t,o,n,r,i,u);const f=e.node(u),h=f.borderTop?f.borderTop:u,p=f.borderBottom?f.borderBottom:u,m=f.borderTop?n:2*n,b=h!==p?1:r-i[a]+1;e.setEdge(d,h,{minlen:b,weight:m,nestingEdge:!0}),e.setEdge(p,l,{minlen:b,weight:m,nestingEdge:!0})}),e.parent(a)||e.setEdge(t,d,{weight:0,minlen:r+i[a]})},jn=e=>{var t;const o={},n=(r,i)=>{const a=e.children(r);a==null||a.forEach(s=>n(s,i+1)),o[r]=i};return(t=e.children())===null||t===void 0||t.forEach(r=>n(r,1)),o},Vn=e=>{let t=0;return e.edges().forEach(o=>{t+=e.edge(o).weight}),t},Bn=e=>{const t=e.graph();t.nestingRoot&&e.removeNode(t.nestingRoot),delete t.nestingRoot,e.edges().forEach(o=>{e.edge(o).nestingEdge&&e.removeEdgeObj(o)})},nt={run:Fn,cleanup:Bn},An=e=>{var t;const o=n=>{const r=e.children(n),i=e.node(n);if(r!=null&&r.length&&r.forEach(a=>o(a)),i.hasOwnProperty("minRank")){i.borderLeft=[],i.borderRight=[];for(let a=i.minRank,s=i.maxRank+1;a<s;a+=1)rt(e,"borderLeft","_bl",n,i,a),rt(e,"borderRight","_br",n,i,a)}};(t=e.children())===null||t===void 0||t.forEach(n=>o(n))},rt=(e,t,o,n,r,i)=>{const a={rank:i,borderType:t,width:0,height:0},s=r[t][i-1],d=ie(e,"border",a,o);r[t][i]=d,e.setParent(d,n),s&&e.setEdge(s,d,{weight:1})},Gn=e=>{var t;const o=(t=e.graph().rankdir)===null||t===void 0?void 0:t.toLowerCase();(o==="lr"||o==="rl")&&Ft(e)},zn=e=>{var t;const o=(t=e.graph().rankdir)===null||t===void 0?void 0:t.toLowerCase();(o==="bt"||o==="rl")&&$n(e),(o==="lr"||o==="rl")&&(Wn(e),Ft(e))},Ft=e=>{e.nodes().forEach(t=>{it(e.node(t))}),e.edges().forEach(t=>{it(e.edge(t))})},it=e=>{const t=e.width;e.width=e.height,e.height=t},$n=e=>{e.nodes().forEach(t=>{xe(e.node(t))}),e.edges().forEach(t=>{var o;const n=e.edge(t);(o=n.points)===null||o===void 0||o.forEach(r=>xe(r)),n.hasOwnProperty("y")&&xe(n)})},xe=e=>{e!=null&&e.y&&(e.y=-e.y)},Wn=e=>{e.nodes().forEach(t=>{Ee(e.node(t))}),e.edges().forEach(t=>{var o;const n=e.edge(t);(o=n.points)===null||o===void 0||o.forEach(r=>Ee(r)),n.hasOwnProperty("x")&&Ee(n)})},Ee=e=>{const t=e.x;e.x=e.y,e.y=t},st={adjust:Gn,undo:zn},at=e=>{const t={},o=e.nodes().filter(c=>{var u;return!(!((u=e.children(c))===null||u===void 0)&&u.length)}),n=o.map(c=>e.node(c).rank),r=Math.max(...n),i=[];for(let c=0;c<r+1;c++)i.push([]);const a=c=>{var u;if(t.hasOwnProperty(c))return;t[c]=!0;const f=e.node(c);isNaN(f.rank)||i[f.rank].push(c),(u=e.successors(c))===null||u===void 0||u.forEach(h=>a(h))},s=o.sort((c,u)=>e.node(c).rank-e.node(u).rank),l=s.filter(c=>e.node(c).fixorder!==void 0).sort((c,u)=>e.node(c).fixorder-e.node(u).fixorder);return l==null||l.forEach(c=>{isNaN(e.node(c).rank)||i[e.node(c).rank].push(c),t[c]=!0}),s==null||s.forEach(a),i},Un=(e,t,o)=>{const n=dn(o,o.map((c,u)=>u)),i=t.map(c=>{var u;const f=(u=e.outEdges(c))===null||u===void 0?void 0:u.map(h=>({pos:n[h.w]||0,weight:e.edge(h).weight}));return f==null?void 0:f.sort((h,p)=>h.pos-p.pos)}).flat().filter(c=>c!==void 0);let a=1;for(;a<o.length;)a<<=1;const s=2*a-1;a-=1;const d=Array(s).fill(0,0,s);let l=0;return i==null||i.forEach(c=>{if(c){let u=c.pos+a;d[u]+=c.weight;let f=0;for(;u>0;)u%2&&(f+=d[u+1]),u=u-1>>1,d[u]+=c.weight;l+=c.weight*f}}),l},dt=(e,t)=>{let o=0;for(let n=1;n<(t==null?void 0:t.length);n+=1)o+=Un(e,t[n-1],t[n]);return o},qn=(e,t,o)=>{const n=Yn(e),r=new ee({compound:!0}).setGraph({root:n}).setDefaultNodeLabel(i=>e.node(i));return e.nodes().forEach(i=>{var a;const s=e.node(i),d=e.parent(i);(s.rank===t||s.minRank<=t&&t<=s.maxRank)&&(r.setNode(i),r.setParent(i,d||n),(a=e[o](i))===null||a===void 0||a.forEach(l=>{const c=l.v===i?l.w:l.v,u=r.edgeFromArgs(c,i),f=u!==void 0?u.weight:0;r.setEdge(c,i,{weight:e.edge(l).weight+f})}),s.hasOwnProperty("minRank")&&r.setNode(i,{borderLeft:s.borderLeft[t],borderRight:s.borderRight[t]}))}),r},Yn=e=>{let t;for(;e.hasNode(t=`_root${Math.random()}`););return t},Kn=(e,t,o)=>{const n={};let r;o==null||o.forEach(i=>{let a=e.parent(i),s,d;for(;a;){if(s=e.parent(a),s?(d=n[s],n[s]=a):(d=r,r=a),d&&d!==a){t.setEdge(d,a);return}a=s}})},Xn=(e,t)=>t.map(o=>{const n=e.inEdges(o);if(!(n!=null&&n.length))return{v:o};{const r={sum:0,weight:0};return n==null||n.forEach(i=>{const a=e.edge(i),s=e.node(i.v);r.sum+=a.weight*s.order,r.weight+=a.weight}),{v:o,barycenter:r.sum/r.weight,weight:r.weight}}}),Hn=(e,t)=>{var o,n,r;const i={};e==null||e.forEach((s,d)=>{i[s.v]={i:d,indegree:0,in:[],out:[],vs:[s.v]};const l=i[s.v];s.barycenter!==void 0&&(l.barycenter=s.barycenter,l.weight=s.weight)}),(o=t.edges())===null||o===void 0||o.forEach(s=>{const d=i[s.v],l=i[s.w];d!==void 0&&l!==void 0&&(l.indegree++,d.out.push(i[s.w]))});const a=(r=(n=Object.values(i)).filter)===null||r===void 0?void 0:r.call(n,s=>!s.indegree);return Jn(a)},Jn=e=>{var t,o;const n=[],r=d=>l=>{l.merged||(l.barycenter===void 0||d.barycenter===void 0||l.barycenter>=d.barycenter)&&Qn(d,l)},i=d=>l=>{l.in.push(d),--l.indegree===0&&e.push(l)};for(;e!=null&&e.length;){const d=e.pop();n.push(d),(t=d.in.reverse())===null||t===void 0||t.forEach(l=>r(d)(l)),(o=d.out)===null||o===void 0||o.forEach(l=>i(d)(l))}const a=n.filter(d=>!d.merged),s=["vs","i","barycenter","weight"];return a.map(d=>{const l={};return s==null||s.forEach(c=>{d[c]!==void 0&&(l[c]=d[c])}),l})},Qn=(e,t)=>{var o;let n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=(o=t.vs)===null||o===void 0?void 0:o.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0},Zn=(e,t,o,n)=>{const r=un(e,f=>{const h=f.hasOwnProperty("fixorder")&&!isNaN(f.fixorder);return n?!h&&f.hasOwnProperty("barycenter"):h||f.hasOwnProperty("barycenter")}),i=r.lhs,a=r.rhs.sort((f,h)=>-f.i- -h.i),s=[];let d=0,l=0,c=0;i==null||i.sort(er(!!t,!!o)),c=lt(s,a,c),i==null||i.forEach(f=>{var h;c+=(h=f.vs)===null||h===void 0?void 0:h.length,s.push(f.vs),d+=f.barycenter*f.weight,l+=f.weight,c=lt(s,a,c)});const u={vs:s.flat()};return l&&(u.barycenter=d/l,u.weight=l),u},lt=(e,t,o)=>{let n=o,r;for(;t.length&&(r=t[t.length-1]).i<=n;)t.pop(),e==null||e.push(r.vs),n++;return n},er=(e,t)=>(o,n)=>{if(o.fixorder!==void 0&&n.fixorder!==void 0)return o.fixorder-n.fixorder;if(o.barycenter<n.barycenter)return-1;if(o.barycenter>n.barycenter)return 1;if(t&&o.order!==void 0&&n.order!==void 0){if(o.order<n.order)return-1;if(o.order>n.order)return 1}return e?n.i-o.i:o.i-n.i},jt=(e,t,o,n,r,i)=>{var a,s,d,l;let c=e.children(t);const u=e.node(t),f=u?u.borderLeft:void 0,h=u?u.borderRight:void 0,p={};f&&(c=c==null?void 0:c.filter(k=>k!==f&&k!==h));const m=Xn(e,c||[]);m==null||m.forEach(k=>{var y;if(!((y=e.children(k.v))===null||y===void 0)&&y.length){const N=jt(e,k.v,o,n,i);p[k.v]=N,N.hasOwnProperty("barycenter")&&or(k,N)}});const b=Hn(m,o);tr(b,p),(a=b.filter(k=>k.vs.length>0))===null||a===void 0||a.forEach(k=>{const y=e.node(k.vs[0]);y&&(k.fixorder=y.fixorder,k.order=y.order)});const w=Zn(b,n,r,i);if(f&&(w.vs=[f,w.vs,h].flat(),!((s=e.predecessors(f))===null||s===void 0)&&s.length)){const k=e.node(((d=e.predecessors(f))===null||d===void 0?void 0:d[0])||""),y=e.node(((l=e.predecessors(h))===null||l===void 0?void 0:l[0])||"");w.hasOwnProperty("barycenter")||(w.barycenter=0,w.weight=0),w.barycenter=(w.barycenter*w.weight+k.order+y.order)/(w.weight+2),w.weight+=2}return w},tr=(e,t)=>{e==null||e.forEach(o=>{var n;const r=(n=o.vs)===null||n===void 0?void 0:n.map(i=>t[i]?t[i].vs:i);o.vs=r.flat()})},or=(e,t)=>{e.barycenter!==void 0?(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight):(e.barycenter=t.barycenter,e.weight=t.weight)},nr=(e,t)=>{const o=Mt(e),n=[],r=[];for(let c=1;c<o+1;c++)n.push(c);for(let c=o-1;c>-1;c--)r.push(c);const i=ct(e,n,"inEdges"),a=ct(e,r,"outEdges");let s=at(e);ke(e,s);let d=Number.POSITIVE_INFINITY,l;for(let c=0,u=0;u<4;++c,++u){ut(c%2?i:a,c%4>=2,!1,t),s=he(e);const f=dt(e,s);f<d&&(u=0,l=ye(s),d=f)}s=at(e),ke(e,s);for(let c=0,u=0;u<4;++c,++u){ut(c%2?i:a,c%4>=2,!0,t),s=he(e);const f=dt(e,s);f<d&&(u=0,l=ye(s),d=f)}ke(e,l)},ct=(e,t,o)=>t.map(n=>qn(e,n,o)),ut=(e,t,o,n)=>{const r=new ee;e==null||e.forEach(i=>{var a;const s=i.graph().root,d=jt(i,s,r,t,o,n);for(let l=0;l<((a=d.vs)===null||a===void 0?void 0:a.length);l++){const c=i.node(d.vs[l]);c&&(c.order=l)}Kn(i,r,d.vs)})},ke=(e,t)=>{t==null||t.forEach(o=>{o==null||o.forEach((n,r)=>{e.node(n).order=r})})};class rr extends be{}const ir=(e,t)=>{const o={},n=(r,i)=>{let a=0,s=0;const d=r.length,l=i==null?void 0:i[(i==null?void 0:i.length)-1];return i==null||i.forEach((c,u)=>{var f;const h=ar(e,c),p=h?e.node(h).order:d;(h||c===l)&&((f=i.slice(s,u+1))===null||f===void 0||f.forEach(m=>{var b;(b=e.predecessors(m))===null||b===void 0||b.forEach(w=>{var k;const y=e.node(w),N=y.order;(N<a||p<N)&&!(y.dummy&&(!((k=e.node(m))===null||k===void 0)&&k.dummy))&&Vt(o,w,m)})}),s=u+1,a=p)}),i};return t!=null&&t.length&&t.reduce(n),o},sr=(e,t)=>{const o={};function n(s,d,l,c,u){var f,h;let p;for(let m=d;m<l;m++)p=s[m],!((f=e.node(p))===null||f===void 0)&&f.dummy&&((h=e.predecessors(p))===null||h===void 0||h.forEach(b=>{const w=e.node(b);w.dummy&&(w.order<c||w.order>u)&&Vt(o,b,p)}))}function r(s){return JSON.stringify(s.slice(1))}function i(s,d){const l=r(s);d.get(l)||(n(...s),d.set(l,!0))}const a=(s,d)=>{let l=-1,c,u=0;const f=new Map;return d==null||d.forEach((h,p)=>{var m;if(((m=e.node(h))===null||m===void 0?void 0:m.dummy)==="border"){const b=e.predecessors(h)||[];b.length&&(c=e.node(b[0]).order,i([d,u,p,l,c],f),u=p,l=c)}i([d,u,d.length,c,s.length],f)}),d};return t!=null&&t.length&&t.reduce(a),o},ar=(e,t)=>{var o,n;if(!((o=e.node(t))===null||o===void 0)&&o.dummy)return(n=e.predecessors(t))===null||n===void 0?void 0:n.find(r=>e.node(r).dummy)},Vt=(e,t,o)=>{let n=t,r=o;if(n>r){const a=n;n=r,r=a}let i=e[n];i||(e[n]=i={}),i[r]=!0},dr=(e,t,o)=>{let n=t,r=o;if(n>r){const i=t;n=r,r=i}return!!e[n]},lr=(e,t,o,n)=>{const r={},i={},a={};return t==null||t.forEach(s=>{s==null||s.forEach((d,l)=>{r[d]=d,i[d]=d,a[d]=l})}),t==null||t.forEach(s=>{let d=-1;s==null||s.forEach(l=>{let c=n(l);if(c.length){c=c.sort((f,h)=>a[f]-a[h]);const u=(c.length-1)/2;for(let f=Math.floor(u),h=Math.ceil(u);f<=h;++f){const p=c[f];i[l]===l&&d<a[p]&&!dr(o,l,p)&&(i[p]=l,i[l]=r[l]=r[p],d=a[p])}}})}),{root:r,align:i}},cr=(e,t,o,n,r)=>{var i;const a={},s=ur(e,t,o,r),d=r?"borderLeft":"borderRight",l=(f,h)=>{let p=s.nodes(),m=p.pop();const b={};for(;m;)b[m]?f(m):(b[m]=!0,p.push(m),p=p.concat(h(m))),m=p.pop()},c=f=>{a[f]=(s.inEdges(f)||[]).reduce((h,p)=>Math.max(h,(a[p.v]||0)+s.edge(p)),0)},u=f=>{const h=(s.outEdges(f)||[]).reduce((m,b)=>Math.min(m,(a[b.w]||0)-s.edge(b)),Number.POSITIVE_INFINITY),p=e.node(f);h!==Number.POSITIVE_INFINITY&&p.borderType!==d&&(a[f]=Math.max(a[f],h))};return l(c,s.predecessors.bind(s)),l(u,s.successors.bind(s)),(i=Object.values(n))===null||i===void 0||i.forEach(f=>{a[f]=a[o[f]]}),a},ur=(e,t,o,n)=>{const r=new rr,i=e.graph(),a=vr(i.nodesep,i.edgesep,n);return t==null||t.forEach(s=>{let d;s==null||s.forEach(l=>{const c=o[l];if(r.setNode(c),d){const u=o[d],f=r.edgeFromArgs(u,c);r.setEdge(u,c,Math.max(a(e,l,d),f||0))}d=l})}),r},fr=(e,t)=>Ve(Object.values(t),o=>{var n;let r=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return(n=Object.keys(o))===null||n===void 0||n.forEach(a=>{const s=o[a],d=mr(e,a)/2;r=Math.max(s+d,r),i=Math.min(s-d,i)}),r-i});function hr(e,t){const o=Object.values(t),n=Math.min(...o),r=Math.max(...o);["u","d"].forEach(i=>{["l","r"].forEach(a=>{const s=i+a,d=e[s];let l;if(d===t)return;const c=Object.values(d);l=a==="l"?n-Math.min(...c):r-Math.max(...c),l&&(e[s]={},Object.keys(d).forEach(u=>{e[s][u]=d[u]+l}))})})}const pr=(e,t)=>{const o={};return Object.keys(e.ul).forEach(n=>{if(t)o[n]=e[t.toLowerCase()][n];else{const r=Object.values(e).map(i=>i[n]);o[n]=(r[0]+r[1])/2}}),o},vr=(e,t,o)=>(n,r,i)=>{const a=n.node(r),s=n.node(i);let d=0,l;if(d+=a.width/2,a.hasOwnProperty("labelpos"))switch((a.labelpos||"").toLowerCase()){case"l":l=-a.width/2;break;case"r":l=a.width/2;break}if(l&&(d+=o?l:-l),l=0,d+=(a.dummy?t:e)/2,d+=(s.dummy?t:e)/2,d+=s.width/2,s.labelpos)switch((s.labelpos||"").toLowerCase()){case"l":l=s.width/2;break;case"r":l=-s.width/2;break}return l&&(d+=o?l:-l),l=0,d},mr=(e,t)=>e.node(t).width||0,yr=e=>{const t=he(e),o=e.graph().ranksep;let n=0;t==null||t.forEach(r=>{const i=r.map(s=>e.node(s).height),a=Math.max(...i,0);r==null||r.forEach(s=>{e.node(s).y=n+a/2}),n+=a+o})},br=e=>{const t=he(e),o=Object.assign(ir(e,t),sr(e,t)),n={};let r=[];["u","d"].forEach(a=>{r=a==="u"?t:Object.values(t).reverse(),["l","r"].forEach(s=>{s==="r"&&(r=r.map(u=>Object.values(u).reverse()));const d=(a==="u"?e.predecessors:e.successors).bind(e),l=lr(e,r,o,d),c=cr(e,r,l.root,l.align,s==="r");s==="r"&&Object.keys(c).forEach(u=>c[u]=-c[u]),n[a+s]=c})});const i=fr(e,n);return i&&hr(n,i),pr(n,e.graph().align)},wr=e=>{var t;const o=Nt(e);yr(o);const n=br(o);(t=Object.keys(n))===null||t===void 0||t.forEach(r=>{o.node(r).x=n[r]})},gr=(e,t)=>{const n=e.nodes().filter(a=>{var s;return!(!((s=e.children(a))===null||s===void 0)&&s.length)}).map(a=>e.node(a).rank),r=Math.max(...n),i=[];for(let a=0;a<r+1;a++)i[a]=[];t==null||t.forEach(a=>{const s=e.node(a);!s||s!=null&&s.dummy||isNaN(s.rank)||(s.fixorder=i[s.rank].length,i[s.rank].push(a))})},xr=(e,t)=>{const o=t&&t.debugTiming?It:Ot;o("layout",()=>{t&&!t.keepNodeOrder&&t.prevGraph&&o("  inheritOrder",()=>{kr(e,t.prevGraph)});const n=o("  buildLayoutGraph",()=>Sr(e));t&&t.edgeLabelSpace===!1||o("  makeSpaceForEdgeLabels",()=>{Tr(n)});try{o("  runLayout",()=>{Er(n,o,t)})}catch(r){if(r.message==="Not possible to find intersection inside of the rectangle"){console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`,r);return}throw r}o("  updateInputGraph",()=>{_r(e,n)})})},Er=(e,t,o)=>{t("    removeSelfEdges",()=>{Gr(e)}),t("    acyclic",()=>{Je.run(e)}),t("    nestingGraph.run",()=>{nt.run(e)}),t("    rank",()=>{Ln(Nt(e))}),t("    injectEdgeLabelProxies",()=>{Dr(e)}),t("    removeEmptyRanks",()=>{cn(e)}),t("    nestingGraph.cleanup",()=>{nt.cleanup(e)}),t("    normalizeRanks",()=>{ln(e)}),t("    assignRankMinMax",()=>{Cr(e)}),t("    removeEdgeLabelProxies",()=>{Rr(e)}),t("    normalize.run",()=>{et.run(e)}),t("    parentDummyChains",()=>{Rn(e)}),t("    addBorderSegments",()=>{An(e)}),o&&o.keepNodeOrder&&t("    initDataOrder",()=>{gr(e,o.nodeOrder)}),t("    order",()=>{nr(e,o==null?void 0:o.keepNodeOrder)}),t("    insertSelfEdges",()=>{zr(e)}),t("    adjustCoordinateSystem",()=>{st.adjust(e)}),t("    position",()=>{wr(e)}),t("    positionSelfEdges",()=>{$r(e)}),t("    removeBorderNodes",()=>{Ar(e)}),t("    normalize.undo",()=>{et.undo(e)}),t("    fixupEdgeLabelCoords",()=>{Vr(e)}),t("    undoCoordinateSystem",()=>{st.undo(e)}),t("    translateGraph",()=>{Fr(e)}),t("    assignNodeIntersects",()=>{jr(e)}),t("    reversePoints",()=>{Br(e)}),t("    acyclic.undo",()=>{Je.undo(e)})},kr=(e,t)=>{e.nodes().forEach(o=>{const n=e.node(o),r=t.node(o);r!==void 0?(n.fixorder=r._order,delete r._order):delete n.fixorder})},_r=(e,t)=>{e.nodes().forEach(o=>{var n;const r=e.node(o);if(r){const i=t.node(o);r.x=i.x,r.y=i.y,r._order=i.order,r._rank=i.rank,!((n=t.children(o))===null||n===void 0)&&n.length&&(r.width=i.width,r.height=i.height)}}),e.edges().forEach(o=>{const n=e.edge(o),r=t.edge(o);n.points=r?r.points:[],r&&r.hasOwnProperty("x")&&(n.x=r.x,n.y=r.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height},Nr=["nodesep","edgesep","ranksep","marginx","marginy"],Mr={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},_e=["acyclicer","ranker","rankdir","align"],Ir=["width","height","layer","fixorder"],Or={width:0,height:0},Pr=["minlen","weight","width","height","labeloffset"],Lr={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Ne=["labelpos"],Sr=e=>{const t=new ee({multigraph:!0,compound:!0}),o=Ie(e.graph()),n={};return _e==null||_e.forEach(r=>{o[r]!==void 0&&(n[r]=o[r])}),t.setGraph(Object.assign({},Mr,Me(o,Nr),n)),e.nodes().forEach(r=>{const i=Ie(e.node(r)),a=Object.assign(Object.assign({},Or),i),s=Me(a,Ir);t.setNode(r,s),t.setParent(r,e.parent(r))}),e.edges().forEach(r=>{const i=Ie(e.edge(r)),a={};Ne==null||Ne.forEach(s=>{i[s]!==void 0&&(a[s]=i[s])}),t.setEdgeObj(r,Object.assign({},Lr,Me(i,Pr),a))}),t},Tr=e=>{const t=e.graph();t.ranksep||(t.ranksep=0),t.ranksep/=2,e.nodes().forEach(o=>{const n=e.node(o);isNaN(n.layer)||n.layer||(n.layer=0)}),e.edges().forEach(o=>{var n;const r=e.edge(o);r.minlen*=2,((n=r.labelpos)===null||n===void 0?void 0:n.toLowerCase())!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?r.width+=r.labeloffset:r.height+=r.labeloffset)})},Dr=e=>{e.edges().forEach(t=>{const o=e.edge(t);if(o.width&&o.height){const n=e.node(t.v),r=e.node(t.w),i={e:t,rank:(r.rank-n.rank)/2+n.rank};ie(e,"edge-proxy",i,"_ep")}})},Cr=e=>{let t=0;e.nodes().forEach(o=>{var n,r;const i=e.node(o);i.borderTop&&(i.minRank=(n=e.node(i.borderTop))===null||n===void 0?void 0:n.rank,i.maxRank=(r=e.node(i.borderBottom))===null||r===void 0?void 0:r.rank,t=Math.max(t,i.maxRank||-1/0))}),e.graph().maxRank=t},Rr=e=>{e.nodes().forEach(t=>{const o=e.node(t);o.dummy==="edge-proxy"&&(e.edge(o.e).labelRank=o.rank,e.removeNode(t))})},Fr=e=>{let t,o=0,n,r=0;const i=e.graph(),a=i.marginx||0,s=i.marginy||0,d=l=>{if(!l)return;const c=l.x,u=l.y,f=l.width,h=l.height;!isNaN(c)&&!isNaN(f)&&(t===void 0&&(t=c-f/2),t=Math.min(t,c-f/2),o=Math.max(o,c+f/2)),!isNaN(u)&&!isNaN(h)&&(n===void 0&&(n=u-h/2),n=Math.min(n,u-h/2),r=Math.max(r,u+h/2))};e.nodes().forEach(l=>{d(e.node(l))}),e.edges().forEach(l=>{const c=e.edge(l);c!=null&&c.hasOwnProperty("x")&&d(c)}),t-=a,n-=s,e.nodes().forEach(l=>{const c=e.node(l);c&&(c.x-=t,c.y-=n)}),e.edges().forEach(l=>{var c;const u=e.edge(l);(c=u.points)===null||c===void 0||c.forEach(f=>{f.x-=t,f.y-=n}),u.hasOwnProperty("x")&&(u.x-=t),u.hasOwnProperty("y")&&(u.y-=n)}),i.width=o-t+a,i.height=r-n+s},jr=e=>{e.edges().forEach(t=>{const o=e.edge(t),n=e.node(t.v),r=e.node(t.w);let i,a;o.points?(i=o.points[0],a=o.points[o.points.length-1]):(o.points=[],i=r,a=n),o.points.unshift(Qe(n,i)),o.points.push(Qe(r,a))})},Vr=e=>{e.edges().forEach(t=>{const o=e.edge(t);if(o!=null&&o.hasOwnProperty("x"))switch((o.labelpos==="l"||o.labelpos==="r")&&(o.width-=o.labeloffset),o.labelpos){case"l":o.x-=o.width/2+o.labeloffset;break;case"r":o.x+=o.width/2+o.labeloffset;break}})},Br=e=>{e.edges().forEach(t=>{var o;const n=e.edge(t);n.reversed&&((o=n.points)===null||o===void 0||o.reverse())})},Ar=e=>{e.nodes().forEach(t=>{var o,n,r;if(!((o=e.children(t))===null||o===void 0)&&o.length){const i=e.node(t),a=e.node(i.borderTop),s=e.node(i.borderBottom),d=e.node(i.borderLeft[((n=i.borderLeft)===null||n===void 0?void 0:n.length)-1]),l=e.node(i.borderRight[((r=i.borderRight)===null||r===void 0?void 0:r.length)-1]);i.width=Math.abs((l==null?void 0:l.x)-(d==null?void 0:d.x))||10,i.height=Math.abs((s==null?void 0:s.y)-(a==null?void 0:a.y))||10,i.x=((d==null?void 0:d.x)||0)+i.width/2,i.y=((a==null?void 0:a.y)||0)+i.height/2}}),e.nodes().forEach(t=>{var o;((o=e.node(t))===null||o===void 0?void 0:o.dummy)==="border"&&e.removeNode(t)})},Gr=e=>{e.edges().forEach(t=>{if(t.v===t.w){const o=e.node(t.v);o.selfEdges||(o.selfEdges=[]),o.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdgeObj(t)}})},zr=e=>{const t=he(e);t==null||t.forEach(o=>{let n=0;o==null||o.forEach((r,i)=>{var a;const s=e.node(r);s.order=i+n,(a=s.selfEdges)===null||a===void 0||a.forEach(d=>{ie(e,"selfedge",{width:d.label.width,height:d.label.height,rank:s.rank,order:i+ ++n,e:d.e,label:d.label},"_se")}),delete s.selfEdges})})},$r=e=>{e.nodes().forEach(t=>{const o=e.node(t);if(o.dummy==="selfedge"){const n=e.node(o.e.v),r=n.x+n.width/2,i=n.y,a=o.x-r,s=n.height/2;e.setEdgeObj(o.e,o.label),e.removeNode(t),o.label.points=[{x:r+2*a/3,y:i-s},{x:r+5*a/6,y:i-s},{y:i,x:r+a},{x:r+5*a/6,y:i+s},{x:r+2*a/3,y:i+s}],o.label.x=o.x,o.label.y=o.y}})},Me=(e,t)=>{const o={};return t==null||t.forEach(n=>{e[n]!==void 0&&(o[n]=+e[n])}),o},Ie=(e={})=>{const t={};return Object.keys(e).forEach(o=>{t[o.toLowerCase()]=e[o]}),t},Wr={layout:xr,util:{time:It,notime:Ot}};class Ur extends bo{constructor(t){super(),this.rankdir="TB",this.nodesep=50,this.ranksep=50,this.controlPoints=!1,this.sortByCombo=!1,this.edgeLabelSpace=!0,this.radial=!1,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.layoutNode=o=>{const n=this,{nodes:r}=n,i=r.find(a=>a.id===o);return i?i.layout!==!1:!0},this.updateCfg(t)}getDefaultCfg(){return{rankdir:"TB",align:void 0,nodeSize:void 0,nodesepFunc:void 0,ranksepFunc:void 0,nodesep:50,ranksep:50,controlPoints:!1,radial:!1,focusNode:null}}execute(){var t,o,n,r;const i=this,{nodes:a,nodeSize:s,rankdir:d,combos:l,begin:c,radial:u,comboEdges:f=[],vedges:h=[]}=i;if(!a)return;const p=i.edges||[],m=new ee({multigraph:!0,compound:!0});i.nodeMap={};const b={};a.forEach(v=>{i.nodeMap[v.id]=v,v.comboId&&(b[v.comboId]=b[v.comboId]||[],b[v.comboId].push(v.id))});let w=[];const k={};!((t=i.nodeOrder)===null||t===void 0)&&t.length?(i.nodeOrder.forEach(v=>{k[v]=!0,w.push(i.nodeMap[v])}),a.forEach(v=>{k[v.id]||w.push(v)})):w=a;let y;s?Ue(s)?y=()=>s:y=()=>[s,s]:y=v=>v.size?Ue(v.size)?v.size:wt(v.size)?[v.size.width||40,v.size.height||40]:[v.size,v.size]:[40,40];const N=qe(i.ranksep,50,i.ranksepFunc),P=qe(i.nodesep,50,i.nodesepFunc);let T=P,Q=N;(d==="LR"||d==="RL")&&(T=N,Q=P),m.setDefaultEdgeLabel(()=>({})),m.setGraph(i);const O={};this.sortByCombo&&l&&l.forEach(v=>{if(O[v.id]=v,v.collapsed){const L=y(v),C=Q(v),S=T(v),F=L[0]+2*S,g=L[1]+2*C;m.setNode(v.id,{width:F,height:g})}v.parentId&&(O[v.parentId]||m.setNode(v.parentId,{}),m.setParent(v.id,v.parentId))}),w.filter(v=>v.layout!==!1).forEach(v=>{const L=y(v),C=Q(v),S=T(v),F=L[0]+2*S,g=L[1]+2*C,_=v.layer;me(_)?m.setNode(v.id,{width:F,height:g,layer:_}):m.setNode(v.id,{width:F,height:g}),this.sortByCombo&&v.comboId&&(O[v.comboId]||(O[v.comboId]={id:v.comboId},m.setNode(v.comboId,{})),m.setParent(v.id,v.comboId))}),p.forEach(v=>{const L=oe(v,"source"),C=oe(v,"target");this.layoutNode(L)&&this.layoutNode(C)&&m.setEdge(L,C,{weight:v.weight||1})}),(o=f==null?void 0:f.concat(h||[]))===null||o===void 0||o.forEach(v=>{var L,C;const{source:S,target:F}=v,g=!((L=O[S])===null||L===void 0)&&L.collapsed?[S]:b[S]||[S],_=!((C=O[F])===null||C===void 0)&&C.collapsed?[F]:b[F]||[F];g.forEach(M=>{_.forEach(I=>{m.setEdge(M,I,{weight:v.weight||1})})})});let z;!((n=i.preset)===null||n===void 0)&&n.nodes&&(z=new ee({multigraph:!0,compound:!0}),i.preset.nodes.forEach(v=>{z==null||z.setNode(v.id,v)})),Wr.layout(m,{prevGraph:z,edgeLabelSpace:i.edgeLabelSpace,keepNodeOrder:!!i.nodeOrder,nodeOrder:i.nodeOrder});const D=[0,0];if(c){let v=1/0,L=1/0;m.nodes().forEach(C=>{const S=m.node(C);v>S.x&&(v=S.x),L>S.y&&(L=S.y)}),m.edges().forEach(C=>{var S;(S=m.edge(C).points)===null||S===void 0||S.forEach(g=>{v>g.x&&(v=g.x),L>g.y&&(L=g.y)})}),D[0]=c[0]-v,D[1]=c[1]-L}const A=d==="LR"||d==="RL";if(u){const{focusNode:v,ranksep:L,getRadialPos:C}=this,S=wo(v)?v:v==null?void 0:v.id,F=S?(r=m.node(S))===null||r===void 0?void 0:r._rank:0,g=[],_=A?"y":"x",M=A?"height":"width";let I=1/0,j=-1/0;m.nodes().forEach(x=>{const E=m.node(x);if(!i.nodeMap[x])return;const $=P(i.nodeMap[x]);if(F===0)g[E._rank]||(g[E._rank]={nodes:[],totalWidth:0,maxSize:-1/0}),g[E._rank].nodes.push(x),g[E._rank].totalWidth+=$*2+E[M],g[E._rank].maxSize<Math.max(E.width,E.height)&&(g[E._rank].maxSize=Math.max(E.width,E.height));else{const R=E._rank-F;if(R===0)g[R]||(g[R]={nodes:[],totalWidth:0,maxSize:-1/0}),g[R].nodes.push(x),g[R].totalWidth+=$*2+E[M],g[R].maxSize<Math.max(E.width,E.height)&&(g[R].maxSize=Math.max(E.width,E.height));else{const V=Math.abs(R);g[V]||(g[V]={left:[],right:[],totalWidth:0,maxSize:-1/0}),g[V].totalWidth+=$*2+E[M],g[V].maxSize<Math.max(E.width,E.height)&&(g[V].maxSize=Math.max(E.width,E.height)),R<0?g[V].left.push(x):g[V].right.push(x)}}const Y=E[_]-E[M]/2-$,W=E[_]+E[M]/2+$;Y<I&&(I=Y),W>j&&(j=W)});let B=L||50;const G={},X=(j-I)/.9,se=[(I+j-X)*.5,(I+j+X)*.5],ae=(x,E,$=-1/0,Y=[0,1])=>{let W=$;return x.forEach(R=>{const V=m.node(R);G[R]=E;const{x:H,y:U}=C(V[_],se,X,E,Y);if(!i.nodeMap[R])return;i.nodeMap[R].x=H+D[0],i.nodeMap[R].y=U+D[1],i.nodeMap[R]._order=V._order;const q=N(i.nodeMap[R]);W<q&&(W=q)}),W};let we=!0;const zt=0;g.forEach(x=>{var E,$,Y,W,R,V,H;if(!(!((E=x==null?void 0:x.nodes)===null||E===void 0)&&E.length)&&!(!(($=x==null?void 0:x.left)===null||$===void 0)&&$.length)&&!(!((Y=x==null?void 0:x.right)===null||Y===void 0)&&Y.length))return;if(we&&x.nodes.length===1){const q=x.nodes[0];if(!i.nodeMap[q])return;i.nodeMap[q].x=D[0],i.nodeMap[q].y=D[1],G[x.nodes[0]]=0,B=N(i.nodeMap[q]),we=!1;return}B=Math.max(B,x.totalWidth/(2*Math.PI));let U=-1/0;if(F===0||!((W=x.nodes)===null||W===void 0)&&W.length)U=ae(x.nodes,B,U,[0,1]);else{const q=((R=x.left)===null||R===void 0?void 0:R.length)/(((V=x.left)===null||V===void 0?void 0:V.length)+((H=x.right)===null||H===void 0?void 0:H.length));U=ae(x.left,B,U,[0,q]),U=ae(x.right,B,U,[q+.05,1])}B+=U,we=!1,zt-x.maxSize}),m.edges().forEach(x=>{var E,$,Y;const W=m.edge(x),R=p.findIndex(V=>{const H=oe(V,"source"),U=oe(V,"target");return H===x.v&&U===x.w});if(!(R<=-1)&&i.edgeLabelSpace&&i.controlPoints&&p[R].type!=="loop"){const V=_==="x"?"y":"x",H=(E=W==null?void 0:W.points)===null||E===void 0?void 0:E.slice(1,W.points.length-1),U=[],q=($=m.node(x.v))===null||$===void 0?void 0:$[V],$t=q-((Y=m.node(x.w))===null||Y===void 0?void 0:Y[V]),Ae=G[x.v],Wt=Ae-G[x.w];H==null||H.forEach(Ge=>{const Ut=(Ge[V]-q)/$t*Wt+Ae,ze=C(Ge[_],se,X,Ut);U.push({x:ze.x+D[0],y:ze.y+D[1]})}),p[R].controlPoints=U}})}else{const v=new Set,C=d==="BT"||d==="RL"?(_,M)=>M-_:(_,M)=>_-M;m.nodes().forEach(_=>{const M=m.node(_);if(!M)return;let I=this.nodeMap[_];I||(I=l==null?void 0:l.find(j=>j.id===_)),I&&(I.x=M.x+D[0],I.y=M.y+D[1],I._order=M._order,v.add(A?I.x:I.y))});const S=Array.from(v).sort(C),F=A?(_,M)=>_.x!==M.x:(_,M)=>_.y!==M.y,g=A?(_,M,I)=>{const j=Math.max(M.y,I.y),B=Math.min(M.y,I.y);return _.filter(G=>G.y<=j&&G.y>=B)}:(_,M,I)=>{const j=Math.max(M.x,I.x),B=Math.min(M.x,I.x);return _.filter(G=>G.x<=j&&G.x>=B)};m.edges().forEach(_=>{var M;const I=m.edge(_),j=p.findIndex(B=>{const G=oe(B,"source"),X=oe(B,"target");return G===_.v&&X===_.w});if(!(j<=-1)&&i.edgeLabelSpace&&i.controlPoints&&p[j].type!=="loop"){(M=I==null?void 0:I.points)===null||M===void 0||M.forEach(X=>{X.x+=D[0],X.y+=D[1]});const B=i.nodeMap[_.v],G=i.nodeMap[_.w];p[j].controlPoints=qr(I==null?void 0:I.points,B,G,S,A,F,g)}})}return i.onLayoutEnd&&i.onLayoutEnd(),{nodes:a,edges:p}}getRadialPos(t,o,n,r,i=[0,1]){let a=(t-o[0])/n;a=a*(i[1]-i[0])+i[0];const s=a*2*Math.PI;return{x:Math.cos(s)*r,y:Math.sin(s)*r}}getType(){return"dagre"}}const qr=(e,t,o,n,r,i,a)=>{let s=(e==null?void 0:e.slice(1,e.length-1))||[];if(t&&o){let{x:d,y:l}=t,{x:c,y:u}=o;if(r&&(d=t.y,l=t.x,c=o.y,u=o.x),u!==l&&d!==c){const f=n.indexOf(l),h=n[f+1];if(h){const b=s[0],w=r?{x:(l+h)/2,y:(b==null?void 0:b.y)||c}:{x:(b==null?void 0:b.x)||c,y:(l+h)/2};(!b||i(b,w))&&s.unshift(w)}const p=n.indexOf(u),m=Math.abs(p-f);if(m===1)s=a(s,t,o),s.length||s.push(r?{x:(l+u)/2,y:d}:{x:d,y:(l+u)/2});else if(m>1){const b=n[p-1];if(b){const w=s[s.length-1],k=r?{x:(u+b)/2,y:(w==null?void 0:w.y)||c}:{x:(w==null?void 0:w.x)||d,y:(u+b)/2};(!w||i(w,k))&&s.push(k)}}}}return s};class Bt{constructor(){J(this,"lf");J(this,"option")}render(t){this.lf=t}getBytesLength(t){if(!t)return 0;let o=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);t.match(/[A-Z]/)?o+=1.5:r>=1&&r<=126||r>=65376&&r<=65439?o+=1:o+=2}return o}layout(t={}){const{nodes:o,edges:n,gridSize:r}=this.lf.graphModel;let i=40,a=40;r>20&&(i=r*2,a=r*2),this.option={type:"dagre",rankdir:"LR",align:"DR",nodesep:i,ranksep:a,begin:[120,120],...t};const d=new Ur(this.option).layout({nodes:o.map(c=>({id:c.id,size:{width:c.width,height:c.height},model:c})),edges:n.map(c=>({source:c.sourceNodeId,target:c.targetNodeId,model:c}))}),l={nodes:[],edges:[]};d.nodes.forEach(c=>{const{model:u}=c,f=u.getData();f.x=c.x,f.y=c.y,l.nodes.push(f)}),d.edges.forEach(c=>{const{model:u}=c,f=u.getData();if(f.pointsList=this.calcPointsList(u,l.nodes),f.pointsList){const h=f.pointsList[0],p=f.pointsList[f.pointsList.length-1];f.startPoint={x:h.x,y:h.y},f.endPoint={x:p.x,y:p.y},f.text&&f.text.value&&(f.text={x:p.x-this.getBytesLength(f.text.value)*6-10,y:p.y,value:f.text.value})}else f.startPoint=void 0,f.endPoint=void 0,f.text&&f.text.value&&(f.text=f.text.value);l.edges.push(f)}),this.lf.renderRawData(l)}pointFilter(t){const o=t;let n=1;for(;n<o.length-1;){const r=o[n-1],i=o[n],a=o[n+1];r.x===i.x&&i.x===a.x||r.y===i.y&&i.y===a.y?o.splice(n,1):n++}return o}calcPointsList(t,o){const n=[];if(this.option.rankdir==="LR"&&t.modelType==="polyline-edge"){const r=this.lf.getNodeModelById(t.sourceNodeId),i=this.lf.getNodeModelById(t.targetNodeId),a=o.find(d=>d.id===t.sourceNodeId),s=o.find(d=>d.id===t.targetNodeId);if(a.x<s.x)return n.push({x:a.x+r.width/2,y:a.y}),n.push({x:a.x+r.width/2+(t.offset||50),y:a.y}),n.push({x:a.x+r.width/2+(t.offset||50),y:s.y}),n.push({x:s.x-i.width/2,y:s.y}),this.pointFilter(n);if(a.x>s.x)return a.y>=s.y?(n.push({x:a.x,y:a.y+r.height/2}),n.push({x:a.x,y:a.y+r.height/2+(t.offset||50)}),n.push({x:s.x,y:a.y+r.height/2+(t.offset||50)}),n.push({x:s.x,y:s.y+i.height/2})):(n.push({x:a.x,y:a.y-r.height/2}),n.push({x:a.x,y:a.y-r.height/2-(t.offset||50)}),n.push({x:s.x,y:a.y-r.height/2-(t.offset||50)}),n.push({x:s.x,y:s.y-i.height/2})),this.pointFilter(n)}}}J(Bt,"pluginName","dagre");class Yr extends Xt{constructor({lf:t}){super({lf:t});const o={text:"复制",icon:!0,className:"lf-menu-copy",callback:y=>t.cloneNode(y.id)},n={text:"删除",icon:!0,className:"lf-menu-delete",callback:y=>{t.deleteNode(y.id),t.deleteEdge(y.id)}},r={text:"编辑文本",icon:!0,className:"lf-menu-edit",callback:y=>t.graphModel.editText(y.id)},i={text:"删除文本",icon:!0,className:"lf-menu-delete",callback:y=>t.updateText(y.id,"")},a={text:"框选",icon:!0,className:"lf-menu-select",callback(){t.openSelectionSelect(),t.once("selection:selected",t.closeSelectionSelect)}},s={text:"清空",icon:!0,className:"lf-menu-clear",callback(){t.clearData()}},d={text:"添加",icon:!0,className:"lf-menu-add",callback:y=>{console.log("🚀 ~ file: menu.ts:66 ~ Menu ~ constructor ~ ele:",y),["endEvent","serviceTask","note"].includes(y.type)?b(y,[l]):b(y,k.nodeMenu)}},l={text:"",icon:!0,className:"lf-menu-back",callback:y=>{b(y,w.nodeMenu)}},c={text:"用户任务",icon:!0,className:"lf-menu-user-task",callback:y=>{const{x:N,y:P}=y,T=t.addNode({type:"userTask",x:N+200,y:P});t.addEdge({sourceNodeId:y.id,targetNodeId:T.id})}},u={text:"服务任务",icon:!0,className:"lf-menu-service-task",callback:y=>{const{x:N,y:P}=y,T=t.addNode({type:"serviceTask",x:N+200,y:P});t.addEdge({type:"noteFlow",sourceNodeId:y.id,targetNodeId:T.id})}},f={text:"结束",icon:!0,className:"lf-menu-end-event",callback:y=>{const{x:N,y:P}=y,T=t.addNode({type:"endEvent",x:N+150,y:P});t.addEdge({sourceNodeId:y.id,targetNodeId:T.id})}},h={text:"互斥网关",icon:!0,className:"lf-menu-exclusive-gateway",callback:y=>{const{x:N,y:P}=y,T=t.addNode({type:"exclusiveGateway",x:N+150,y:P});t.addEdge({sourceNodeId:y.id,targetNodeId:T.id})}},p={text:"并行网关",icon:!0,className:"lf-menu-parallel-gateway",callback:y=>{const{x:N,y:P}=y,T=t.addNode({type:"parallelGateway",x:N+150,y:P});t.addEdge({sourceNodeId:y.id,targetNodeId:T.id})}},m={text:"注释",icon:!0,className:"lf-menu-note",callback:y=>{const{x:N,y:P}=y,T=t.addNode({type:"note",x:N,y:P-150});t.addEdge({type:"noteFlow",sourceNodeId:y.id,targetNodeId:T.id})}},b=(y,N)=>{setTimeout(()=>{this.__currentData=y;const{left:P,top:T}=this.__menuDOM.style;this.showMenu(P,T,N)})},w={nodeMenu:[d,o,n,r,i],edgeMenu:[n,r,i],graphMenu:[a,s]},k={nodeMenu:[l,c,u,h,p,f,m]};this.setMenuConfig(w)}}class Kr extends Ht{constructor({lf:t}){super({lf:t}),this.setPatternItems([{label:"框选",icon:"https://api.iconify.design/bpmn/lasso-tool.svg?width=24&height=24",callback(){t.openSelectionSelect(),t.once("selection:selected",t.closeSelectionSelect)}},{type:"group",label:"子流程",icon:"https://api.iconify.design/bpmn/subprocess-expanded.svg?width=24&height=24"},{type:"startEvent",text:"开始",label:"开始节点",icon:"https://api.iconify.design/bpmn/start-event.svg?width=24&height=24"},{type:"endEvent",text:"结束",label:"结束节点",icon:"https://api.iconify.design/bpmn/end-event.svg?width=24&height=24"},{type:"userTask",label:"用户任务",icon:"https://api.iconify.design/bpmn/user-task.svg?width=24&height=24"},{type:"serviceTask",label:"服务任务",icon:"https://api.iconify.design/bpmn/service-task.svg?width=24&height=24"},{type:"exclusiveGateway",label:"互斥网关",icon:"https://api.iconify.design/bpmn/gateway-xor.svg?width=24&height=24"},{type:"parallelGateway",label:"并行网关",icon:"https://api.iconify.design/bpmn/gateway-parallel.svg?width=24&height=24"},{type:"note",label:"注释",icon:"https://api.iconify.design/bpmn/text-annotation.svg?width=24&height=24"}])}}const At={type:"process",key:"Process",properties:{}};function Xr(e){const{id:t,type:o,x:n,y:r,properties:i,children:a,text:s}=e;return{incoming:[],outgoing:[],children:a,type:o,key:t,groupKey:i==null?void 0:i.groupKey,properties:{...i,name:Re(s)?s:(s==null?void 0:s.value)??"",x:n,y:r,text:s}}}function Hr(e){const{id:t,type:o,sourceNodeId:n,targetNodeId:r,startPoint:i,endPoint:a,pointsList:s,properties:d,text:l}=e;return{incoming:[n],outgoing:[r],type:o,key:t,groupKey:d==null?void 0:d.groupKey,properties:{...d,name:Re(l)?l:(l==null?void 0:l.value)??"",text:l,startPoint:i,endPoint:a,pointsList:s}}}function Jr(e){const{id:t,type:o,properties:n,text:r}=e;return{type:o,key:t,properties:{...n,name:Re(r)?r:(r==null?void 0:r.value)??""}}}function Qr(e){const t=new Map,o={processData:At,flowElementList:[]};return e.nodes.forEach(n=>{var r;if(n.type==="process")o.processData=Jr(n);else{const i=Xr(n);(r=o.flowElementList)==null||r.push(i),t.set(n.id,i)}}),e.edges.forEach(n=>{var s;const r=Hr(n);t.get(n.sourceNodeId).outgoing.push(r.key),t.get(n.targetNodeId).incoming.push(r.key),(s=o.flowElementList)==null||s.push(r)}),o}function Zr(e){const{incoming:t,outgoing:o,properties:n,key:r,type:i}=e,{text:a,name:s,startPoint:d,endPoint:l,pointsList:c}=n??{},u={id:r,type:i,sourceNodeId:(t==null?void 0:t[0])??"",targetNodeId:(o==null?void 0:o[0])??"",text:a||s,startPoint:d,endPoint:l,pointsList:c,properties:{}},f=["startPoint","endPoint","pointsList","text"];return u.properties=Ce(n,f),u}function ei(e){const{properties:t,key:o,type:n,children:r}=e,{x:i,y:a,text:s,name:d}=t??{},l={id:o,type:n??"",x:i,y:a,text:s||d,children:r,properties:{}},c=["x","y","text"];return l.properties=Ce(t,c),l}function ti(e){const{properties:t,key:o,type:n}=e,{name:r}=t??{},i={id:o,type:n??"",text:r,x:0,y:0},a=["x","y","text"];return i.properties=Ce(t,a),i}function oi(e){const{flowElementList:t}=e,o=a=>["sequenceFlow","noteFlow"].includes(a),n=(t==null?void 0:t.filter(a=>!o(a.type)).map(ei))??[],r=(t==null?void 0:t.filter(a=>o(a.type)).map(Zr))??[];return n.unshift(ti(e.processData??At)),{nodes:n,edges:r}}class Be{constructor({lf:t}){t.adapterIn=this.adapterIn,t.adapterOut=this.adapterOut}adapterOut(t){return Qr(t)}adapterIn(t){return oi(t)}}J(Be,"pluginName","turboAdapter");class Gt{constructor({lf:t}){J(this,"lf");J(this,"container");J(this,"__tooltipDOM");J(this,"__currentData");J(this,"__tooltips",[]);this.__tooltipDOM=document.createElement("div"),this.__tooltipDOM.className="lf-tooltip",this.__tooltipDOM.style.position="absolute",this.__tooltipDOM.style.display="none",this.lf=t}render(t,o){this.container=o,o.appendChild(this.__tooltipDOM),t.on("node:mouseenter,edge:mouseenter",({data:n,e:r})=>{var l;const i=(l=this.__tooltips.find(c=>c.id===n.id))==null?void 0:l.content;if(!i)return;this.__tooltipDOM.innerHTML=i;const a=t.getPointByClient(r.x,r.y),{domOverlayPosition:{x:s,y:d}}=a;this.__tooltipDOM.style.top=`${d+10}px`,this.__tooltipDOM.style.left=`${s+10}px`,this.__tooltipDOM.style.display="block"}),t.on("node:mouseleave,edge:mouseleave",()=>{this.__tooltipDOM.style.display="none"})}setTooltips(t){this.__tooltips=t}}J(Gt,"pluginName","tooltip");const ni=so("span",null,"编辑JSON",-1),ri=Fe({__name:"flow-editor",props:{modelValue:{},visible:{type:Boolean}},emits:["confirm"],setup(e,{emit:t}){const n=yt(e),{modelValue:r,visible:i}=n,a=no("");function s(){const d=JSON.parse(a.value);r.value=d,t("confirm",d),i.value=!1}return ro(()=>{a.value=JSON.stringify(r.value,null,2)}),(d,l)=>{const c=Z("el-input"),u=Z("el-button"),f=Z("el-drawer");return ne(),de(f,{modelValue:K(i),"onUpdate:modelValue":l[1]||(l[1]=h=>le(i)?i.value=h:null)},{header:re(()=>[ni,Oe(d.$slots,"header")]),default:re(()=>[ce(c,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=h=>a.value=h),class:"flow-editor__textarea",type:"textarea"},null,8,["modelValue"]),ce(u,{class:"flow-editor__confirm-btn",type:"primary",onClick:s},{default:re(()=>[io(" 确定 ")]),_:1})]),_:3},8,["modelValue"])}}}),hs=Fe({__name:"index",props:{lf:{},initOptions:{},modelValue:{},elementData:{},formOptions:{},formData:{},formOption:{},formDefaults:{},formWidth:{},formOptionFormat:{type:Function},formDataFormat:{type:Function},dataOptions:{}},setup(e){const t=e,o=oo(t),{lf:n,graphData:r,formRef:i,formData:a,formOption:s,formDefaults:d,formLoading:l,editorVisible:c,onUpdateFormData:u}=o,f=vt("container");return mt(()=>{var h;n.value=new ft.LogicFlow({container:document.querySelector(`#${f}`),grid:{type:"dot",size:10},nodeTextDraggable:!0,edgeTextDraggable:!0,nodeTextEdit:!0,edgeTextEdit:!0,plugins:[yo,Kr,Jt,Yr,Qt,Zt,ht,pt,Be,Bt],edgeGenerator:(p,m)=>{if(["note","serviceTask"].includes(m.type))return"noteFlow"},...t.initOptions}),(h=n.value)==null||h.setTheme(bt),ho(o),pe(r,p=>{var k,y,N;const m=JSON.stringify(p),b=JSON.stringify((k=n.value)==null?void 0:k.getGraphData());m!==b&&((y=n.value)==null||y.render(p),(N=n.value)==null||N.emit("element:click",{isForce:!0}))},{immediate:!0})}),(h,p)=>{const m=Z("el-main"),b=Z("el-empty"),w=Z("el-skeleton"),k=Z("avue-form"),y=Z("el-aside"),N=Z("el-container");return ne(),de(N,{class:"lf-container"},{default:re(()=>[ce(m,{id:K(f),class:"lf-main"},null,8,["id"]),ce(y,{width:h.formWidth,class:"lf-aside"},{default:re(()=>{var P,T;return[Oe(h.$slots,"form-top"),(T=(P=K(s))==null?void 0:P.group)!=null&&T.length?K(l)?(ne(),de(w,{key:1})):(ne(),de(k,{key:2,ref_key:"formRef",ref:i,modelValue:K(a),"onUpdate:modelValue":[p[0]||(p[0]=Q=>le(a)?a.value=Q:null),K(u)],defaults:K(d),"onUpdate:defaults":p[1]||(p[1]=Q=>le(d)?d.value=Q:null),option:K(s)},null,8,["modelValue","defaults","option","onUpdate:modelValue"])):(ne(),de(b,{key:0,description:"选择元素以编辑数据"}))]}),_:3},8,["width"]),ce(ri,{modelValue:K(r),"onUpdate:modelValue":p[2]||(p[2]=P=>le(r)?r.value=P:null),visible:K(c),"onUpdate:visible":p[3]||(p[3]=P=>le(c)?c.value=P:null),onConfirm:p[4]||(p[4]=P=>{var T;return(T=K(n))==null?void 0:T.render(P)})},ao({_:2},[h.$slots["editor-header"]?{name:"header",fn:re(()=>[Oe(h.$slots,"editor-header")]),key:"0"}:void 0]),1032,["modelValue","visible"])]),_:3})}}}),ii=["id"],ps=Fe({__name:"index",props:{lf:{},initOptions:{},modelValue:{},styles:{},tooltips:{}},setup(e){const t=e,o=yt(t,void 0,{passive:!0}),{lf:n,modelValue:r}=o,i=vt("container");return mt(()=>{var a;n.value=new ft.LogicFlow({container:document.querySelector(`#${i}`),grid:{type:"dot",size:10},isSilentMode:!0,plugins:[ht,pt,Be,Gt],...t.initOptions}),(a=n.value)==null||a.setTheme(bt),pe(r,s=>{var d;(d=n.value)==null||d.render(s)},{immediate:!0}),pe(()=>t.styles,s=>{s==null||s.forEach(({id:d,style:l})=>{var c,u;d&&((u=(c=n.value)==null?void 0:c.graphModel)==null||u.updateAttributes(d,{style:l}))})},{immediate:!0}),pe(()=>t.tooltips,s=>{var d,l;(l=(d=n.value)==null?void 0:d.extension.tooltip)==null||l.setTooltips(s??[])},{immediate:!0})}),(a,s)=>(ne(),lo("div",{id:K(i),class:"lf-container"},null,8,ii))}});export{ht as BpmnExtend,yo as Control,Bt as Dagre,ys as EndEventModel,bs as EndEventView,ws as ExclusiveGatewayModel,gs as ExclusiveGatewayView,hs as FlowModeler,ps as FlowViewer,pt as Group,xs as GroupModel,Es as GroupView,Yr as Menu,ks as NoteFlowModel,_s as NoteFlowView,Ns as NoteModel,Ms as NoteView,Kr as Panel,Is as ParallelGatewayModel,Os as ParallelGatewayView,Ps as ProcessModel,Ls as ProcessView,Ss as SequenceFlowModel,Ts as SequenceFlowView,Ds as ServiceTaskModel,Cs as ServiceTaskView,Rs as StartEventModel,Fs as StartEventView,Gt as Tooltip,Be as TurboAdapter,js as UserTaskModel,Vs as UserTaskView,zs as assigneeColumn,$s as baseColumn,Ws as buttonColumn,Us as circulateColumn,As as defaultGraphData,to as defaultGroup,qs as defaultOptions,bt as defaultTheme,ls as executionListenerColumn,Ys as formPropertyColumn,Ks as gatewayColumn,Xs as multiInstanceColumn,Hs as noteColumn,Js as processColumn,Qs as propertyColumn,Zs as sequenceFlowColumn,ea as serialColumn,ta as serviceTaskColumn,cs as taskListenerColumn,us as timeLimitColumn,oi as toLogicflowData,Qr as toTurboData,oa as userTaskColumn};
