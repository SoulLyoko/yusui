import{a as P,O as I,K as H,a0 as ke,M as Te,f as W,v as V,y as x,k as E,S as U,R as _,e as T,x as B,I as J,B as f,T as q,z as K,L as M,Q as ee,D as xe,J as de,a4 as N,d as te,H as De,V as ne,aa as me,ai as fe,c as be,a6 as $e,q as Ce}from"./framework.1859beb2.js";import{a as Z,e as Se,w as Oe}from"./theme.d27d32d4.js";import{e as ie,g as Le,a as C,f as Ie,h as Ee,_ as $,c as le,i as A,b as Re,k as We,l as je,m as Pe,n as Ae,o as Ue,q as ze,r as Be,t as Fe,u as Me,v as He,w as qe,x as Ke,y as Ge,z as Ne,A as Je,B as Qe,C as Xe,D as Ye,E as Ze,F as et,G as se,H as ve,d as ae,j as tt}from"./tree.2adb9634.js";import{J as Al,I as Ul,p as zl,s as Bl}from"./tree.2adb9634.js";import"./index.b942cce0.js";import{DiffEditor as lt}from"./index.ed8e6555.js";import{b as ot,f as nt,a as at}from"./form.ed548c37.js";import{_ as Ml,c as Hl}from"./form.ed548c37.js";import{c as j}from"./cloneDeep.0df5a121.js";import{a as rt,b as it}from"./index.7b9b2b88.js";import{i as ye}from"./isEqual.fd497ed2.js";import{m as oe}from"./merge.388a8cf7.js";import{o as ut}from"./omit.c30a42ae.js";import{D as he}from"./vuedraggable.umd.96a1619d.js";import{E as pt}from"./index.vue_vue_type_script_setup_true_lang.cffe25d9.js";import{o as st}from"./omitBy.5165ced3.js";import{l as ct}from"./baseGet.dbab6d06.js";import{d as dt}from"./union.d4dfed4a.js";import{s as ce}from"./set.d8392183.js";import{g as mt}from"./get.45bf40f8.js";import"./index.ac4e533a.js";import"./fromPairs.e099444b.js";import"./isNil.c75b1b34.js";import"./kebabCase.6194d69f.js";import"./createCompounder.ded3b507.js";import"./index.8a35a738.js";import"./use-global-config.0f76ccf3.js";import"./use-form-item.61a89537.js";import"./Uint8Array.f03d52c3.js";import"./arrayPush.474a561f.js";import"./baseSet.946f8e4f.js";import"./initCloneObject.1c5107bb.js";import"./getTag.3cc3157b.js";import"./pickBy.3939954b.js";import"./basePickBy.1969992d.js";import"./vue.runtime.esm-browser.prod.16ad7abb.js";import"./typescript.861248ef.js";import"./pick.95244439.js";const ft=Object.freeze(Object.defineProperty({__proto__:null,get array(){return We},get cascader(){return je},get checkbox(){return Pe},get color(){return _t},get date(){return Ae},get daterange(){return Ue},get dates(){return ze},get datetime(){return Be},get datetimerange(){return Fe},get dynamic(){return Vt},get form(){return nt},get group(){return wt},get icon(){return Me},get img(){return He},get input(){return kt},get month(){return qe},get monthrange(){return Ke},get number(){return Tt},get password(){return xt},get radio(){return Ge},get rate(){return Dt},get select(){return Ne},get slider(){return $t},get switch(){return Ct},get table(){return St},get textarea(){return Ot},get time(){return Je},get timerange(){return Qe},get title(){return Lt},get tree(){return Xe},get upload(){return It},get url(){return Ye},get week(){return Ze},get year(){return et}},Symbol.toStringTag,{value:"Module"}));function Y(t){return t.map(o=>{var n;const e=j(o);e.name=e.name||e.component||e.type,e.id=e.id||ie(e.name);const p={name:e.name,id:e.id,isRoot:e.isRoot,props:e};return e.name==="form"?p.children=Y([...e.column??[],...e.group??[]]):e.name==="group"?p.children=Y(e.column??[]):["dynamic","table"].includes(e.name)?p.children=Y(((n=e.children)==null?void 0:n.column)??[]):Array.isArray(e.children)&&(p.children=Y(e.children)),p})}function re(t){return Y([{isRoot:!0,name:"form",id:ie("form"),...t}])[0]}function G(t){return t.map(o=>{var p,n,i;const e=j(o);if(e.props&&(e.props.prop=e.props.prop??e.id),e.name==="form"){const s=G(((p=e.children)==null?void 0:p.filter(u=>u.name!=="group"))??[]),a=G(((n=e.children)==null?void 0:n.filter(u=>u.name==="group"))??[]);return{...e.props,column:s.length?s:void 0,group:a.length?a:void 0}}if(e.name==="group"){const s=G(e.children??[]);return{...e.props,column:s}}else if(["dynamic","table"].includes(e.name??"")){const s=G(e.children??[]),a={...(i=e.props)==null?void 0:i.children,column:s};return{...e.props,children:a}}else if(Array.isArray(e.children))return{...e.props,children:G(e.children)};return{...e.props}})}function ge(t){return G([t])[0]??{}}function ue(t,o){const{parentWhiteList:e,parentBlackList:p}=(t==null?void 0:t.rules)??{},{childWhiteList:n,childBlackList:i}=(o==null?void 0:o.rules)??{},s=[];if(e&&o){const a=e.includes((o==null?void 0:o.name)??"");s.push(a)}if(p&&o){const a=p.includes((o==null?void 0:o.name)??"");s.push(!a)}if(n){const a=n.includes((t==null?void 0:t.name)??"");s.push(a)}if(i){const a=i.includes((t==null?void 0:t.name)??"");s.push(!a)}return s.every(a=>a)}const _e=Symbol("form-design-state");function bt(t,o){const e=Z(t),{modelValue:p}=e,n=P(()=>t.groupList||Le),i=P(()=>oe(j({...ft}),t.resources)),s=P(()=>oe(k(ot),k(t.baseOption))),a=P(()=>oe(k(gt),k(t.advanceOption))),u=I({}),r=I({}),b=I({}),l=P(()=>{var v;return ut((v=u.value)==null?void 0:v.props,["column","group"])??{}}),c=I([]),m=I(0),h=I("design"),S=I("pc");H(p,v=>{ye(u.value,re(v||{}))||(u.value=re(v||{}),Object.keys(r.value).length||D(),c.value.length||d("init"))},{immediate:!0,deep:!0}),H(u,()=>{p.value=ge(u.value)},{deep:!0});function O(v){if(v)return i.value[v]}function D(v){r.value=v??u.value??{}}function k(v){if(typeof v=="function"){const R={elementTree:u.value,activeElement:r.value};return j(v(R)??[])}else return j(v??[])}async function d(v){c.value.push({type:v,timestamp:Date.now(),active:j(r.value),tree:j(u.value),option:j(p.value??{})}),m.value=c.value.length-1}function w(v){const R=c.value.find((F,L)=>L===v);R&&(u.value=j(R.tree),r.value=j(R.active),m.value=v)}function y(){c.value=[],m.value=0,u.value={},r.value={},o("reset")}const g={groupList:n,resources:i,elementTree:u,activeElement:r,hoverElement:b,formOption:l,historyList:c,historyIndex:m,workType:h,deviceType:S,modelValue:p,baseOption:s,advanceOption:a,resolveSettings:k,setActiveElement:D,recordHistory:d,restoreHistory:w,resetHistory:y,getResource:O};return ke(_e,g),g}function z(){return Te(_e)}const vt=W({__name:"property-select",props:{tableData:{},dic:{}},setup(t){const o=t,{elementTree:e,baseOption:p,resolveSettings:n,getResource:i}=z(),s=P(()=>{var r;const a=rt([e.value],b=>{var l,c,m;return((l=b.props)==null?void 0:l.prop)===((m=(c=o.tableData)==null?void 0:c.row)==null?void 0:m.field)}),u=((r=i(a==null?void 0:a.name))==null?void 0:r.settings)??[];return[...p.value,...n(u)].filter(b=>b.prop).map(b=>({label:b.label,value:b.prop,desc:b.prop}))});return(a,u)=>{const r=V("avue-select");return x(),E(r,{dic:s.value,"allow-create":"",filterable:"","default-first-option":""},null,8,["dic"])}}}),yt=W({__name:"index",props:{modelValue:{default:""}},setup(t){const o=t,{modelValue:e}=Z(o),{elementTree:p}=z(),n=I(!1),i=I([]);H(e,()=>{var u,r,b;if(!e.value){i.value=[];return}try{const c=((b=(r=(u=Ie(e.value,{ecmaVersion:"latest"}).body[0])==null?void 0:u.expression)==null?void 0:r.body)==null?void 0:b.properties)??[];c!=null&&c.length&&(i.value=c.map(m=>m.value.properties.map(h=>{const S=Ee(h.value);return{field:m.key.name,property:h.key.name,value:S}})).flat())}catch{}},{immediate:!0}),H(i,()=>{var b;if(!n.value)return;const r=`(val, form) => ({
    ${[...new Set((b=i.value)==null?void 0:b.map(l=>l.field))].map(l=>{var m;const c=(m=i.value)==null?void 0:m.filter(h=>h.field===l);return`${l}: { ${c==null?void 0:c.map(h=>`${h.property}: ${h.value}`).join(", ")} }`}).join(`,
    `)}
})`;e.value=r},{deep:!0});const s=P(()=>{var r;return it(((r=p.value)==null?void 0:r.children)??[]).map(b=>{const{label:l,prop:c}=b.props??{};return{label:l,value:c,desc:c}})}),a=P(()=>({column:[{label:"受控字段",prop:"field",type:"select",dicData:s.value,rules:{required:!0}},{label:"受控属性",prop:"property",component:vt,rules:{required:!0}},{label:"表达式/值",prop:"value",component:C,tooltip:!0,rules:{required:!0}}]}));return(u,r)=>{const b=V("el-button"),l=V("avue-dynamic"),c=V("el-dialog");return x(),U(B,null,[_(b,{onClick:r[0]||(r[0]=m=>n.value=!0)},{default:T(()=>[J(" 编辑代码 ")]),_:1}),_(c,{modelValue:n.value,"onUpdate:modelValue":r[3]||(r[3]=m=>n.value=m),title:"控制字段属性"},{default:T(()=>[_(l,{modelValue:i.value,"onUpdate:modelValue":r[1]||(r[1]=m=>i.value=m),children:a.value},null,8,["modelValue","children"]),J(" 代码： "),_(C,{modelValue:f(e),"onUpdate:modelValue":r[2]||(r[2]=m=>q(e)?e.value=m:null),"value-type":"function",height:"200px"},null,8,["modelValue"])]),_:1},8,["modelValue"])],64)}}}),Rl=W({__name:"index",props:{modelValue:{default:()=>[]},setterType:{}},setup(t){const o=t,{modelValue:e}=Z(o),p={column:[{label:"名称",prop:"label"},{label:"值",prop:"value"}]},n={props:{value:"id"},formOption:{column:[{label:"名称",prop:"label"},{label:"值",prop:"value"}]}},i=I({});function s(b,l){b(),setTimeout(()=>{(l==="add"||l==="parentAdd")&&(i.value.id=ie())},100)}const a=(b,l,c)=>c(),u=(b,l,c)=>c(),r=(b,l)=>l();return(b,l)=>{const c=V("avue-tree"),m=V("avue-dynamic");return b.setterType==="tree"?(x(),E(c,{key:0,modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=h=>i.value=h),data:f(e),option:n,"before-open":s,onSave:a,onUpdate:u,onDel:r},null,8,["modelValue","data"])):(x(),E(m,{key:1,modelValue:f(e),"onUpdate:modelValue":l[1]||(l[1]=h=>q(e)?e.value=h:null),children:p},null,8,["modelValue"]))}}}),ht=W({__name:"index",props:{modelValue:{default:""},tableData:{}},setup(t){const o=t,{modelValue:e}=Z(o),p=I(!1),n=I({});H(e,()=>{var s,a;e.value&&(n.value=((a=(s=o.tableData)==null?void 0:s.row)==null?void 0:a.onLoadData)??{})},{immediate:!0}),H(n,()=>{var h;if(!p.value||!((h=o.tableData)!=null&&h.row)||(o.tableData.row.onLoadData=n.value,n.value.codeMode))return;const{url:s,method:a,isPage:u,currentPageKey:r,pageSizeKey:b,totalPath:l,dataPath:c}=n.value,m=`({ page, value, data }, callback) => {
    const params = page && ${u} ? { ${r}: page.currentPage, ${b}: page.pageSize } : {};
    this.$axios({ url: "${s}", method: "${a}", params }).then(res => {
        const data = this.getAsVal({ res }, "${c}");
        const total = this.getAsVal({ res }, "${l}");
        callback({ data, total });
    });
}`;e.value=m},{deep:!0});const i={span:24,menuBtn:!1,labelWidth:100,column:[{label:"请求地址",prop:"url"},{label:"请求方法",prop:"method",type:"radio",button:!0,value:"get",dicData:[{label:"GET",value:"get"},{label:"POST",value:"post"}]},{label:"是否分页",prop:"isPage",type:"switch",value:!0},{label:"当前页键名",prop:"currentPageKey",value:"current"},{label:"每页条数键名",prop:"pageSizeKey",value:"size"},{label:"总条数路径",prop:"totalPath",value:"res.data.total"},{label:"返回数据路径",prop:"dataPath",value:"res.data.records"},{label:"编辑代码模式",prop:"codeMode",type:"switch",value:!1,span:4,tip:"关闭时，代码根据以上参数自动生成。开启时，可自由编辑代码"}]};return(s,a)=>{const u=V("el-button"),r=V("avue-form"),b=V("el-dialog");return x(),U(B,null,[_(u,{onClick:a[0]||(a[0]=l=>p.value=!0)},{default:T(()=>[J(" 编辑代码 ")]),_:1}),_(b,{modelValue:p.value,"onUpdate:modelValue":a[3]||(a[3]=l=>p.value=l),title:"加载数据函数"},{default:T(()=>[_(r,{modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=l=>n.value=l),option:i},null,8,["modelValue"]),J(" 代码： "),_(C,{modelValue:f(e),"onUpdate:modelValue":a[2]||(a[2]=l=>q(e)?e.value=l:null),"value-type":"function",height:"200px",disabled:""},null,8,["modelValue"])]),_:1},8,["modelValue"])],64)}}}),gt=[{label:"控制其它字段",prop:"control",component:yt},{label:"值变化事件",prop:"change",component:C,tooltip:!0,defaultValue:"({ value, row }) => {}"},{label:"点击事件",prop:"click",component:C,tooltip:!0,defaultValue:"({ value, row  }) => {}"},{label:"获取焦点事件",prop:"focus",component:C,tooltip:!0,defaultValue:"({ value, row  }) => {}"},{label:"失去焦点事件",prop:"blur",component:C,tooltip:!0,defaultValue:"({ value, row  }) => {}"},{label:"其他属性",prop:"params",component:C,valueType:"object",tooltip:!0,defaultValue:"{}"},{label:"其他事件",prop:"event",component:C,valueType:"object",tooltip:!0,defaultValue:"{}"}],_t={name:"color",title:"颜色",icon:"el-icon-brush",group:"表单组件",props:{type:"color",label:"颜色"},settings:[{label:"支持透明度选择",prop:"showAlpha",component:$,defaultValue:!1,labelWidth:120},{label:"颜色格式",prop:"colorFormat",type:"select",dicData:[{label:"hsl",value:"hsl"},{label:"hsv",value:"hsv"},{label:"hex",value:"hex"},{label:"rgb",value:"rgb"}]},{label:"预定义颜色",prop:"predefine",type:"array"}]},Vt={name:"dynamic",title:"子表单",icon:"el-icon-grid",group:"表单组件",isContainer:!0,rules:{parentWhiteList:["form","group"],childBlackList:["group","dynamic"]},designOption:t=>{const{label:o,prop:e}=t.props??{};return{column:[{label:o,prop:e,type:"text"}]}},props:{type:"dynamic",label:"子表单",children:{column:[]}},settings:[{prop:"children",labelWidth:0,component:"avue-form",option:{labelWidth:100,menuBtn:!1,span:24,column:[{label:"展示类型",prop:"type",type:"radio",button:!0,value:"crud",dicData:[{label:"表格",value:"crud"},{label:"表单",value:"form"}],control(t){const o=t==="form",e=t==="crud";return{showHeader:{display:e},stripe:{display:e},border:{display:e},headerAlign:{display:e},align:{display:e},span:{display:o}}}},{label:"显示新增按钮",prop:"addBtn",component:$,defaultValue:!0},{label:"显示删除按钮",prop:"delBtn",component:$,defaultValue:!0},{label:"显示序号",prop:"index",type:"switch",control(t,o){return o.type==="crud"&&typeof t=="boolean"&&(o.index=t?"":!1),{}}},{label:"显示表头",prop:"showHeader",component:$,defaultValue:!0},{label:"表格边框",prop:"border",component:$,defaultValue:!0},{label:"斑马纹",prop:"stripe",component:$,defaultValue:!1},{label:"表头对齐方式",prop:"headerAlign",type:"radio",button:!0,dicData:le},{label:"对齐方式",prop:"align",type:"radio",button:!0,dicData:le},{label:"表单项栅格",prop:"span",type:"number"},{label:"空数据文字",prop:"emptyText",type:"number"}]}}]},wt={name:"group",title:"分组",icon:"el-icon-menu",group:"布局组件",isContainer:!0,rules:{parentWhiteList:["form"],childBlackList:["group"]},designOption:t=>{const{label:o,prop:e}=t.props??{};return{column:[{prop:e,labelWidth:0,type:"title",modelValue:o,styles:{fontWeight:500,fontSize:"16px"}}]}},props:{type:"group",label:"分组",column:[]},settings:[{label:"图标",prop:"icon",type:"icon",iconList:A},{label:"是否默认展开",prop:"collapse",component:$,defaultValue:!0},{label:"是否显示箭头",prop:"arrow",component:$,defaultValue:!0}]},kt={name:"input",title:"输入框",icon:"el-icon-chat-dot-square",group:"表单组件",props:{type:"input",label:"输入框"},settings:[{label:"最大长度",prop:"maxlength",type:"number"},{label:"显示统计字数",prop:"showWordLimit",component:$,defaultValue:!1,tip:"仅在最大长度大于0时有效"},{label:"前缀文字",prop:"prepend"},{label:"后缀文字",prop:"append"},{label:"前缀图标",prop:"prefixIcon",type:"icon",iconList:A},{label:"后缀图标",prop:"suffixIcon",type:"icon",iconList:A},{label:"输入值格式化",prop:"formatter",component:C,valueType:"function",tooltip:!0,defaultValue:"(value) => value"},{label:"返回值格式化",prop:"parser",component:C,valueType:"function",tooltip:!0,defaultValue:"(value) => value"},{label:"输入框样式",prop:"inputStyle",component:C,valueType:"object",tooltip:!0,defaultValue:"{}"}]},Tt={name:"number",title:"数字输入框",icon:"el-icon-more",group:"表单组件",props:{type:"number",label:"数字输入框"},settings:[{label:"最小值",prop:"min",type:"number"},{label:"最大值",prop:"max",type:"number"},{label:"计数器步长",prop:"step",type:"number"},{label:"只能输入步长倍数",prop:"stepStrictly",component:$,defaultValue:!1,labelWidth:130},{label:"数值精度",prop:"precision",type:"number"},{label:"是否使用控制按钮",prop:"controls",type:"switch",value:!0,labelWidth:130,control(t){return{controlsPosition:{display:!!t}}}},{label:"控制按钮位置",prop:"controlsPosition",type:"radio",button:!0,dicData:[{label:"两边",value:"default"},{label:"右",value:"right"}]},{label:"清空时显示值",prop:"valueOnClear",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:[{label:"最小值",value:"min"},{label:"最大值",value:"max"}],control(t,o){return t&&!["min","max"].includes(t)&&(o.valueOnClear=Number(t)),{}}}]},xt={name:"password",title:"密码输入框",icon:"el-icon-lock",group:"表单组件",props:{type:"password",label:"密码输入框"},settings:[{label:"最大长度",prop:"maxlength",type:"number"},{label:"前缀图标",prop:"prefixIcon",type:"icon",iconList:A},{label:"后缀图标",prop:"suffixIcon",type:"icon",iconList:A},{label:"是否显示切换密码",prop:"showPassword",component:$,defaultValue:!1,labelWidth:130}]},Dt={name:"rate",title:"评分",icon:"el-icon-star",group:"表单组件",props:{type:"rate",label:"评分",max:5,lowThreshold:2,highThreshold:4},settings:[{label:"是否允许半选",prop:"allowHalf",component:$,defaultValue:!1},{label:"最大分值",prop:"max",type:"number"},{label:"低分界限值",prop:"lowThreshold",type:"number",labelTip:"低分和中等分数的界限值，值本身被划分在低分中"},{label:"高分界限值",prop:"highThreshold",type:"number",labelTip:"高分和中等分数的界限值，值本身被划分在高分中"},{label:"颜色数组",prop:"colors",component:C,valueType:"object",tooltip:!0,defaultValue:"[]",labelTip:"若传入数组，共有 3 个元素，为 3 个分段所对应的颜色；若传入对象，可自定义分段，键名为分段的界限值，键值为对应的颜色"},{label:"未选中颜色",prop:"voidColor",type:"color"},{label:"未选颜色(禁用)",prop:"disabledVoidColor",type:"color",labelWidth:110},{label:"图标数组",prop:"icons",component:C,valueType:"object",tooltip:!0,defaultValue:"[]",labelTip:"若传入数组，则需要传入 3 个元素，分别为 3 个部分所对应的图标；若传入对象，则可自定义分段，键名为分段的界限值，键值为对应的图标"},{label:"未选中图标",prop:"voidIcon",type:"icon",iconList:A},{label:"未选图标(禁用)",prop:"disabledVoidIcon",type:"icon",iconList:A,labelWidth:110},{label:"显示辅助文字",prop:"showText",component:$,defaultValue:!1,labelWidth:120,labelTip:"是否显示辅助文字，若为是，则会从 辅助文字数组 中选取当前分数对应的文字内容"},{label:"辅助文字数组",prop:"texts",type:"array",labelWidth:120,labelTip:"通过设置辅助文字数组可以为每一个分值指定对应的辅助文字"},{label:"显示当前分数",prop:"showScore",component:$,defaultValue:!1,labelWidth:120,labelTip:"是否显示当前分数，当前分数 和 辅助文字 不能同时显示"},{label:"分数显示模板",prop:"scoreTemplate",labelWidth:120,labelTip:'模板为一个包含了 {value} 的字符串，{value} 会被替换为当前分值。如: "当前分数：{value}"'}]},$t={name:"slider",title:"滑块",icon:"el-icon-operation",group:"表单组件",props:{type:"slider",label:"滑块"},settings:[{label:"最小值",prop:"min",type:"number"},{label:"最大值",prop:"max",type:"number"},{label:"步长",prop:"step",type:"number"},{label:"显示输入框",prop:"showInput",component:$,defaultValue:!1},{label:"输入控制按钮",prop:"showInputControls",component:$,defaultValue:!0},{label:"显示间断点",prop:"showStops",component:$,defaultValue:!1},{label:"显示提示信息",prop:"showTooltip",component:$,defaultValue:!0},{label:"提示信息类名",prop:"tooltipClase"},{label:"提示信息位置",prop:"placement",type:"select",dicData:Re},{label:"格式化提示",prop:"formatTooltip",component:C,valueType:"function",tooltip:!0,defaultValue:"(value) => value"},{label:"开启选择范围",prop:"range",component:$,defaultValue:!1},{label:"垂直模式",prop:"vertical",component:$,defaultValue:!1},{label:"滑块高度",prop:"height",type:"number",labelTip:"垂直模式必填"},{label:"标记",prop:"marks",component:C,valueType:"object",tooltip:!0,defaultValue:"{}",labelTip:"标记， key 的类型必须为 number 且取值在闭区间 [min, max] 内，每个标记可以单独设置样式"}]},Ct={name:"switch",title:"开关",icon:"el-icon-switch",group:"表单组件",props:{type:"switch",label:"开关"},settings:[{label:"开关数据",prop:"dicData",type:"dynamic",labelPosition:"top",children:{column:[{label:"_index",prop:"_index",hide:!0},{label:"文字",prop:"label"},{label:"值",prop:"value",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:[{label:"true",value:!0},{label:"false",value:!1}]}]},value:[{label:"",value:!1},{label:"",value:!0}]},{label:"开关宽度",prop:"len"},{label:"文字在点内",prop:"inlinePrompt",component:$,defaultValue:!1},{label:"开启时图标",prop:"activeIcon",type:"icon",iconList:A},{label:"关闭时图标",prop:"inactiveIcon",type:"icon",iconList:A},{label:"开启动作图标",prop:"activeActionIcon",type:"icon",iconList:A},{label:"关闭动作图标",prop:"inactiveActionIcon",type:"icon",iconList:A},{label:"改变前钩子",prop:"beforeChange",labelTip:"回调 false 则停止切换",component:C,tooltip:!0,defaultValue:"(cb) => cb(true)"}]},St={name:"table",title:"表格选择",icon:"el-icon-grid",group:"表单组件",isContainer:!0,props:{type:"table",label:"表格选择",children:{column:[]}},settings:[{label:"显示表头",prop:"showHeader",component:$,defaultValue:!0},{label:"斑马纹",prop:"stripe",component:$,defaultValue:!1},{label:"表格边框",prop:"border",component:$,defaultValue:!1},{label:"表头对齐方式",prop:"headerAlign",type:"radio",button:!0,dicData:le},{label:"整体对齐方式",prop:"align",type:"radio",button:!0,dicData:le},{label:"显示序号",prop:"index",type:"switch"},{label:"键值配置",prop:"props",component:C,valueType:"object",tooltip:!0,value:{label:"name",value:"id"}},{label:"格式化函数",prop:"formatter",component:C,valueType:"function",tooltip:!0,defaultValue:"(row) => row.name"},{label:"加载数据函数",prop:"onLoad",component:ht}]},Ot={name:"textarea",title:"文本域",icon:"el-icon-chat-line-square",group:"表单组件",props:{type:"textarea",label:"文本域"},settings:[{label:"最小行数",prop:"minRows",type:"number"},{label:"最大行数",prop:"maxRows",type:"number"},{label:"最大长度",prop:"maxlength",type:"number"},{label:"显示统计字数",prop:"showWordLimit",component:$,defaultValue:!1,tip:"仅在最大长度大于0时有效"},{label:"是否能被缩放",prop:"resize",type:"select",dicData:[{label:"不可缩放",value:"none"},{label:"可水平缩放",value:"horizontal"},{label:"可垂直缩放",value:"vertical"},{label:"可自由缩放",value:"both"}]},{label:"输入框样式",prop:"inputStyle",component:C,valueType:"object",tooltip:!0,defaultValue:"{}"}]},Lt={name:"title",title:"标题",icon:"el-icon-minus",group:"布局组件",props:{type:"title",labelWidth:0,modelValue:"标题",styles:{textAlign:"center"}},settings:[{label:"标题内容",prop:"modelValue",type:"textarea",labelPosition:"top"},{label:"样式",prop:"styles",component:C,valueType:"object",tooltip:!0}]},It={name:"upload",title:"上传",icon:"el-icon-upload",group:"表单组件",props:{type:"upload",label:"上传"},settings:[{label:"上传地址",prop:"action"},{label:"请求头",prop:"headers",component:C,valueType:"object",tooltip:!0,defaultValue:"{}"},{label:"请求方法",prop:"method",type:"radio",button:!0,dicData:[{label:"POST",value:"post"},{label:"GET",value:"get"}]},{label:"是否支持多选",prop:"multiple",component:$,defaultValue:!1},{label:"额外参数",prop:"data",component:C,valueType:"object",tooltip:!0,defaultValue:"{}"},{label:"显示文件列表",prop:"showFileList",component:$,defaultValue:!0},{label:"拖拽排序",prop:"drag",component:$,defaultValue:!1},{label:"拖拽上传",prop:"dragFile",component:$,defaultValue:!1},{label:"接受上传类型",prop:"accept"},{label:"文件列表类型",prop:"listType",type:"select",dicData:[{label:"文本",value:"text"},{label:"图片",value:"picture"},{label:"图片卡片",value:"picture-card"},{label:"图片图片",value:"picture-img"}]},{label:"最大上传数量",prop:"limit",type:"number"},{label:"最大上传大小",prop:"fileSize",type:"number"},{label:"上传按钮文字",prop:"fileText"},{label:"上传等待文字",prop:"loadText"},{label:"上传请求配置",prop:"propsHttp",component:C,valueType:"object",tooltip:!0,defaultValue:`{
  home: "",
  res: "",
  url: "",
  name: "",
  fileName: "file"
}`},{label:"图片水印配置",prop:"canvasOption",component:C,valueType:"object",tooltip:!0,defaultValue:`{
  text: "",
  fontFamily: "microsoft yahei",
  color: "#999",
  fontSize: 16,
  opacity: 100,
  bottom: 10,
  right: 10,
  ratio: 1
}`}]},Et={class:"resource-list"},Rt={class:"resource-item"},Wt=W({__name:"resource",setup(t){const{groupList:o,resources:e,elementTree:p,workType:n,setActiveElement:i,recordHistory:s,getResource:a}=z(),u=I(""),r=P(()=>{const c=Object.values(e.value).filter(m=>{const{name:h,title:S,keywords:O}=m,D=[h,S,O].filter(k=>k).join(",");return!m.disabled&&(D==null?void 0:D.includes(u.value))});return o.value.map(m=>({label:m,children:c.filter(h=>h.group===m).map((h,S)=>({...h,priority:h.priority??S})).sort((h,S)=>h.priority-S.priority)})).filter(m=>m.children.length)});function b(c){var h,S;if(n.value!=="design")return;const m=se(c);(S=(h=p.value)==null?void 0:h.children)==null||S.push(m),i(m),s("added")}function l({draggedContext:c,relatedContext:m}){var h;return ue(a(c.element.name),a((h=m.component.componentData)==null?void 0:h.name))}return(c,m)=>{const h=V("el-input"),S=V("el-button"),O=V("el-collapse-item"),D=V("el-collapse");return x(),U("div",Et,[_(h,{modelValue:u.value,"onUpdate:modelValue":m[0]||(m[0]=k=>u.value=k),"suffix-icon":"el-icon-search",placeholder:"搜索组件"},null,8,["modelValue"]),_(D,{"model-value":r.value.map(k=>k.label)},{default:T(()=>[(x(!0),U(B,null,K(r.value,k=>(x(),E(O,{key:k.label,title:k.label,name:k.label},{default:T(()=>[_(f(he),{list:k.children,group:{name:"components",pull:"clone",put:!1},clone:f(se),sort:!1,"item-key":"name",move:l},{item:T(({element:d})=>[M("div",Rt,[_(S,{icon:d.icon,onClick:w=>b(d)},{default:T(()=>[J(ee(d.title),1)]),_:2},1032,["icon","onClick"])])]),_:2},1032,["list","clone"])]),_:2},1032,["title","name"]))),128))]),_:1},8,["model-value"])])}}}),jt=["onMouseover"],Pt={class:"item-label"},At={class:"item-actions"},Ut=W({__name:"tree",setup(t){const{elementTree:o,activeElement:e,hoverElement:p,setActiveElement:n,recordHistory:i,getResource:s}=z(),a=P(()=>[j(o.value)]);function u(d,w,y){return w.data.isRoot?!1:y==="inner"?ue(s(d.data.name),s(w.data.name)):!0}const r=I();xe(()=>{var d,w;(w=r.value)==null||w.setCurrentKey((d=e.value)==null?void 0:d.id)});function b(d){n(d)}function l(){o.value=a.value[0]}function c(d){var y;const w=ve(d.data);(y=r.value)==null||y.append(w,d.parent),l(),n(w),i("added")}function m(d){var w;(w=r.value)==null||w.remove(d),l(),n(),i("removed")}function h(d){var w;(w=d.data.children)!=null&&w.length&&(d.data.children.forEach(y=>{var g;return(g=r.value)==null?void 0:g.remove(y)}),l(),n(d.data),i("clear"))}function S(){l(),i("moved")}const O=[{name:"copy",type:"primary",icon:"el-icon-copy-document",handler:c},{name:"delete",type:"danger",icon:"el-icon-delete",handler:m},{name:"clear",type:"warning",icon:"el-icon-folder-delete",handler:h}];function D(d){return O.filter(w=>k(d,w.name))}function k(d,w){const{disabledActions:y,isContainer:g}=s(d.name)??{},v=!(y!=null&&y.includes(w));return w==="clear"?g&&v:v}return(d,w)=>{const y=V("el-link");return x(),E(f(pt),{ref_key:"treeRef",ref:r,class:"component-tree","node-key":"id",data:a.value,"default-expand-all":"",draggable:"","expand-on-click-node":!1,"allow-drop":u,onNodeClick:b,onNodeDrop:S},{default:T(({node:g,data:v})=>{var R,F;return[M("div",{class:"tree-item",onMouseover:L=>p.value=v||{},onMouseleave:w[0]||(w[0]=L=>p.value={})},[M("div",Pt,ee(((R=v.props)==null?void 0:R.label)||((F=f(s)(v.name))==null?void 0:F.title)),1),M("div",At,[(x(!0),U(B,null,K(D(v),L=>(x(),E(y,de({key:L.name,underline:!1},L,{onClick:N(pe=>L.handler(g),["stop"])}),null,16,["onClick"]))),128))])],40,jt)]}),_:1},8,["data"])}}});var zt=(t=>(t.copy="复制",t.delete="删除",t.clear="清空",t))(zt||{}),Ve=(t=>(t.init="初始化",t.added="添加组件",t.moved="移动组件",t.removed="删除组件",t.property="修改属性",t.clear="清空子组件",t))(Ve||{});const Bt={class:"history-list"},Ft=["onClick"],Mt=W({__name:"history",setup(t){const{historyList:o,historyIndex:e,restoreHistory:p}=z(),n=Se("history-show-source",!1),i={renderValidationDecorations:"off",readOnly:!0},s=P(()=>document.documentElement.className.includes("dark")?"vs-dark":"light");return(a,u)=>{const r=V("el-switch"),b=V("el-tooltip");return x(),U("div",Bt,[J(" 显示源码："),_(r,{modelValue:f(n),"onUpdate:modelValue":u[0]||(u[0]=l=>q(n)?n.value=l:null)},null,8,["modelValue"]),(x(!0),U(B,null,K(f(o),(l,c)=>(x(),E(b,{key:l.timestamp,disabled:!f(n),effect:"light",placement:"right"},{content:T(()=>[_(f(lt),{original:f(ae)(f(o)[c-1]),modified:f(ae)(l),theme:s.value,options:i,language:"javascript",width:"800px",height:"600px"},null,8,["original","modified","theme"])]),default:T(()=>[M("div",{class:te(["history-item",{"is-active":c===f(e)}]),onClick:m=>f(p)(c)},[M("span",null,ee(f(Ve)[l.type]),1),M("span",null,ee(new Date(l.timestamp).toLocaleString()),1)],10,Ft)]),_:2},1032,["disabled"]))),128))])}}}),Ht=W({__name:"index",setup(t){const o=[{title:"组件",icon:"el-icon-menu",component:Wt},{title:"大纲",icon:"el-icon-operation",component:Ut},{title:"历史",icon:"el-icon-clock",component:Mt}];return(e,p)=>{const n=V("el-link"),i=V("el-tab-pane"),s=V("el-tabs");return x(),E(s,{"tab-position":"top",stretch:""},{default:T(()=>[(x(),U(B,null,K(o,a=>_(i,{key:a.title},{label:T(()=>[_(n,{title:a.title,icon:a.icon,underline:!1,style:{color:"inherit"}},null,8,["title","icon"])]),default:T(()=>[(x(),E(De(a.component)))]),_:2},1024)),64))]),_:1})}}}),qt={class:"item-actions"},we=W({__name:"design",props:{list:{},componentData:{}},emits:["update:active","update:list"],setup(t,{emit:o}){const e=t,p=o,{list:n}=Z(e,p,{passive:!0,deep:!0}),{activeElement:i,hoverElement:s,formOption:a,setActiveElement:u,recordHistory:r,getResource:b}=z();function l(y){const g={...j(a.value),span:24,menuBtn:!1},{designOption:v}=b(y.name)??{};if(typeof v=="object")return{...g,...v};if(typeof v=="function")return{...g,...v(y)};{const R=[];return y.props&&R.push({...st(y.props,ct),span:24}),{...g,column:R}}}function c(y){var g,v;return(g=b(y.name))!=null&&g.isContainer?24:((v=y.props)==null?void 0:v.span)||a.value.span||24}async function m(y){var v;const g=Object.keys(y)[0];g&&(u(),await be(),u((v=y[g])==null?void 0:v.element),r(g))}function h(y){const g=ve(y);n.value.push(g),u(g),r("added")}function S(y,g){n.value.splice(g,1),u(n.value[g]??n.value[g-1]),r("removed")}function O(y){var g;(g=y.children)!=null&&g.length&&(y.children=[],u(y),r("clear"))}function D({draggedContext:y,relatedContext:g}){var v;return ue(b(y.element.name),b((v=g.component.componentData)==null?void 0:v.name))}const k=[{name:"copy",type:"primary",icon:"el-icon-copy-document",handler:h},{name:"delete",type:"danger",icon:"el-icon-delete",handler:S},{name:"clear",type:"warning",icon:"el-icon-folder-delete",handler:O}];function d(y){return k.filter(g=>w(y,g.name))}function w(y,g){const{disabledActions:v,isContainer:R}=b(y.name)??{},F=!(v!=null&&v.includes(g));return g==="clear"?R&&F:F}return(y,g)=>{const v=V("avue-form"),R=V("el-button"),F=V("el-col");return x(),E(f(he),{list:f(n),class:te(["el-row draggable-list",{"is-empty":!f(n).length,"is-root":y.componentData.isRoot}]),group:{name:"components"},"component-data":y.componentData,"item-key":"id",move:D,onChange:m},{item:T(({element:L,index:pe})=>[_(F,{class:te(["draggable-item",{"is-active":f(i).id===L.id,"is-hover":f(s).name&&f(s).id===L.id}]),span:c(L),onClick:N(Q=>f(u)(L),["stop"]),onMouseover:N(Q=>s.value=L||{},["stop"]),onMouseleave:g[0]||(g[0]=N(Q=>s.value={},["stop"]))},{default:T(()=>{var Q;return[L.name!=="form"?(x(),E(v,{key:0,option:l(L)},null,8,["option"])):ne("",!0),(Q=f(b)(L.name))!=null&&Q.isContainer?(x(),E(we,{key:1,class:"is-container","component-data":L,list:L.children??[],"onUpdate:list":X=>L.children=X},null,8,["component-data","list","onUpdate:list"])):ne("",!0),me(M("div",qt,[(x(!0),U(B,null,K(d(L),X=>(x(),E(R,de({key:X.name},X,{circle:"",plain:"",onClick:N(Xt=>X.handler(L,pe),["stop"])}),null,16,["onClick"]))),128))],512),[[fe,f(i).id===L.id]])]}),_:2},1032,["class","span","onClick","onMouseover"])]),_:1},8,["list","class","component-data"])}}}),Kt=W({setup(){const{proxy:t}=Ce(),{modelValue:o}=z(),e=I({}),p=I({}),n=P(()=>tt.bind(t)(ae(o.value))),i=I();function s(a,u){console.log(a),u==null||u()}return{form:e,defaults:p,option:n,formRef:i,onSubmit:s}},render(){return $e(V("avue-form"),{ref:"formRef",modelValue:this.form,option:this.option,defaults:this.defaults,"onUpdate:modelValue":t=>this.form=t,"onUpdate:defaults":t=>this.defaults=t,onSubmit:this.onSubmit})}}),Gt=W({__name:"source",setup(t){const{modelValue:o,setActiveElement:e}=z();return(p,n)=>(x(),E(f(C),{modelValue:f(o),"onUpdate:modelValue":[n[0]||(n[0]=i=>q(o)?o.value=i:null),n[1]||(n[1]=i=>f(e)())],"value-type":"object"},null,8,["modelValue"]))}}),Nt=W({__name:"index",setup(t){const{elementTree:o,workType:e,setActiveElement:p}=z();return(n,i)=>f(e)==="preview"?(x(),E(Kt,{key:0})):f(e)==="source"?(x(),E(Gt,{key:1})):(x(),E(we,{key:2,"component-data":f(o),list:f(o).children??[],"onUpdate:list":i[0]||(i[0]=s=>f(o).children=s),onClick:i[1]||(i[1]=N(s=>f(p)(),["stop"]))},null,8,["component-data","list"]))}}),Jt=W({__name:"index",setup(t){const o=z(),{elementTree:e,activeElement:p,baseOption:n,advanceOption:i,resolveSettings:s,recordHistory:a,getResource:u}=o,r=I(!1),b=I(""),l=I(0),c=I({}),m=I({labelPosition:"left",labelWidth:100,menuBtn:!1,span:24,tabs:!0,group:[]});H(()=>p.value.id,async()=>{r.value=!0,l.value=0,await be();const{settings:O,disabledSettings:D}=u(p.value.name)??{},k={label:"基础",prop:"base",column:n.value},d={label:"属性",prop:"component",column:s(O)},w={label:"高级",prop:"advance",column:i.value},y=[k,d,w].filter(g=>!(D!=null&&D.includes(g.prop)));m.value.group=y,b.value=y[0].prop,c.value=j(p.value.props),r.value=!1},{immediate:!0});const h=dt(()=>a("property"),1e3);Oe(c,O=>{const D=at(O,[void 0,null,""],["$"]);if(p.value.isRoot)ce(e.value,"props",D);else{const k=S(e.value,p.value.id)??[];k.length&&!ye(D,mt(e.value,k.concat("props")))&&ce(e.value,k.concat("props"),D)}l.value&&h(),l.value++},{deep:!0,debounce:100});function S(O,D){if(O.id===D)return[];if(O.children)for(const k in O.children){const d=S(O.children[k],D);if(d)return["children",k].concat(d)}}return(O,D)=>{const k=V("avue-form");return r.value?ne("",!0):(x(),E(k,{key:0,modelValue:c.value,"onUpdate:modelValue":D[0]||(D[0]=d=>c.value=d),class:"settings-form",option:m.value},null,8,["modelValue","option"]))}}}),Qt=W({__name:"index",setup(t){const{elementTree:o,workType:e,deviceType:p,historyList:n,historyIndex:i,restoreHistory:s,resetHistory:a}=z(),u=[{label:"PC端",value:"pc",icon:"el-icon-monitor"},{label:"移动端",value:"mobile",icon:"el-icon-cellphone"}],r=[{label:"设计",value:"design",icon:"el-icon-brush"},{label:"源码",value:"source",icon:"el-icon-more"},{label:"预览",value:"preview",icon:"el-icon-view"}];return(b,l)=>{const c=V("el-button"),m=V("el-button-group"),h=V("el-col"),S=V("el-link"),O=V("el-radio-button"),D=V("el-radio-group"),k=V("el-row");return x(),E(k,{gutter:20},{default:T(()=>[_(h,{span:8,style:{"align-self":"center"}},{default:T(()=>[_(m,{size:"small"},{default:T(()=>{var d;return[_(c,{disabled:f(i)===0,title:"撤回",icon:"el-icon-arrow-left",onClick:l[0]||(l[0]=w=>f(s)(f(i)-1))},null,8,["disabled"]),_(c,{disabled:f(i)===f(n).length-1,title:"重做",icon:"el-icon-arrow-right",onClick:l[1]||(l[1]=w=>f(s)(f(i)+1))},null,8,["disabled"]),_(c,{disabled:!((d=f(o).children)!=null&&d.length),title:"清空",icon:"el-icon-delete",onClick:l[2]||(l[2]=w=>f(a)())},null,8,["disabled"])]}),_:1})]),_:1}),_(h,{span:8,style:{"text-align":"center"}},{default:T(()=>[_(D,{modelValue:f(p),"onUpdate:modelValue":l[3]||(l[3]=d=>q(p)?p.value=d:null),size:"small",style:{"font-size":"unset"}},{default:T(()=>[(x(),U(B,null,K(u,d=>_(O,{key:d.value,label:d.value},{default:T(()=>[_(S,{title:d.label,icon:d.icon,underline:!1,style:{color:"inherit"},onClick:w=>p.value=d.value},null,8,["title","icon","onClick"])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1}),_(h,{span:8,style:{"text-align":"right"}},{default:T(()=>[_(D,{modelValue:f(e),"onUpdate:modelValue":l[4]||(l[4]=d=>q(e)?e.value=d:null),size:"small",style:{"font-size":"unset"}},{default:T(()=>[(x(),U(B,null,K(r,d=>_(O,{key:d.value,label:d.value},{default:T(()=>[_(S,{title:d.label,icon:d.icon,underline:!1,style:{color:"inherit"},onClick:w=>e.value=d.value},null,8,["title","icon","onClick"])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),Wl=W({__name:"index",props:{modelValue:{},groupList:{},resources:{},baseOption:{},advanceOption:{},leftWidth:{},rightWidth:{},adapterIn:{type:Function,default:re},adapterOut:{type:Function,default:ge}},emits:["reset"],setup(t,{emit:o}){const e=t,p=o,{workType:n,deviceType:i}=bt(e,p);return(s,a)=>{const u=V("el-aside"),r=V("el-header"),b=V("el-main"),l=V("el-container");return x(),E(l,{class:"form-design"},{default:T(()=>[_(u,{class:"left-panel",width:s.leftWidth},{default:T(()=>[_(Ht)]),_:1},8,["width"]),_(l,null,{default:T(()=>[_(r,{class:"main-header",height:"auto"},{default:T(()=>[_(Qt)]),_:1}),_(b,{class:"main-workspace"},{default:T(()=>[_(Nt,{class:te(`device-${f(i)}`)},null,8,["class"])]),_:1})]),_:1}),me(_(u,{class:"right-panel",width:s.rightWidth},{default:T(()=>[_(Jt)]),_:1},8,["width"]),[[fe,f(n)==="design"]])]),_:1})}}});export{yt as ControlSetter,zt as DesignAction,Rl as DicDataSetter,Al as DicTreeSetter,C as EditorSetter,Wl as FormDesign,Ve as HistoryType,ht as OnLoadSetter,Ml as RulesSetter,$ as SwitchSetter,Hl as ValueSetter,re as adapterIn,ge as adapterOut,gt as advance,le as alignDic,We as array,ot as base,je as cascader,ue as checkRules,Pe as checkbox,se as cloneItem,_t as color,ve as copyItem,Ae as date,Ue as daterange,ze as dates,Be as datetime,Fe as datetimerange,Ul as dic,Vt as dynamic,nt as form,ie as getRandomId,wt as group,Le as groupList,Me as icon,A as iconList,He as img,kt as input,tt as jsonParse,ae as jsonStringify,qe as month,Ke as monthrange,Tt as number,xt as password,Re as placementDic,zl as positionDic,Ge as radio,Dt as rate,Ne as select,Bl as sizeDic,$t as slider,Ct as switch,St as table,Ot as textarea,Je as time,Qe as timerange,Lt as title,Xe as tree,It as upload,Ye as url,Ze as week,et as year};
