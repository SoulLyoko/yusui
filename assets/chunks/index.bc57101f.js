import{a as ut,s as At,e as le,b as Kt,u as Z}from"./index.15c943cf.js";import{I as se}from"./iconify.5d378855.js";import{d as Mt}from"./index.5e3eb256.js";import{X as Me,B as De,r as L,s as he,d as P,e as J,w as pe,i as ee,u as k,n as _e,Y as Bt,h as A,H as C,j as T,k as E,R as X,F as W,D as $,E as b,J as g,p as R,q as j,a3 as tt,C as q,_ as Te,G as B,K as jt,l as Ht,O as lt,b as it,L as zt,a9 as Pe,aA as Wt,M as Yt,a7 as oe,a8 as ae,m as Gt,aM as ct,a5 as dt,I as qt}from"./framework.268af5be.js";import{_ as Qt,d as Jt,a as Xt}from"./index.3004631c.js";import"./index.2a8fee36.js";import{t as pt,P as ft,f as Zt,M as mt,L as el,u as tl}from"./vuedraggable.umd.5bd0051d.js";import{u as fe,w as Ne,d as ll,e as ol}from"./theme.a5c17c5b.js";import{p as al}from"./index.vue_vue_type_script_setup_true_lang.ed2201cd.js";import{E as G,m as nl,a as de}from"./index.e39bc4dd.js";import{d as vt}from"./differenceBy.a1afd1ca.js";import{aa as sl,F as rl,D as ge}from"./index.f85f9727.js";import{o as ul}from"./omitBy.9af654cc.js";import{a as il}from"./snakeCase.5ddcd990.js";import{J as cl,K as dl}from"../app.69a49066.js";import"./omit.67d7f778.js";import"./vue.runtime.esm-bundler.8984e576.js";const pl={},fl=Symbol("GLOBAL_OPTIONS_PROVIDE_KEY"),ml=()=>pl,ne=e=>e,Ee=e=>Array.isArray(e),Be=e=>e!==null&&typeof e=="object",je=e=>e instanceof Function,be=e=>e==null,He=typeof window>"u",_t=()=>{var e;return He||be((e=window.document)===null||e===void 0?void 0:e.visibilityState)?!0:window.document.visibilityState==="visible"},vl=()=>{var e,t;return(e=!He&&((t=window.navigator)===null||t===void 0?void 0:t.onLine))!==null&&e!==void 0?e:!0},Se=()=>new Promise(()=>{}),te=e=>ee(e)?e.value:e,_l=e=>Be(e)?Object.assign(Ee(e)?[]:{},e):e,ke=new Map,bl=e=>be(e)?void 0:ke.get(e),wl=(e,t,l)=>{const p=ke.get(e);p!=null&&p.timer&&clearTimeout(p.timer);const n=setTimeout(()=>ke.delete(e),t);ke.set(e,{...l,timer:n})};function bt(e,t,l){let p,n,a,d,o,r,c=0,w=!1,s=!1,f=!0;const i=!t&&t!==0&&typeof window.requestAnimationFrame=="function";if(typeof e!="function")throw new TypeError("Expected a function");t=+t||0,Be(l)&&(w=!!l.leading,s="maxWait"in l,a=s?Math.max(+l.maxWait||0,t):a,f="trailing"in l?!!l.trailing:f);function y(D){const N=p,x=n;return p=n=void 0,c=D,d=e.apply(x,N),d}function _(D,N){return i?(window.cancelAnimationFrame(o),window.requestAnimationFrame(D)):setTimeout(D,N)}function u(D){if(i)return window.cancelAnimationFrame(D);clearTimeout(D)}function m(D){return c=D,o=_(V,t),w?y(D):d}function v(D){const N=D-r,x=D-c,K=t-N;return s?Math.min(K,a-x):K}function h(D){const N=D-r,x=D-c;return r===void 0||N>=t||N<0||s&&x>=a}function V(){const D=Date.now();if(h(D))return I(D);o=_(V,v(D))}function I(D){return o=void 0,f&&p?y(D):(p=n=void 0,d)}function S(){o!==void 0&&u(o),c=0,p=r=n=o=void 0}function O(){return o===void 0?d:I(Date.now())}function U(){return o!==void 0}function F(){const D=Date.now(),N=h(D);for(var x=arguments.length,K=new Array(x),H=0;H<x;H++)K[H]=arguments[H];if(p=K,n=this,r=D,N){if(o===void 0)return m(r);if(s)return o=_(V,t),y(r)}return o===void 0&&(o=_(V,t)),d}return F.cancel=S,F.flush=O,F.pending=U,F}function yl(e,t,l){let p=!0,n=!0;if(typeof e!="function")throw new TypeError("Expected a function");return Be(l)&&(p="leading"in l?!!l.leading:p,n="trailing"in l?!!l.trailing:n),bt(e,t,{leading:p,trailing:n,maxWait:t})}var gl=ne((e,t)=>{let{debounceInterval:l,debounceOptions:p,manual:n}=t;const a=L(!1),d=L(),o=P(()=>p),r=P(()=>te(l)),c=L(e.context.runAsync);return n||(a.value=!0),J(w=>{be(r.value)||(d.value=bt(s=>s(),r.value,o.value),e.context.runAsync=function(){for(var s=arguments.length,f=new Array(s),i=0;i<s;i++)f[i]=arguments[i];return new Promise((y,_)=>{a.value?(a.value=!1,c.value(...f).then(y).catch(_)):d.value(()=>{c.value(...f).then(y).catch(_)})})},w(()=>{var s;(s=d.value)===null||s===void 0||s.cancel(),e.context.runAsync=c.value}))}),{onCancel(){var w;(w=d.value)===null||w===void 0||w.cancel()}}}),hl=ne((e,t)=>{let{errorRetryCount:l=0,errorRetryInterval:p=0}=t;const n=L(),a=L(0),d=P(()=>te(l)),o=P(()=>te(p));let r=!1;const c=()=>{a.value=0},w=P(()=>{if(o.value)return o.value;const i=1e3,y=1,_=9,u=Math.floor(Math.random()*2**Math.min(a.value,_)+y);return i*u}),s=()=>{let i;const y=d.value===-1,_=a.value<d.value;return(y||_)&&(y||(a.value+=1),i=setTimeout(()=>{r=!0,e.context.refresh()},w.value)),()=>i&&clearTimeout(i)},f=()=>{n.value&&n.value()};return{onBefore(){r||c(),r=!1,f()},onSuccess(){c()},onError(){n.value=s()},onCancel(){c(),f()}}}),kl=ne((e,t)=>{let{ready:l=L(!0),manual:p,defaultParams:n=[]}=t;return pe(l,a=>{!p&&a&&e.context.run(...n)},{flush:"sync"}),{onBefore(){if(!(je(l)?l():l.value))return e.loading.value=!1,{isBreak:!0}}}}),Cl=ne((e,t)=>{let{refreshDeps:l,refreshDepsAction:p,manual:n}=t;if(l===void 0||Ee(l)&&l.length===0)return{};const a=Ee(l)?l:[l];return pe(a,()=>{p?p():!n&&e.context.refresh()}),{}}),Vl=ne((e,t)=>{let{throttleInterval:l,throttleOptions:p}=t;const n=L(),a=P(()=>te(l)),d=P(()=>p),o=L(e.context.runAsync);return J(r=>{if(be(l))return{};n.value=yl(c=>c(),a.value,d.value),e.context.runAsync=function(){for(var c=arguments.length,w=new Array(c),s=0;s<c;s++)w[s]=arguments[s];return new Promise((f,i)=>{n.value(()=>{o.value(...w).then(f).catch(i)})})},r(()=>{var c;(c=n.value)===null||c===void 0||c.cancel(),e.context.runAsync=o.value})}),{onCancel(){var r;(r=n.value)===null||r===void 0||r.cancel()}}});const Dl=(e,t)=>l=>{Object.keys(l).forEach(p=>{e[p].value=l[p]}),t.forEach(p=>p(e))},Tl=(e,t)=>()=>{let l=t;for(let p=e.length;p-- >0;)l=e[p](l);return l()},Nl=(e,t,l)=>{var p,n;const{initialData:a,onSuccess:d,onError:o,onBefore:r,onAfter:c}=t,w=L((p=l==null?void 0:l.loading)!==null&&p!==void 0?p:!1),s=he((n=l==null?void 0:l.data)!==null&&n!==void 0?n:a),f=he(l==null?void 0:l.error),i=L(l==null?void 0:l.params),y=L([]),_=he("pending"),u={},m=Dl({status:_,loading:w,data:s,error:f,params:i},[]),v=function(V){for(var I=arguments.length,S=new Array(I>1?I-1:0),O=1;O<I;O++)S[O-1]=arguments[O];if(V==="onQuery"){const U=y.value.map(F=>F.onQuery).filter(Boolean);return{servicePromise:Tl(U,S[0])()}}else{const U=y.value.map(F=>{var D;return(D=F[V])===null||D===void 0?void 0:D.call(F,...S)});return Object.assign({},...U)}},h=L(0);return u.runAsync=async function(){for(var V=arguments.length,I=new Array(V),S=0;S<V;S++)I[S]=arguments[S];m({loading:!0,params:I,status:"pending"}),h.value+=1;const O=h.value,{isBreak:U,breakResult:F=Se()}=v("onBefore",I);if(U)return m({status:"settled"}),F;r==null||r(I);try{const D=()=>new Promise(K=>K(e(...i.value)));let{servicePromise:N}=v("onQuery",D);N||(N=D());const x=await N;return O!==h.value?Se():(m({data:x,loading:!1,error:void 0,status:"settled"}),v("onSuccess",x,I),d==null||d(x,I),O===h.value&&v("onAfter",I,x,void 0),c==null||c(I),x)}catch(D){if(O!==h.value)return Se();throw m({loading:!1,error:D,status:"settled"}),v("onError",D,I),o==null||o(D,I),O===h.value&&v("onAfter",I,void 0,D),c==null||c(I),D}},u.run=function(){u.runAsync(...arguments).catch(V=>{o||console.error(V)})},u.cancel=()=>{h.value+=1,m({loading:!1}),v("onCancel")},u.refresh=()=>{u.run(...i.value||[])},u.refreshAsync=()=>u.runAsync(...i.value||[]),u.mutate=V=>{const I=je(V)?V(s.value):V,S=_l(I);m({data:S}),v("onMutate",S)},{status:_,loading:w,data:s,error:f,params:i,plugins:y,context:u}};function xl(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=arguments.length>2?arguments[2]:void 0;const p=Me(fl,{}),n={...ml(),...p,...t},{manual:a=!1,defaultParams:d=[]}=n,o=Nl(e,n);if(o.plugins.value=l.map(r=>r(o,n)),!a){const r=o.params.value||d;o.context.run(...r)}return De(()=>{o.context.cancel()}),{loading:o.loading,data:o.data,error:o.error,params:o.params,cancel:o.context.cancel,refresh:o.context.refresh,refreshAsync:o.context.refreshAsync,mutate:o.context.mutate,run:o.context.run,runAsync:o.context.runAsync}}const Ce=new Map,Il=(e,t)=>{Ce.set(e,t),t.then(l=>(Ce.delete(e),l)).catch(()=>{Ce.delete(e)})},Ll=e=>Ce.get(e),ue=new Map,Ol=(e,t)=>{ue.has(e)&&ue.get(e).forEach(l=>l(t))},$l=(e,t)=>(ue.has(e)?ue.get(e).push(t):ue.set(e,[t]),()=>{const l=ue.get(e).indexOf(t);ue.get(e).splice(l,1)});var Sl=ne((e,t)=>{let{cacheKey:l,cacheTime:p=6e5,staleTime:n=0,getCache:a,setCache:d}=t;if(!l)return{};const o=je(l)?l:()=>l,r=L(()=>{});let c;const w=m=>a?a(m):bl(m),s=(m,v,h)=>{d?d(m,h):wl(m,v,h),Ol(m,h.data)},f=m=>n===-1||m+n>new Date().getTime(),i=(m,v)=>Object.prototype.hasOwnProperty.call(m,v),y=m=>{const v=o(m);return $l(v,h=>{e.data.value=h})},_=o(),u=w(_);return u&&i(u,"data")&&(e.data.value=u.data,e.params.value=u.params),_&&(r.value=y()),De(()=>{r.value()}),{onBefore(m){const v=o(m),h=w(v);if(!h||!i(h,"data"))return{};if(f(h.time))return e.data.value=h.data,e.loading.value=!1,{isBreak:!0,breakResult:h.data};e.data.value=h.data},onQuery(m){const v=e.params.value,h=o(v);let V=Ll(h);return V&&V!==c?()=>V:(V=m(),c=V,Il(h,V),()=>V)},onSuccess(m,v){const h=o(v);h&&(r.value(),s(h,p,{data:m,params:v,time:new Date().getTime()}),r.value=y(v))},onMutate(m){const v=o(e.params.value);v&&(r.value(),s(v,p,{data:m,params:e.params.value,time:new Date().getTime()}),r.value=y(e.params.value))}}});function Fl(e){let t,l;class p extends Promise{constructor(a){super(a),this.cancel=()=>{l(),clearTimeout(t)}}}return new p(n=>{l=n,t=setTimeout(l,e)})}function Fe(){return new Date().getTime()}var Ul=ne((e,t)=>{let{loadingDelay:l=0,loadingKeep:p=0}=t;const n=L(()=>{}),a=P(()=>te(l)),d=P(()=>te(p));let o=0,r={};const c=()=>{let w;return a.value&&(w=setTimeout(()=>{e.status.value==="pending"&&(e.loading.value=!0)},a.value)),()=>w&&clearTimeout(w)};return{onBefore(){e.loading.value=!a.value,n.value(),n.value=c(),o=Fe()},onQuery(w){if(!d.value)return()=>w();r=Fl(d.value+a.value);const s=async()=>{try{const i=await w();return Fe()-o<=a.value&&r.cancel(),Promise.resolve(i)}catch(i){return Fe()-o<=a.value&&r.cancel(),Promise.reject(i)}},f=Promise.allSettled([s(),r]).then(i=>{const y=i[0];return y.status==="fulfilled"?y.value:Promise.reject(y.reason)});return()=>f},onCancel(){n.value()},onAfter(){n.value()}}}),Ue;const wt=new Set,yt=new Set,gt=new Set,Ve=(e,t)=>{let l;switch(e){case"FOCUS_LISTENER":l=wt;break;case"RECONNECT_LISTENER":l=gt;break;case"VISIBLE_LISTENER":l=yt;break}if(!l.has(t))return l.add(t),()=>{l.delete(t)}},Re=e=>{e.forEach(t=>{t()})};!He&&(Ue=window)!==null&&Ue!==void 0&&Ue.addEventListener&&(window.addEventListener("visibilitychange",()=>{_t()&&Re(yt)},!1),window.addEventListener("focus",()=>Re(wt),!1),window.addEventListener("online",()=>Re(gt),!1));var Rl=ne((e,t)=>{let{pollingInterval:l,pollingWhenHidden:p=!1,pollingWhenOffline:n=!1,errorRetryCount:a=0}=t;const d=L(),o=L(!1),r=P(()=>te(l)),c=P(()=>te(a)),w=[],s=_=>{_&&w.push(_)},f=()=>(p||_t())&&(n||vl()),i=_=>{if(e.error.value&&c.value!==0)return;let u;if(!be(r.value)&&r.value>=0)if(f())u=setTimeout(_,r.value);else{o.value=!0;return}return()=>u&&clearTimeout(u)},y=()=>{o.value&&f()&&(e.context.refresh(),o.value=!1)};return pe(r,()=>{d.value&&(d.value(),d.value=i(()=>e.context.refresh()))}),p||s(Ve("VISIBLE_LISTENER",y)),n||s(Ve("RECONNECT_LISTENER",y)),De(()=>{w.forEach(_=>_())}),{onBefore(){var _;(_=d.value)===null||_===void 0||_.call(d)},onCancel(){var _;(_=d.value)===null||_===void 0||_.call(d)},onAfter(){d.value=i(()=>e.context.refresh())}}});const Pl=(e,t)=>{let l=!1;return function(){l||(l=!0,e(...arguments),setTimeout(()=>{l=!1},t))}};var El=ne((e,t)=>{let{refreshOnWindowFocus:l=!1,refocusTimespan:p=5e3}=t;const n=P(()=>te(l)),a=P(()=>te(p)),d=[],o=c=>{c&&d.push(c)},r=()=>{d.forEach(c=>c())};return J(()=>{if(r(),n.value){const c=Pl(e.context.refresh,a.value);o(Ve("VISIBLE_LISTENER",c)),o(Ve("FOCUS_LISTENER",c))}}),De(()=>{r()}),{}});function ie(e,t){return xl(e,t,[Ul,hl,gl,Rl,Vl,El,Cl,kl,Sl])}var ht=(e=>(e[e.已办=1]="已办",e[e.待办=2]="待办",e[e.失败=3]="失败",e[e.撤销=4]="撤销",e[e.终止=5]="终止",e))(ht||{});function xe(){const{request:e}=z(),t={publishList:"/sapier-flow/flow-run/queryPublishFlowList",taskList:"/sapier-flow/flow-run/userTaskList",detail:"/sapier-flow/flow-run/queryPublishFlowDetail",approvalNode:"/sapier-flow/flow-run/queryApprovalNode",start:"/sapier-flow/flow-run/startProcess",commit:"/sapier-flow/flow-run/commitTask",draft:"/sapier-flow/flow-run/saveDraft",revoke:"/sapier-flow/flow-run/revokeTask",terminate:"/sapier-flow/flow-run/terminateFlow",withdraw:"/sapier-flow/flow-run/withdrawToStart",transfer:"/sapier-flow/flow-run/transferTask",reject:"/sapier-flow/flow-run/rollbackTask",green:"/sapier-flow/flow-run/greenTask",circulate:"/sapier-flow/flow-circulate/commitTask"};return{url:t,getPublishList:()=>e.get(t.publishList),getTaskList:u=>e.get(t.taskList,{params:u}),getFlowDetail:u=>e.get(t.detail,{params:u}),getApprovalNode:u=>e.post(t.approvalNode,u),startTask:u=>e.post(t.start,u),commitTask:u=>e.post(t.commit,u),saveDraft:u=>e.post(t.draft,u),revokeTask:u=>e.post(t.revoke,u),terminateTask:u=>e.post(t.terminate,u),withdrawTask:u=>e.post(t.withdraw,u),transferTask:u=>e.post(t.transfer,u),rejectTask:u=>e.post(t.reject,u),greenChannel:u=>e.post(t.green,u),circulateTask:u=>e.post(t.circulate,u)}}function Al(e){const{commitTask:t,revokeTask:l,saveDraft:p,startTask:n,terminateTask:a,transferTask:d,withdrawTask:o,rejectTask:r,greenChannel:c,circulateTask:w}=xe(),s=P(()=>{const{flowDetail:i,formVariables:y,approvalFormData:_,debug:u,fileIds:m}=e,{flowDeployId:v}=i.value.process??{},{taskId:h,flowInstanceId:V}=i.value.task??{};return{flowDeployId:v,taskId:h,flowInstanceId:V,variables:y.value,debug:u.value,fileIds:m.value,..._.value}}),f=()=>s.value.taskId&&s.value.flowInstanceId;return{flow_draft(){if(f())return p(s.value)},flow_pass(){return f()?t(s.value):n(s.value)},flow_revoke(){if(f())return l(s.value)},flow_withdraw(){if(f())return o(s.value)},flow_terminate(){if(f())return a(s.value)},flow_transfer(){if(f())return d(s.value)},flow_reject(){if(f())return r(s.value)},flow_green(){if(f())return c(s.value)},flow_circulate(){if(f()){const{approvalFormData:i,circulateId:y}=e;return w({id:y==null?void 0:y.value,comment:i==null?void 0:i.value.comment})}}}}function Kl(e){const t=L({});return J(async()=>{var p;const{formProperty:l}=((p=k(e))==null?void 0:p.properties)||{};l!=null&&l.length&&(await _e(),Object.keys(t.value).forEach(n=>{var o,r,c,w;const a=((o=t.value[n])==null?void 0:o.label)||"",d=l==null?void 0:l.find(s=>s.prop===n);if(t.value[n].display=d==null?void 0:d.display,t.value[n].disabled=d==null?void 0:d.disabled,t.value[n].detail=d==null?void 0:d.detail,t.value[n].readonly=d==null?void 0:d.readonly,t.value[n].rules=t.value[n].rules??[],d!=null&&d.required&&((r=t.value[n].rules)!=null&&r.some(s=>s.required)))return null;d!=null&&d.required?(c=t.value[n].rules)==null||c.push({required:!0,message:`${a}为必填项`}):t.value[n].rules=(w=t.value[n].rules)==null?void 0:w.filter(s=>!s.required)}))}),t}function Ml(){return{modelValue:{type:Object,default:()=>({})},title:{type:String},flowDetail:{type:Object,default:()=>({})},formLoading:{type:Boolean},submitLoading:{type:Boolean},activeTab:{type:String,default:"formTab"},activeBtn:{type:Object,default:()=>({})},approvalFormData:{type:Object,default:()=>({})},flowKey:{type:String},taskId:{type:String},instanceId:{type:String},formId:{type:String},permission:{type:Object},beforeClick:{type:Function},beforeSubmit:{type:Function},detail:{type:Boolean},debug:{type:Boolean},circulateId:{type:String}}}function Bl(){return{complete:e=>e}}const kt=Symbol("flowFormState");function jl(e,t){const l=fe(e,void 0,{passive:!0,deep:!0}),{flowDetail:p,modelValue:n,formLoading:a}=l,{getFlowDetail:d}=xe(),{tabs:o}=z(),r=P(()=>(o==null?void 0:o.filter(i=>{var _,u,m;const y=(m=(u=(_=p.value)==null?void 0:_.properties)==null?void 0:u.formProperty)==null?void 0:m.find(v=>v.prop===i.prop);return(y==null?void 0:y.display)!==!1}))??[]);J(()=>{const{flowKey:i,taskId:y,instanceId:_}=e;!i&&!y&&!_||(a.value=!0,d({flowKey:i,taskId:y,flowInstanceId:_}).then(u=>{p.value=u.data,n.value=u.data.formData||{}}).finally(()=>{a.value=!1}))});const c=L(!1),w=P(()=>Object.entries(n.value||{}).filter(([i])=>!i.startsWith("$")).map(([i,y])=>({key:i,value:y}))),s=L(),f={...l,formData:n,formVariables:w,approvalVisible:c,tabList:r,fileIds:s,emit:t};return Bt(kt,f),f}function ce(){return Me(kt)}const Hl=A({__name:"button-list",emits:["click"],setup(e,{emit:t}){const{flowDetail:l,circulateId:p}=ce(),{data:n}=qe().useList(),{userInfo:a}=z();function d(r,c){return r.map(w=>{const s=c.find(i=>i.buttonKey===w.buttonKey);return{...w,...al(s,["display","approval"])}})}const o=P(()=>{var v,h,V,I,S,O;if(p!=null&&p.value){const U=(v=n.value)==null?void 0:v.find(F=>F.buttonKey==="flow_circulate");return U?[U]:[]}const r=typeof a=="function"?a():a,{assignee:c,status:w}=((h=l.value)==null?void 0:h.task)||{},{createUser:s,flowInstanceId:f,status:i}=((V=l.value)==null?void 0:V.flowInstance)||{},y={true:!0,false:!1,startUser:s==(r==null?void 0:r.userId),assignee:c==(r==null?void 0:r.userId),todo:w==2,done:w==1,notstarted:!f,started:!!f,finished:i===1,unfinished:i===2},_=((I=n.value)==null?void 0:I.filter(U=>U.buttonKey!=="flow_circulate"))??[],{button:u}=((S=l.value)==null?void 0:S.properties)||{};return((O=d(_,u??[]))==null?void 0:O.filter(U=>{var F,D;return(D=(F=U.display)==null?void 0:F.split(","))==null?void 0:D.every(N=>y[N])}))??[]});return(r,c)=>{const w=C("el-button");return T(!0),E(W,null,X(o.value,s=>(T(),$(w,{key:s.buttonKey,type:s.buttonType,onClick:f=>t("click",s)},{default:b(()=>[g(k(se),{icon:s.icon},null,8,["icon"]),R(" "+j(s.name),1)]),_:2},1032,["type","onClick"]))),128)}}});function ze(e){return new Promise((t,l)=>{k(e).validate((n,a,d)=>{n?(a(),t(d)):l(d)})})}const zl=A({__name:"common-comments",props:{modelValue:{}},setup(e){const t=e,{modelValue:l}=fe(t),{batchUpdate:p,create:n,remove:a,useList:d}=co(),o=L(!1),{activeBtn:r}=ce(),c=P(()=>{var h;return(h=r.value)==null?void 0:h.buttonKey}),{data:w,refresh:s}=d(c),f=P(()=>{var V,I,S;const h=l.value;if(h&&!((V=w.value)!=null&&V.some(O=>O.content===h))){const O=(((S=(I=w.value)==null?void 0:I[0])==null?void 0:S.sort)||1)-1;return[{content:h,sort:O},...w.value||[]]}return w.value});async function i(h){var V;await n({...h,type:(V=r.value)==null?void 0:V.buttonKey}),G.success("添加成功"),s()}async function y(h){await a(h.id),G.success("删除成功"),s()}async function _(h,V){let I=V.parent.data;I=I.map((S,O)=>({id:S.id,sort:O+1})),await p(I),G.success("修改排序成功"),s(),o.value=!1}function u(){o.value=!0}const m=L();async function v(h){var V;l.value=h.content??"",await _e(),(V=m.value)==null||V.blur()}return(h,V)=>{const I=C("el-input"),S=C("el-text"),O=C("el-col"),U=C("el-button"),F=C("el-row"),D=C("el-tree"),N=C("el-popover");return T(),$(N,{visible:o.value,placement:"bottom",title:"常用意见",width:600},{reference:b(()=>[g(I,{ref_key:"inputRef",ref:m,modelValue:k(l),"onUpdate:modelValue":V[0]||(V[0]=x=>ee(l)?l.value=x:null),type:"textarea",placeholder:"请输入意见",rows:"5",onFocus:V[1]||(V[1]=x=>o.value=!0),onBlur:V[2]||(V[2]=x=>o.value=!1)},null,8,["modelValue"])]),default:b(()=>[g(D,{data:f.value,"node-key":"content",draggable:"","allow-drop":(x,K,H)=>H!=="inner",props:{label:"content"},onNodeClick:v,onNodeDrop:_,onNodeDragStart:u},{default:b(({data:x})=>[g(F,{style:{width:"600px"}},{default:b(()=>[g(O,{span:22},{default:b(()=>[g(S,{truncated:"",title:x.content},{default:b(()=>[R(j(x.content),1)]),_:2},1032,["title"])]),_:2},1024),g(O,{span:2},{default:b(()=>[x.id?(T(),$(U,{key:0,type:"danger",size:"small",icon:"el-icon-close",text:"",onClick:tt(K=>y(x),["stop"])},null,8,["onClick"])):(T(),$(U,{key:1,type:"primary",size:"small",icon:"el-icon-plus",text:"",onClick:tt(K=>i(x),["stop"])},null,8,["onClick"]))]),_:2},1024)]),_:2},1024)]),_:1},8,["data","allow-drop"])]),_:1},8,["visible"])}}}),Wl=A({__name:"approval-tree",props:{modelValue:{},data:{},autoCheck:{type:Boolean}},setup(e){const t=e,{modelValue:l}=fe(t),p=L(),n={class(s){return`node-${s.type}`}},a=P(()=>pt(t.data??[],(s,f,i)=>{const y=ut();return s.taskNodeKey=(i==null?void 0:i.taskNodeKey)??s.taskNodeKey,s.incoming=(i==null?void 0:i.incoming)??s.incoming,s.multiple=(i==null?void 0:i.multiple)??s.multiple,{...s,id:y,label:s.title,disabled:s.type!=="user"}})),d={element:"ep:flag",post:"ep:share",dept:"ep:share",user:"ep:user"};Ne(()=>[a.value,p.value],async()=>{if(!p.value||!a.value.length)return;if(t.autoCheck){const f=o(a.value);f&&w([f])}ft(a.value,f=>{var i;return!!((i=f.children)!=null&&i.length)}).map(async f=>{var y;await At(100);const i=(y=p.value)==null?void 0:y.getNode(f);i==null||i.expand()})},{immediate:!0,debounce:100});function o(s){var f;if(s.length===1)return(f=s[0].children)!=null&&f.length?o(s[0].children):s[0]}async function r(s,{checkedNodes:f}){var _;let i=f.filter(u=>u.type==="user");const y=i.some(u=>u.id===s.id);if(a.value.every(u=>!u.multiple)&&y)i=[s];else if(!s.multiple&&y){const v=((_=p.value)==null?void 0:_.getNode(s)).parent.data.children.filter(h=>h.id!==s.id);i=vt(i,v,"id")}w(i)}function c(s){const f=l.value.filter(i=>i.id!==s.id);w(f)}function w(s){var f;l.value=s,(f=p.value)==null||f.setCheckedNodes(s)}return(s,f)=>{const i=C("el-tag"),y=C("Icon"),_=C("el-tree");return T(),E(W,null,[(T(!0),E(W,null,X(k(l),u=>(T(),$(i,{key:u.id,type:"info",closable:"",onClose:m=>c(u)},{default:b(()=>[R(j(u.title),1)]),_:2},1032,["onClose"]))),128)),g(_,{ref_key:"treeRef",ref:p,class:"approval-tree",data:a.value,props:n,"node-key":"id","check-on-click-node":"","show-checkbox":"",onCheck:r},{default:b(({data:u})=>[q("div",null,[g(y,{icon:d[u.type]||d.element,style:{display:"inline-block"}},null,8,["icon"]),q("span",null,j(u.title),1)])]),_:1},8,["data"])],64)}}});const ot=Te(Wl,[["__scopeId","data-v-f1318efd"]]),at=A({__name:"assignee-setter",props:{modelValue:{},tableData:{}},emits:["update:modelValue"],setup(e,{emit:t}){const l=e,p=P({get(){return typeof l.modelValue=="string"?l.modelValue?l.modelValue.split(","):[]:l.modelValue},set(s){var f;t("update:modelValue",s.join(",")),(f=l.tableData)!=null&&f.row&&(l.tableData.row.idVal=ft(o.value,i=>s==null?void 0:s.includes(i.id)).map(i=>i[`${d.value}Id`]).join(","))}}),n=P({get(){return Array.isArray(l.modelValue)?l.modelValue.join(","):l.modelValue},set(s){t("update:modelValue",s)}}),a=L(!1),d=P(()=>{var s,f;return(f=(s=l.tableData)==null?void 0:s.row)==null?void 0:f.type}),o=L([]),r=L([]),{getUserTree:c}=vo(),{getParam:w}=me();return pe(d,s=>{["dept","post","user"].includes(s)?(a.value=!0,c(s==="user"?"":s).then(f=>{o.value=pt(f.data,i=>({...i,label:i.title,value:i.id,disabled:s==="user"?i.type!=="user":!1}))}).finally(()=>a.value=!1)):d.value==="dynamic"&&(a.value=!0,w("flow.trends.user").then(f=>{r.value=f.data}).finally(()=>a.value=!1))},{immediate:!0}),(s,f)=>{const i=C("el-tree-select"),y=C("el-input");return["dept","post","user"].includes(d.value)?(T(),$(i,{key:0,modelValue:p.value,"onUpdate:modelValue":f[0]||(f[0]=_=>p.value=_),data:o.value,loading:a.value,"expand-on-click-node":!1,multiple:"","check-on-click-node":"","show-checkbox":"","check-strictly":"",clearable:"",style:{width:"100%"}},null,8,["modelValue","data","loading"])):d.value==="dynamic"?(T(),$(i,{key:1,modelValue:n.value,"onUpdate:modelValue":f[1]||(f[1]=_=>n.value=_),data:r.value,loading:a.value,clearable:"",style:{width:"100%"}},null,8,["modelValue","data","loading"])):d.value==="userTask"?(T(),$(k(Qt),{key:2,modelValue:n.value,"onUpdate:modelValue":f[2]||(f[2]=_=>n.value=_),"filter-type":"userTask"},null,8,["modelValue"])):(T(),$(y,{key:3,modelValue:n.value,"onUpdate:modelValue":f[3]||(f[3]=_=>n.value=_)},null,8,["modelValue"]))}}}),Yl={key:0,class:"flow-viewer"},Gl={key:0,class:"flow-status-legend"},ql=A({__name:"index",props:{modelValue:{},view:{type:Boolean},flowFormOption:{},flowHistory:{},showLegend:{type:Boolean}},emits:["update:modelValue","nodeClick"],setup(e,{emit:t}){const l=e,{FlowDesign:p,tabs:n}=z(),a=he();ll(a,()=>{var u;(u=a.value)==null||u.on("node:click",m=>t("nodeClick",m))});const d=P({get(){let u=Jt();return typeof l.modelValue=="string"&&l.modelValue?u=JSON.parse(l.modelValue):typeof l.modelValue=="object"&&Object.keys(l.modelValue)&&(u=l.modelValue),u},set(u){t("update:modelValue",JSON.stringify(u))}}),o=P(()=>{const{column:u=[],group:m=[]}=JSON.parse(l.flowFormOption||"{}");return[...u,...m.map(h=>h.column??[]).flat()]}),{data:r}=qe().useList(),c=P(()=>(n==null?void 0:n.map(u=>({...u,display:!0})))??[]),w=P(()=>{var u;return{formPropertyList:[...o.value,...c.value],buttonList:(u=r.value)==null?void 0:u.filter(m=>m.status===1),fieldsDic:o.value.map(m=>({label:m.label,value:`\${${m.prop}}`,desc:`\${${m.prop}}`})),flowButtonDisplayDic:le(Ye),flowButtonApprovalDic:le(Ge)}}),s=L({}),f=L({});Ne(f,u=>{var m,v,h,V,I,S;u&&((h=(v=(m=u.assignee)==null?void 0:m.children)==null?void 0:v.column)!=null&&h[1]&&(u.assignee.children.column[1].component=at),(S=(I=(V=u.circulate)==null?void 0:V.children)==null?void 0:I.column)!=null&&S[1]&&(u.circulate.children.column[1].component=at))},{debounce:1});const{data:i}=me().useParam("flow.task.status"),y=P(()=>{var u;return(u=l.flowHistory)==null?void 0:u.map(m=>{var h,V;const v=(V=(h=i.value)==null?void 0:h.find(I=>I.value===m.status))==null?void 0:V.style;return{id:m.taskNodeKey,style:v}})}),_=P(()=>{var u,m;return(m=(u=l.flowHistory)==null?void 0:u.filter(v=>v.taskNodeType==="userTask"))==null?void 0:m.map(v=>{var h;return{id:v.taskNodeKey,content:`<div>${v.assigneeName}</div>
        <div>${v.endTime??""}</div>
        <div>${((h=v.comment)==null?void 0:h.handleComment)??""}</div>`}})});return(u,m)=>u.view?(T(),E("div",Yl,[u.showLegend!==!1?(T(),E("div",Gl,[(T(!0),E(W,null,X(k(i),v=>{var h;return T(),E("div",{key:v.label,class:"legend-item"},[q("div",{class:"legend-color",style:jt({backgroundColor:(h=v.style)==null?void 0:h.fill})},null,4),q("span",null,j(v.label),1)])}),128))])):B("",!0),g(k(p),{lf:a.value,"onUpdate:lf":m[0]||(m[0]=v=>a.value=v),"model-value":d.value,styles:y.value,tooltips:_.value,type:"viewer"},null,8,["lf","model-value","styles","tooltips"])])):(T(),$(k(p),{key:1,modelValue:d.value,"onUpdate:modelValue":m[1]||(m[1]=v=>d.value=v),formData:s.value,"onUpdate:formData":m[2]||(m[2]=v=>s.value=v),formDefaults:f.value,"onUpdate:formDefaults":m[3]||(m[3]=v=>f.value=v),"form-options":k(Xt),"data-options":w.value,"form-width":"30%"},null,8,["modelValue","formData","formDefaults","form-options","data-options"]))}});const we=Te(ql,[["__scopeId","data-v-8d328451"]]),Ql=A({__name:"node-select",props:{modelValue:{}},setup(e){const t=e,{modelValue:l}=fe(t),{flowDetail:p}=ce(),n=L(!1);function a({data:d}){d.type==="userTask"&&(n.value=!1,l.value=d.id)}return(d,o)=>{const r=C("el-button"),c=C("el-popover");return T(),$(c,{visible:n.value,"onUpdate:visible":o[0]||(o[0]=w=>n.value=w),placement:"bottom-start",width:"800px",trigger:"click"},{reference:b(()=>[g(r,null,{default:b(()=>[R(" 点击选择节点 ")]),_:1})]),default:b(()=>{var w,s;return[g(we,{"model-value":(s=(w=k(p))==null?void 0:w.process)==null?void 0:s.flowData,view:"",style:{height:"600px"},onNodeClick:a},null,8,["model-value"])]}),_:1},8,["visible"])}}}),Jl=A({__name:"approval-form",emits:["confirm"],setup(e,{emit:t}){const{getApprovalNode:l}=xe(),{useParam:p}=me(),{formData:n,approvalFormData:a,activeBtn:d,approvalVisible:o,formVariables:r,flowDetail:c}=ce(),w=L([]),s=L([]),f=L([]),i=L([]),y=L(!1),_=L(!1),u=L(),m=L(),v={menuBtn:!1,labelWidth:100,column:[{label:"指定节点",prop:"jumpTaskNodeKey",span:24,rules:[{required:!0,message:"请选择指定节点"}]},{label:"审批人",prop:"assignee",span:24,rules:[{required:!0,validator:h}]},{label:"传阅人",prop:"circulate",span:24},{label:"意见",prop:"comment",span:24,rules:[{required:!0,message:"请填写意见"}]}]};function h(D,N,x){var Q,M,ye;const K=((Q=w.value[0])==null?void 0:Q.type)==="parallelGateway",H=(ye=(M=w.value[0])==null?void 0:M.children)==null?void 0:ye.every(Ie=>Zt([Ie],re=>s.value.some(Le=>Le.id===re.id)));if(s.value.length){if(K&&!H)return x("请在每个节点选择审批人")}else return x("请选择审批人");return!0}const{data:V}=p("flow.default.comment"),{data:I}=p("flow.approval.autocheck");J(async()=>{var N;if(!o.value||!u.value||!m.value)return;S();const{taskId:D}=((N=c.value)==null?void 0:N.task)||{};_e(()=>{u.value.resetFields(),a.value.comment=n.value.comment||(D?"":V.value),m.value.jumpTaskNodeKey.display=O("specifyNode"),m.value.assignee.display=O("assignee"),m.value.circulate.display=O("circulate"),m.value.comment.display=O("comment")})}),J(async()=>{var x,K;if(!o.value||!O("assignee")||O("specifyNode")&&!a.value.jumpTaskNodeKey)return;S();const{flowKey:D}=((x=c.value)==null?void 0:x.process)||{},{taskId:N}=((K=c.value)==null?void 0:K.task)||{};try{_.value=!0;const H=await l({flowKey:D,taskId:N,variables:r.value,buttonType:d.value.buttonKey,jumpTaskNodeKey:a.value.jumpTaskNodeKey});w.value=H.data.approvalNodeList,f.value=H.data.circulateNodeList}finally{_.value=!1}});function S(){w.value=[],s.value=[],f.value=[],i.value=[]}function O(D){var N,x;return(x=(N=d.value)==null?void 0:N.approval)==null?void 0:x.includes(D)}async function U(){await ze(u),y.value=!0;const{data:D,outgoing:N}=F(s.value),{data:x}=F(i.value);a.value.assignee=D,a.value.outgoing=[...N],a.value.circulate=x,console.log("🚀 ~ file: approval-form.vue:210 ~ onConfirm ~ formData:",n),t("confirm")}function F(D){const N={},x={},K=new Set;return D.forEach(H=>{const{taskNodeKey:Q,incoming:M}=H;N[Q]||(N[Q]=new Set),H.userId&&N[Q].add(H.userId),x[Q]=[...N[Q]].join(","),M&&K.add(M)}),{set:N,data:x,outgoing:K}}return(D,N)=>{const x=C("el-skeleton"),K=C("avue-form"),H=C("el-button"),Q=C("el-dialog");return T(),$(Q,{modelValue:k(o),"onUpdate:modelValue":N[7]||(N[7]=M=>ee(o)?o.value=M:null),class:"approlval-form",title:k(d).name,width:"900px","append-to-body":""},{footer:b(()=>[g(H,{onClick:N[6]||(N[6]=M=>o.value=!1)},{default:b(()=>[R(" 取 消 ")]),_:1}),g(H,{type:"primary",onClick:U},{default:b(()=>[R(" 确 定 ")]),_:1})]),default:b(()=>[g(K,{ref_key:"formRef",ref:u,modelValue:k(a),"onUpdate:modelValue":N[4]||(N[4]=M=>ee(a)?a.value=M:null),defaults:m.value,"onUpdate:defaults":N[5]||(N[5]=M=>m.value=M),option:v},{jumpTaskNodeKey:b(()=>[g(Ql,{modelValue:k(a).jumpTaskNodeKey,"onUpdate:modelValue":N[0]||(N[0]=M=>k(a).jumpTaskNodeKey=M)},null,8,["modelValue"])]),assignee:b(()=>[_.value?(T(),$(x,{key:0})):(T(),$(ot,{key:"AssigneeTree",modelValue:s.value,"onUpdate:modelValue":N[1]||(N[1]=M=>s.value=M),data:w.value,"auto-check":k(I)==="true"},null,8,["modelValue","data","auto-check"]))]),circulate:b(()=>[_.value?(T(),$(x,{key:0})):(T(),$(ot,{key:"CirculateTree",modelValue:i.value,"onUpdate:modelValue":N[2]||(N[2]=M=>i.value=M),data:f.value},null,8,["modelValue","data"]))]),comment:b(()=>[g(zl,{modelValue:k(a).comment,"onUpdate:modelValue":N[3]||(N[3]=M=>k(a).comment=M)},null,8,["modelValue"])]),_:1},8,["modelValue","defaults"])]),_:1},8,["modelValue","title"])}}}),Xl={class:"flow-form__title"},We=A({__name:"index",props:Ml(),emits:Bl(),setup(e,{emit:t}){const l=e,p=jl(l,t),{flowDetail:n,tabList:a,activeTab:d,activeBtn:o,formLoading:r,approvalVisible:c,submitLoading:w}=p,s=L();async function f(_){var u,m;o.value=_,await((u=s.value)==null?void 0:u.validate()),await((m=l.beforeClick)==null?void 0:m.call(l,_)),(_==null?void 0:_.approval)!=="false"?c.value=!0:y()}const i=Al(p);async function y(){var _,u;try{const{buttonKey:m}=o.value;w.value=!0,await((_=l.beforeSubmit)==null?void 0:_.call(l,o.value));const v=(u=i[m])==null?void 0:u.call(i);v instanceof Promise?(await v,G.success("操作成功"),c.value=!1,t("complete",o.value)):G.error("操作失败")}finally{w.value=!1}}return(_,u)=>{const m=C("el-skeleton"),v=C("el-main"),h=C("el-header"),V=C("el-tab-pane"),I=C("el-tabs"),S=C("el-container");return k(r)?(T(),$(v,{key:0},{default:b(()=>[g(m)]),_:1})):(T(),$(S,{key:1,class:"flow-form"},{default:b(()=>[g(h,{class:"flow-form__header",height:"auto"},{default:b(()=>{var O;return[q("div",Xl,j(l.title??((O=k(n).flowInstance)==null?void 0:O.title)),1),_.detail?B("",!0):(T(),$(Hl,{key:0,onClick:f})),Ht(_.$slots,"button")]}),_:3}),g(v,{class:"flow-form__main"},{default:b(()=>[g(I,{modelValue:k(d),"onUpdate:modelValue":u[0]||(u[0]=O=>ee(d)?d.value=O:null)},{default:b(()=>[(T(!0),E(W,null,X(k(a),O=>(T(),$(V,{key:O.prop,label:O.label,name:O.prop,lazy:""},{default:b(()=>[O.prop==="formTab"?(T(),$(lt(_.$slots.default??O.component),{key:0,ref_for:!0,ref:U=>s.value=U},null,512)):(T(),$(lt(O.component),{key:1}))]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1}),g(Jl,{onConfirm:y})]),_:3}))}}});function Ct(e,t){switch(t.type){case"window":return Zl(e,t);case"dialog":case"drawer":return eo(e,t);default:return{open:l=>{},close:()=>{}}}}function Zl(e,t){const{window:[l="",p="flow-form",n="left=0,top=0,width=1600,height=900"]=[]}=t,a=L(null),d=P(()=>`${l}?${Kt(ul(e,il(sl,rl)))}`);return{open:c=>{var w;a.value=window.open(d.value,p,n),(w=a.value)==null||w.addEventListener("message",s=>{const{event:f}=s.data,i={...k(e),...k(c)}[f];typeof i=="function"&&i(s.data)})},close:()=>{var c;return(c=a.value)==null?void 0:c.close()},openedWindow:a}}function eo(e,t){const{appContext:l}=it();let p,n;const a=o=>{p=document.createElement("div"),p.className="flow-form-wrapper";const r=to(t.formPath),c=Pe(r,{...k(e),...k(o)});n=Pe(t.type==="dialog"?cl:dl,{customClass:"flow-form-overlay",modelValue:!0,width:"80%",size:"80%",top:"100px",fullscreen:!0,destroyOnClose:!0,onClose:d,...t.overlay},c),n.appContext=l,Wt(n,p),document.body.appendChild(p)},d=()=>{var o,r;(r=(o=n==null?void 0:n.component)==null?void 0:o.props)!=null&&r.modelValue&&(n.component.props.modelValue=!1),p&&document.body.removeChild(p),p=null};return{open:a,close:d}}function to(e){return e?zt(()=>Yt(()=>import(e),[])):We}const lo=A({setup(){const{flowDetail:e,formData:t,detail:l}=ce(),p=Kl(e.value),{proxy:n}=it(),a=L({});J(()=>{const{formOption:r}=e.value.process??{};a.value=mt.bind(n)(r||'{"menuBtn":false}'),a.value.detail=!!l.value});const d=L();function o(){return ze(d)}return{form:t,option:a,defaults:p,formRef:d,validate:o}},render(){return Pe(C("avue-form"),{ref:"formRef",modelValue:this.form,defaults:this.defaults,option:this.option,class:this.option.class,"onUpdate:modelValue":e=>this.form=e,"onUpdate:defaults":e=>this.defaults=e})}}),oo=A({__name:"upload-table",setup(e){const{flowDetail:t,fileIds:l}=ce(),{upload:{action:p,headers:n,preview:a,download:d,props:o}={}}=z(),r=typeof n=="function"?n():n,c=P(()=>{var v,h;return((h=(v=t.value)==null?void 0:v.task)==null?void 0:h.flowInstanceId)??ut()}),w={rowKey:"id",align:"center",index:!0,border:!0,stripe:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuWidth:200,column:[{label:"文件名",prop:"fileName"},{label:"文件类型",prop:"fileType"},{label:"文件大小",prop:"fileSize"},{label:"版本",prop:"version"},{label:"上传时间",prop:"createTime"}]},{bindVal:s,getDataList:f,handleDel:i,handleSave:y,afterGetList:_,crudStateRefs:{tableData:u}}=Z({crudOption:{...fo(),saveSuccessMsg:"上传成功"},tableOption:w,queryForm:{isLatest:1,flowInstanceId:c.value}});_(()=>{l.value=u.value.map(v=>v.id).join(",")}),f();async function m(v,h){var D,N;const{fileName:V,fileType:I,fileSize:S,fileUrl:O,res:U}=o,F={fileName:ge({res:v},`${U}.${V}`),fileType:ge({res:v},`${U}.${I}`),fileSize:ge({res:v},`${U}.${S}`),fileUrl:ge({res:v},`${U}.${O}`),taskId:(N=(D=t.value)==null?void 0:D.task)==null?void 0:N.taskId,flowInstanceId:c.value,rootMark:(h==null?void 0:h.rootMark)||"",version:typeof(h==null?void 0:h.version)=="number"?h.version+1:1};await y(F,f,()=>{})}return(v,h)=>{const V=C("el-button"),I=C("el-upload"),S=C("avue-crud");return T(),$(S,oe(ae(k(s))),{"menu-left":b(()=>[g(I,{action:k(p),headers:k(r),"show-file-list":!1,onSuccess:h[0]||(h[0]=O=>m(O))},{default:b(()=>[g(V,{type:"primary",icon:"el-icon-upload"},{default:b(()=>[R(" 点击上传 ")]),_:1})]),_:1},8,["action","headers"])]),menu:b(({row:O,index:U})=>[g(V,{type:"primary",text:"",icon:"el-icon-view",onClick:F=>{var D;return(D=k(a))==null?void 0:D(O,k(u))}},{default:b(()=>[R(" 预览 ")]),_:2},1032,["onClick"]),g(V,{type:"primary",text:"",icon:"el-icon-download",onClick:F=>{var D;return(D=k(d))==null?void 0:D(O,k(u))}},{default:b(()=>[R(" 下载 ")]),_:2},1032,["onClick"]),g(I,{action:k(p),headers:k(r),"show-file-list":!1,style:{display:"inline","vertical-align":"middle","margin-right":"10px"},onSuccess:F=>m(F,O)},{default:b(()=>[g(V,{type:"primary",text:"",icon:"el-icon-upload"},{default:b(()=>[R(" 更新版本 ")]),_:1})]),_:2},1032,["action","headers","onSuccess"]),g(V,{type:"primary",text:"",icon:"el-icon-delete",onClick:F=>k(i)(O,U)},{default:b(()=>[R(" 删除 ")]),_:2},1032,["onClick"])]),_:1},16)}}}),ao={class:"flow-track"},no={key:0},so={key:1},ro=A({__name:"flow-track",setup(e){const{flowDetail:t}=ce(),l=L("table"),p=[{label:"table",icon:"ep:grid"},{label:"graph",icon:"ep:picture"},{label:"timeline",icon:"ep:finished"}],n=P(()=>{var r,c,w;return((w=(c=(r=t.value)==null?void 0:r.flowHistory)==null?void 0:c.filter(s=>s.taskNodeType==="userTask"))==null?void 0:w.map(s=>({...s,duration:Mt(s.duration)})))??[]}),a={addBtn:!1,menu:!1,border:!0,column:[{label:"节点名称",prop:"taskNodeName"},{label:"处理人",prop:"assigneeName"},{label:"接收时间",prop:"startTime"},{label:"处理时间",prop:"endTime"},{label:"办理时长",prop:"duration"},{label:"操作类型",prop:"type",dicUrl:"/sapier-flow/flow-param/getParam",dicQuery:{paramKey:"flow.handle.type"}},{label:"办理意见",prop:"comment",bind:"comment.handleComment"}]},{data:d}=me().useParam("flow.handle.type");function o(r){var c;return(c=d.value)==null?void 0:c.find(w=>w.value===r)}return(r,c)=>{var m,v,h;const w=C("el-radio-button"),s=C("el-radio-group"),f=C("avue-crud"),i=C("el-card"),y=C("el-timeline-item"),_=C("el-timeline"),u=C("el-empty");return T(),E(W,null,[g(s,{modelValue:l.value,"onUpdate:modelValue":c[0]||(c[0]=V=>l.value=V)},{default:b(()=>[(T(),E(W,null,X(p,V=>g(w,{key:V.label,label:V.label},{default:b(()=>[g(k(se),{icon:V.icon},null,8,["icon"])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"]),q("div",ao,[l.value==="table"?(T(),$(f,{key:0,data:n.value,option:a},null,8,["data"])):B("",!0),l.value==="graph"?(T(),$(we,{key:1,"model-value":(v=(m=k(t))==null?void 0:m.process)==null?void 0:v.flowData,"flow-history":(h=k(t))==null?void 0:h.flowHistory,view:"","show-legend":""},null,8,["model-value","flow-history"])):B("",!0),l.value==="timeline"?(T(),E(W,{key:2},[n.value.length?(T(),$(_,{key:0},{default:b(()=>[(T(!0),E(W,null,X([...n.value].reverse(),V=>(T(),$(y,{key:V.id,timestamp:V.endTime,placement:"top"},{default:b(()=>[g(i,null,{default:b(()=>{var I,S,O;return[q("div",null,j(V.assigneeName)+" 开始处理 ["+j(V.taskNodeName)+"] 环节 ",1),V.duration?(T(),E("div",no," 办理时长："+j(V.duration),1)):B("",!0),V.type&&((I=V.comment)!=null&&I.handleComment)?(T(),E("div",so,j((S=o(V.type))==null?void 0:S.label)+"意见："+j((O=V.comment)==null?void 0:O.handleComment),1)):B("",!0)]}),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:1})):(T(),$(u,{key:1}))],64)):B("",!0)])],64)}}});const uo=Te(ro,[["__scopeId","data-v-f55ecc9f"]]),nt=Symbol("flowPagesConfig"),io={FlowDesign:{},FormDesign:{},FlowForm:We,tabs:[{label:"审批表单",prop:"formTab",component:lo},{label:"附件资料",prop:"fileTab",component:oo},{label:"流程跟踪",prop:"trackTab",component:uo}],request:()=>{},upload:{props:{fileName:"fileOriginalName",fileType:"fileType",fileSize:"fileSize",fileUrl:"fileUrl",res:"res.data"}}};var Vt=(e=>(e[e.否=0]="否",e[e.是=1]="是",e))(Vt||{});const Ae=le(Vt);function z(e,t){return e&&t?(e.provide(nt,nl(io,t)),t):Me(nt)}function co(){const{request:e}=z(),t={list:"/sapier-flow/flow-user-common/list",save:"/sapier-flow/flow-user-common/save",update:"/sapier-flow/flow-user-common/update",remove:"/sapier-flow/flow-user-common/remove",batchUpdate:"/sapier-flow/flow-user-common/batchUpdate"},l=r=>e.get(t.list,{params:{type:r,ascs:"sort"}});return{url:t,getList:l,useList:r=>ie(()=>l(r.value).then(c=>c.data.records),{refreshDeps:[r]}),create:r=>e.post(t.save,r),update:r=>e.post(t.update,r),remove:r=>e.post(t.remove,{},{params:{ids:r}}),batchUpdate:r=>e.post(t.batchUpdate,r)}}var Dt=(e=>(e.默认="default",e.主要="primary",e.成功="success",e.警告="warning",e.危险="danger",e.信息="info",e.文字="text",e))(Dt||{}),Ye=(e=>(e.显示="true",e.隐藏="false",e.发起人="startUser",e.处理人="assignee",e.已办="done",e.待办="todo",e.未发起="notstarted",e.已发起="started",e.未办结="unfinished",e.已办结="finished",e))(Ye||{}),Ge=(e=>(e.不显示="false",e.指定节点="specifyNode",e.审批人="assignee",e.传阅人="circulate",e.意见="comment",e))(Ge||{}),Tt=(e=>(e[e.禁用=0]="禁用",e[e.正常=1]="正常",e))(Tt||{});function qe(){const{request:e}=z(),t={list:"/sapier-flow/dev-button/list",save:"/sapier-flow/dev-button/save",update:"/sapier-flow/dev-button/update",remove:"/sapier-flow/dev-button/remove"},l=o=>e.get(t.list,{params:o});return{url:t,getList:l,useList:()=>ie(()=>l({size:-1,ascs:"sort"}).then(o=>o.data.records)),create:o=>e.post(t.save,o),update:o=>e.post(t.update,o),remove:o=>e.post(t.remove,{},{params:{ids:o}})}}function po(){const{request:e}=z(),t={list:"/sapier-flow/flow-category/list",save:"/sapier-flow/flow-category/save",update:"/sapier-flow/flow-category/update",remove:"/sapier-flow/flow-category/remove",tree:"/sapier-flow/flow-category/tree"};return{getList:o=>e.get(t.list,{params:o}),getTree:o=>e.get(t.tree,{params:o}),create:o=>e.post(t.save,o),update:o=>e.post(t.update,o),remove:o=>e.post(t.remove,{},{params:{ids:o}})}}function Nt(){const{request:e}=z(),t={list:"/sapier-flow/flow-circulate/userTaskList",opslist:"/sapier-flow/flow-circulate-ops/list",update:"/sapier-flow/flow-circulate-ops/update",remove:"/sapier-flow/flow-circulate-ops/remove"};return{url:t,getCirculateList:d=>e.get(t.list,{params:d}),getCirculateOpsList:d=>e.get(t.list,{params:d}),updateCirculate:d=>e.post(t.update,d),removeCirculate:d=>e.post(t.remove,{},{params:{ids:d}})}}function Qe(){const{request:e}=z(),t={list:"/sapier-flow/flow-definition/list",save:"/sapier-flow/flow-definition/save",update:"/sapier-flow/flow-definition/update",remove:"/sapier-flow/flow-definition/remove",detail:"/sapier-flow/flow-definition/detail",deploy:"/sapier-flow/flow-definition/deployFlow"};return{url:t,getList:r=>e.get(t.list,{params:r}),create:r=>e.post(t.save,r),update:r=>e.post(t.update,r),remove:r=>e.post(t.remove,{},{params:{ids:r}}),deploy:r=>e.post(t.deploy,r),getDetail:r=>e.get(t.detail,{params:r})}}var xt=(e=>(e[e.否=0]="否",e[e.是=1]="是",e))(xt||{});function Je(){const{request:e}=z(),t={list:"/sapier-flow/flow-deploy/list",update:"/sapier-flow/flow-deploy/update",remove:"/sapier-flow/flow-deploy/remove",detail:"/sapier-flow/flow-deploy/detail"};return{url:t,getList:d=>e.get(t.list,{params:d}),getDetail:d=>e.get(t.detail,{params:d}),update:d=>e.post(t.update,d),remove:d=>e.post(t.remove,{},{params:{ids:d}})}}function fo(){const{request:e}=z(),t={list:"/sapier-flow/flow-file/list",save:"/sapier-flow/flow-file/save",remove:"/sapier-flow/flow-file/remove"};return{getList:a=>e.get(t.list,{params:a}),create:a=>e.post(t.save,a),remove:a=>e.post(t.remove,{},{params:{ids:a}})}}function mo(){const{request:e}=z(),t={list:"/sapier-flow/flow-ops/list"};return{url:t,getTaskOpsList:p=>e.get(t.list,{params:p})}}function me(){const{request:e}=z(),t={list:"/sapier-flow/flow-param/list",save:"/sapier-flow/flow-param/save",update:"/sapier-flow/flow-param/update",remove:"/sapier-flow/flow-param/remove",all:"/sapier-flow/flow-param/getAllParam",key:"/sapier-flow/flow-param/getParam"},l=c=>e.get(t.list,{params:c}),p=()=>e.get(t.all),n=c=>e.get(t.key,{params:{paramKey:c}});return{url:t,getList:l,getAllParam:p,getParam:n,useParam:c=>ie(()=>n(c).then(w=>w.data)),create:c=>e.post(t.save,c),update:c=>e.post(t.update,c),remove:c=>e.post(t.remove,{},{params:{ids:c}})}}function It(){const{request:e}=z(),t={list:"/sapier-flow/dev-flow/list",save:"/sapier-flow/dev-flow/save",update:"/sapier-flow/dev-flow/update",remove:"/sapier-flow/dev-flow/remove"},l=o=>e.get(t.list,{params:o});return{url:t,getList:l,useList:()=>ie(()=>l({size:-1}).then(o=>o.data.records)),create:o=>e.post(t.save,o),update:o=>e.post(t.update,o),remove:o=>e.post(t.remove,{},{params:{ids:o}})}}function vo(){const{request:e}=z(),t={tree:"/sapier-flow/flow-user/tree"},l=n=>e.get(t.tree,{params:{filter:n}});return{url:t,getUserTree:l,useUserTree:()=>ie(()=>l().then(n=>n.data))}}function Lt(){const{request:e}=z(),t={list:"/sapier-flow/dev-form/list",save:"/sapier-flow/dev-form/save",update:"/sapier-flow/dev-form/update",remove:"/sapier-flow/dev-form/remove"},l=o=>e.get(t.list,{params:o});return{url:t,getList:l,useList:()=>ie(()=>l({size:-1}).then(o=>o.data.records)),create:o=>e.post(t.save,o),update:o=>e.post(t.update,o),remove:o=>e.post(t.remove,{},{params:{ids:o}})}}var Ot=(e=>(e.ASSIGN_ID="ASSIGN_ID",e.ASSIGN_UUID="ASSIGN_UUID",e.AUTO="AUTO",e.INPUT="INPUT",e.NONE="NONE",e))(Ot||{}),$t=(e=>(e.bigint="bigint",e.blob="blob",e.char="char",e.date="date",e.datetime="datetime",e.decimal="decimal",e.double="double",e.enum="enum",e.float="float",e.int="int",e.longblob="longblob",e.longtext="longtext",e.mediumblob="mediumblob",e.mediumint="mediumint",e.mediumtext="mediumtext",e.set="set",e.smallint="smallint",e.text="text",e.time="time",e.timestamp="timestamp",e.tinyblob="tinyblob",e.tinyint="tinyint",e.tinytext="tinytext",e.varbinary="varbinary",e.varchar="varchar",e.year="year",e))($t||{});function Ke(){const{request:e}=z(),t={list:"/sapier-flow/dev-table/list",save:"/sapier-flow/dev-table/save",update:"/sapier-flow/dev-table/update",remove:"/sapier-flow/dev-table/remove",deploy:"/sapier-flow/dev-table/deploy",getFields:"/sapier-flow/dev-table/getTableFields"},l=c=>e.get(t.list,{params:c});return{url:t,getList:l,useList:()=>ie(()=>l({size:-1}).then(c=>c.data.records)),create:c=>e.post(t.save,c),update:c=>e.post(t.update,c),remove:c=>e.post(t.remove,{},{params:{ids:c}}),deploy:c=>e.post(t.deploy,c),getFields:c=>e.get(t.getFields,{params:c})}}const _o={rowKey:"id",align:"center",index:!0,border:!0,stripe:!0,searchMenuSpan:6,labelWidth:150,span:24,column:[{label:"按钮名称",prop:"name",search:!0},{label:"按钮标识",prop:"buttonKey",search:!0},{label:"按钮图标",prop:"icon",component:"icon-select"},{label:"按钮类型",prop:"buttonType",type:"select",dicData:le(Dt)},{label:"默认显示条件",prop:"display",type:"select",multiple:!0,dataType:"string",value:"false",dicData:le(Ye),tip:"选择多个时,所有条件都满足才显示",labelTip:`显示: 始终显示;<br/>隐藏: 始终隐藏;<br/>
      发起人: 用户为发起人时显示;<br/>处理人: 用户为处理人时显示;<br/>
      已办: 任务状态为已办时显示;<br/>待办: 任务状态为待办时显示;<br/>
      未发起: 流程未发起时显示;<br/>已发起: 流程已发起时显示;<br/>
      未办结: 流程未办结时显示;<br/>已办结: 流程已办结时显示;`},{label:"默认审批窗口显示",prop:"approval",type:"select",multiple:!0,dataType:"string",value:"false",dicData:le(Ge),labelTip:`不显示: 不显示审批窗口;<br/>指定节点: 显示指定节点选择框(常用于绿色通道等);<br/>
      审批人: 显示审批人选择框;<br/>传阅人: 显示传阅人选择框;<br/>意见: 显示意见输入框;`},{label:"排序",prop:"sort",type:"number",value:0},{label:"状态",prop:"status",type:"switch",value:1,dicData:le(Tt)},{label:"按钮预览",prop:"buttonPreview",width:150}]},bo=A({__name:"index",setup(e){const{bindVal:t,crudStateRefs:{formData:l},getDataList:p}=Z({tableOption:_o,crudOption:qe(),sortOption:{ascs:"sort"}});return p(),(n,a)=>{const d=C("el-button"),o=C("avue-crud");return T(),$(o,oe(ae(k(t))),{icon:b(({row:r})=>[g(k(se),{icon:r.icon,style:{display:"inline"}},null,8,["icon"])]),buttonPreview:b(({row:r})=>[g(d,{type:r.buttonType},{default:b(()=>[g(k(se),{icon:r.icon},null,8,["icon"]),R(" "+j(r.name),1)]),_:2},1032,["type"])]),"buttonPreview-form":b(()=>[g(d,{type:k(l).buttonType},{default:b(()=>[g(k(se),{icon:k(l).icon},null,8,["icon"]),R(" "+j(k(l).name),1)]),_:1},8,["type"])]),_:1},16)}}}),Xe={menuBtn:!1,span:24,column:[{label:"流程名称",prop:"flowName",rules:[{required:!0,message:"请输入流程名称"}]},{label:"流程标识",prop:"flowKey",rules:[{required:!0,message:"请输入流程标识"}]},{label:"流程分类",prop:"categoryId",type:"select",dicUrl:"/sapier-flow/flow-category/list",props:{label:"name",value:"id"}},{label:"流程图标",prop:"flowIcon",component:"icon-select"},{label:"流程描述",prop:"remarks"},{label:"自定义表单",prop:"formPath"},{label:"关联表",prop:"formDataTable",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicUrl:"/sapier-flow/dev-table/list",dicQuery:{size:-1},props:{label:"tableComment",value:"tableName",desc:"tableName",res:"data.records"}},{label:"表单设计",prop:"formOption",display:!1,hide:!0},{label:"模型设计",prop:"flowData",display:!1,hide:!0}]},wo={rowKey:"flowModuleId",align:"center",index:!0,border:!0,stripe:!0,searchMenuSpan:6,tabs:!0,dialogFullscreen:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuWidth:100,menuType:"menu",menuBtnTitle:"操作",column:[...Xe.column.map((e,t)=>({...e,search:t<2})),{label:"流程主版本",prop:"mainVersion",formatter(e,t){return t?`V${t||""}`:""}}]},St=A({__name:"index",props:{categoryId:{}},emits:["add","view","edit","version"],setup(e,{emit:t}){const l=e,{getList:p,deploy:n,remove:a}=Qe(),{bindVal:d,crudStateRefs:{searchForm:o},getDataList:r}=Z({tableOption:wo,crudOption:{getList:p,remove:a},searchForm:{categoryId:l.categoryId}});J(()=>{o.value.categoryId=l.categoryId??"",r()});const c=L(!1);async function w(f){await de.confirm("发布新版本，是否确认？","提示",{type:"success"}),c.value=!0,n({flowModuleId:f.flowModuleId}).then(()=>{G.success("发布成功"),r()}).finally(()=>{c.value=!1})}async function s(f){if(console.log("🚀 ~ file: index.vue:49 ~ handleDel ~ row:",f),f.mainVersion)return G.warning("请先删除已发布的流程");await de.confirm("确认删除？","提示",{type:"warning"}),await a(f.flowModuleId),G.success("删除成功"),r()}return(f,i)=>{const y=C("el-button"),_=C("el-dropdown-item"),u=C("avue-crud");return T(),$(u,oe(ae(k(d))),{"menu-left":b(()=>[g(y,{type:"primary",icon:"el-icon-plus",onClick:i[0]||(i[0]=m=>t("add"))},{default:b(()=>[R(" 新增 ")]),_:1})]),"menu-btn":b(({row:m})=>[g(_,{icon:"el-icon-view",onClick:v=>t("view",m)},{default:b(()=>[R(" 查看 ")]),_:2},1032,["onClick"]),g(_,{icon:"el-icon-edit",onClick:v=>t("edit",m)},{default:b(()=>[R(" 编辑 ")]),_:2},1032,["onClick"]),g(_,{icon:"el-icon-delete",onClick:v=>s(m)},{default:b(()=>[R(" 删除 ")]),_:2},1032,["onClick"]),g(_,{icon:"el-icon-upload",onClick:v=>w(m)},{default:b(()=>[R(" 发布 ")]),_:2},1032,["onClick"]),g(_,{icon:"el-icon-switch",onClick:v=>t("version",m)},{default:b(()=>[R(" 版本管理 ")]),_:2},1032,["onClick"])]),flowIcon:b(({row:m})=>[g(k(se),{icon:m.flowIcon,width:"25",style:{display:"inline"}},null,8,["icon"])]),_:1},16)}}}),yo={rowKey:"flowDeloyId",align:"center",index:!0,border:!0,stripe:!0,searchMenuSpan:6,tabs:!0,dialogFullscreen:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuWidth:100,menuType:"menu",menuBtnTitle:"操作",column:[...Xe.column,{label:"流程版本",prop:"version",formatter(e,t){return t?`V${t||""}`:""}},{label:"是否主版本",prop:"mainVersion",type:"select",dicData:[{label:"否",value:0},{label:"是",value:1}]}]},Ft=A({__name:"index",props:{flowModuleId:{}},emits:["back","view","edit"],setup(e,{emit:t}){const l=e,{getList:p,update:n,remove:a}=Je(),{bindVal:d,crudStateRefs:{searchForm:o},getDataList:r}=Z({tableOption:yo,crudOption:{getList:p,dataPath:"res.data"}});J(()=>{l.flowModuleId&&(o.value.flowModuleId=l.flowModuleId,r())});const c=L(!1);async function w(f){await de.confirm(`确定将 ${f.flowName}(${f.flowKey}:v${f.version}) 设为主版本?`,"提示",{type:"warning"}),c.value=!0,n({flowDeployId:f.flowDeployId,flowModuleId:f.flowModuleId,mainVersion:1}).then(()=>{G.success("设置成功"),r()}).finally(()=>{c.value=!1})}async function s(f){const{value:i}=await de.prompt("请输入确认删除的流程标识","提示",{type:"warning"});i===f.flowKey&&(await a(f.flowDeployId),G.success("删除成功"),r())}return(f,i)=>{const y=C("el-button"),_=C("el-dropdown-item"),u=C("avue-crud");return T(),$(u,oe(ae(k(d))),{"menu-left":b(()=>[g(y,{loading:c.value,type:"primary",icon:"el-icon-arrow-left",onClick:i[0]||(i[0]=m=>t("back"))},{default:b(()=>[R(" 返回 ")]),_:1},8,["loading"])]),"menu-btn":b(({row:m})=>[g(_,{icon:"el-icon-view",onClick:v=>t("view",m)},{default:b(()=>[R(" 查看 ")]),_:2},1032,["onClick"]),g(_,{icon:"el-icon-edit",onClick:v=>t("edit",m)},{default:b(()=>[R(" 编辑 ")]),_:2},1032,["onClick"]),g(_,{icon:"el-icon-delete",onClick:v=>s(m)},{default:b(()=>[R(" 删除 ")]),_:2},1032,["onClick"]),g(_,{icon:"el-icon-switch",disabled:m.mainVersion===k(xt).是,onClick:v=>w(m)},{default:b(()=>[R(" 设为主版本 ")]),_:2},1032,["disabled","onClick"])]),flowIcon:b(({row:m})=>[g(k(se),{icon:m.flowIcon,width:"25",style:{display:"inline"}},null,8,["icon"])]),_:1},16)}}}),st={defaultExpandAll:!0,props:{label:"name",value:"id"},filter:!0,formOption:{column:[{label:"分类名称",prop:"name",rules:[{required:!0,message:"请输入分类名称"}]},{label:"描述",prop:"remark"}]}},go=A({__name:"index",emits:["node-click"],setup(e,{emit:t}){const{crudStateRefs:{formData:l,tableData:p},getDataList:n,handleSave:a,handleUpdate:d,handleDel:o}=Z({crudOption:{rowKey:"id",...po(),dataPath:"res.data"},tableOption:st,pageOption:{pageSize:20}});n();function r(s,f,i,y){a(f,i,y)}function c(s,f,i,y){d(f,NaN,i,y)}async function w(s,f){await o(s.data,NaN),f()}return(s,f)=>{const i=C("avue-tree");return T(),$(i,{modelValue:k(l),"onUpdate:modelValue":f[0]||(f[0]=y=>ee(l)?l.value=y:null),option:k(st),data:k(p),onNodeClick:f[1]||(f[1]=y=>t("node-click",y)),onSave:r,onUpdate:c,onDel:w},null,8,["modelValue","option","data"])}}}),Ze=A({__name:"index",props:{modelValue:{},view:{type:Boolean},fields:{}},emits:["update:modelValue"],setup(e,{emit:t}){var r;const l=e,{FormDesign:p}=z(),n=P({get(){return l.modelValue?mt(l.modelValue):{menuBtn:!1,span:24}},set(c){t("update:modelValue",el(c,{useJson5:!1}))}}),a=P(()=>l.fields?JSON.parse(l.fields):[]),d=P(()=>{const c={type:"select",dicData:a.value,filterable:!0,allowCreate:!0,defaultFirstOption:!0};return[{...c,props:{label:"name",value:"name",desc:"comment"}},{...c,props:{label:"comment",value:"comment",desc:"name"}}]}),o={form:{settings:Array.from({length:((r=tl.settings)==null?void 0:r.length)??0}).fill({}).concat({label:"样式类",prop:"class"})}};return(c,w)=>{const s=C("avue-form");return c.view?(T(),$(s,{key:0,class:Gt(n.value.class),"model-value":{},option:n.value},null,8,["class","option"])):(T(),$(k(p),{key:1,modelValue:n.value,"onUpdate:modelValue":w[0]||(w[0]=f=>n.value=f),"base-option":d.value,resources:o},null,8,["modelValue","base-option"]))}}}),ho=q("span",null,"流程设计",-1),ko={key:0},Co={key:1},Vo={style:{height:"calc(100vh - 144px)"}},Do=A({__name:"index",props:{modelValue:{},visible:{type:Boolean}},emits:["close"],setup(e,{emit:t}){const p=fe(e),{visible:n,modelValue:a}=p,{create:d,deploy:o,getDetail:r,update:c}=Qe(),{getDetail:w,update:s}=Je(),f=["流程信息","表单设计","模型设计","完成"],i=L(!1);pe(n,async F=>{if(!F)return;const{flowModuleId:D}=a.value,{flowDeployId:N}=a.value;try{i.value=!0;let x={};N?x=await w({flowDeployId:N}):D&&(x=await r({flowModuleId:D})),a.value=x.data}finally{i.value=!1}},{immediate:!0});const{data:y}=Lt().useList(),{data:_}=It().useList(),{data:u}=Ke().useList(),m=P(()=>{var F,D;return(D=(F=u.value)==null?void 0:F.find(N=>N.tableName===a.value.formDataTable))==null?void 0:D.tableFields}),v=L(0),h=P(()=>{var F,D;return v.value===1?((F=y.value)==null?void 0:F.map(N=>({label:N.formName,value:N.formOption})))??[]:v.value===2?((D=_.value)==null?void 0:D.map(N=>({label:N.flowName,value:N.flowData})))??[]:[]});function V(F){v.value===1?a.value.formOption=F.value:v.value===2&&(a.value.flowData=F.value)}const I=L();async function S(F){v.value===0&&await ze(I),i.value=!0;const{flowModuleId:D}=a.value,{flowDeployId:N}=a.value;try{N?await s(a.value):D?await c(a.value):await d(a.value).then(x=>{a.value.flowModuleId=x.data.flowModuleId}),G.success("保存成功")}finally{i.value=!1}typeof F=="number"?v.value=F:v.value++}async function O(){await de.confirm("发布新版本，是否确认？","提示"),i.value=!0,o({flowModuleId:a.value.flowModuleId}).then(()=>{G.success("发布成功")}).finally(()=>{i.value=!1})}function U(){n.value=!1,v.value=0,a.value={},t("close")}return(F,D)=>{const N=C("el-link"),x=C("el-dropdown-item"),K=C("el-scrollbar"),H=C("el-dropdown-menu"),Q=C("el-dropdown"),M=C("el-col"),ye=C("el-step"),Ie=C("el-steps"),re=C("el-button"),Le=C("el-row"),Ut=C("avue-form"),Rt=C("el-result"),Pt=C("el-dialog"),Et=ct("loading");return T(),$(Pt,{modelValue:k(n),"onUpdate:modelValue":D[5]||(D[5]=Y=>ee(n)?n.value=Y:null),fullscreen:"","show-close":!1,"destroy-on-close":"",onClose:U},{header:b(()=>[g(Le,{justify:"center"},{default:b(()=>[g(M,{span:5},{default:b(()=>{var Y,ve,Oe,et;return[q("div",null,[ho,(Y=k(a))!=null&&Y.flowName?(T(),E("span",ko," - "+j((ve=k(a))==null?void 0:ve.flowName),1)):B("",!0),(Oe=k(a))!=null&&Oe.version?(T(),E("span",Co," - V"+j((et=k(a))==null?void 0:et.version),1)):B("",!0)]),h.value.length?(T(),$(Q,{key:0},{dropdown:b(()=>[g(H,null,{default:b(()=>[g(K,{"max-height":"400px"},{default:b(()=>[(T(!0),E(W,null,X(h.value,$e=>(T(),$(x,{key:$e.label,onClick:Qo=>V($e)},{default:b(()=>[R(j($e.label),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),default:b(()=>[g(N,{icon:"el-icon-arrow-down",underline:!1},{default:b(()=>[R(" 选择模板 ")]),_:1})]),_:1})):B("",!0)]}),_:1}),g(M,{span:14},{default:b(()=>[g(Ie,{active:v.value,simple:"","process-status":"finish","finish-status":"success"},{default:b(()=>[(T(),E(W,null,X(f,(Y,ve)=>g(ye,{key:ve,title:Y,onClick:Oe=>S(ve)},null,8,["title","onClick"])),64))]),_:1},8,["active"])]),_:1}),g(M,{span:5,style:{"text-align":"right"}},{default:b(()=>[g(re,{disabled:v.value===0,loading:i.value,type:"primary",onClick:D[0]||(D[0]=Y=>v.value--)},{default:b(()=>[R(" 上一步 ")]),_:1},8,["disabled","loading"]),g(re,{disabled:v.value===f.length-1,type:"primary",loading:i.value,onClick:D[1]||(D[1]=Y=>S())},{default:b(()=>[R(" 下一步 ")]),_:1},8,["disabled","loading"]),g(re,{onClick:U},{default:b(()=>[R(" 关闭 ")]),_:1})]),_:1})]),_:1})]),default:b(()=>[dt((T(),E("div",Vo,[v.value===0?(T(),$(Ut,{key:0,ref_key:"formRef",ref:I,modelValue:k(a),"onUpdate:modelValue":D[2]||(D[2]=Y=>ee(a)?a.value=Y:null),option:k(Xe),style:{width:"50%",magin:"0 auto"}},null,8,["modelValue","option"])):B("",!0),v.value===1?(T(),$(Ze,{key:1,modelValue:k(a).formOption,"onUpdate:modelValue":D[3]||(D[3]=Y=>k(a).formOption=Y),fields:m.value},null,8,["modelValue","fields"])):B("",!0),v.value===2?(T(),$(we,{key:2,modelValue:k(a).flowData,"onUpdate:modelValue":D[4]||(D[4]=Y=>k(a).flowData=Y),"flow-form-option":k(a).formOption},null,8,["modelValue","flow-form-option"])):B("",!0),v.value===3?(T(),$(Rt,{key:3,icon:"success",title:"流程设计完成"},{extra:b(()=>[k(a).flowDeployId?B("",!0):(T(),$(re,{key:0,type:"primary",onClick:O},{default:b(()=>[R(" 发布 ")]),_:1})),g(re,{onClick:U},{default:b(()=>[R(" 关闭 ")]),_:1})]),_:1})):B("",!0)])),[[Et,i.value]])]),_:1},8,["modelValue"])}}}),To=q("span",null,"流程查看",-1),No={key:0},xo={key:1},Io=A({__name:"index",props:{modelValue:{},visible:{type:Boolean}},setup(e){const l=fe(e),{visible:p,modelValue:n}=l,{getDetail:a}=Qe(),{getDetail:d}=Je(),o=L("form"),r=L(!1);pe(p,async w=>{if(!w)return;const{flowModuleId:s}=n.value,{flowDeployId:f}=n.value;try{r.value=!0;let i={};f?i=await d({flowDeployId:f}):s&&(i=await a({flowModuleId:s})),n.value={...i.data}}finally{r.value=!1}},{immediate:!0});function c(){n.value={},o.value="form"}return(w,s)=>{const f=C("el-tab-pane"),i=C("el-tabs"),y=C("el-dialog"),_=ct("loading");return T(),$(y,{modelValue:k(p),"onUpdate:modelValue":s[3]||(s[3]=u=>ee(p)?p.value=u:null),width:"60%",top:"0",onClose:c},{header:b(()=>{var u,m,v,h;return[To,(u=k(n))!=null&&u.flowName?(T(),E("span",No," - "+j((m=k(n))==null?void 0:m.flowName),1)):B("",!0),(v=k(n))!=null&&v.version?(T(),E("span",xo," - V"+j((h=k(n))==null?void 0:h.version),1)):B("",!0)]}),default:b(()=>[dt((T(),$(i,{modelValue:o.value,"onUpdate:modelValue":s[2]||(s[2]=u=>o.value=u)},{default:b(()=>[g(f,{label:"查看表单",name:"form",style:{height:"600px","overflow-y":"auto"}},{default:b(()=>[o.value==="form"&&k(n).formOption?(T(),$(Ze,{key:0,modelValue:k(n).formOption,"onUpdate:modelValue":s[0]||(s[0]=u=>k(n).formOption=u),view:""},null,8,["modelValue"])):B("",!0)]),_:1}),g(f,{label:"查看流程",name:"flow",style:{height:"600px"}},{default:b(()=>[o.value==="flow"?(T(),$(we,{key:0,modelValue:k(n).flowData,"onUpdate:modelValue":s[1]||(s[1]=u=>k(n).flowData=u),view:""},null,8,["modelValue"])):B("",!0)]),_:1})]),_:1},8,["modelValue"])),[[_,r.value]])]),_:1},8,["modelValue"])}}}),Lo=A({__name:"index",setup(e){const t=L("definition"),l=L({}),p=L(""),n=L("");function a(y){p.value===y.id?p.value="":p.value=y.id}const d=L(!1),o=L(!1);function r(){l.value={},d.value=!0}function c(y){l.value=y,d.value=!0}function w(y){l.value=y,o.value=!0}function s(y){n.value=y.flowModuleId||"",t.value="deploy"}function f(){n.value="",t.value="definition"}async function i(){const y=t.value;await _e(),t.value="",await _e(),t.value=`${y}`}return(y,_)=>{const u=C("el-col"),m=C("el-row");return T(),$(m,{gutter:20},{default:b(()=>[g(u,{span:4},{default:b(()=>[g(go,{onNodeClick:a})]),_:1}),g(u,{span:20},{default:b(()=>[t.value==="definition"?(T(),$(St,{key:0,"category-id":p.value,onAdd:r,onEdit:c,onView:w,onVersion:s},null,8,["category-id"])):B("",!0),t.value==="deploy"?(T(),$(Ft,{key:1,"flow-module-id":n.value,onEdit:c,onView:w,onBack:f},null,8,["flow-module-id"])):B("",!0),g(Do,{modelValue:l.value,"onUpdate:modelValue":_[0]||(_[0]=v=>l.value=v),visible:d.value,"onUpdate:visible":_[1]||(_[1]=v=>d.value=v),onClose:i},null,8,["modelValue","visible"]),g(Io,{modelValue:l.value,"onUpdate:modelValue":_[2]||(_[2]=v=>l.value=v),visible:o.value,"onUpdate:visible":_[3]||(_[3]=v=>o.value=v)},null,8,["modelValue","visible"])]),_:1})]),_:1})}}}),Oo=[{label:"流程名称",prop:"flowName"},{label:"流程标识",prop:"flowKey"},{label:"流程分类",prop:"categoryId",type:"select",search:!0,dicUrl:"/sapier-flow/flow-category/list",props:{label:"name",value:"id"}},{label:"标题",prop:"processTitle",search:!0},{label:"流水号",prop:"serialNumber"},{label:"当前节点",prop:"taskNodeName"},{label:"审批人",prop:"assigneeName"},{label:"申请人",prop:"applyUserName"},{label:"接收时间",prop:"startTime"},{label:"任务状态",prop:"status",type:"select",search:!0,searchValue:2,dicUrl:"/sapier-flow/flow-param/getParam",dicQuery:{paramKey:"flow.task.status"}}].map(e=>({...e,display:!1})),$o=[{label:"审批人",prop:"assignee"},{label:"节点名称",prop:"taskNodeName"},{label:"接收时间",prop:"startTime",type:"datetime",format:"YYYY-MM-DD HH:mm:ss",valueFormat:"YYYY-MM-DD HH:mm:ss"},{label:"结束时间",prop:"endTime",type:"datetime",format:"YYYY-MM-DD HH:mm:ss",valueFormat:"YYYY-MM-DD HH:mm:ss"},{label:"耗时",prop:"duration"},{label:"传阅意见",prop:"comment"}].map(e=>({...e,hide:!0})),So={rowKey:"id",align:"center",index:!0,border:!0,stripe:!0,searchMenuSpan:6,menu:!0,addBtn:!1,column:[...Oo,...$o]},Fo=A({__name:"index",setup(e){const t=ol("debugMode",!1),{getTaskOpsList:l}=mo(),{getCirculateOpsList:p,updateCirculate:n,removeCirculate:a}=Nt(),{bindVal:d,getDataList:o,crudStateRefs:{searchForm:r,crudOption:c}}=Z({tableOption:So,crudOption:{getList:l},searchForm:{status:2},sortOption:{descs:"start_time"}});Ne(r,o,{debounce:300,immediate:!0,deep:!0});const w=L("task"),s=[{label:"任务",name:"task",getList:l},{label:"传阅",name:"circulate",getList:p,update:n,remove:a}];function f({paneName:u}){const m=s.find(v=>v.name===u);c.value.getList=m.getList,c.value.update=m.update,c.value.remove=m.remove,o()}const{open:i,close:y}=Ct({onComplete:()=>(y(),o())},{type:"drawer"});function _(u){i({flowKey:u.flowKey,taskId:u.taskId,instanceId:u.flowInstanceId,debug:t.value,circulateId:u.id})}return(u,m)=>{const v=C("el-tab-pane"),h=C("el-tabs"),V=C("el-switch"),I=C("el-button"),S=C("el-link"),O=C("avue-crud");return T(),E(W,null,[g(h,{modelValue:w.value,"onUpdate:modelValue":m[0]||(m[0]=U=>w.value=U),onTabClick:f},{default:b(()=>[(T(),E(W,null,X(s,U=>g(v,{key:U.name,label:U.label,name:U.name},null,8,["label","name"])),64))]),_:1},8,["modelValue"]),g(O,qt(k(d),{permission:{menu:w.value==="circulate"}}),{"menu-right":b(()=>[g(I,{type:"text"},{default:b(()=>[g(V,{modelValue:k(t),"onUpdate:modelValue":m[1]||(m[1]=U=>ee(t)?t.value=U:null),"inline-prompt":"","active-text":"debug","inactive-text":"debug"},null,8,["modelValue"])]),_:1})]),processTitle:b(({row:U})=>[g(S,{type:"primary",underline:!1,onClick:F=>_(U)},{default:b(()=>[R(j(U.processTitle||"无标题"),1)]),_:2},1032,["onClick"])]),_:1},16,["permission"])],64)}}}),Uo={rowKey:"id",align:"center",index:!0,border:!0,stripe:!0,searchMenuSpan:6,column:[{label:"配置名称",prop:"paramName",search:!0},{label:"配置Key",prop:"paramKey",search:!0},{label:"备注",prop:"remark"},{label:"系统内置",prop:"paramType",type:"switch",dicData:Ae},{label:"配置值",prop:"paramValue",type:"textarea",maxRows:20,span:24,overHidden:!0}]},Ro=A({__name:"index",setup(e){const{bindVal:t,getDataList:l}=Z({tableOption:Uo,crudOption:me()});return l(),(p,n)=>{const a=C("avue-crud");return T(),$(a,oe(ae(k(t))),null,16)}}}),Po={rowKey:"id",align:"center",index:!0,border:!0,stripe:!0,searchMenuSpan:6,menu:!1,addBtn:!1,column:[{label:"流程名称",prop:"flowName"},{label:"流程标识",prop:"flowKey"},{label:"流程分类",prop:"categoryId",type:"select",search:!0,dicUrl:"/sapier-flow/flow-category/list",props:{label:"name",value:"id"}},{label:"标题",prop:"processTitle",search:!0},{label:"流水号",prop:"serialNumber"},{label:"当前节点",prop:"taskNodeName"},{label:"审批人",prop:"assigneeName"},{label:"申请人",prop:"applyUserName"},{label:"接收时间",prop:"startTime"}]},Eo={class:"flow-list"},Ao=["onClick"],Ko={class:"flow-name"},Mo=A({__name:"index",setup(e){const t=L([]),{getPublishList:l,getTaskList:p}=xe(),{getCirculateList:n}=Nt();l().then(u=>{t.value=u.data});const a=[{label:"待办",value:2},{label:"已办",value:1}],{bindVal:d,getDataList:o,crudStateRefs:{searchForm:r,crudOption:c}}=Z({tableOption:Po,crudOption:{getList:p},searchForm:{status:2}});Ne(r,o,{debounce:300,immediate:!0,deep:!0});const w=L("task"),s=[{label:"任务",name:"task",getList:p},{label:"传阅",name:"circulate",getList:n}];function f({paneName:u}){const m=s.find(v=>v.name===u);c.value.getList=m.getList,o()}const{open:i,close:y}=Ct({onComplete:()=>(y(),o())},{type:"drawer"});function _(u){i({flowKey:u.flowKey,taskId:u.taskId,instanceId:u.flowInstanceId,circulateId:u.id,detail:u.taskId?u.status===ht.已办:!1})}return(u,m)=>{const v=C("el-button"),h=C("el-collapse-item"),V=C("el-collapse"),I=C("el-card"),S=C("el-divider"),O=C("el-tab-pane"),U=C("el-tabs"),F=C("avue-radio"),D=C("el-link"),N=C("avue-crud");return T(),E(W,null,[g(I,{"body-style":{padding:"0 20px"}},{default:b(()=>[g(V,{"model-value":"1"},{default:b(()=>[g(h,{name:"1"},{title:b(()=>[g(v,{text:"",icon:"el-icon-promotion"},{default:b(()=>[R(" 发起审批 ")]),_:1})]),default:b(()=>[q("div",Eo,[(T(!0),E(W,null,X(t.value,x=>(T(),E("div",{key:x.flowKey,class:"flow-item",onClick:K=>_(x)},[g(k(se),{class:"flow-icon",icon:x.flowIcon,width:"60"},null,8,["icon"]),q("div",Ko,j(x.flowName),1)],8,Ao))),128))])]),_:1})]),_:1})]),_:1}),g(S,{direction:"horizontal","content-position":"left"}),g(U,{modelValue:w.value,"onUpdate:modelValue":m[0]||(m[0]=x=>w.value=x),onTabClick:f},{default:b(()=>[(T(),E(W,null,X(s,x=>g(O,{key:x.name,label:x.label,name:x.name},null,8,["label","name"])),64))]),_:1},8,["modelValue"]),g(N,oe(ae(k(d))),{"menu-left":b(()=>[g(F,{modelValue:k(r).status,"onUpdate:modelValue":m[1]||(m[1]=x=>k(r).status=x),button:"",dic:a},null,8,["modelValue"])]),processTitle:b(({row:x})=>[g(D,{type:"primary",underline:!1,onClick:K=>_(x)},{default:b(()=>[R(j(x.processTitle||"无标题"),1)]),_:2},1032,["onClick"])]),_:1},16)],64)}}});const Bo=Te(Mo,[["__scopeId","data-v-e1f72e36"]]),jo={rowKey:"id",align:"center",index:!0,border:!0,stripe:!0,searchMenuSpan:6,span:24,column:[{label:"流程标识",prop:"flowKey",search:!0},{label:"流程名称",prop:"flowName",search:!0},{label:"流程备注",prop:"remarks"},{label:"排序",prop:"sort"}]},Ho=A({__name:"index",setup(e){const{bindVal:t,crudStateRefs:{formData:l},getDataList:p,handleUpdate:n}=Z({tableOption:jo,crudOption:It()});p();const a=L(!1);async function d(r){l.value=r,a.value=!0}async function o(){await n(l.value,NaN,()=>a.value=!1,()=>{})}return(r,c)=>{const w=C("el-button"),s=C("avue-crud"),f=C("el-dialog");return T(),E(W,null,[g(s,oe(ae(k(t))),{menu:b(({row:i})=>[g(w,{type:"primary",text:"",icon:"el-icon-crop",onClick:y=>d(i)},{default:b(()=>[R(" 设计 ")]),_:2},1032,["onClick"])]),_:1},16),g(f,{modelValue:a.value,"onUpdate:modelValue":c[2]||(c[2]=i=>a.value=i),title:`模型设计-${k(l).flowName}`,fullscreen:"","destroy-on-close":""},{footer:b(()=>[g(w,{type:"primary",onClick:o},{default:b(()=>[R(" 保存 ")]),_:1}),g(w,{onClick:c[1]||(c[1]=i=>a.value=!1)},{default:b(()=>[R(" 取消 ")]),_:1})]),default:b(()=>[g(we,{modelValue:k(l).flowData,"onUpdate:modelValue":c[0]||(c[0]=i=>k(l).flowData=i),style:{height:"calc(100vh - 177px)"}},null,8,["modelValue"])]),_:1},8,["modelValue","title"])],64)}}}),zo={rowKey:"id",align:"center",index:!0,border:!0,stripe:!0,searchMenuSpan:6,span:24,column:[{label:"表单标识",prop:"formKey",search:!0},{label:"表单名称",prop:"formName",search:!0},{label:"表单备注",prop:"remarks"},{label:"排序",prop:"sort",type:"number"}]},Wo=A({__name:"index",setup(e){const{bindVal:t,crudStateRefs:{formData:l},getDataList:p,handleUpdate:n}=Z({tableOption:zo,crudOption:Lt()});p();const a=L(!1);async function d(r){l.value={...r},a.value=!0}async function o(){await n(l.value,NaN,()=>a.value=!1,()=>{})}return(r,c)=>{const w=C("el-button"),s=C("avue-crud"),f=C("el-dialog");return T(),E(W,null,[g(s,oe(ae(k(t))),{menu:b(({row:i})=>[g(w,{type:"primary",text:"",icon:"el-icon-crop",onClick:y=>d(i)},{default:b(()=>[R(" 设计 ")]),_:2},1032,["onClick"])]),_:1},16),g(f,{modelValue:a.value,"onUpdate:modelValue":c[2]||(c[2]=i=>a.value=i),title:`表单设计-${k(l).formName}`,fullscreen:"","destroy-on-close":""},{footer:b(()=>[g(w,{type:"primary",onClick:o},{default:b(()=>[R(" 保存 ")]),_:1}),g(w,{onClick:c[1]||(c[1]=i=>a.value=!1)},{default:b(()=>[R(" 取消 ")]),_:1})]),default:b(()=>[g(Ze,{modelValue:k(l).formOption,"onUpdate:modelValue":c[0]||(c[0]=i=>k(l).formOption=i),style:{height:"calc(100vh - 177px)"}},null,8,["modelValue"])]),_:1},8,["modelValue","title"])],64)}}}),rt=[{label:"字段名称",prop:"name"},{label:"字段备注",prop:"comment"},{label:"字段类型",prop:"type",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:le($t)},{label:"字段长度",prop:"size",type:"number"},{label:"小数位",prop:"point",type:"number"},{label:"默认值",prop:"default"},{label:"是否主键",prop:"primary",type:"switch",dicData:Ae,value:0},{label:"是否允许为空",prop:"permitNull",type:"switch",dicData:Ae,value:1}],Yo={rowKey:"id",align:"center",index:!0,border:!0,stripe:!0,searchMenuSpan:6,span:24,dialogFullscreen:!0,column:[{label:"表名",prop:"tableName",search:!0},{label:"表注释",prop:"tableComment",search:!0},{label:"表引擎",prop:"tableEngine"},{label:"表主键策略",prop:"tablePrimary",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:le(Ot)},{label:"数据库字段",prop:"editFields",hide:!0,type:"dynamic",children:{column:rt}},{label:"默认字段",prop:"defaultFields",hide:!0,type:"dynamic",children:{addBtn:!1,delBtn:!1,column:rt}}]},Go=q("br",null,null,-1),qo=A({__name:"index",setup(e){const{bindVal:t,crudStateRefs:{formData:l,defaults:p},getDataList:n,afterOpen:a,beforeSubmit:d}=Z({crudOption:Ke(),tableOption:Yo});n();const{data:o}=me().useParam("table.default.fields");a(y=>{if(l.value.defaultFields=o.value??[],y==="edit"){const _=JSON.parse(l.value.tableFields);l.value.editFields=vt(_,o.value??[],"name")}}),d(y=>{const _=[...y.defaultFields,...y.editFields];y.tableFields=JSON.stringify(_)});const r=L(!1);J(()=>{var y;(y=p.value)!=null&&y.defaultFields&&(p.value.defaultFields.display=r.value)});const{deploy:c,getFields:w}=Ke(),s=L(!1);async function f(y){await de.confirm("部署将自动生成数据库表，是否确认？","提示",{type:"success"}),s.value=!0,c({id:y.id}).then(()=>{G.success("部署成功"),n()}).finally(()=>{s.value=!1})}function i(){w({tableName:l.value.tableName}).then(y=>{var _;if(!((_=y.data)!=null&&_.length))return G.warning("未找到该表");l.value.editFields=y.data})}return(y,_)=>{const u=C("el-button"),m=C("el-input"),v=C("el-switch"),h=C("el-tooltip"),V=C("avue-crud");return T(),$(V,oe(ae(k(t))),{menu:b(({row:I})=>[g(u,{type:"text",icon:"el-icon-upload",onClick:S=>f(I)},{default:b(()=>[R(" 部署 ")]),_:2},1032,["onClick"])]),"tableName-form":b(()=>[g(m,{modelValue:k(l).tableName,"onUpdate:modelValue":_[0]||(_[0]=I=>k(l).tableName=I),placeholder:"请输入 表名"},{append:b(()=>[g(u,{type:"primary",size:"default",onClick:i},{default:b(()=>[R(" 导入已有表 ")]),_:1})]),_:1},8,["modelValue"])]),"editFields-label":b(()=>[q("div",null,[R(" 数据库字段 "),Go,g(h,{content:"显示默认字段"},{default:b(()=>[g(v,{modelValue:r.value,"onUpdate:modelValue":_[1]||(_[1]=I=>r.value=I)},null,8,["modelValue"])]),_:1})])]),_:1},16)}}}),ma={install(e,t){e.component("FlowButton",bo).component("FlowDefinition",St).component("FlowDeploy",Ft).component("FlowForm",We).component("FlowManage",Lo).component("FlowOps",Fo).component("FlowParam",Ro).component("FlowTemplate",Ho).component("FormTemplate",Wo).component("TableTemplate",qo).component("FlowWorkbench",Bo),z(e,t)}};export{io as CONFIG_DEFAULT,nt as CONFIG_PROVIDE_KEY,bo as FlowButton,St as FlowDefinition,Ft as FlowDeploy,We as FlowForm,Lo as FlowManage,Fo as FlowOps,Ro as FlowParam,Ho as FlowTemplate,Bo as FlowWorkbench,Wo as FormTemplate,qo as TableTemplate,Vt as Whether,ma as default,to as resolveFlowFormComponent,z as useConfigProvider,Ct as useFlowForm,eo as useFlowFormOverlay,Zl as useFlowFormWindow,Ae as whetherDic};
