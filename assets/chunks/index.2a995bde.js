import{j as g,v as O,I as _,k as D,E as P,G as m,K as b,u as W,a as w,Z as j,Y as $,d as K}from"./framework.e6d5cdfe.js";import{a as q}from"./theme.71a909f8.js";function N(e,a){return a={exports:{}},e(a,a.exports),a.exports}var L=N(function(e){var a=e.exports=function(l,r){if(r||(r=16),l===void 0&&(l=128),l<=0)return"0";for(var n=Math.log(Math.pow(2,l))/Math.log(r),o=2;n===1/0;o*=2)n=Math.log(Math.pow(2,l/o))/Math.log(r)*o;for(var u=n-Math.floor(n),s="",o=0;o<Math.floor(n);o++){var t=Math.floor(Math.random()*r).toString(r);s=t+s}if(u){var p=Math.pow(r,u),t=Math.floor(Math.random()*p).toString(r);s=t+s}var f=parseInt(s,r);return f!==1/0&&f>=Math.pow(2,l)?a(l,r):s};a.rack=function(l,r,n){var o=function(s){var t=0;do{if(t++>10)if(n)l+=n;else throw new Error("too many ID collisions, use more bits");var p=a(l,r)}while(Object.hasOwnProperty.call(u,p));return u[p]=s,p},u=o.hats={};return o.get=function(s){return o.hats[s]},o.set=function(s,t){return o.hats[s]=t,o},o.bits=l||128,o.base=r||16,o}});function i(e){if(!(this instanceof i))return new i(e);e=e||[128,36,1],this._seed=e.length?L.rack(e[0],e[1],e[2]):e}i.prototype.next=function(e){return this._seed(e||!0)};i.prototype.nextPrefixed=function(e,a){var l;do l=e+this.next(!0);while(this.assigned(l));return this.claim(l,a),l};i.prototype.claim=function(e,a){this._seed.set(e,a||!0)};i.prototype.assigned=function(e){return this._seed.get(e)||!1};i.prototype.unclaim=function(e){delete this._seed.hats[e]};i.prototype.clear=function(){var e=this._seed.hats,a;for(a in e)this.unclaim(a)};var R=new i([32,32,1]);function v(){return R.next()}function re(){const e=`Process_${v()}`,a=`Event_${v()}`,l=`Flow_${v()}`,r=`Activity_${v()}`;return{processData:{type:"process",key:e,properties:{}},flowElementList:[{incoming:[],outgoing:[l],type:"startEvent",key:a,properties:{name:"开始",x:160,y:240,text:{x:160,y:280,value:"开始"}}},{incoming:[l],outgoing:[],type:"userTask",key:r,properties:{name:"发起人",x:290,y:240,text:{x:290,y:240,value:"发起人"}}},{incoming:[a],outgoing:[r],type:"sequenceFlow",key:l,properties:{name:"",text:"",startPoint:{x:178,y:240},endPoint:{x:240,y:240},pointsList:[{x:178,y:240},{x:240,y:240}]}}]}}const A=[{label:"",labelWidth:0,prop:"assignee",type:"dynamic",children:{rowKey:"type",addBtn:!0,column:[{label:"类型",prop:"type",type:"select",width:120,dicData:[{label:"用户",value:"user"},{label:"部门",value:"dept"},{label:"岗位",value:"post"},{label:"动态",value:"dynamic"},{label:"指定节点",value:"userTask"},{label:"自定义",value:"custom"}]},{label:"值",prop:"value"}]},value:[]}],c=[{label:"节点id",prop:"id",readonly:!0},{label:"节点名称",prop:"name"},{label:"节点描述",prop:"desc"}],C=g({__name:"flow-text",setup(e){return(a,l)=>O(a.$attrs.modelValue)}}),I=[{label:"",labelWidth:0,prop:"button",value:[],type:"dynamic",children:{addBtn:!1,delBtn:!1,column:[{prop:"_index",hide:!0},{label:"按钮名",prop:"name",width:100,component:C},{label:"按钮值",prop:"buttonKey",width:100,component:C},{label:"显示条件",prop:"display",type:"select",dataType:"string",multiple:!0},{label:"审批窗口",prop:"approval",type:"select",dataType:"string",multiple:!0}]}}],Y=[{label:"",labelWidth:0,prop:"circulate",type:"dynamic",children:{rowKey:"type",addBtn:!0,column:[{label:"类型",prop:"type",type:"select",width:120,dicData:[{label:"用户",value:"user"},{label:"部门",value:"dept"},{label:"岗位",value:"post"},{label:"动态",value:"dynamic"},{label:"指定节点",value:"userTask"},{label:"自定义",value:"custom"}]},{label:"值",prop:"value"}]},value:[]}],Z=g({__name:"flow-form-property",props:{modelValue:{}},setup(e){const a=e,{modelValue:l}=q(a),r={rowKey:"prop",menu:!1,defaultExpandAll:!0,addBtn:!1,refreshBtn:!1,columnBtn:!1,column:[{label:"字段",prop:"label"},{label:"属性",prop:"prop"},{label:"显示",prop:"display",width:40},{label:"禁用",prop:"disabled",width:40},{label:"详情",prop:"detail",width:40},{label:"只读",prop:"readonly",width:40},{label:"必填",prop:"required",width:40}]};return(n,o)=>{const u=_("el-checkbox"),s=_("avue-crud");return D(),P(s,{class:"hide-menu",data:W(l)||[],option:r},{display:m(({row:t})=>[b(u,{modelValue:t.display,"onUpdate:modelValue":p=>t.display=p},null,8,["modelValue","onUpdate:modelValue"])]),readonly:m(({row:t})=>[b(u,{modelValue:t.readonly,"onUpdate:modelValue":p=>t.readonly=p},null,8,["modelValue","onUpdate:modelValue"])]),disabled:m(({row:t})=>[b(u,{modelValue:t.disabled,"onUpdate:modelValue":p=>t.disabled=p},null,8,["modelValue","onUpdate:modelValue"])]),detail:m(({row:t})=>[b(u,{modelValue:t.detail,"onUpdate:modelValue":p=>t.detail=p},null,8,["modelValue","onUpdate:modelValue"])]),required:m(({row:t})=>[b(u,{modelValue:t.required,"onUpdate:modelValue":p=>t.required=p},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["data"])}}}),h=[{label:"",labelWidth:0,prop:"formProperty",component:Z,type:"dynamic",value:[]}],z=[{label:"网关类型",prop:"inout",type:"radio",button:!0,value:"in",dicData:[{label:"进",value:"in"},{label:"出",value:"out"}]},{label:"完成条件",prop:"completionCondition",type:"slider",showInput:!0,showInputControls:!1,labelPosition:"top",step:.01,max:1,value:0,labelTip:"任务完成的百分比，如2人接收，需同时完成才往下进行时=100%，只需1人完成时=50%",span:23,offset:1}],M=[{label:"多实例类型",prop:"multiInstanceType",tip:"选择后节点变更为多人任务",type:"select",dicData:[{label:"并行审批",value:"parallel",desc:"同时接收审批"},{label:"顺序审批",value:"sequential",desc:"按顺序审批"}]},{label:"完成条件",prop:"completionCondition",type:"slider",showInput:!0,showInputControls:!1,labelPosition:"top",step:.01,max:1,value:0,labelTip:"任务完成的百分比，如2人接收，需同时完成才往下进行时=100%，只需1人完成时=50%",span:23,offset:1},{label:"回收任务",prop:"isRecall",type:"switch",value:!1,labelTip:"满足完成条件时，该节点未审批任务是否回收，回收的任务仅保留记录，对应人员无需再办理"}],H=[{label:"节点id",prop:"id",readonly:!0},{label:"节点描述",prop:"name",type:"textarea"}],U=Symbol("flowDesignState");function pe(e){const a=q(e,void 0,{passive:!0}),{lf:l,modelValue:r,elementData:n,formOptions:o,formData:u,formOption:s,formDefaults:t,dataOptions:p}=a,f=w(!1),F=w(!1);function S(G){var k,T,V;const y=(k=n.value)==null?void 0:k.id;y&&((T=l.value)==null||T.setProperties(y,G)),y&&((V=l.value)==null||V.updateText(y,G.name))}const E=w(),x={lf:l,graphData:r,elementData:n,formRef:E,formData:u,formDefaults:t,formLoading:f,formOption:s,formOptions:o,editorVisible:F,dataOptions:p,onUpdateFormData:S};return j(U,x),x}function J(){return $(U)}const B=g({__name:"flow-node-select",props:{filterType:{},dic:{}},setup(e){const a=e,{lf:l}=J(),r=K(()=>{var n;return(n=l.value)==null?void 0:n.graphModel.nodes.filter(o=>a.filterType?a.filterType.includes(o.type):!0).map(o=>({label:o.text.value,value:o.id,desc:o.id}))});return(n,o)=>{const u=_("avue-select");return D(),P(u,{dic:r.value},null,8,["dic"])}}}),Q=[{label:"跳过第一节点",prop:"skipFirstNode",type:"switch",labelWidth:100,value:!0},{label:"默认驳回节点",prop:"rollbackNode",type:"select",labelWidth:100,component:B,params:{filterType:"userTask"}},{label:"优先级字段",prop:"priority",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0},{label:"表单标题",prop:"formTitle",separator:"-",type:"select",dataType:"string",multiple:!0,filterable:!0,allowCreate:!0,defaultFirstOption:!0},{label:"标题分隔符",prop:"formTitleSeparator",value:"-",control(e){return{formTitle:{separator:e}}}}],d=[{label:"",labelWidth:0,prop:"property",type:"dynamic",children:{column:[{label:"属性名",prop:"name"},{label:"属性值",prop:"value",type:"textarea",minRows:1}]},value:[]}],X=[{label:"条件表达式",prop:"conditionsequenceflow"},{label:"是否为默认分支",prop:"defaultConditions",labelWidth:120,type:"switch",value:!1}],ee=[{label:"",labelWidth:0,prop:"serial",component:"avue-form",option:{menuBtn:!1,span:24,column:[{label:"名称",prop:"name"},{label:"前缀",prop:"prefix"},{label:"日期格式",prop:"dateFormat"},{label:"后缀位数",prop:"suffixLength"},{label:"初始数值",prop:"startSequence"},{label:"连接符",prop:"connector"},{label:"重置周期",prop:"cycle",type:"select",dicData:[{label:"不重置",value:"none"},{label:"按天重置",value:"day"},{label:"按周重置",value:"week"},{label:"按月重置",value:"month"},{label:"按年重置",value:"year"}]}]}}],le=[{label:"类",prop:"className"},{label:"异步",prop:"isAsync",type:"switch",value:!1}],ae=[{label:"驳回节点",prop:"rollbackNode",type:"select",component:B,params:{filterType:"userTask"}},{label:"重新提交后回到驳回人",prop:"backToRejecter",type:"switch",value:!1}],ne=[{label:"基本配置",prop:"base",column:c}],se={startEvent:[{label:"基本配置",prop:"baseGroup",column:c},{label:"表单配置",prop:"formPropertyGroup",collapse:!1,column:h},{label:"扩展属性",prop:"propertyGroup",collapse:!1,column:d}],endEvent:[{label:"基本配置",prop:"baseGroup",column:c},{label:"表单配置",prop:"formPropertyGroup",collapse:!1,column:h},{label:"扩展属性",prop:"propertyGroup",collapse:!1,column:d}],userTask:[{label:"基本配置",prop:"baseGroup",column:[...c,...ae]},{label:"人员配置",prop:"assigneeGroup",column:A},{label:"多实例配置",prop:"multiInstanceGroup",collapse:!1,column:M},{label:"按钮配置",prop:"buttonGroup",collapse:!1,column:I},{label:"表单配置",prop:"formPropertyGroup",collapse:!1,column:h},{label:"扩展属性",prop:"propertyGroup",collapse:!1,column:d}],serviceTask:[{label:"基本配置",prop:"baseGroup",column:c},{label:"服务配置",prop:"serviceGroup",column:le},{label:"扩展属性",prop:"propertyGroup",collapse:!1,column:d}],circulateTask:[{label:"基本配置",prop:"baseGroup",column:c},{label:"传阅配置",prop:"circulateGroup",column:Y},{label:"按钮配置",prop:"buttonGroup",collapse:!1,column:I},{label:"表单配置",prop:"formPropertyGroup",collapse:!1,column:h}],sequenceFlow:[{label:"基本配置",prop:"baseGroup",column:c},{label:"条件配置",prop:"sequenceFlowGroup",column:X},{label:"扩展属性",prop:"propertyGroup",collapse:!1,column:d}],parallelGateway:[{label:"基本配置",prop:"baseGroup",column:c},{label:"网关配置",prop:"baseGroup",column:z}],process:[{label:"流程配置",prop:"baseGroup",column:Q},{label:"流水号配置",prop:"serialGroup",column:ee},{label:"扩展属性",prop:"propertyGroup",collapse:!1,column:d}],group:[{label:"基本配置",prop:"baseGroup",column:c},{label:"多实例配置",prop:"multiInstanceGroup",collapse:!1,column:M},{label:"扩展属性",prop:"propertyGroup",collapse:!1,column:d}],note:[{label:"基本配置",prop:"baseGroup",column:H}]};export{i as I,B as _,se as a,ne as b,J as c,re as d,A as e,c as f,v as g,I as h,U as i,Y as j,h as k,z as l,M as m,H as n,d as o,Q as p,ee as q,le as r,X as s,ae as t,pe as u};
