import{d as Re}from"./index.013eb64a.js";import{I as Ue}from"./iconify.4cf0302a.js";import{a as ie,e as Me,f as Ge,w as xe,g as Je}from"./index.f1ae53c3.js";import{m as Qe,e as J,u as We}from"./index.662af1e4.js";import{_ as He,d as Xe}from"./index.861a3681.js";import{d as Ye}from"./data.3a7fc5d1.js";import"./index.722b7181.js";import{j as Ze}from"./tree.9b5eb098.js";import"./vuedraggable.umd.34b59ae3.js";import{u as te}from"./index.es.bd4305ee.js";import{ab as $e,g as z,h as j,A as ue,l as y,E as fe,$ as qe,S as Fe,Y as et,d as Q,J as x,c as E,L as ee,K as X,o as N,b as T,w as U,N as L,a as M,t as G,B as ne,a3 as ke,k as q,R as se,_ as ve,z as tt,C as at,e as R,U as lt,O as Le,a5 as ot,D as nt,a9 as st,aa as rt}from"./framework.a13ec59b.js";import{p as it}from"./pick.d171649b.js";import{t as ut,b as he,f as ct}from"./index.d8aaa0c2.js";import{E as oe}from"./index.11c61ab2.js";import{u as Te}from"./index.386fc70b.js";import{d as pt}from"./zipWith.3aba0508.js";import{g as le}from"./get.8a71353d.js";import{c as dt}from"./cloneDeep.0addb388.js";import{m as mt}from"./merge.cdc37a6d.js";function Y(e){const{tableOption:t}=W();return $e({...t,...e})}function ft(e){const{buttonHandler:t,request:o}=W(),{commitTask:_,revokeTask:r,saveDraft:p,startTask:a,terminateTask:f,transferTask:d,withdrawTask:c,rejectTask:w,greenChannel:b}=ye(o),l=z(()=>{const{flowDetail:k,formVariables:D,approvalFormData:s,debug:n,fileIds:g}=e,{flowDeployId:u}=k.value.process??{},{taskId:i,flowInstanceId:m}=k.value.task??{};return{flowDeployId:u,taskId:i,flowInstanceId:m,variables:D.value,debug:n.value,fileIds:g==null?void 0:g.value,...s.value}}),v=()=>l.value.taskId&&l.value.flowInstanceId;return{flow_draft(){if(v())return p(l.value)},flow_pass(){return v()?_(l.value):a(l.value)},flow_revoke(){if(v())return r(l.value)},flow_withdraw(){if(v())return c(l.value)},flow_terminate(){if(v())return f(l.value)},flow_transfer(){if(v())return d(l.value)},flow_reject(){if(v())return w(l.value)},flow_green(){if(v())return b(l.value)},...t==null?void 0:t(e)}}function Ve(){const e=Qe();return{emitter:e,onAfterGetDetail:p=>{e.on("afterGetDetail",async(...a)=>await(p==null?void 0:p(...a)))},onBeforeClick:p=>{e.on("beforeClick",async(...a)=>await(p==null?void 0:p(...a)))},onBeforeSubmit:p=>{e.on("beforeSubmit",async(...a)=>await(p==null?void 0:p(...a)))},onAfterSubmit:p=>{e.on("afterSubmit",async(...a)=>await(p==null?void 0:p(...a)))}}}function vt(e){const t=j({});return ue(async()=>{var _;const{formProperty:o}=((_=y(e))==null?void 0:_.properties)||{};o!=null&&o.length&&(await fe(),Object.keys(t.value).forEach(r=>{var f,d,c,w;const p=((f=t.value[r])==null?void 0:f.label)||"",a=o==null?void 0:o.find(b=>b.prop===r);if(t.value[r].display=a==null?void 0:a.display,t.value[r].disabled=a==null?void 0:a.disabled,t.value[r].detail=a==null?void 0:a.detail,t.value[r].readonly=a==null?void 0:a.readonly,t.value[r].rules=t.value[r].rules??[],a!=null&&a.required&&((d=t.value[r].rules)!=null&&d.some(b=>b.required)))return null;a!=null&&a.required?(c=t.value[r].rules)==null||c.push({required:!0,message:`${p}为必填项`}):t.value[r].rules=(w=t.value[r].rules)==null?void 0:w.filter(b=>!b.required)}))}),t}const bt={modelValue:{type:Object,default:()=>({})},title:{type:String},flowDetail:{type:Object,default:()=>({})},formLoading:{type:Boolean},submitLoading:{type:Boolean},activeTab:{type:String,default:"formTab"},activeBtn:{type:Object,default:()=>({})},approvalVisible:{type:Boolean},approvalFormData:{type:Object,default:()=>({})},flowKey:{type:String},taskId:{type:String},instanceId:{type:String},formId:{type:String},fileIds:{type:String},permission:{type:Object},afterGetDetail:{type:Function},beforeClick:{type:Function},beforeSubmit:{type:Function},afterSubmit:{type:Function},detail:{type:[Boolean,String],default:!1},debug:{type:[Boolean,String],default:!1}},_t={complete:e=>e},Oe=Symbol("flowFormState");function yt(e,t){const o=ie(e,void 0,{passive:!0,deep:!0}),{flowDetail:_,modelValue:r,formLoading:p,activeTab:a,afterGetDetail:f}=o,{emitter:d}=Ve(),{tabs:c,customForm:w,request:b}=W(),l=j({}),v=z(()=>(c==null?void 0:c.filter(u=>{var h,V,A;const i=(A=(V=(h=_.value)==null?void 0:h.properties)==null?void 0:V.formProperty)==null?void 0:A.find(P=>P.prop===u.prop),m={...u,display:(i==null?void 0:i.display)??u.display};return(m==null?void 0:m.display)!==!1}).map(u=>{var m,h;let i=u.component;if(u.prop==="formTab"){const V=w==null?void 0:w[((h=(m=_==null?void 0:_.value)==null?void 0:m.process)==null?void 0:h.formPath)??""];typeof V=="function"?i=et(V):V&&(i=V)}return{...u,component:i}}))??[]),k=j();H()&&Me(k,{onSwipeEnd(u,i){if(!["left","right"].includes(i))return;const m=v.value.findIndex(V=>V.prop===a.value),h=Ge(m+(i==="right"?-1:1),0,v.value.length-1);a.value=v.value[h].prop}});const{getFlowDetail:D}=ye(b);ue(()=>{const{flowKey:u,taskId:i,instanceId:m}=e;!u&&!i&&!m||(p.value=!0,D({flowKey:u,taskId:i,flowInstanceId:m}).then(async h=>{var V;_.value=h.data,r.value=h.data.formData||{},await((V=f==null?void 0:f.value)==null?void 0:V.call(f)),await d.emitAsync("afterGetDetail",h.data)}).finally(()=>{p.value=!1}))});const s=z(()=>Object.entries(r.value||{}).filter(([u])=>!u.startsWith("$")).map(([u,i])=>({key:u,value:i}))),n=z(()=>e.detail===!0||e.detail==="true"),g={...o,...Ve(),formData:r,formVariables:s,tabRefs:l,tabList:v,detail:n,tabsRef:k,emit:t};return qe(Oe,g),g}function F(){return Fe(Oe)}const Ne=Q({__name:"button-list",emits:["click"],setup(e,{emit:t}){const{userInfo:o,request:_}=W(),{flowDetail:r}=F(),{data:p}=Pe(_).useList();function a(d,c){return d.map(w=>{const b=c.find(v=>v.buttonKey===w.buttonKey);return{...w,...it(b,["display","approval"])}})}const f=z(()=>{var n,g,u,i;const d=typeof o=="function"?o():o,{assignee:c,status:w}=((n=r.value)==null?void 0:n.task)||{},{createUser:b,flowInstanceId:l,status:v}=((g=r.value)==null?void 0:g.flowInstance)||{},k={true:!0,false:!1,startUser:b==(d==null?void 0:d.userId),assignee:c==(d==null?void 0:d.userId),todo:w==re.待办,done:w==re.已办,notstarted:!l,started:!!l,finished:v===de.已办结,unfinished:v===de.未办结},{button:D}=((u=r.value)==null?void 0:u.properties)||{};return((i=a(p.value??[],D??[]))==null?void 0:i.filter(m=>{var h,V;return(V=(h=m.display)==null?void 0:h.split(","))==null?void 0:V.every(A=>k[A])}))??[]});return(d,c)=>{const w=x("el-button");return N(!0),E(X,null,ee(f.value,b=>(N(),T(w,{key:b.buttonKey,type:b.buttonType,onClick:l=>t("click",b)},{default:U(()=>[L(y(Ue),{icon:b.icon},null,8,["icon"]),M(" "+G(b.name),1)]),_:2},1032,["type","onClick"]))),128)}}}),wt=Q({__name:"common-comments",props:{modelValue:{}},setup(e){const t=e,{modelValue:o}=ie(t),{request:_}=W(),{batchUpdate:r,create:p,remove:a,useList:f}=jt(_),d=j(!1),{activeBtn:c}=F(),w=z(()=>{var i;return(i=c.value)==null?void 0:i.buttonKey}),{data:b,refresh:l}=f(w),v=z(()=>{var m,h,V;const i=o.value;if(i&&!((m=b.value)!=null&&m.some(A=>A.content===i))){const A=(((V=(h=b.value)==null?void 0:h[0])==null?void 0:V.sort)||1)-1;return[{content:i,sort:A},...b.value||[]]}return b.value});async function k(i){var m;await p({...i,type:(m=c.value)==null?void 0:m.buttonKey}),oe.success("添加成功"),l()}async function D(i){await a(i.id),oe.success("删除成功"),l()}async function s(i,m){let h=m.parent.data;h=h.map((V,A)=>({id:V.id,sort:A+1})),await r(h),oe.success("修改排序成功"),l(),d.value=!1}function n(){d.value=!0}const g=j();async function u(i){var m;o.value=i.content??"",await fe(),(m=g.value)==null||m.blur()}return(i,m)=>{const h=x("el-input"),V=x("el-text"),A=x("el-col"),P=x("el-button"),O=x("el-row"),I=x("el-tree"),C=x("el-popover");return N(),T(C,{visible:d.value,placement:"bottom",title:"常用意见",width:y(H)()?"98%":"600px"},{reference:U(()=>[L(h,{ref_key:"inputRef",ref:g,modelValue:y(o),"onUpdate:modelValue":m[0]||(m[0]=S=>ne(o)?o.value=S:null),type:"textarea",placeholder:"请输入意见",rows:"5",onFocus:m[1]||(m[1]=S=>d.value=!0),onBlur:m[2]||(m[2]=S=>d.value=!1)},null,8,["modelValue"])]),default:U(()=>[L(I,{data:v.value,"node-key":"content",draggable:"","allow-drop":(S,K,$)=>$!=="inner",props:{label:"content"},onNodeClick:u,onNodeDrop:s,onNodeDragStart:n},{default:U(({data:S})=>[L(O,{style:{width:"100%"}},{default:U(()=>[L(A,{span:22},{default:U(()=>[L(V,{truncated:"",title:S.content},{default:U(()=>[M(G(S.content),1)]),_:2},1032,["title"])]),_:2},1024),L(A,{span:2},{default:U(()=>[S.id?(N(),T(P,{key:0,type:"danger",size:"small",icon:"el-icon-close",text:"",onClick:ke(K=>D(S),["stop"])},null,8,["onClick"])):(N(),T(P,{key:1,type:"primary",size:"small",icon:"el-icon-plus",text:"",onClick:ke(K=>k(S),["stop"])},null,8,["onClick"]))]),_:2},1024)]),_:2},1024)]),_:1},8,["data","allow-drop"])]),_:1},8,["visible","width"])}}}),gt=Q({__name:"approval-tree",props:{modelValue:{},data:{},autoCheck:{type:Boolean},mode:{}},setup(e){const t=e,{modelValue:o}=ie(t),_={element:"ep:flag",post:"ep:share",dept:"ep:share",user:"ep:user"},p={defaultExpandAll:!0,lazy:!0,showCheckbox:!0,nodeKey:"id",load:(l,v)=>{l.level===0?v(f.value):v(l.data.children??[])},onCheck:c,props:{label:"title",class(l){return`node-${l.type}`}}},a=j(),f=z(()=>ut(t.data??[],(l,v,k)=>{const D=Te();return l.taskNodeKey=(k==null?void 0:k.taskNodeKey)??l.taskNodeKey,l.incoming=(k==null?void 0:k.incoming)??l.incoming,l.multiple=(k==null?void 0:k.multiple)??l.multiple,l.parentId=(k==null?void 0:k.id)??l.parentId,{...l,id:D}}));xe(()=>[f.value,a.value],async()=>{if(!(!a.value||!f.value.length)&&t.autoCheck){const l=d(f.value);l&&b([l])}},{immediate:!0,debounce:100});function d(l){var v;if(l.length===1)return(v=l[0].children)!=null&&v.length?d(l[0].children):l[0]}async function c(l,{checkedNodes:v}){var s;let k=v.filter(n=>n.type==="user");const D=k.some(n=>n.id===l.id);if(f.value.every(n=>!n.multiple)&&D)k=[l];else if(!l.multiple&&D){const u=((s=a.value)==null?void 0:s.getNode(l)).parent.data.children.filter(i=>i.id!==l.id);k=pt(k,u,"id")}b(k)}function w(l){const v=o.value.filter(k=>k.id!==l.id);b(v)}function b(l){var v;o.value=l,(v=a.value)==null||v.setCheckedNodes(l)}return(l,v)=>{const k=x("el-tag"),D=x("Icon"),s=x("el-tree");return N(),E(X,null,[(N(!0),E(X,null,ee(y(o),n=>(N(),T(k,{key:n.id,type:"info",closable:"",onClose:g=>w(n)},{default:U(()=>[M(G(n.title),1)]),_:2},1032,["onClose"]))),128)),L(s,se({ref_key:"treeRef",ref:a,class:["approval-tree",`mode-${l.mode}`],data:f.value},p),{default:U(({data:n})=>[q("div",null,[L(D,{icon:_[n.type]||_.element,style:{display:"inline-block"}},null,8,["icon"]),q("span",null,G(n.title),1)])]),_:1},16,["class","data"])],64)}}});const De=ve(gt,[["__scopeId","data-v-9646bed9"]]),kt={key:0},Ce=Q({__name:"assignee-setter",props:{modelValue:{},tableData:{},placeholder:{}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,_=z({get(){return typeof o.modelValue=="string"?o.modelValue?o.modelValue.split(","):[]:o.modelValue},set(D){var s;t("update:modelValue",D.join(",")),(s=o.tableData)!=null&&s.row&&(o.tableData.row.values=he(f.value,n=>D==null?void 0:D.includes(n.id)),o.tableData.row.idVal=o.tableData.row.values.map(n=>n[`${a.value}Id`]).join(","))}}),r=z({get(){return Array.isArray(o.modelValue)?o.modelValue.join(","):o.modelValue},set(D){t("update:modelValue",D)}}),p=j(!1),a=z(()=>{var D,s;return(s=(D=o.tableData)==null?void 0:D.row)==null?void 0:s.type}),f=j([]),d=j([]),{request:c}=W(),{getUserTree:w}=Rt(c),{getParam:b}=ce(c);tt(a,async D=>{try{if(p.value=!0,["dept","post","user"].includes(D)){const s=await w(D==="user"?"":D);f.value=s.data}else if(a.value==="dynamic"){const s=await b("flow.trends.user");d.value=s.data}}finally{p.value=!1}},{immediate:!0});function l(){_.value=he(f.value,D=>D.type===a.value).map(D=>D.id)}const v=z(()=>({checkStrictly:a.value!=="user",clearable:!0,collapseTags:!0,collapseTagsTooltip:!0,data:f.value,filterable:!0,loading:p.value,maxCollapseTags:3,multiple:!0,nodeKey:"id",props:{label:"title"},placeholder:"请选择",showCheckbox:!0})),k=z(()=>({clearable:!0,data:d.value,filterable:!0,loading:p.value,nodeKey:"value",props:{label:"title"},placeholder:"请选择"}));return(D,s)=>{const n=x("el-tree-select"),g=x("el-button"),u=x("el-input");return["dept","post","user"].includes(a.value)?(N(),E("div",kt,[L(n,se({modelValue:_.value,"onUpdate:modelValue":s[0]||(s[0]=i=>_.value=i)},v.value,{style:{width:"75%"}}),null,16,["modelValue"]),L(g,{text:"",type:"primary",icon:"el-icon-check",style:{width:"20%"},onClick:l},{default:U(()=>[M(" 全选 ")]),_:1})])):a.value==="dynamic"?(N(),T(n,se({key:1,modelValue:r.value,"onUpdate:modelValue":s[1]||(s[1]=i=>r.value=i)},k.value,{style:{width:"100%"}}),null,16,["modelValue"])):a.value==="userTask"?(N(),T(y(He),{key:2,modelValue:r.value,"onUpdate:modelValue":s[2]||(s[2]=i=>r.value=i),"filter-type":"userTask",placeholder:"请选择"},null,8,["modelValue"])):(N(),T(u,{key:3,modelValue:r.value,"onUpdate:modelValue":s[3]||(s[3]=i=>r.value=i),clearable:"",placeholder:"请输入"},null,8,["modelValue"]))}}}),ht={key:0,class:"flow-viewer"},Vt={key:0,class:"flow-status-legend"},Nt={class:"legend-text"},Dt=Q({__name:"index",props:{modelValue:{},view:{type:Boolean},flowFormOption:{},flowHistory:{},showLegend:{type:Boolean}},emits:["update:modelValue","nodeClick"],setup(e,{emit:t}){const o=e,_=at();Je(_,()=>{var n;(n=_.value)==null||n.on("node:click",g=>t("nodeClick",g))});const r=z({get(){let n=Ye();return typeof o.modelValue=="string"&&o.modelValue?n=JSON.parse(o.modelValue):typeof o.modelValue=="object"&&Object.keys(o.modelValue)&&(n=o.modelValue),n},set(n){t("update:modelValue",JSON.stringify(n))}}),p=z(()=>{const{column:n=[],group:g=[]}=JSON.parse(o.flowFormOption||"{}");return[...n,...g.map(i=>i.column??[]).flat()]}),{FlowDesign:a,tabs:f,request:d}=W(),{data:c}=Pe(d).useList(),w=z(()=>(f==null?void 0:f.map(n=>({...n,display:n.display??!0})))??[]),b=z(()=>({formPropertyList:[...p.value,...w.value],buttonList:c.value,fieldsDic:p.value.map(n=>({label:n.label,value:`\${${n.prop}}`,desc:`\${${n.prop}}`})),flowButtonDisplayDic:J(be),flowButtonApprovalDic:J(_e)})),l=j({}),v=j({});xe(v,n=>{var g,u,i,m,h,V;n&&((i=(u=(g=n.assignee)==null?void 0:g.children)==null?void 0:u.column)!=null&&i[1]&&(n.assignee.children.column[1].component=Ce),(V=(h=(m=n.circulate)==null?void 0:m.children)==null?void 0:h.column)!=null&&V[1]&&(n.circulate.children.column[1].component=Ce))},{debounce:1});const{data:k}=ce(d).useParam("flow.task.status"),D=z(()=>{var n;return(n=o.flowHistory)==null?void 0:n.map(g=>{var i,m;const u=(m=(i=k.value)==null?void 0:i.find(h=>h.value===g.status))==null?void 0:m.style;return{id:g.taskNodeKey,style:u}})}),s=z(()=>{var n,g;return(g=(n=o.flowHistory)==null?void 0:n.filter(u=>u.taskNodeType==="userTask"))==null?void 0:g.map(u=>{var i;return{id:u.taskNodeKey,content:`<div>${u.assigneeName}</div>
        <div>${u.endTime??""}</div>
        <div>${((i=u.comment)==null?void 0:i.handleComment)??""}</div>`}})});return(n,g)=>n.view?(N(),E("div",ht,[n.showLegend!==!1?(N(),E("div",Vt,[(N(!0),E(X,null,ee(y(k),u=>{var i;return N(),E("div",{key:u.label,class:"legend-item"},[q("div",{class:"legend-color",style:lt({backgroundColor:(i=u.style)==null?void 0:i.fill})},null,4),q("span",Nt,G(u.label),1)])}),128))])):R("",!0),L(y(a),{lf:_.value,"onUpdate:lf":g[0]||(g[0]=u=>_.value=u),"model-value":r.value,styles:D.value,tooltips:s.value,type:"viewer"},null,8,["lf","model-value","styles","tooltips"])])):(N(),T(y(a),{key:1,modelValue:r.value,"onUpdate:modelValue":g[1]||(g[1]=u=>r.value=u),formData:l.value,"onUpdate:formData":g[2]||(g[2]=u=>l.value=u),formDefaults:v.value,"onUpdate:formDefaults":g[3]||(g[3]=u=>v.value=u),"form-options":y(Xe),"data-options":b.value,"form-width":"30%"},null,8,["modelValue","formData","formDefaults","form-options","data-options"]))}});const Se=ve(Dt,[["__scopeId","data-v-510addf8"]]),Ct=Q({__name:"node-select",props:{modelValue:{}},setup(e){const t=e,{modelValue:o}=ie(t),{flowDetail:_}=F(),r=j(!1);function p({data:a}){a.type==="userTask"&&(r.value=!1,o.value=a.id)}return(a,f)=>{const d=x("el-button"),c=x("el-popover");return N(),T(c,{visible:r.value,"onUpdate:visible":f[0]||(f[0]=w=>r.value=w),placement:"bottom-start",width:"800px",trigger:"click"},{reference:U(()=>[L(d,null,{default:U(()=>[M(" 点击选择节点 ")]),_:1})]),default:U(()=>{var w,b;return[L(Se,{"model-value":(b=(w=y(_))==null?void 0:w.process)==null?void 0:b.flowData,view:"",style:{height:"600px"},onNodeClick:p},null,8,["model-value"])]}),_:1},8,["visible"])}}}),It=Q({__name:"approval-form",emits:["submit"],setup(e,{emit:t}){const{request:o}=W(),{getApprovalNode:_}=ye(o),{useParam:r}=ce(o),{formData:p,approvalFormData:a,activeBtn:f,approvalVisible:d,formVariables:c,flowDetail:w}=F(),b=j([]),l=j([]),v=j([]),k=j([]),D=j(!1),s=j(!1),n=j(),g=z(()=>{const O=b.value.length,I=v.value.length&&!b.value.length;return{menuBtn:!1,labelWidth:"auto",span:24,column:[{label:"指定节点",prop:"jumpTaskNodeKey",display:u("specifyNode"),rules:[{required:!0,message:"请选择指定节点"}]},{label:"审批人",prop:"assignee",display:u("assignee"),rules:O?[{required:!0,validator:i}]:[]},{label:"传阅人",prop:"circulate",display:u("circulate"),rules:I?[{required:!0,message:"请选择传阅人"}]:[]},{label:"意见",prop:"comment",display:u("comment"),rules:[{required:!0,message:"请填写意见"}]}]}});function u(O){var I,C;return(C=(I=f.value)==null?void 0:I.approval)==null?void 0:C.includes(O)}function i(O,I,C){var $,Z,ae;const S=(($=b.value[0])==null?void 0:$.type)==="parallelGateway",K=(ae=(Z=b.value[0])==null?void 0:Z.children)==null?void 0:ae.every(B=>ct([B],pe=>l.value.some(Ee=>Ee.id===pe.id)));if(l.value.length){if(S&&!K)return C("请在每个节点选择审批人")}else return C("请选择审批人");return!0}const{data:m}=r("flow.approval.autocheck"),{data:h}=r("flow.approval.autocomment");ue(async()=>{var C,S;if(!d.value||!n.value)return;fe(()=>{n.value.resetFields(),a.value.comment=p.value.comment||h.value==="true"&&f.value.name||""});const{taskId:O}=((C=w.value)==null?void 0:C.task)||{},{flowKey:I}=((S=w.value)==null?void 0:S.process)||{};if(V(),!!u("assignee")&&!(u("specifyNode")&&!a.value.jumpTaskNodeKey))try{s.value=!0;const K=await _({flowKey:I,taskId:O,variables:c.value,buttonType:f.value.buttonKey,jumpTaskNodeKey:a.value.jumpTaskNodeKey});b.value=K.data.approvalNodeList,v.value=K.data.circulateNodeList}finally{s.value=!1}});function V(){b.value=[],l.value=[],v.value=[],k.value=[]}async function A(){await Be(n),D.value=!0;const{data:O,outgoing:I}=P(l.value),{data:C}=P(k.value);a.value.assignee=O,a.value.circulate=C,a.value.outgoing=[...I],t("submit")}function P(O){const I={},C={},S=new Set;return O.forEach(K=>{const{taskNodeKey:$,incoming:Z}=K;I[$]||(I[$]=new Set),K.userId&&I[$].add(K.userId),C[$]=[...I[$]].join(","),Z&&S.add(Z)}),{dataSet:I,data:C,outgoing:S}}return(O,I)=>{const C=x("el-skeleton"),S=x("avue-form"),K=x("el-button");return N(),T(Le(y(H)()?"el-drawer":"el-dialog"),{modelValue:y(d),"onUpdate:modelValue":I[6]||(I[6]=$=>ne(d)?d.value=$:null),class:"approval-form-overlay",title:y(f).name,"append-to-body":"",width:"900px",size:"50%",direction:"btt"},{footer:U(()=>[L(K,{onClick:I[5]||(I[5]=$=>d.value=!1)},{default:U(()=>[M(" 取 消 ")]),_:1}),L(K,{type:"primary",onClick:A},{default:U(()=>[M(" 确 定 ")]),_:1})]),default:U(()=>[L(S,{ref_key:"formRef",ref:n,modelValue:y(a),"onUpdate:modelValue":I[4]||(I[4]=$=>ne(a)?a.value=$:null),class:"approval-form",option:g.value},{jumpTaskNodeKey:U(()=>[L(Ct,{modelValue:y(a).jumpTaskNodeKey,"onUpdate:modelValue":I[0]||(I[0]=$=>y(a).jumpTaskNodeKey=$)},null,8,["modelValue"])]),assignee:U(()=>[s.value?(N(),T(C,{key:0})):(N(),T(De,{key:"AssigneeTree",modelValue:l.value,"onUpdate:modelValue":I[1]||(I[1]=$=>l.value=$),data:b.value,"auto-check":y(m)==="true",mode:y(H)()?"vertical":"horizontal"},null,8,["modelValue","data","auto-check","mode"]))]),circulate:U(()=>[s.value?(N(),T(C,{key:0})):(N(),T(De,{key:"CirculateTree",modelValue:k.value,"onUpdate:modelValue":I[2]||(I[2]=$=>k.value=$),data:v.value,mode:y(H)()?"vertical":"horizontal"},null,8,["modelValue","data","mode"]))]),comment:U(()=>[L(wt,{modelValue:y(a).comment,"onUpdate:modelValue":I[3]||(I[3]=$=>y(a).comment=$)},null,8,["modelValue"])]),_:1},8,["modelValue","option"])]),_:1},8,["modelValue","title"])}}});const Ut={class:"flow-form__title"},xt=Q({__name:"index",props:bt,emits:_t,setup(e,{emit:t}){const _=yt(e,t),{ApprovalForm:r,tabsProps:p}=W(),a=r??It,{title:f,detail:d,flowDetail:c,tabRefs:w,tabList:b,activeTab:l,activeBtn:v,formLoading:k,approvalVisible:D,submitLoading:s,beforeClick:n,beforeSubmit:g,afterSubmit:u,tabsRef:i,emitter:m}=_;async function h(P){var O,I;v.value=P;for(const C of Object.values(w.value))await((O=C==null?void 0:C.validate)==null?void 0:O.call(C));await((I=n==null?void 0:n.value)==null?void 0:I.call(n,P)),await m.emitAsync("beforeClick",P),(P==null?void 0:P.approval)!=="false"?D.value=!0:A()}const V=ft(_);async function A(){var P,O;try{s.value=!0,await((P=g==null?void 0:g.value)==null?void 0:P.call(g,v.value)),await m.emitAsync("beforeSubmit",v.value);const{buttonKey:I}=v.value,C=V[I];if(!C){oe.error("无法找到相应的操作");return}await(C==null?void 0:C()),await((O=u==null?void 0:u.value)==null?void 0:O.call(u,v.value)),await m.emitAsync("afterSubmit",v.value),D.value=!1,t("complete",v.value)}finally{s.value=!1}}return(P,O)=>{const I=x("el-skeleton"),C=x("el-main"),S=x("el-header"),K=x("el-tab-pane"),$=x("el-tabs"),Z=x("el-footer"),ae=x("el-container");return y(k)?(N(),T(C,{key:0},{default:U(()=>[L(I)]),_:1})):(N(),T(ae,{key:1,class:"flow-form"},{default:U(()=>[L(S,{class:"flow-form__header",height:"auto"},{default:U(()=>{var B;return[q("div",Ut,G(y(f)??((B=y(c).flowInstance)==null?void 0:B.title)),1),!y(d)&&!y(H)()?(N(),T(Ne,{key:0,onClick:h})):R("",!0)]}),_:1}),L(C,{class:"flow-form__main"},{default:U(()=>[L($,se({ref_key:"tabsRef",ref:i,modelValue:y(l),"onUpdate:modelValue":O[0]||(O[0]=B=>ne(l)?l.value=B:null)},y(p)),{default:U(()=>[(N(!0),E(X,null,ee(y(b),B=>(N(),T(K,{key:B.prop,label:B.label,name:B.prop,lazy:B.lazy,disabled:B.disabled,closable:B.closable},{default:U(()=>[(N(),T(Le(B.component),{ref_for:!0,ref:pe=>y(w)[B.prop]=pe},null,512))]),_:2},1032,["label","name","lazy","disabled","closable"]))),128))]),_:1},16,["modelValue"])]),_:1}),!y(d)&&y(H)()?(N(),T(Z,{key:0,class:"flow-form__footer",height:"auto"},{default:U(()=>[L(Ne,{onClick:h})]),_:1})):R("",!0),L(y(a),{onSubmit:A})]),_:1}))}}});const $t=Q({setup(){const{flowDetail:e,formData:t,detail:o}=F(),_=vt(e.value),{proxy:r}=nt(),p=j({});ue(()=>{const{formOption:d}=e.value.process??{};p.value=Ze.bind(r)(d||'{"menuBtn":false}'),p.value.detail=!!o.value});const a=j();function f(){return Be(a)}return{form:t,option:p,defaults:_,formRef:a,validate:f}},render(){return ot(x("avue-form"),{ref:"formRef",modelValue:this.form,defaults:this.defaults,option:this.option,class:this.option.class,"onUpdate:modelValue":e=>this.form=e,"onUpdate:defaults":e=>this.defaults=e})}}),Lt=Q({__name:"upload-table",setup(e){const{flowDetail:t,fileIds:o,detail:_}=F(),{upload:{action:r,headers:p,preview:a,download:f,props:d}={},request:c}=W(),w=typeof p=="function"?p():p,b=z(()=>{var h,V;return((V=(h=t.value)==null?void 0:h.task)==null?void 0:V.flowInstanceId)??Te()}),l=[{label:"文件名",prop:"fileName"},{label:"文件类型",prop:"fileType"},{label:"文件大小",prop:"fileSize"},{label:"版本",prop:"version"},{label:"上传时间",prop:"createTime"}],v=l.filter(h=>h.prop==="fileName"),k={rowKey:"id",align:"center",index:!1,border:!0,stripe:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuType:"menu",menuBtnTitle:"操作",column:H()?v:l},{bindVal:D,getDataList:s,handleDel:n,handleSave:g,afterGetList:u,crudStateRefs:{tableData:i}}=We({crudOption:{...Bt(c),saveSuccessMsg:"上传成功"},tableOption:k,queryForm:{isLatest:1,flowInstanceId:b.value}});u(()=>{o.value=i.value.map(h=>h.id).join(",")}),s();async function m(h,V){var K,$;const{fileName:A,fileType:P,fileSize:O,fileUrl:I,res:C}=d,S={fileName:le({res:h},`${C}.${A}`),fileType:le({res:h},`${C}.${P}`),fileSize:le({res:h},`${C}.${O}`),fileUrl:le({res:h},`${C}.${I}`),taskId:($=(K=t.value)==null?void 0:K.task)==null?void 0:$.taskId,flowInstanceId:b.value,rootMark:(V==null?void 0:V.rootMark)||"",version:typeof(V==null?void 0:V.version)=="number"?V.version+1:1};await g(S,s,()=>{})}return(h,V)=>{const A=x("el-button"),P=x("el-upload"),O=x("el-dropdown-item"),I=x("avue-crud");return N(),T(I,st(rt(y(D))),{"menu-left":U(()=>[y(_)?R("",!0):(N(),T(P,{key:0,action:y(r),headers:y(w),"show-file-list":!1,onSuccess:V[0]||(V[0]=C=>m(C))},{default:U(()=>[L(A,{type:"primary",icon:"el-icon-upload"},{default:U(()=>[M(" 点击上传 ")]),_:1})]),_:1},8,["action","headers"]))]),"menu-btn":U(({row:C,index:S})=>[L(O,{icon:"el-icon-view",onClick:K=>{var $;return($=y(a))==null?void 0:$(C,y(i))}},{default:U(()=>[M(" 预览 ")]),_:2},1032,["onClick"]),L(O,{icon:"el-icon-download",onClick:K=>{var $;return($=y(f))==null?void 0:$(C,y(i))}},{default:U(()=>[M(" 下载 ")]),_:2},1032,["onClick"]),y(_)?R("",!0):(N(),T(O,{key:0,icon:"el-icon-upload"},{default:U(()=>[L(P,{action:y(r),headers:y(w),"show-file-list":!1,onSuccess:K=>m(K,C)},{default:U(()=>[M(" 更新版本 ")]),_:2},1032,["action","headers","onSuccess"])]),_:2},1024)),y(_)?R("",!0):(N(),T(O,{key:1,icon:"el-icon-delete",onClick:K=>y(n)(C,S)},{default:U(()=>[M(" 删除 ")]),_:2},1032,["onClick"]))]),_:1},16)}}}),Tt={class:"flow-track"},Ot={key:0},St={key:1},At=Q({__name:"flow-track",setup(e){const{flowDetail:t}=F(),o=j(H()?"timeline":"table"),_=[{label:"table",icon:"ep:grid"},{label:"graph",icon:"ep:picture"},{label:"timeline",icon:"ep:finished"}],r=z(()=>{var c,w,b;return((b=(w=(c=t.value)==null?void 0:c.flowHistory)==null?void 0:w.filter(l=>l.taskNodeType==="userTask"))==null?void 0:b.map(l=>({...l,duration:Re(l.duration)})))??[]}),p={addBtn:!1,menu:!1,border:!0,column:[{label:"节点名称",prop:"taskNodeName"},{label:"处理人",prop:"assigneeName"},{label:"接收时间",prop:"startTime"},{label:"处理时间",prop:"endTime"},{label:"办理时长",prop:"duration"},{label:"操作类型",prop:"type",dicUrl:"/sapier-flow/flow-param/getParam",dicQuery:{paramKey:"flow.handle.type"}},{label:"办理意见",prop:"comment",bind:"comment.handleComment"}]},{request:a}=W(),{data:f}=ce(a).useParam("flow.handle.type");function d(c){var w;return(w=f.value)==null?void 0:w.find(b=>b.value===c)}return(c,w)=>{var g,u,i;const b=x("el-radio-button"),l=x("el-radio-group"),v=x("avue-crud"),k=x("el-card"),D=x("el-timeline-item"),s=x("el-timeline"),n=x("el-empty");return N(),E(X,null,[y(H)()?R("",!0):(N(),T(l,{key:0,modelValue:o.value,"onUpdate:modelValue":w[0]||(w[0]=m=>o.value=m)},{default:U(()=>[(N(),E(X,null,ee(_,m=>L(b,{key:m.label,label:m.label},{default:U(()=>[L(y(Ue),{icon:m.icon},null,8,["icon"])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])),q("div",Tt,[o.value==="table"?(N(),T(v,{key:0,data:r.value,option:p},null,8,["data"])):R("",!0),o.value==="graph"?(N(),T(Se,{key:1,"model-value":(u=(g=y(t))==null?void 0:g.process)==null?void 0:u.flowData,"flow-history":(i=y(t))==null?void 0:i.flowHistory,view:"","show-legend":""},null,8,["model-value","flow-history"])):R("",!0),o.value==="timeline"?(N(),E(X,{key:2},[r.value.length?(N(),T(s,{key:0},{default:U(()=>[(N(!0),E(X,null,ee([...r.value].reverse(),m=>(N(),T(D,{key:m.id,timestamp:m.endTime,placement:"top"},{default:U(()=>[L(k,null,{default:U(()=>{var h,V,A;return[q("div",null,G(m.assigneeName)+" 开始处理 ["+G(m.taskNodeName)+"] 环节 ",1),m.duration?(N(),E("div",Ot," 办理时长："+G(m.duration),1)):R("",!0),m.type&&((h=m.comment)!=null&&h.handleComment)?(N(),E("div",St,G((V=d(m.type))==null?void 0:V.label)+"意见："+G((A=m.comment)==null?void 0:A.handleComment),1)):R("",!0)]}),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:1})):(N(),T(n,{key:1}))],64)):R("",!0)])],64)}}});const Kt=ve(At,[["__scopeId","data-v-b788684b"]]),Pt={FlowDesign:{},FormDesign:{},FlowForm:xt,request:{},tabs:[{label:"审批表单",prop:"formTab",component:$t},{label:"附件资料",prop:"fileTab",component:Lt},{label:"流程跟踪",prop:"trackTab",component:Kt}],useFlowFormOptions:{type:"drawer",window:["","flow-form","left=0,top=0,width=1600,height=900"],overlay:{width:"80%",size:"80%",top:"100px",fullscreen:!0,destroyOnClose:!0}},tableOption:{align:"center",border:!0,card:!0,stripe:!0,searchMenuSpan:6,span:24},upload:{props:{fileName:"fileOriginalName",fileType:"fileType",fileSize:"fileSize",fileUrl:"fileUrl",res:"res.data"}}};function jt(e){const t={list:"/sapier-flow/flow-user-common/list",save:"/sapier-flow/flow-user-common/save",update:"/sapier-flow/flow-user-common/update",remove:"/sapier-flow/flow-user-common/remove",batchUpdate:"/sapier-flow/flow-user-common/batchUpdate"},o=d=>e.get(t.list,{params:{type:d,ascs:"sort"}});return{url:t,getList:o,useList:d=>te(()=>o(d.value).then(c=>c.data.records),{refreshDeps:[d]}),create:d=>e.post(t.save,d),update:d=>e.post(t.update,d),remove:d=>e.post(t.remove,{},{params:{ids:d}}),batchUpdate:d=>e.post(t.batchUpdate,d)}}var Ae=(e=>(e.默认="default",e.主要="primary",e.成功="success",e.警告="warning",e.危险="danger",e.信息="info",e.文字="text",e))(Ae||{}),zt=(e=>(e.保存草稿="flow_draft",e.发送="flow_pass",e.退回="flow_reject",e.终止="flow_terminate",e.撤销="flow_revoke",e.撤回到发起="flow_withdraw",e.打印="flow_print",e.转办="flow_transfer",e.加签="flow_add_instance",e.减签="flow_del_instance",e.指定回退="flow_rollback",e.绿色通道="flow_green",e))(zt||{}),be=(e=>(e.显示="true",e.隐藏="false",e.发起人="startUser",e.处理人="assignee",e.已办="done",e.待办="todo",e.未发起="notstarted",e.已发起="started",e.未办结="unfinished",e.已办结="finished",e))(be||{}),_e=(e=>(e.不显示="false",e.指定节点="specifyNode",e.审批人="assignee",e.传阅人="circulate",e.意见="comment",e))(_e||{}),Ke=(e=>(e[e.禁用=0]="禁用",e[e.正常=1]="正常",e))(Ke||{});function Pe(e){const t={list:"/sapier-flow/dev-button/list",save:"/sapier-flow/dev-button/save",update:"/sapier-flow/dev-button/update",remove:"/sapier-flow/dev-button/remove"},o=f=>e.get(t.list,{params:f});return{url:t,getList:o,useList:()=>te(()=>o({size:-1,ascs:"sort",status:1}).then(f=>f.data.records)),create:f=>e.post(t.save,f),update:f=>e.post(t.update,f),remove:f=>e.post(t.remove,{},{params:{ids:f}})}}function Bt(e){const t={list:"/sapier-flow/flow-file/list",save:"/sapier-flow/flow-file/save",remove:"/sapier-flow/flow-file/remove"};return{getList:p=>e.get(t.list,{params:p}),create:p=>e.post(t.save,p),remove:p=>e.post(t.remove,{},{params:{ids:p}})}}function ce(e){const t={list:"/sapier-flow/flow-param/list",save:"/sapier-flow/flow-param/save",update:"/sapier-flow/flow-param/update",remove:"/sapier-flow/flow-param/remove",all:"/sapier-flow/flow-param/getAllParam",key:"/sapier-flow/flow-param/getParam"},o=c=>e.get(t.list,{params:c}),_=()=>e.get(t.all),r=c=>e.get(t.key,{params:{paramKey:c}});return{url:t,getList:o,getAllParam:_,getParam:r,useParam:c=>te(()=>r(c).then(w=>w.data)),create:c=>e.post(t.save,c),update:c=>e.post(t.update,c),remove:c=>e.post(t.remove,{},{params:{ids:c}})}}var re=(e=>(e[e.已办=1]="已办",e[e.待办=2]="待办",e[e.失败=3]="失败",e[e.撤销=4]="撤销",e[e.终止=5]="终止",e))(re||{}),de=(e=>(e[e.已办结=1]="已办结",e[e.未办结=2]="未办结",e[e.已终止=3]="已终止",e))(de||{}),Et=(e=>(e[e.系统执行=1]="系统执行",e[e.用户办理=2]="用户办理",e[e.任务撤销=3]="任务撤销",e[e.任务退回=4]="任务退回",e[e.流程终止=5]="流程终止",e[e.任务转办=6]="任务转办",e[e.绿色通道=7]="绿色通道",e))(Et||{});function ye(e){const t={publishList:"/sapier-flow/flow-run/queryPublishFlowList",taskList:"/sapier-flow/flow-run/userTaskList",detail:"/sapier-flow/flow-run/queryPublishFlowDetail",approvalNode:"/sapier-flow/flow-run/queryApprovalNode",start:"/sapier-flow/flow-run/startProcess",commit:"/sapier-flow/flow-run/commitTask",draft:"/sapier-flow/flow-run/saveDraft",revoke:"/sapier-flow/flow-run/revokeTask",terminate:"/sapier-flow/flow-run/terminateFlow",withdraw:"/sapier-flow/flow-run/withdrawToStart",transfer:"/sapier-flow/flow-run/transferTask",reject:"/sapier-flow/flow-run/rollbackTask",green:"/sapier-flow/flow-run/greenTask"},o=s=>e.get(t.detail,{params:s}),_=s=>e.post(t.approvalNode,s),r=s=>e.post(t.start,s),p=s=>e.post(t.commit,s),a=s=>e.post(t.draft,s),f=s=>e.post(t.revoke,s),d=s=>e.post(t.terminate,s),c=s=>e.post(t.withdraw,s),w=s=>e.post(t.transfer,s),b=s=>e.post(t.reject,s),l=s=>e.post(t.green,s),v=()=>e.get(t.publishList);return{url:t,getFlowDetail:o,getApprovalNode:_,startTask:r,commitTask:p,saveDraft:a,revokeTask:f,terminateTask:d,withdrawTask:c,transferTask:w,rejectTask:b,greenChannel:l,getPublishList:v,usePublishList:()=>te(()=>v().then(s=>s.data)),getTaskList:s=>e.get(t.taskList,{params:s})}}function Rt(e){const t={tree:"/sapier-flow/flow-user/tree"},o=r=>e.get(t.tree,{params:{filter:r}});return{url:t,getUserTree:o,useUserTree:()=>te(()=>o().then(r=>r.data))}}var we=(e=>(e.ASSIGN_ID="ASSIGN_ID",e.ASSIGN_UUID="ASSIGN_UUID",e.AUTO="AUTO",e.INPUT="INPUT",e.NONE="NONE",e))(we||{}),ge=(e=>(e.bigint="bigint",e.blob="blob",e.char="char",e.date="date",e.datetime="datetime",e.decimal="decimal",e.double="double",e.enum="enum",e.float="float",e.int="int",e.longblob="longblob",e.longtext="longtext",e.mediumblob="mediumblob",e.mediumint="mediumint",e.mediumtext="mediumtext",e.set="set",e.smallint="smallint",e.text="text",e.time="time",e.timestamp="timestamp",e.tinyblob="tinyblob",e.tinyint="tinyint",e.tinytext="tinytext",e.varbinary="varbinary",e.varchar="varchar",e.year="year",e))(ge||{});function ua(e){const t={list:"/sapier-flow/dev-table/list",save:"/sapier-flow/dev-table/save",update:"/sapier-flow/dev-table/update",remove:"/sapier-flow/dev-table/remove",deploy:"/sapier-flow/dev-table/deploy",getFields:"/sapier-flow/dev-table/getTableFields"},o=c=>e.get(t.list,{params:c});return{url:t,getList:o,useList:()=>te(()=>o({size:-1}).then(c=>c.data.records)),create:c=>e.post(t.save,c),update:c=>e.post(t.update,c),remove:c=>e.post(t.remove,{},{params:{ids:c}}),deploy:c=>e.post(t.deploy,c),getFields:c=>e.get(t.getFields,{params:c})}}var je=(e=>(e[e.否=0]="否",e[e.是=1]="是",e))(je||{});const me=J(je),ca=J(ge),pa=J(we),Mt=$e(dt(Pt));function W(e){return mt(Mt,e)}const da=Y({rowKey:"id",labelWidth:150,column:[{label:"按钮名称",prop:"name",search:!0},{label:"按钮标识",prop:"buttonKey",search:!0},{label:"按钮图标",prop:"icon",component:"icon-select"},{label:"按钮类型",prop:"buttonType",type:"select",dicData:J(Ae)},{label:"默认显示条件",prop:"display",type:"select",multiple:!0,dataType:"string",value:"false",dicData:J(be),tip:"选择多个时,所有条件都满足才显示",labelTip:`显示: 始终显示;<br/>隐藏: 始终隐藏;<br/>
      发起人: 用户为发起人时显示;<br/>处理人: 用户为处理人时显示;<br/>
      已办: 任务状态为已办时显示;<br/>待办: 任务状态为待办时显示;<br/>
      未发起: 流程未发起时显示;<br/>已发起: 流程已发起时显示;<br/>
      未办结: 流程未办结时显示;<br/>已办结: 流程已办结时显示;`},{label:"默认审批窗口显示",prop:"approval",type:"select",multiple:!0,dataType:"string",value:"false",dicData:J(_e),labelTip:`不显示: 不显示审批窗口;<br/>指定节点: 显示指定节点选择框(常用于绿色通道等);<br/>
      审批人: 显示审批人选择框;<br/>传阅人: 显示传阅人选择框;<br/>意见: 显示意见输入框;`},{label:"备注",prop:"remarks",overHidden:!0},{label:"排序",prop:"sort",type:"number",value:0},{label:"状态",prop:"status",type:"switch",value:1,dicData:J(Ke)},{label:"按钮预览",prop:"buttonPreview",width:150}]}),ze={menuBtn:!1,span:24,column:[{label:"流程名称",prop:"flowName",rules:[{required:!0,message:"请输入流程名称"}]},{label:"流程标识",prop:"flowKey",editDisabled:!0,rules:[{required:!0,message:"请输入流程标识"}]},{label:"流程分类",prop:"categoryId",type:"select",dicUrl:"/sapier-flow/flow-category/list",dicQuery:{size:-1},props:{label:"name",value:"id"}},{label:"流程图标",prop:"flowIcon",component:"icon-select"},{label:"流程描述",prop:"remarks"},{label:"自定义表单",prop:"formPath"},{label:"关联表",prop:"formDataTable",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicUrl:"/sapier-flow/dev-table/list",dicQuery:{size:-1},props:{label:"tableComment",value:"tableName",desc:"tableName",res:"data.records"}},{label:"排序",prop:"sort",type:"number",width:110},{label:"表单设计",prop:"formOption",display:!1,hide:!0},{label:"模型设计",prop:"flowData",display:!1,hide:!0}]},ma=Y({rowKey:"flowModuleId",dialogFullscreen:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuWidth:100,menuType:"menu",menuBtnTitle:"操作",column:[...ze.column.map((e,t)=>({...e,search:t<2})),{label:"流程主版本",prop:"mainVersion",formatter(e,t){return t?`V${t||""}`:""}}]}),fa=Y({rowKey:"flowDeloyId",dialogFullscreen:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuWidth:100,menuType:"menu",menuBtnTitle:"操作",column:[...ze.column,{label:"流程版本",prop:"version",formatter(e,t){return t?`V${t||""}`:""}},{label:"是否主版本",prop:"mainVersion",type:"select",dicData:[{label:"否",value:0},{label:"是",value:1}]}]}),va=Y({rowKey:"id",menu:!1,addBtn:!1,column:[{label:"流程名称",prop:"flowName"},{label:"流程标识",prop:"flowKey"},{label:"流程分类",prop:"categoryId",type:"select",search:!0,dicUrl:"/sapier-flow/flow-category/list",props:{label:"name",value:"id"}},{label:"标题",prop:"processTitle",search:!0},{label:"流水号",prop:"serialNumber"},{label:"当前节点",prop:"taskNodeName"},{label:"审批人",prop:"assigneeName"},{label:"申请人",prop:"applyUserName"},{label:"接收时间",prop:"startTime"},{label:"任务状态",prop:"status",type:"select",search:!0,searchValue:re.待办,dicUrl:"/sapier-flow/flow-param/getParam",dicQuery:{paramKey:"flow.task.status"}}]}),ba=Y({rowKey:"id",column:[{label:"配置名称",prop:"paramName",search:!0},{label:"配置Key",prop:"paramKey",search:!0},{label:"备注",prop:"remark"},{label:"系统内置",prop:"paramType",type:"switch",dicData:me},{label:"配置值",prop:"paramValue",type:"textarea",maxRows:20,span:24,overHidden:!0}]}),_a=Y({rowKey:"id",menu:!1,addBtn:!1,column:[{label:"流程名称",prop:"flowName"},{label:"流程标识",prop:"flowKey"},{label:"流程分类",prop:"categoryId",type:"select",search:!0,dicUrl:"/sapier-flow/flow-category/list",props:{label:"name",value:"id"}},{label:"标题",prop:"processTitle",search:!0},{label:"流水号",prop:"serialNumber"},{label:"当前节点",prop:"taskNodeName"},{label:"审批人",prop:"assigneeName"},{label:"申请人",prop:"applyUserName"},{label:"接收时间",prop:"startTime"}]});const ya=Y({rowKey:"id",column:[{label:"流程标识",prop:"flowKey",search:!0},{label:"流程名称",prop:"flowName",search:!0},{label:"流程备注",prop:"remarks"},{label:"排序",prop:"sort"}]}),wa=Y({rowKey:"id",column:[{label:"表单标识",prop:"formKey",search:!0},{label:"表单名称",prop:"formName",search:!0},{label:"表单备注",prop:"remarks"},{label:"排序",prop:"sort",type:"number"}]}),Ie=[{label:"字段名称",prop:"name"},{label:"字段备注",prop:"comment"},{label:"字段类型",prop:"type",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:J(ge)},{label:"字段长度",prop:"size",type:"number"},{label:"小数位",prop:"point",type:"number"},{label:"默认值",prop:"default"},{label:"是否主键",prop:"primary",type:"switch",dicData:me,value:0},{label:"是否允许为空",prop:"permitNull",type:"switch",dicData:me,value:1}],ga=Y({rowKey:"id",dialogFullscreen:!0,column:[{label:"表名",prop:"tableName",search:!0},{label:"表注释",prop:"tableComment",search:!0},{label:"表引擎",prop:"tableEngine"},{label:"表主键策略",prop:"tablePrimary",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:J(we)},{label:"数据库字段",prop:"editFields",hide:!0,type:"dynamic",children:{column:Ie}},{label:"默认字段",prop:"defaultFields",hide:!0,type:"dynamic",children:{addBtn:!1,delBtn:!1,column:Ie}}]});function Be(e){return new Promise((t,o)=>{y(e).validate((r,p,a)=>{r?(p(),t(a)):o(a)})})}function H(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}export{Rt as A,we as B,Pt as C,ge as D,Y as E,Se as F,me as G,Et as H,ca as I,pa as J,It as K,Ne as L,Kt as M,$t as N,Lt as O,ft as P,Ve as Q,bt as R,_t as S,re as T,Oe as U,yt as V,je as W,H as X,xt as _,vt as a,Be as b,W as c,Pe as d,ma as e,fa as f,ua as g,ze as h,va as i,ba as j,ce as k,_a as l,ye as m,ya as n,wa as o,ga as p,jt as q,Ae as r,zt as s,da as t,F as u,be as v,_e as w,Ke as x,Bt as y,de as z};
