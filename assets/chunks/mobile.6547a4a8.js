import{d as Ee}from"./index.dc6e423c.js";import{I as Ce}from"./iconify.924204c7.js";import{a as ue,f as Re,g as Me,w as Ge,h as Je}from"./index.63550f19.js";import{m as Qe,u as We}from"./index.f27332da.js";import{b as Ye}from"./index.1ee4f9aa.js";import"./form.814fb769.js";import"./index.100f92e3.js";import"./index.6700b933.js";import{j as He}from"./tree.15c11b5a.js";import"./vuedraggable.umd.9d85cf94.js";import"./index.es.1accc3d3.js";import{e as J}from"./index.0246ace1.js";import{u as Z}from"./index.568e6668.js";import{ab as Ie,g as j,h as B,A as ae,l as y,E as de,$ as Xe,S as Ze,Y as Fe,d as W,J as T,c as E,L as te,K as H,o as V,b as L,w as x,e as R,a as M,t as G,N as S,B as re,a3 as ge,k as q,R as Ve,_ as me,C as qe,U as et,O as xe,a5 as tt,D as at,a9 as ot,aa as lt}from"./framework.6b67ac47.js";import{p as nt}from"./pick.c38fd284.js";import{t as Te,a as st}from"./index.da343e5c.js";import{E as se}from"./index.b68c08c0.js";import{u as Ue}from"./index.386fc70b.js";import{d as rt}from"./zipWith.8642dcad.js";import{d as it}from"./data.0c1ff404.js";import{g as ne}from"./get.51c768ca.js";import{c as ut}from"./cloneDeep.6b1411dd.js";import{m as ct}from"./merge.0f542de0.js";function X(e){const{tableOption:t}=Y();return Ie({...t,...e})}function pt(e){const{buttonHandler:t,request:a}=Y(),{commitTask:s,revokeTask:v,saveDraft:p,startTask:n,terminateTask:m,transferTask:r,withdrawTask:c,rejectTask:f,greenChannel:w}=_e(a),o=j(()=>{const{flowDetail:g,formVariables:A,approvalFormData:O,debug:i,fileIds:$}=e,{flowDeployId:N}=g.value.process??{},{taskId:b,flowInstanceId:u}=g.value.task??{};return{flowDeployId:N,taskId:b,flowInstanceId:u,variables:A.value,debug:i.value,fileIds:$==null?void 0:$.value,...O.value}}),d=()=>o.value.taskId&&o.value.flowInstanceId;return{flow_draft(){if(d())return p(o.value)},flow_pass(){return d()?s(o.value):n(o.value)},flow_revoke(){if(d())return v(o.value)},flow_withdraw(){if(d())return c(o.value)},flow_terminate(){if(d())return m(o.value)},flow_transfer(){if(d())return r(o.value)},flow_reject(){if(d())return f(o.value)},flow_green(){if(d())return w(o.value)},...t==null?void 0:t(e)}}function ke(){const e=Qe();return{emitter:e,onAfterGetDetail:p=>{e.on("afterGetDetail",async(...n)=>await(p==null?void 0:p(...n)))},onBeforeClick:p=>{e.on("beforeClick",async(...n)=>await(p==null?void 0:p(...n)))},onBeforeSubmit:p=>{e.on("beforeSubmit",async(...n)=>await(p==null?void 0:p(...n)))},onAfterSubmit:p=>{e.on("afterSubmit",async(...n)=>await(p==null?void 0:p(...n)))}}}function $e(e,t){e.forEach(a=>{var v,p,n,m,r,c;const s=t==null?void 0:t.find(f=>f.prop===a.prop);s&&(a.display=s.display,a.disabled=s.disabled,a.detail=s.detail,a.readonly=s.readonly,a.rules=s.validate?a.rules??[]:[],s.required&&!((v=a.rules)!=null&&v.some(f=>f.required))?(p=a.rules)==null||p.push({required:!0,message:`${a.label}为必填项`}):s.required||(a.rules=a.rules.filter(f=>!f.required)),(m=(n=a.children)==null?void 0:n.column)!=null&&m.length&&((r=s.children)!=null&&r.length)&&$e((c=a.children)==null?void 0:c.column,s.children))})}function dt(e){const t=B({});return ae(async()=>{var s;const{formProperty:a}=((s=y(e))==null?void 0:s.properties)||{};a!=null&&a.length&&(await de(),$e(Object.values(t.value),a))}),t}const mt={modelValue:{type:Object,default:()=>({})},title:{type:String},flowDetail:{type:Object,default:()=>({})},formLoading:{type:Boolean},submitLoading:{type:Boolean},activeTab:{type:String,default:"formTab"},activeBtn:{type:Object,default:()=>({})},approvalVisible:{type:Boolean},approvalFormData:{type:Object,default:()=>({})},flowKey:{type:String},taskId:{type:String},instanceId:{type:String},formId:{type:String},fileIds:{type:String},permission:{type:Object},afterGetDetail:{type:Function},beforeClick:{type:Function},beforeSubmit:{type:Function},afterSubmit:{type:Function},detail:{type:[Boolean,String],default:!1},debug:{type:[Boolean,String],default:!1}},ft={complete:e=>e},Oe=Symbol("flowFormState");function vt(e,t){const a=ue(e,void 0,{passive:!0,deep:!0}),{flowDetail:s,modelValue:v,formLoading:p,activeTab:n,afterGetDetail:m}=a,{emitter:r}=ke(),{tabs:c,customForm:f,request:w}=Y(),o=B({}),d=j(()=>(c==null?void 0:c.filter(N=>{var k,l,D;const b=(D=(l=(k=s.value)==null?void 0:k.properties)==null?void 0:l.formProperty)==null?void 0:D.find(C=>C.prop===N.prop),u={...N,display:(b==null?void 0:b.display)??N.display};return(u==null?void 0:u.display)!==!1}).map(N=>{var u,k;let b=N.component;if(N.prop==="formTab"){const l=f==null?void 0:f[((k=(u=s==null?void 0:s.value)==null?void 0:u.process)==null?void 0:k.formPath)??""];typeof l=="function"?b=Fe(l):l&&(b=l)}return{...N,component:b}}))??[]),g=B();Q()&&Re(g,{onSwipeEnd(N,b){if(!["left","right"].includes(b))return;const u=d.value.findIndex(l=>l.prop===n.value),k=Me(u+(b==="right"?-1:1),0,d.value.length-1);n.value=d.value[k].prop}});const{getFlowDetail:A}=_e(w);ae(()=>{const{flowKey:N,taskId:b,instanceId:u}=e;!N&&!b&&!u||(p.value=!0,A({flowKey:N,taskId:b,flowInstanceId:u}).then(async k=>{var l;s.value=k.data,v.value=k.data.formData||{},await((l=m==null?void 0:m.value)==null?void 0:l.call(m)),await r.emitAsync("afterGetDetail",k.data)}).finally(()=>{p.value=!1}))});const O=j(()=>Object.entries(v.value||{}).filter(([N])=>!N.startsWith("$")).map(([N,b])=>({key:N,value:b}))),i=j(()=>e.detail===!0||e.detail==="true"),$={...a,...ke(),formData:v,formVariables:O,tabRefs:o,tabList:d,detail:i,tabsRef:g,emit:t};return Xe(Oe,$),$}function ee(){return Ze(Oe)}const he=W({__name:"button-list",emits:["click"],setup(e,{emit:t}){const{userInfo:a,request:s}=Y(),{flowDetail:v}=ee(),{data:p}=Pe(s).useList();function n(r,c){return r.map(f=>{const w=c.find(d=>d.buttonKey===f.buttonKey);return{...f,...nt(w,["display","approval","validate"])}})}const m=j(()=>{var $,N,b,u;const r=typeof a=="function"?a():a,{assignee:c,status:f}=(($=v.value)==null?void 0:$.task)||{},{createUser:w,flowInstanceId:o,status:d}=((N=v.value)==null?void 0:N.flowInstance)||{},g={false:!1,startUser:w==(r==null?void 0:r.userId),assignee:c==(r==null?void 0:r.userId),todo:f==ie.待办,done:f==ie.已办,unfinished:d===pe.未办结,finished:d===pe.已办结,started:!!o},A={true:!0,notstarted:!o},{button:O}=((b=v.value)==null?void 0:b.properties)||{};return((u=n(p.value??[],O??[]))==null?void 0:u.filter(k=>{var I;const l=(I=k.display)==null?void 0:I.split(","),D=l==null?void 0:l.every(_=>g[_]),C=l==null?void 0:l.some(_=>A[_]);return D||C}))??[]});return(r,c)=>{const f=T("el-button");return V(!0),E(H,null,te(m.value,w=>(V(),L(f,{key:w.buttonKey,type:w.buttonType,onClick:o=>t("click",w)},{default:x(()=>[w.icon?(V(),L(y(Ce),{key:0,icon:w.icon},null,8,["icon"])):R("",!0),M(" "+G(w.name),1)]),_:2},1032,["type","onClick"]))),128)}}}),bt=W({__name:"common-comments",props:{modelValue:{}},setup(e){const t=e,{modelValue:a}=ue(t),{request:s}=Y(),{batchUpdate:v,create:p,remove:n,useList:m}=St(s),r=B(!1),{activeBtn:c}=ee(),f=j(()=>{var b;return(b=c.value)==null?void 0:b.buttonKey}),{data:w,refresh:o}=m(f),d=j(()=>{var u,k,l;const b=a.value;if(b&&!((u=w.value)!=null&&u.some(D=>D.content===b))){const D=(((l=(k=w.value)==null?void 0:k[0])==null?void 0:l.sort)||1)-1;return[{content:b,sort:D},...w.value||[]]}return w.value});async function g(b){var u;await p({...b,type:(u=c.value)==null?void 0:u.buttonKey}),se.success("添加成功"),o()}async function A(b){await n(b.id),se.success("删除成功"),o()}async function O(b,u){let k=u.parent.data;k=k.map((l,D)=>({id:l.id,sort:D+1})),await v(k),se.success("修改排序成功"),o(),r.value=!1}function i(){r.value=!0}const $=B();async function N(b){var u;a.value=b.content??"",await de(),(u=$.value)==null||u.blur()}return(b,u)=>{const k=T("el-input"),l=T("el-text"),D=T("el-col"),C=T("el-button"),I=T("el-row"),_=T("el-tree"),h=T("el-popover");return V(),L(h,{visible:r.value,placement:"bottom",title:"常用意见",width:y(Q)()?"98%":"600px"},{reference:x(()=>[S(k,{ref_key:"inputRef",ref:$,modelValue:y(a),"onUpdate:modelValue":u[0]||(u[0]=P=>re(a)?a.value=P:null),type:"textarea",placeholder:"请输入意见",rows:"5",onFocus:u[1]||(u[1]=P=>r.value=!0),onBlur:u[2]||(u[2]=P=>r.value=!1)},null,8,["modelValue"])]),default:x(()=>[S(_,{data:d.value,"node-key":"content",draggable:"","allow-drop":(P,K,U)=>U!=="inner",props:{label:"content"},onNodeClick:N,onNodeDrop:O,onNodeDragStart:i},{default:x(({data:P})=>[S(I,{style:{width:"100%"}},{default:x(()=>[S(D,{span:22},{default:x(()=>[S(l,{truncated:"",title:P.content},{default:x(()=>[M(G(P.content),1)]),_:2},1032,["title"])]),_:2},1024),S(D,{span:2},{default:x(()=>[P.id?(V(),L(C,{key:0,type:"danger",size:"small",icon:"el-icon-close",text:"",onClick:ge(K=>A(P),["stop"])},null,8,["onClick"])):(V(),L(C,{key:1,type:"primary",size:"small",icon:"el-icon-plus",text:"",onClick:ge(K=>g(P),["stop"])},null,8,["onClick"]))]),_:2},1024)]),_:2},1024)]),_:1},8,["data","allow-drop"])]),_:1},8,["visible","width"])}}}),_t=W({__name:"approval-tree",props:{modelValue:{},data:{},autoCheck:{type:Boolean},mode:{}},setup(e){const t=e,{modelValue:a}=ue(t),s={element:"ep:flag",post:"ep:share",dept:"ep:share",user:"ep:user"},p={defaultExpandAll:!0,lazy:!0,showCheckbox:!0,nodeKey:"id",load:(o,d)=>{o.level===0?d(m.value):d(o.data.children??[])},onCheck:c,props:{label:"title",class(o){return`node-${o.type}`}}},n=B(),m=j(()=>Te(t.data??[],(o,d,g)=>{const A=Ue();return o.taskNodeKey=(g==null?void 0:g.taskNodeKey)??o.taskNodeKey,o.incoming=(g==null?void 0:g.incoming)??o.incoming,o.multiple=(g==null?void 0:g.multiple)??o.multiple,o.parentId=(g==null?void 0:g.id)??o.parentId,{...o,id:A}}));Ge(()=>[m.value,n.value],async()=>{if(!(!n.value||!m.value.length)&&t.autoCheck){const o=r(m.value);o&&w([o])}},{immediate:!0,debounce:100});function r(o){var d;if(o.length===1)return(d=o[0].children)!=null&&d.length?r(o[0].children):o[0]}async function c(o,{checkedNodes:d}){var O;let g=d.filter(i=>i.type==="user");const A=g.some(i=>i.id===o.id);if(m.value.every(i=>!i.multiple)&&A)g=[o];else if(!o.multiple&&A){const N=((O=n.value)==null?void 0:O.getNode(o)).parent.data.children.filter(b=>b.id!==o.id);g=rt(g,N,"id")}w(g)}function f(o){const d=a.value.filter(g=>g.id!==o.id);w(d)}function w(o){var d;a.value=o,(d=n.value)==null||d.setCheckedNodes(o)}return(o,d)=>{const g=T("el-tag"),A=T("Icon"),O=T("el-tree");return V(),E(H,null,[(V(!0),E(H,null,te(y(a),i=>(V(),L(g,{key:i.id,type:"info",closable:"",onClose:$=>f(i)},{default:x(()=>[M(G(i.title),1)]),_:2},1032,["onClose"]))),128)),S(O,Ve({ref_key:"treeRef",ref:n,class:["approval-tree",`mode-${o.mode}`],data:m.value},p),{default:x(({data:i})=>[q("div",null,[S(A,{icon:s[i.type]||s.element,style:{display:"inline-block"}},null,8,["icon"]),q("span",null,G(i.title),1)])]),_:1},16,["class","data"])],64)}}});const Ne=me(_t,[["__scopeId","data-v-9646bed9"]]),yt={key:0,class:"flow-viewer"},wt={key:0,class:"flow-status-legend"},gt={class:"legend-text"},kt=W({__name:"index",props:{modelValue:{},view:{type:Boolean},flowFormOption:{},flowHistory:{},showLegend:{type:Boolean}},emits:["update:modelValue","nodeClick"],setup(e,{emit:t}){const a=e,s=qe();Je(s,()=>{var l;(l=s.value)==null||l.on("node:click",D=>t("nodeClick",D))});const v=j({get(){let l=it();return typeof a.modelValue=="string"&&a.modelValue?l=JSON.parse(a.modelValue):typeof a.modelValue=="object"&&Object.keys(a.modelValue)&&(l=a.modelValue),l},set(l){t("update:modelValue",JSON.stringify(l))}}),p=j(()=>{const{column:l=[],group:D=[]}=JSON.parse(a.flowFormOption||"{}");return[...l,...D.map(I=>I.column??[]).flat()]}),{FlowDesign:n,tabs:m,request:r}=Y(),c=j(()=>(m==null?void 0:m.map(l=>({...l,display:l.display??!0})))??[]),f=j(()=>!a.view),{data:w}=Pe(r).useList({ready:f}),{useUserTree:o}=jt(r),{data:d}=o({ready:f}),{data:g}=o({ready:f,defaultParams:["dept"]}),{data:A}=o({ready:f,defaultParams:["post"]}),{useParam:O}=be(r),{data:i}=O("flow.trends.user");function $(l){return Te(l,D=>({...D,label:D.title,value:D.id}))}const N=j(()=>({formPropertyList:[...p.value,...c.value],buttonList:w.value,fieldsDic:p.value.map(l=>({label:l.label,value:`\${${l.prop}}`,desc:`\${${l.prop}}`})),flowButtonDisplayDic:J(fe),flowButtonApprovalDic:J(ve),flowButtonValidateDic:oe.map(l=>({...l,label:""})),flowAssigneeUserDic:$(d.value??[]),flowAssigneeDeptDic:$(g.value??[]),flowAssigneePostDic:$(A.value??[]),flowAssigneeDynamicDic:i.value})),{data:b}=O("flow.task.status"),u=j(()=>{var l;return(l=a.flowHistory)==null?void 0:l.map(D=>{var I,_;const C=(_=(I=b.value)==null?void 0:I.find(h=>h.value===D.status))==null?void 0:_.style;return{id:D.taskNodeKey,style:C}})}),k=j(()=>{var l,D;return(D=(l=a.flowHistory)==null?void 0:l.filter(C=>C.taskNodeType==="userTask"))==null?void 0:D.map(C=>{var I;return{id:C.taskNodeKey,content:`<div>${C.assigneeName}</div>
        <div>${C.endTime??""}</div>
        <div>${((I=C.comment)==null?void 0:I.handleComment)??""}</div>`}})});return(l,D)=>l.view?(V(),E("div",yt,[l.showLegend!==!1?(V(),E("div",wt,[(V(!0),E(H,null,te(y(b),C=>{var I;return V(),E("div",{key:C.label,class:"legend-item"},[q("div",{class:"legend-color",style:et({backgroundColor:(I=C.style)==null?void 0:I.fill})},null,4),q("span",gt,G(C.label),1)])}),128))])):R("",!0),S(y(n),{lf:s.value,"onUpdate:lf":D[0]||(D[0]=C=>s.value=C),"model-value":v.value,styles:u.value,tooltips:k.value,type:"viewer"},null,8,["lf","model-value","styles","tooltips"])])):(V(),L(y(n),{key:1,modelValue:v.value,"onUpdate:modelValue":D[1]||(D[1]=C=>v.value=C),"form-options":y(Ye),"data-options":N.value,"form-width":"30%"},null,8,["modelValue","form-options","data-options"]))}});const Le=me(kt,[["__scopeId","data-v-7f223fe3"]]),ht=W({__name:"node-select",props:{modelValue:{}},setup(e){const t=e,{modelValue:a}=ue(t),{flowDetail:s}=ee(),v=B(!1);function p({data:n}){n.type==="userTask"&&(v.value=!1,a.value=n.id)}return(n,m)=>{const r=T("el-button"),c=T("el-popover");return V(),L(c,{visible:v.value,"onUpdate:visible":m[0]||(m[0]=f=>v.value=f),placement:"bottom-start",width:"800px",trigger:"click"},{reference:x(()=>[S(r,null,{default:x(()=>[M(" 点击选择节点 ")]),_:1})]),default:x(()=>{var f,w;return[S(Le,{"model-value":(w=(f=y(s))==null?void 0:f.process)==null?void 0:w.flowData,view:"",style:{height:"600px"},onNodeClick:p},null,8,["model-value"])]}),_:1},8,["visible"])}}}),Nt=W({__name:"approval-form",emits:["submit"],setup(e,{emit:t}){const{request:a}=Y(),{getApprovalNode:s}=_e(a),{useParam:v}=be(a),{formData:p,approvalFormData:n,activeBtn:m,approvalVisible:r,formVariables:c,flowDetail:f}=ee(),w=B([]),o=B([]),d=B([]),g=B([]),A=B(!1),O=B(!1),i=B(),$=j(()=>{const I=w.value.length,_=d.value.length&&!w.value.length;return{menuBtn:!1,labelWidth:"auto",span:24,column:[{label:"指定节点",prop:"jumpTaskNodeKey",display:N("specifyNode"),rules:[{required:!0,message:"请选择指定节点"}]},{label:"审批人",prop:"assignee",display:N("assignee"),rules:I?[{required:!0,validator:b}]:[]},{label:"传阅人",prop:"circulate",display:N("circulate"),rules:_?[{required:!0,message:"请选择传阅人"}]:[]},{label:"意见",prop:"comment",display:N("comment"),rules:[{required:!0,message:"请填写意见"}]}]}});function N(I){var _,h;return(h=(_=m.value)==null?void 0:_.approval)==null?void 0:h.includes(I)}function b(I,_,h){var U,F,le;const P=((U=w.value[0])==null?void 0:U.type)==="parallelGateway",K=(le=(F=w.value[0])==null?void 0:F.children)==null?void 0:le.every(z=>st([z],ce=>o.value.some(ze=>ze.id===ce.id)));if(o.value.length){if(P&&!K)return h("请在每个节点选择审批人")}else return h("请选择审批人");return!0}const{data:u}=v("flow.approval.autocheck"),{data:k}=v("flow.approval.autocomment");ae(async()=>{!r.value||!i.value||(de(()=>{i.value.resetForm(),n.value.comment=p.value.comment||k.value==="true"&&m.value.name||""}),l())}),ae(async()=>{var I,_;if(N("assignee")&&!(N("specifyNode")&&!n.value.jumpTaskNodeKey)){l();try{O.value=!0;const{taskId:h}=((I=f.value)==null?void 0:I.task)||{},{flowKey:P}=((_=f.value)==null?void 0:_.process)||{},K=await s({flowKey:P,taskId:h,variables:c.value,buttonType:m.value.buttonKey,jumpTaskNodeKey:n.value.jumpTaskNodeKey});w.value=K.data.approvalNodeList,d.value=K.data.circulateNodeList}finally{O.value=!1}}});function l(){w.value=[],o.value=[],d.value=[],g.value=[]}async function D(){await Be(i),A.value=!0;const{data:I,outgoing:_}=C(o.value),{data:h}=C(g.value);n.value.assignee=I,n.value.circulate=h,n.value.outgoing=[..._],t("submit")}function C(I){const _={},h={},P=new Set;return I.forEach(K=>{const{taskNodeKey:U,incoming:F}=K;_[U]||(_[U]=new Set),K.userId&&_[U].add(K.userId),h[U]=[..._[U]].join(","),F&&P.add(F)}),{dataSet:_,data:h,outgoing:P}}return(I,_)=>{const h=T("el-skeleton"),P=T("avue-form"),K=T("el-button");return V(),L(xe(y(Q)()?"el-drawer":"el-dialog"),{modelValue:y(r),"onUpdate:modelValue":_[6]||(_[6]=U=>re(r)?r.value=U:null),class:"approval-form-overlay",title:y(m).name,"append-to-body":"",width:"900px",size:"50%",direction:"btt","destroy-on-close":""},{footer:x(()=>[S(K,{onClick:_[5]||(_[5]=U=>r.value=!1)},{default:x(()=>[M(" 取 消 ")]),_:1}),S(K,{type:"primary",onClick:D},{default:x(()=>[M(" 确 定 ")]),_:1})]),default:x(()=>[S(P,{ref_key:"formRef",ref:i,modelValue:y(n),"onUpdate:modelValue":_[4]||(_[4]=U=>re(n)?n.value=U:null),class:"approval-form",option:$.value},{jumpTaskNodeKey:x(()=>[S(ht,{modelValue:y(n).jumpTaskNodeKey,"onUpdate:modelValue":_[0]||(_[0]=U=>y(n).jumpTaskNodeKey=U)},null,8,["modelValue"])]),assignee:x(()=>[O.value?(V(),L(h,{key:0})):(V(),L(Ne,{key:"AssigneeTree",modelValue:o.value,"onUpdate:modelValue":_[1]||(_[1]=U=>o.value=U),data:w.value,"auto-check":y(u)==="true",mode:y(Q)()?"vertical":"horizontal"},null,8,["modelValue","data","auto-check","mode"]))]),circulate:x(()=>[O.value?(V(),L(h,{key:0})):(V(),L(Ne,{key:"CirculateTree",modelValue:g.value,"onUpdate:modelValue":_[2]||(_[2]=U=>g.value=U),data:d.value,mode:y(Q)()?"vertical":"horizontal"},null,8,["modelValue","data","mode"]))]),comment:x(()=>[S(bt,{modelValue:y(n).comment,"onUpdate:modelValue":_[3]||(_[3]=U=>y(n).comment=U)},null,8,["modelValue"])]),_:1},8,["modelValue","option"])]),_:1},8,["modelValue","title"])}}});const Dt={class:"flow-form__title"},Ct=W({__name:"index",props:mt,emits:ft,setup(e,{emit:t}){const s=vt(e,t),{ApprovalForm:v,tabsProps:p}=Y(),n=v??Nt,{title:m,detail:r,flowDetail:c,tabRefs:f,tabList:w,activeTab:o,activeBtn:d,formLoading:g,approvalVisible:A,submitLoading:O,beforeClick:i,beforeSubmit:$,afterSubmit:N,tabsRef:b,emitter:u}=s;async function k(C){var I,_;if(d.value=C,C.validate===1)for(const h of Object.values(f.value))await((I=h==null?void 0:h.validate)==null?void 0:I.call(h));await((_=i==null?void 0:i.value)==null?void 0:_.call(i,C)),await u.emitAsync("beforeClick",C),(C==null?void 0:C.approval)!=="false"?A.value=!0:D()}const l=pt(s);async function D(){var C,I;try{O.value=!0,await((C=$==null?void 0:$.value)==null?void 0:C.call($,d.value)),await u.emitAsync("beforeSubmit",d.value);const{buttonKey:_}=d.value,h=l[_];if(!h){se.error("无法找到相应的操作");return}await(h==null?void 0:h()),await((I=N==null?void 0:N.value)==null?void 0:I.call(N,d.value)),await u.emitAsync("afterSubmit",d.value),A.value=!1,t("complete",d.value)}finally{O.value=!1}}return(C,I)=>{const _=T("el-skeleton"),h=T("el-main"),P=T("el-header"),K=T("el-tab-pane"),U=T("el-tabs"),F=T("el-footer"),le=T("el-container");return y(g)?(V(),L(h,{key:0},{default:x(()=>[S(_)]),_:1})):(V(),L(le,{key:1,class:"flow-form"},{default:x(()=>[S(P,{class:"flow-form__header",height:"auto"},{default:x(()=>{var z;return[q("div",Dt,G(y(m)??((z=y(c).flowInstance)==null?void 0:z.title)),1),!y(r)&&!y(Q)()?(V(),L(he,{key:0,onClick:k})):R("",!0)]}),_:1}),S(h,{class:"flow-form__main"},{default:x(()=>[S(U,Ve({ref_key:"tabsRef",ref:b,modelValue:y(o),"onUpdate:modelValue":I[0]||(I[0]=z=>re(o)?o.value=z:null)},y(p)),{default:x(()=>[(V(!0),E(H,null,te(y(w),z=>(V(),L(K,{key:z.prop,label:z.label,name:z.prop,lazy:z.lazy,disabled:z.disabled,closable:z.closable},{default:x(()=>[(V(),L(xe(z.component),{ref_for:!0,ref:ce=>y(f)[z.prop]=ce},null,512))]),_:2},1032,["label","name","lazy","disabled","closable"]))),128))]),_:1},16,["modelValue"])]),_:1}),!y(r)&&y(Q)()?(V(),L(F,{key:0,class:"flow-form__footer",height:"auto"},{default:x(()=>[S(he,{onClick:k})]),_:1})):R("",!0),S(y(n),{onSubmit:D})]),_:1}))}}});const It=W({setup(){const{flowDetail:e,formData:t,detail:a}=ee(),s=dt(e.value),{proxy:v}=at(),p=B({});ae(()=>{const{formOption:r}=e.value.process??{};p.value=He.bind(v)(r||'{"menuBtn":false}'),p.value.detail=!!a.value});const n=B();function m(){return Be(n)}return{form:t,option:p,defaults:s,formRef:n,validate:m}},render(){return tt(T("avue-form"),{ref:"formRef",modelValue:this.form,defaults:this.defaults,option:this.option,class:this.option.class,"onUpdate:modelValue":e=>this.form=e,"onUpdate:defaults":e=>this.defaults=e})}}),Vt=W({__name:"upload-table",setup(e){const{flowDetail:t,fileIds:a,detail:s}=ee(),{upload:{action:v,headers:p,preview:n,download:m,props:r}={},request:c}=Y(),f=typeof p=="function"?p():p,w=j(()=>{var k,l;return((l=(k=t.value)==null?void 0:k.task)==null?void 0:l.flowInstanceId)??Ue()}),o=[{label:"文件名",prop:"fileName"},{label:"文件类型",prop:"fileType"},{label:"文件大小",prop:"fileSize"},{label:"版本",prop:"version"},{label:"上传时间",prop:"createTime"}],d=o.filter(k=>k.prop==="fileName"),g={rowKey:"id",align:"center",index:!1,border:!0,stripe:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuType:"menu",menuBtnTitle:"操作",column:Q()?d:o},{bindVal:A,getDataList:O,handleDel:i,handleSave:$,afterGetList:N,crudStateRefs:{tableData:b}}=We({crudOption:{...Pt(c),saveSuccessMsg:"上传成功"},tableOption:g,queryForm:{isLatest:1,flowInstanceId:w.value}});N(()=>{a.value=b.value.map(k=>k.id).join(",")}),O();async function u(k,l){var K,U;const{fileName:D,fileType:C,fileSize:I,fileUrl:_,res:h}=r,P={fileName:ne({res:k},`${h}.${D}`),fileType:ne({res:k},`${h}.${C}`),fileSize:ne({res:k},`${h}.${I}`),fileUrl:ne({res:k},`${h}.${_}`),taskId:(U=(K=t.value)==null?void 0:K.task)==null?void 0:U.taskId,flowInstanceId:w.value,rootMark:(l==null?void 0:l.rootMark)||"",version:typeof(l==null?void 0:l.version)=="number"?l.version+1:1};await $(P,O,()=>{})}return(k,l)=>{const D=T("el-button"),C=T("el-upload"),I=T("el-dropdown-item"),_=T("avue-crud");return V(),L(_,ot(lt(y(A))),{"menu-left":x(()=>[y(s)?R("",!0):(V(),L(C,{key:0,action:y(v),headers:y(f),"show-file-list":!1,onSuccess:l[0]||(l[0]=h=>u(h))},{default:x(()=>[S(D,{type:"primary",icon:"el-icon-upload"},{default:x(()=>[M(" 点击上传 ")]),_:1})]),_:1},8,["action","headers"]))]),"menu-btn":x(({row:h,index:P})=>[S(I,{icon:"el-icon-view",onClick:K=>{var U;return(U=y(n))==null?void 0:U(h,y(b))}},{default:x(()=>[M(" 预览 ")]),_:2},1032,["onClick"]),S(I,{icon:"el-icon-download",onClick:K=>{var U;return(U=y(m))==null?void 0:U(h,y(b))}},{default:x(()=>[M(" 下载 ")]),_:2},1032,["onClick"]),y(s)?R("",!0):(V(),L(I,{key:0,icon:"el-icon-upload"},{default:x(()=>[S(C,{action:y(v),headers:y(f),"show-file-list":!1,onSuccess:K=>u(K,h)},{default:x(()=>[M(" 更新版本 ")]),_:2},1032,["action","headers","onSuccess"])]),_:2},1024)),y(s)?R("",!0):(V(),L(I,{key:1,icon:"el-icon-delete",onClick:K=>y(i)(h,P)},{default:x(()=>[M(" 删除 ")]),_:2},1032,["onClick"]))]),_:1},16)}}}),xt={class:"flow-track"},Tt={key:0},Ut={key:1},$t=W({__name:"flow-track",setup(e){const{flowDetail:t}=ee(),a=B(Q()?"timeline":"table"),s=[{label:"table",icon:"ep:grid"},{label:"graph",icon:"ep:picture"},{label:"timeline",icon:"ep:finished"}],v=j(()=>{var c,f,w;return((w=(f=(c=t.value)==null?void 0:c.flowHistory)==null?void 0:f.filter(o=>o.taskNodeType==="userTask"))==null?void 0:w.map(o=>({...o,duration:Ee(o.duration)})))??[]}),p={addBtn:!1,menu:!1,border:!0,column:[{label:"节点名称",prop:"taskNodeName"},{label:"处理人",prop:"assigneeName"},{label:"接收时间",prop:"startTime"},{label:"处理时间",prop:"endTime"},{label:"办理时长",prop:"duration"},{label:"操作类型",prop:"type",dicUrl:"/sapier-flow/flow-param/getParam",dicQuery:{paramKey:"flow.handle.type"}},{label:"办理意见",prop:"comment",bind:"comment.handleComment"}]},{request:n}=Y(),{data:m}=be(n).useParam("flow.handle.type");function r(c){var f;return(f=m.value)==null?void 0:f.find(w=>w.value===c)}return(c,f)=>{var $,N,b;const w=T("el-radio-button"),o=T("el-radio-group"),d=T("avue-crud"),g=T("el-card"),A=T("el-timeline-item"),O=T("el-timeline"),i=T("el-empty");return V(),E(H,null,[y(Q)()?R("",!0):(V(),L(o,{key:0,modelValue:a.value,"onUpdate:modelValue":f[0]||(f[0]=u=>a.value=u)},{default:x(()=>[(V(),E(H,null,te(s,u=>S(w,{key:u.label,label:u.label},{default:x(()=>[S(y(Ce),{icon:u.icon},null,8,["icon"])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])),q("div",xt,[a.value==="table"?(V(),L(d,{key:0,data:v.value,option:p},null,8,["data"])):R("",!0),a.value==="graph"?(V(),L(Le,{key:1,"model-value":(N=($=y(t))==null?void 0:$.process)==null?void 0:N.flowData,"flow-history":(b=y(t))==null?void 0:b.flowHistory,view:"","show-legend":""},null,8,["model-value","flow-history"])):R("",!0),a.value==="timeline"?(V(),E(H,{key:2},[v.value.length?(V(),L(O,{key:0},{default:x(()=>[(V(!0),E(H,null,te([...v.value].reverse(),u=>(V(),L(A,{key:u.id,timestamp:u.endTime,placement:"top"},{default:x(()=>[S(g,null,{default:x(()=>{var k,l,D;return[q("div",null,G(u.assigneeName)+" 开始处理 ["+G(u.taskNodeName)+"] 环节 ",1),u.duration?(V(),E("div",Tt," 办理时长："+G(u.duration),1)):R("",!0),u.type&&((k=u.comment)!=null&&k.handleComment)?(V(),E("div",Ut,G((l=r(u.type))==null?void 0:l.label)+"意见："+G((D=u.comment)==null?void 0:D.handleComment),1)):R("",!0)]}),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:1})):(V(),L(i,{key:1}))],64)):R("",!0)])],64)}}});const Ot=me($t,[["__scopeId","data-v-b788684b"]]),Lt={FlowDesign:{},FormDesign:{},FlowForm:Ct,request:{},tabs:[{label:"审批表单",prop:"formTab",component:It},{label:"附件资料",prop:"fileTab",component:Vt},{label:"流程跟踪",prop:"trackTab",component:Ot}],useFlowFormOptions:{type:"drawer",window:["","flow-form","left=0,top=0,width=1600,height=900"],overlay:{width:"80%",size:"80%",top:"100px",fullscreen:!0,destroyOnClose:!0}},tableOption:{align:"center",border:!0,card:!0,stripe:!0,searchMenuSpan:6,span:24},upload:{props:{fileName:"fileOriginalName",fileType:"fileType",fileSize:"fileSize",fileUrl:"fileUrl",res:"res.data"}}};function St(e){const t={list:"/sapier-flow/flow-user-common/list",save:"/sapier-flow/flow-user-common/save",update:"/sapier-flow/flow-user-common/update",remove:"/sapier-flow/flow-user-common/remove",batchUpdate:"/sapier-flow/flow-user-common/batchUpdate"},a=r=>e.get(t.list,{params:{type:r,ascs:"sort"}});return{url:t,getList:a,useList:r=>Z(()=>a(r.value),{res:"data.records",modify:!1,refreshDeps:[r]}),create:r=>e.post(t.save,r),update:r=>e.post(t.update,r),remove:r=>e.post(t.remove,{},{params:{ids:r}}),batchUpdate:r=>e.post(t.batchUpdate,r)}}var Se=(e=>(e.默认="default",e.主要="primary",e.成功="success",e.警告="warning",e.危险="danger",e.信息="info",e.文字="text",e))(Se||{}),At=(e=>(e.保存草稿="flow_draft",e.发送="flow_pass",e.退回="flow_reject",e.终止="flow_terminate",e.撤销="flow_revoke",e.撤回到发起="flow_withdraw",e.打印="flow_print",e.转办="flow_transfer",e.加签="flow_add_instance",e.减签="flow_del_instance",e.指定回退="flow_rollback",e.绿色通道="flow_green",e))(At||{}),fe=(e=>(e.显示="true",e.隐藏="false",e.发起人="startUser",e.处理人="assignee",e.已办="done",e.待办="todo",e.已办结="finished",e.未办结="unfinished",e.已发起="started",e.未发起="notstarted",e))(fe||{}),ve=(e=>(e.不显示="false",e.指定节点="specifyNode",e.审批人="assignee",e.传阅人="circulate",e.意见="comment",e))(ve||{}),Ae=(e=>(e[e.禁用=0]="禁用",e[e.正常=1]="正常",e))(Ae||{});function Pe(e){const t={list:"/sapier-flow/dev-button/list",save:"/sapier-flow/dev-button/save",update:"/sapier-flow/dev-button/update",remove:"/sapier-flow/dev-button/remove"},a=m=>e.get(t.list,{params:m}),s=Z(a,{res:"data.records",defaultParams:[{size:-1,ascs:"sort",status:1}]});return{url:t,getList:a,useList:s,create:m=>e.post(t.save,m),update:m=>e.post(t.update,m),remove:m=>e.post(t.remove,{},{params:{ids:m}})}}function Pt(e){const t={list:"/sapier-flow/flow-file/list",save:"/sapier-flow/flow-file/save",remove:"/sapier-flow/flow-file/remove"},a=n=>e.get(t.list,{params:n}),s=Z(a,{res:"data"});return{getList:a,useList:s,create:n=>e.post(t.save,n),remove:n=>e.post(t.remove,{},{params:{ids:n}})}}function be(e){const t={list:"/sapier-flow/flow-param/list",save:"/sapier-flow/flow-param/save",update:"/sapier-flow/flow-param/update",remove:"/sapier-flow/flow-param/remove",all:"/sapier-flow/flow-param/getAllParam",key:"/sapier-flow/flow-param/getParam"},a=c=>e.get(t.list,{params:c}),s=()=>e.get(t.all),v=c=>e.get(t.key,{params:{paramKey:c}});return{url:t,getList:a,getAllParam:s,getParam:v,useParam:c=>Z(v,{res:"data",modify:!1,defaultParams:[c]}),create:c=>e.post(t.save,c),update:c=>e.post(t.update,c),remove:c=>e.post(t.remove,{},{params:{ids:c}})}}var ie=(e=>(e[e.已办=1]="已办",e[e.待办=2]="待办",e[e.失败=3]="失败",e[e.撤销=4]="撤销",e[e.终止=5]="终止",e))(ie||{}),pe=(e=>(e[e.已办结=1]="已办结",e[e.未办结=2]="未办结",e[e.已终止=3]="已终止",e))(pe||{}),Kt=(e=>(e[e.系统执行=1]="系统执行",e[e.用户办理=2]="用户办理",e[e.任务撤销=3]="任务撤销",e[e.任务退回=4]="任务退回",e[e.流程终止=5]="流程终止",e[e.任务转办=6]="任务转办",e[e.绿色通道=7]="绿色通道",e))(Kt||{});function _e(e){const t={publishList:"/sapier-flow/flow-run/queryPublishFlowList",taskList:"/sapier-flow/flow-run/userTaskList",detail:"/sapier-flow/flow-run/queryPublishFlowDetail",approvalNode:"/sapier-flow/flow-run/queryApprovalNode",start:"/sapier-flow/flow-run/startProcess",commit:"/sapier-flow/flow-run/commitTask",draft:"/sapier-flow/flow-run/saveDraft",revoke:"/sapier-flow/flow-run/revokeTask",terminate:"/sapier-flow/flow-run/terminateFlow",withdraw:"/sapier-flow/flow-run/withdrawToStart",transfer:"/sapier-flow/flow-run/transferTask",reject:"/sapier-flow/flow-run/rollbackTask",green:"/sapier-flow/flow-run/greenTask"},a=i=>e.get(t.detail,{params:i}),s=i=>e.post(t.approvalNode,i),v=i=>e.post(t.start,i),p=i=>e.post(t.commit,i),n=i=>e.post(t.draft,i),m=i=>e.post(t.revoke,i),r=i=>e.post(t.terminate,i),c=i=>e.post(t.withdraw,i),f=i=>e.post(t.transfer,i),w=i=>e.post(t.reject,i),o=i=>e.post(t.green,i),d=i=>e.get(t.publishList,{params:i}),g=Z(d,{res:"data",defaultParams:[{ascs:"sort"}]}),A=i=>e.get(t.taskList,{params:i}),O=Z(A,{res:"data.records"});return{url:t,getFlowDetail:a,getApprovalNode:s,startTask:v,commitTask:p,saveDraft:n,revokeTask:m,terminateTask:r,withdrawTask:c,transferTask:f,rejectTask:w,greenChannel:o,getPublishList:d,usePublishList:g,getTaskList:A,useTaskList:O}}function jt(e){const t={tree:"/sapier-flow/flow-user/tree"},a=v=>e.get(t.tree,{params:{filter:v}}),s=Z(a,{res:"data"});return{url:t,getUserTree:a,useUserTree:s}}var ye=(e=>(e.ASSIGN_ID="ASSIGN_ID",e.ASSIGN_UUID="ASSIGN_UUID",e.AUTO="AUTO",e.INPUT="INPUT",e.NONE="NONE",e))(ye||{}),we=(e=>(e.bigint="bigint",e.blob="blob",e.char="char",e.date="date",e.datetime="datetime",e.decimal="decimal",e.double="double",e.enum="enum",e.float="float",e.int="int",e.longblob="longblob",e.longtext="longtext",e.mediumblob="mediumblob",e.mediumint="mediumint",e.mediumtext="mediumtext",e.set="set",e.smallint="smallint",e.text="text",e.time="time",e.timestamp="timestamp",e.tinyblob="tinyblob",e.tinyint="tinyint",e.tinytext="tinytext",e.varbinary="varbinary",e.varchar="varchar",e.year="year",e))(we||{});function ua(e){const t={list:"/sapier-flow/dev-table/list",save:"/sapier-flow/dev-table/save",update:"/sapier-flow/dev-table/update",remove:"/sapier-flow/dev-table/remove",deploy:"/sapier-flow/dev-table/deploy",getFields:"/sapier-flow/dev-table/getTableFields"},a=c=>e.get(t.list,{params:c}),s=Z(a,{res:"data.records",defaultParams:[{size:-1}]});return{url:t,getList:a,useList:s,create:c=>e.post(t.save,c),update:c=>e.post(t.update,c),remove:c=>e.post(t.remove,{},{params:{ids:c}}),deploy:c=>e.post(t.deploy,c),getFields:c=>e.get(t.getFields,{params:c})}}var Ke=(e=>(e[e.否=0]="否",e[e.是=1]="是",e))(Ke||{});const oe=J(Ke),ca=J(we),pa=J(ye),Bt=Ie(ut(Lt));function Y(e){return ct(Bt,e)}const da=X({rowKey:"id",labelWidth:150,column:[{label:"按钮名称",prop:"name",search:!0},{label:"按钮标识",prop:"buttonKey",search:!0},{label:"按钮图标",prop:"icon",component:"icon-select"},{label:"按钮类型",prop:"buttonType",type:"select",dicData:J(Se)},{label:"默认显示条件",prop:"display",type:"select",multiple:!0,dataType:"string",value:"false",dicData:J(fe),tip:"选择多个时,所有条件都满足才显示",labelTip:`显示: 始终显示，或运算条件;<br/>隐藏: 始终隐藏，与运算条件;<br/>
      发起人: 用户为发起人时显示，与运算条件;<br/>处理人: 用户为处理人时显示，与运算条件;<br/>
      已办: 任务状态为已办时显示，与运算条件;<br/>待办: 任务状态为待办时显示，与运算条件;<br/>
      已办结: 流程已办结时显示，与运算条件;<br/>未办结: 流程未办结时显示，与运算条件;<br/>
      已发起: 流程已发起时显示，与运算条件;<br/>未发起: 流程未发起时显示，或运算条件;`},{label:"默认审批窗口显示",prop:"approval",type:"select",multiple:!0,dataType:"string",value:"false",dicData:J(ve),labelTip:`不显示: 不显示审批窗口;<br/>指定节点: 显示指定节点选择框(常用于绿色通道等);<br/>
      审批人: 显示审批人选择框;<br/>传阅人: 显示传阅人选择框;<br/>意见: 显示意见输入框;`},{label:"默认是否校验",prop:"validate",type:"switch",value:1,dicData:oe,labelTip:"是: 点击按钮时先执行每个tab的校验;<br/>否: 点击按钮不执行校验;"},{label:"备注",prop:"remarks",overHidden:!0},{label:"排序",prop:"sort",type:"number",value:0},{label:"状态",prop:"status",type:"switch",value:1,dicData:J(Ae)},{label:"按钮预览",prop:"buttonPreview",width:150}]}),je={menuBtn:!1,span:24,column:[{label:"流程名称",prop:"flowName",rules:[{required:!0,message:"请输入流程名称"}]},{label:"流程标识",prop:"flowKey",editDisabled:!0,rules:[{required:!0,message:"请输入流程标识"}]},{label:"流程分类",prop:"categoryId",type:"select",dicUrl:"/sapier-flow/flow-category/list",dicQuery:{size:-1,ascs:"sort"},props:{label:"name",value:"id"}},{label:"流程图标",prop:"flowIcon",component:"icon-select"},{label:"流程描述",prop:"remarks"},{label:"自定义表单",prop:"formPath"},{label:"关联表",prop:"formDataTable",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicUrl:"/sapier-flow/dev-table/list",dicQuery:{size:-1},props:{label:"tableComment",value:"tableName",desc:"tableName",res:"data.records"}},{label:"排序",prop:"sort",type:"number",width:110},{label:"表单设计",prop:"formOption",display:!1,hide:!0},{label:"模型设计",prop:"flowData",display:!1,hide:!0}]},ma=X({rowKey:"flowModuleId",dialogFullscreen:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuWidth:100,menuType:"menu",menuBtnTitle:"操作",column:[...je.column.map((e,t)=>({...e,search:t<2})),{label:"流程主版本",prop:"mainVersion",formatter(e,t){return t?`V${t||""}`:""}}]}),fa=X({rowKey:"flowDeloyId",dialogFullscreen:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuWidth:100,menuType:"menu",menuBtnTitle:"操作",column:[...je.column,{prop:"sort",hide:!0},{label:"流程版本",prop:"version",formatter(e,t){return t?`V${t||""}`:""}},{label:"是否主版本",prop:"mainVersion",type:"select",dicData:[{label:"否",value:0},{label:"是",value:1}]}]}),va=X({rowKey:"id",menu:!1,addBtn:!1,column:[{label:"流程名称",prop:"flowName"},{label:"流程标识",prop:"flowKey"},{label:"流程分类",prop:"categoryId",type:"select",search:!0,dicUrl:"/sapier-flow/flow-category/list",props:{label:"name",value:"id"}},{label:"标题",prop:"processTitle",search:!0},{label:"流水号",prop:"serialNumber"},{label:"当前节点",prop:"taskNodeName"},{label:"审批人",prop:"assigneeName"},{label:"申请人",prop:"applyUserName"},{label:"接收时间",prop:"startTime"},{label:"任务状态",prop:"status",type:"select",search:!0,searchValue:ie.待办,dicUrl:"/sapier-flow/flow-param/getParam",dicQuery:{paramKey:"flow.task.status"}}]}),ba=X({rowKey:"id",column:[{label:"配置名称",prop:"paramName",search:!0},{label:"配置Key",prop:"paramKey",search:!0},{label:"备注",prop:"remark"},{label:"系统内置",prop:"paramType",type:"switch",dicData:oe},{label:"配置值",prop:"paramValue",type:"textarea",maxRows:20,span:24,overHidden:!0}]}),_a=X({rowKey:"id",menu:!1,addBtn:!1,column:[{label:"流程名称",prop:"flowName"},{label:"流程标识",prop:"flowKey"},{label:"流程分类",prop:"categoryId",type:"select",search:!0,dicUrl:"/sapier-flow/flow-category/list",props:{label:"name",value:"id"}},{label:"标题",prop:"processTitle",search:!0},{label:"流水号",prop:"serialNumber"},{label:"当前节点",prop:"taskNodeName"},{label:"审批人",prop:"assigneeName"},{label:"申请人",prop:"applyUserName"},{label:"接收时间",prop:"startTime"}]});const ya=X({rowKey:"id",column:[{label:"流程标识",prop:"flowKey",search:!0},{label:"流程名称",prop:"flowName",search:!0},{label:"流程备注",prop:"remarks"},{label:"排序",prop:"sort"}]}),wa=X({rowKey:"id",column:[{label:"表单标识",prop:"formKey",search:!0},{label:"表单名称",prop:"formName",search:!0},{label:"表单备注",prop:"remarks"},{label:"排序",prop:"sort",type:"number"}]}),De=[{label:"字段名称",prop:"name"},{label:"字段备注",prop:"comment"},{label:"字段类型",prop:"type",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:J(we)},{label:"字段长度",prop:"size",type:"number"},{label:"小数位",prop:"point",type:"number"},{label:"默认值",prop:"default"},{label:"是否主键",prop:"primary",type:"switch",dicData:oe,value:0},{label:"是否允许为空",prop:"permitNull",type:"switch",dicData:oe,value:1}],ga=X({rowKey:"id",dialogFullscreen:!0,column:[{label:"表名",prop:"tableName",search:!0},{label:"表注释",prop:"tableComment",search:!0},{label:"表引擎",prop:"tableEngine"},{label:"表主键策略",prop:"tablePrimary",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:J(ye)},{label:"数据库字段",prop:"editFields",hide:!0,type:"dynamic",children:{column:De}},{label:"默认字段",prop:"defaultFields",hide:!0,type:"dynamic",children:{addBtn:!1,delBtn:!1,column:De}}]});function Be(e){return new Promise((t,a)=>{y(e).validate((v,p,n)=>{v?(p(),t(n)):a(n)})})}function Q(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}export{jt as A,ye as B,Lt as C,we as D,X as E,Le as F,oe as G,Kt as H,ca as I,pa as J,Nt as K,he as L,Ot as M,It as N,Vt as O,pt as P,ke as Q,$e as R,mt as S,ie as T,ft as U,Oe as V,Ke as W,vt as X,Q as Y,Ct as _,dt as a,Be as b,Y as c,Pe as d,ma as e,fa as f,ua as g,je as h,va as i,ba as j,be as k,_e as l,_a as m,ya as n,wa as o,ga as p,St as q,Se as r,At as s,da as t,ee as u,fe as v,ve as w,Ae as x,Pt as y,pe as z};
