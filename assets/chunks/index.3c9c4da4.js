import{g as A,h as L,z as F,$ as Ve,S as we,d as I,J as V,o as D,b as E,c as M,N as g,w as x,K as B,a as J,l as b,B as Q,L as N,k as H,t as ee,A as ke,R as ce,a3 as K,n as te,O as Te,e as ne,a7 as de,ao as me,E as fe,a5 as xe,D as De}from"./framework.6b67ac47.js";import{a as Z,e as Ce,w as $e}from"./index.63550f19.js";import{e as ie,g as Se,a as S,f as Oe,h as Le,_ as $,c as le,i as P,b as Ee,k as je,l as Ie,m as Re,n as We,o as Ae,q as Pe,r as Me,t as Ue,u as ze,v as Be,w as He,x as Fe,y as Ne,z as qe,A as Ge,B as Ke,C as Je,D as Qe,E as Xe,F as Ye,G as se,H as be,V as Ze,d as ae,j as et}from"./tree.50ccd3e9.js";import{J as El,I as jl,p as Il,s as Rl}from"./tree.50ccd3e9.js";import"./index.013eb64a.js";import{b as tt,f as lt,a as ot}from"./form.d4ae7eba.js";import{_ as Al,c as Pl}from"./form.d4ae7eba.js";import{c as W}from"./cloneDeep.6b1411dd.js";import{a as nt,b as at}from"./index.da343e5c.js";import{i as ve}from"./isEqual.1cc8ee6e.js";import{m as oe}from"./merge.0f542de0.js";import{o as rt,a as it}from"./omitBy.496be11f.js";import{D as ye}from"./vuedraggable.umd.9831e9f5.js";import{E as pt}from"./index.vue_vue_type_script_setup_true_lang.814d8a22.js";import{k as st}from"./baseGet.f3f2ab16.js";import{d as ut}from"./union.c774781a.js";import{s as ue}from"./set.30e920c7.js";import{g as ct}from"./get.51c768ca.js";import"./use-form-item.18167ea7.js";import"./isNil.990ccdb3.js";import"./kebabCase.47021076.js";import"./createCompounder.12670e9b.js";import"./state-local.dd516420.js";import"./index.6748db2d.js";import"./baseSet.84292f44.js";import"./initCloneObject.fb0a9e5d.js";import"./getTag.9f0d1dee.js";import"./pickBy.e06d9ce3.js";import"./basePickBy.40d88517.js";import"./vue.runtime.esm-bundler.21b58301.js";import"./pick.c38fd284.js";import"./index.bde6247e.js";import"./baseMap.717c06fd.js";const dt=Object.freeze(Object.defineProperty({__proto__:null,get array(){return je},get cascader(){return Ie},get checkbox(){return Re},get color(){return ht},get date(){return We},get daterange(){return Ae},get dates(){return Pe},get datetime(){return Me},get datetimerange(){return Ue},get dynamic(){return gt},get form(){return lt},get group(){return _t},get icon(){return ze},get img(){return Be},get input(){return Vt},get month(){return He},get monthrange(){return Fe},get number(){return wt},get password(){return kt},get radio(){return Ne},get rate(){return Tt},get select(){return qe},get slider(){return xt},get switch(){return Dt},get table(){return Ct},get textarea(){return $t},get time(){return Ge},get timerange(){return Ke},get title(){return St},get tree(){return Je},get upload(){return Ot},get url(){return Qe},get week(){return Xe},get year(){return Ye}},Symbol.toStringTag,{value:"Module"}));function Y(l){return l.map(o=>{var m;const e=W(o);let t=[];return e.name=e.name||e.component||e.type,e.id=e.id||ie(e.name),e.name==="form"?t=Y([...e.column??[],...e.group??[]]):e.name==="group"?t=Y(e.column??[]):["dynamic","table"].includes(e.name)?t=Y(((m=e.children)==null?void 0:m.column)??[]):Array.isArray(e.children)&&(t=Y(e.children)),{name:e.name,id:e.id,isRoot:e.isRoot,props:e,children:t}})}function re(l){return Y([{isRoot:!0,name:"form",id:ie("form"),...l}])[0]}function G(l){return l.map(o=>{var t,m,a;const e=W(o);if(e.props&&(e.props.prop=e.props.prop??e.id),e.name==="form"){const u=G(((t=e.children)==null?void 0:t.filter(i=>i.name!=="group"))??[]),r=G(((m=e.children)==null?void 0:m.filter(i=>i.name==="group"))??[]);return{...e.props,column:u.length?u:void 0,group:r.length?r:void 0}}if(e.name==="group"){const u=G(e.children??[]);return{...e.props,column:u}}else if(["dynamic","table"].includes(e.name??"")){const u=G(e.children??[]),r={...(a=e.props)==null?void 0:a.children,column:u};return{...e.props,children:r}}else if(Array.isArray(e.children))return{...e.props,children:G(e.children)};return{...e.props}})}function he(l){return G([l])[0]??{}}function pe(l,o){const{parentWhiteList:e,parentBlackList:t}=(l==null?void 0:l.rules)??{},{childWhiteList:m,childBlackList:a}=(o==null?void 0:o.rules)??{},u=[];if(e&&o){const r=e.includes((o==null?void 0:o.name)??"");u.push(r)}if(t&&o){const r=t.includes((o==null?void 0:o.name)??"");u.push(!r)}if(m){const r=m.includes((l==null?void 0:l.name)??"");u.push(r)}if(a){const r=a.includes((l==null?void 0:l.name)??"");u.push(!r)}return u.every(r=>r)}const ge=Symbol("form-design-state");function mt(l,o){const e=Z(l),{modelValue:t}=e,m=A(()=>l.groupList||Se),a=A(()=>oe(W({...dt}),l.resources)),u=A(()=>oe(k(tt),k(l.baseOption))),r=A(()=>oe(k(yt),k(l.advanceOption))),i=L({}),f=L({}),y=L({}),s=A(()=>{var w;return rt((w=i.value)==null?void 0:w.props,["column","group"])??{}}),n=L([]),c=L(0),h=L("design"),_=L("pc");F(t,w=>{ve(i.value,re(w||{}))||(i.value=re(w||{}),Object.keys(f.value).length||C(),n.value.length||d("init"))},{immediate:!0,deep:!0}),F(i,()=>{t.value=he(i.value)},{deep:!0});function O(w){if(w)return a.value[w]}function C(w){f.value=w??i.value??{}}function k(w){if(typeof w=="function"){const R={elementTree:i.value,activeElement:f.value};return W(w(R)??[])}else return W(w??[])}async function d(w){n.value.push({type:w,timestamp:Date.now(),active:W(f.value),tree:W(i.value),option:W(t.value??{})}),c.value=n.value.length-1}function p(w){const R=n.value.find((j,z)=>z===w);R&&(i.value=W(R.tree),f.value=W(R.active),c.value=w)}function v(){n.value=[],c.value=0,i.value={},f.value={},o("reset")}const T={groupList:m,resources:a,elementTree:i,activeElement:f,hoverElement:y,formOption:s,historyList:n,historyIndex:c,workType:h,deviceType:_,modelValue:t,baseOption:u,advanceOption:r,resolveSettings:k,setActiveElement:C,recordHistory:d,restoreHistory:p,resetHistory:v,getResource:O};return Ve(ge,T),T}function U(){return we(ge)}const ft=I({__name:"property-select",props:{tableData:{},dic:{}},setup(l){const o=l,{elementTree:e,baseOption:t,resolveSettings:m,getResource:a}=U(),u=A(()=>{var f;const r=nt([e.value],y=>{var s,n,c;return((s=y.props)==null?void 0:s.prop)===((c=(n=o.tableData)==null?void 0:n.row)==null?void 0:c.field)}),i=((f=a(r==null?void 0:r.name))==null?void 0:f.settings)??[];return[...t.value,...m(i)].filter(y=>y.prop).map(y=>({label:y.label,value:y.prop,desc:y.prop}))});return(r,i)=>{const f=V("avue-select");return D(),E(f,{dic:u.value,"allow-create":"",filterable:"","default-first-option":""},null,8,["dic"])}}}),bt=I({__name:"index",props:{modelValue:{}},setup(l){const e=Z(l),{modelValue:t}=e,{elementTree:m}=U(),a=L(!1),u=L([]);F(t,()=>{var f,y,s;if(!t.value){u.value=[];return}try{const c=((s=(y=(f=Oe(t.value,{ecmaVersion:"latest"}).body[0])==null?void 0:f.expression)==null?void 0:y.body)==null?void 0:s.properties)??[];c!=null&&c.length&&(u.value=c.map(h=>h.value.properties.map(_=>{const O=Le(_.value);return{field:h.key.name,property:_.key.name,value:O}})).flat())}catch{}},{immediate:!0}),F(u,()=>{var s;if(!a.value)return;const y=`(val, form) => ({
    ${[...new Set((s=u.value)==null?void 0:s.map(n=>n.field))].map(n=>{var h;const c=(h=u.value)==null?void 0:h.filter(_=>_.field===n);return`${n}: { ${c==null?void 0:c.map(_=>`${_.property}: ${_.value}`).join(", ")} }`}).join(`,
    `)}
})`;t.value=y},{deep:!0});const r=A(()=>{var y;return at(((y=m.value)==null?void 0:y.children)??[]).map(s=>{const{label:n,prop:c}=s.props??{};return{label:n,value:c,desc:c}})}),i=A(()=>({column:[{label:"受控字段",prop:"field",type:"select",dicData:r.value,rules:{required:!0}},{label:"受控属性",prop:"property",component:ft,rules:{required:!0}},{label:"表达式/值",prop:"value",component:S,tooltip:!0,rules:{required:!0}}]}));return(f,y)=>{const s=V("el-button"),n=V("avue-dynamic"),c=V("el-dialog");return D(),M(B,null,[g(s,{onClick:y[0]||(y[0]=h=>a.value=!0)},{default:x(()=>[J(" 编辑代码 ")]),_:1}),g(c,{modelValue:a.value,"onUpdate:modelValue":y[3]||(y[3]=h=>a.value=h),title:"控制字段属性"},{default:x(()=>[g(n,{modelValue:u.value,"onUpdate:modelValue":y[1]||(y[1]=h=>u.value=h),children:i.value},null,8,["modelValue","children"]),J(" 代码： "),g(S,{modelValue:b(t),"onUpdate:modelValue":y[2]||(y[2]=h=>Q(t)?t.value=h:null),"value-type":"function",height:"200px"},null,8,["modelValue"])]),_:1},8,["modelValue"])],64)}}}),Cl=I({__name:"index",props:{modelValue:{},setterType:{}},setup(l){const e=Z(l),{modelValue:t}=e,m={column:[{label:"名称",prop:"label"},{label:"值",prop:"value"}]},a={props:{value:"id"},formOption:{column:[{label:"名称",prop:"label"},{label:"值",prop:"value"}]}},u=L({});function r(s,n){s(),setTimeout(()=>{(n==="add"||n==="parentAdd")&&(u.value.id=ie())},100)}const i=(s,n,c)=>c(),f=(s,n,c)=>c(),y=(s,n)=>n();return(s,n)=>{const c=V("avue-tree"),h=V("avue-dynamic");return s.setterType=="tree"?(D(),E(c,{key:0,modelValue:u.value,"onUpdate:modelValue":n[0]||(n[0]=_=>u.value=_),data:b(t),option:a,"before-open":r,onSave:i,onUpdate:f,onDel:y},null,8,["modelValue","data"])):(D(),E(h,{key:1,children:m,"model-value":b(t)||[],"onUpdate:modelValue":n[1]||(n[1]=_=>t.value=_)},null,8,["model-value"]))}}}),vt=I({__name:"index",props:{modelValue:{},tableData:{}},setup(l){const o=l,e=Z(o),{modelValue:t}=e,m=L(!1),a=L({});F(t,()=>{var r,i;t.value&&(a.value=((i=(r=o.tableData)==null?void 0:r.row)==null?void 0:i.onLoadData)??{})},{immediate:!0}),F(a,()=>{var _;if(!m.value||!((_=o.tableData)!=null&&_.row)||(o.tableData.row.onLoadData=a.value,a.value.codeMode))return;const{url:r,method:i,isPage:f,currentPageKey:y,pageSizeKey:s,totalPath:n,dataPath:c}=a.value,h=`({ page, value, data }, callback) => {
    const params = page && ${f} ? { ${y}: page.currentPage, ${s}: page.pageSize } : {};
    this.$axios({ url: "${r}", method: "${i}", params }).then(res => {
        const data = this.getAsVal({ res }, "${c}");
        const total = this.getAsVal({ res }, "${n}");
        callback({ data, total });
    });
}`;t.value=h},{deep:!0});const u={span:24,menuBtn:!1,labelWidth:100,column:[{label:"请求地址",prop:"url"},{label:"请求方法",prop:"method",type:"radio",button:!0,value:"get",dicData:[{label:"GET",value:"get"},{label:"POST",value:"post"}]},{label:"是否分页",prop:"isPage",type:"switch",value:!0},{label:"当前页键名",prop:"currentPageKey",value:"current"},{label:"每页条数键名",prop:"pageSizeKey",value:"size"},{label:"总条数路径",prop:"totalPath",value:"res.data.total"},{label:"返回数据路径",prop:"dataPath",value:"res.data.records"},{label:"编辑代码模式",prop:"codeMode",type:"switch",value:!1,span:4,tip:"关闭时，代码根据以上参数自动生成。开启时，可自由编辑代码"}]};return(r,i)=>{const f=V("el-button"),y=V("avue-form"),s=V("el-dialog");return D(),M(B,null,[g(f,{onClick:i[0]||(i[0]=n=>m.value=!0)},{default:x(()=>[J(" 编辑代码 ")]),_:1}),g(s,{modelValue:m.value,"onUpdate:modelValue":i[3]||(i[3]=n=>m.value=n),title:"加载数据函数"},{default:x(()=>[g(y,{modelValue:a.value,"onUpdate:modelValue":i[1]||(i[1]=n=>a.value=n),option:u},null,8,["modelValue"]),J(" 代码： "),g(S,{modelValue:b(t),"onUpdate:modelValue":i[2]||(i[2]=n=>Q(t)?t.value=n:null),"value-type":"function",height:"200px",disabled:""},null,8,["modelValue"])]),_:1},8,["modelValue"])],64)}}}),yt=[{label:"控制其它字段",prop:"control",component:bt},{label:"值变化事件",prop:"change",component:S,tooltip:!0,defaultValue:"({ value, row }) => {}"},{label:"点击事件",prop:"click",component:S,tooltip:!0,defaultValue:"({ value, row  }) => {}"},{label:"获取焦点事件",prop:"focus",component:S,tooltip:!0,defaultValue:"({ value, row  }) => {}"},{label:"失去焦点事件",prop:"blur",component:S,tooltip:!0,defaultValue:"({ value, row  }) => {}"},{label:"其他属性",prop:"params",component:S,valueType:"object",tooltip:!0,defaultValue:"{}"},{label:"其他事件",prop:"event",component:S,valueType:"object",tooltip:!0,defaultValue:"{}"}],ht={name:"color",title:"颜色",icon:"el-icon-brush",group:"表单组件",props:{type:"color",label:"颜色"},settings:[{label:"支持透明度选择",prop:"showAlpha",component:$,defaultValue:!1,labelWidth:120},{label:"颜色格式",prop:"colorFormat",type:"select",dicData:[{label:"hsl",value:"hsl"},{label:"hsv",value:"hsv"},{label:"hex",value:"hex"},{label:"rgb",value:"rgb"}]},{label:"预定义颜色",prop:"predefine",type:"array"}]},gt={name:"dynamic",title:"子表单",icon:"el-icon-grid",group:"表单组件",isContainer:!0,rules:{parentWhiteList:["form","group"],childBlackList:["group","dynamic"]},designOption:l=>{const{label:o,prop:e}=l.props??{};return{column:[{label:o,prop:e,type:"text"}]}},props:{type:"dynamic",label:"子表单",children:{column:[]}},settings:[{prop:"children",labelWidth:0,component:"avue-form",option:{labelWidth:100,menuBtn:!1,span:24,column:[{label:"展示类型",prop:"type",type:"radio",button:!0,value:"crud",dicData:[{label:"表格",value:"crud"},{label:"表单",value:"form"}],control(l){const o=l==="form",e=l==="crud";return{showHeader:{display:e},stripe:{display:e},border:{display:e},headerAlign:{display:e},align:{display:e},span:{display:o}}}},{label:"显示新增按钮",prop:"addBtn",component:$,defaultValue:!0},{label:"显示删除按钮",prop:"delBtn",component:$,defaultValue:!0},{label:"显示序号",prop:"index",type:"switch",control(l,o){return o.type==="crud"&&typeof l=="boolean"&&(o.index=l?"":!1),{}}},{label:"显示表头",prop:"showHeader",component:$,defaultValue:!0},{label:"表格边框",prop:"border",component:$,defaultValue:!0},{label:"斑马纹",prop:"stripe",component:$,defaultValue:!1},{label:"表头对齐方式",prop:"headerAlign",type:"radio",button:!0,dicData:le},{label:"对齐方式",prop:"align",type:"radio",button:!0,dicData:le},{label:"表单项栅格",prop:"span",type:"number"},{label:"空数据文字",prop:"emptyText",type:"number"}]}}]},_t={name:"group",title:"分组",icon:"el-icon-menu",group:"布局组件",isContainer:!0,rules:{parentWhiteList:["form"],childBlackList:["group"]},designOption:l=>{const{label:o,prop:e}=l.props??{};return{column:[{prop:e,labelWidth:0,type:"title",modelValue:o,styles:{fontWeight:500,fontSize:"16px"}}]}},props:{type:"group",label:"分组",column:[]},settings:[{label:"图标",prop:"icon",type:"icon",iconList:P},{label:"是否默认展开",prop:"collapse",component:$,defaultValue:!0},{label:"是否显示箭头",prop:"arrow",component:$,defaultValue:!0}]},Vt={name:"input",title:"输入框",icon:"el-icon-chat-dot-square",group:"表单组件",props:{type:"input",label:"输入框"},settings:[{label:"最大长度",prop:"maxlength",type:"number"},{label:"显示统计字数",prop:"showWordLimit",component:$,defaultValue:!1,tip:"仅在最大长度大于0时有效"},{label:"前缀文字",prop:"prepend"},{label:"后缀文字",prop:"append"},{label:"前缀图标",prop:"prefixIcon",type:"icon",iconList:P},{label:"后缀图标",prop:"suffixIcon",type:"icon",iconList:P},{label:"输入值格式化",prop:"formatter",component:S,valueType:"function",tooltip:!0,defaultValue:"(value) => value"},{label:"返回值格式化",prop:"parser",component:S,valueType:"function",tooltip:!0,defaultValue:"(value) => value"},{label:"输入框样式",prop:"inputStyle",component:S,valueType:"object",tooltip:!0,defaultValue:"{}"}]},wt={name:"number",title:"数字输入框",icon:"el-icon-more",group:"表单组件",props:{type:"number",label:"数字输入框"},settings:[{label:"最小值",prop:"min",type:"number"},{label:"最大值",prop:"max",type:"number"},{label:"计数器步长",prop:"step",type:"number"},{label:"只能输入步长倍数",prop:"stepStrictly",component:$,defaultValue:!1,labelWidth:130},{label:"数值精度",prop:"precision",type:"number"},{label:"是否使用控制按钮",prop:"controls",type:"switch",value:!0,labelWidth:130,control(l){return{controlsPosition:{display:!!l}}}},{label:"控制按钮位置",prop:"controlsPosition",type:"radio",button:!0,dicData:[{label:"两边",value:"default"},{label:"右",value:"right"}]},{label:"清空时显示值",prop:"valueOnClear",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:[{label:"最小值",value:"min"},{label:"最大值",value:"max"}],control(l,o){return l&&!["min","max"].includes(l)&&(o.valueOnClear=Number(l)),{}}}]},kt={name:"password",title:"密码输入框",icon:"el-icon-lock",group:"表单组件",props:{type:"password",label:"密码输入框"},settings:[{label:"最大长度",prop:"maxlength",type:"number"},{label:"前缀图标",prop:"prefixIcon",type:"icon",iconList:P},{label:"后缀图标",prop:"suffixIcon",type:"icon",iconList:P},{label:"是否显示切换密码",prop:"showPassword",component:$,defaultValue:!1,labelWidth:130}]},Tt={name:"rate",title:"评分",icon:"el-icon-star",group:"表单组件",props:{type:"rate",label:"评分",max:5,lowThreshold:2,highThreshold:4},settings:[{label:"是否允许半选",prop:"allowHalf",component:$,defaultValue:!1},{label:"最大分值",prop:"max",type:"number"},{label:"低分界限值",prop:"lowThreshold",type:"number",labelTip:"低分和中等分数的界限值，值本身被划分在低分中"},{label:"高分界限值",prop:"highThreshold",type:"number",labelTip:"高分和中等分数的界限值，值本身被划分在高分中"},{label:"颜色数组",prop:"colors",component:S,valueType:"object",tooltip:!0,defaultValue:"[]",labelTip:"若传入数组，共有 3 个元素，为 3 个分段所对应的颜色；若传入对象，可自定义分段，键名为分段的界限值，键值为对应的颜色"},{label:"未选中颜色",prop:"voidColor",type:"color"},{label:"未选颜色(禁用)",prop:"disabledVoidColor",type:"color",labelWidth:110},{label:"图标数组",prop:"icons",component:S,valueType:"object",tooltip:!0,defaultValue:"[]",labelTip:"若传入数组，则需要传入 3 个元素，分别为 3 个部分所对应的图标；若传入对象，则可自定义分段，键名为分段的界限值，键值为对应的图标"},{label:"未选中图标",prop:"voidIcon",type:"icon",iconList:P},{label:"未选图标(禁用)",prop:"disabledVoidIcon",type:"icon",iconList:P,labelWidth:110},{label:"显示辅助文字",prop:"showText",component:$,defaultValue:!1,labelWidth:120,labelTip:"是否显示辅助文字，若为是，则会从 辅助文字数组 中选取当前分数对应的文字内容"},{label:"辅助文字数组",prop:"texts",type:"array",labelWidth:120,labelTip:"通过设置辅助文字数组可以为每一个分值指定对应的辅助文字"},{label:"显示当前分数",prop:"showScore",component:$,defaultValue:!1,labelWidth:120,labelTip:"是否显示当前分数，当前分数 和 辅助文字 不能同时显示"},{label:"分数显示模板",prop:"scoreTemplate",labelWidth:120,labelTip:'模板为一个包含了 {value} 的字符串，{value} 会被替换为当前分值。如: "当前分数：{value}"'}]},xt={name:"slider",title:"滑块",icon:"el-icon-operation",group:"表单组件",props:{type:"slider",label:"滑块"},settings:[{label:"最小值",prop:"min",type:"number"},{label:"最大值",prop:"max",type:"number"},{label:"步长",prop:"step",type:"number"},{label:"显示输入框",prop:"showInput",component:$,defaultValue:!1},{label:"输入控制按钮",prop:"showInputControls",component:$,defaultValue:!0},{label:"显示间断点",prop:"showStops",component:$,defaultValue:!1},{label:"显示提示信息",prop:"showTooltip",component:$,defaultValue:!0},{label:"提示信息类名",prop:"tooltipClase"},{label:"提示信息位置",prop:"placement",type:"select",dicData:Ee},{label:"格式化提示",prop:"formatTooltip",component:S,valueType:"function",tooltip:!0,defaultValue:"(value) => value"},{label:"开启选择范围",prop:"range",component:$,defaultValue:!1},{label:"垂直模式",prop:"vertical",component:$,defaultValue:!1},{label:"滑块高度",prop:"height",type:"number",labelTip:"垂直模式必填"},{label:"标记",prop:"marks",component:S,valueType:"object",tooltip:!0,defaultValue:"{}",labelTip:"标记， key 的类型必须为 number 且取值在闭区间 [min, max] 内，每个标记可以单独设置样式"}]},Dt={name:"switch",title:"开关",icon:"el-icon-switch",group:"表单组件",props:{type:"switch",label:"开关"},settings:[{label:"开关数据",prop:"dicData",type:"dynamic",labelPosition:"top",children:{column:[{label:"_index",prop:"_index",hide:!0},{label:"文字",prop:"label"},{label:"值",prop:"value",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:[{label:"true",value:!0},{label:"false",value:!1}]}]},value:[{label:"",value:!1},{label:"",value:!0}]},{label:"开关宽度",prop:"len"},{label:"文字在点内",prop:"inlinePrompt",component:$,defaultValue:!1},{label:"开启时图标",prop:"activeIcon",type:"icon",iconList:P},{label:"关闭时图标",prop:"inactiveIcon",type:"icon",iconList:P},{label:"开启动作图标",prop:"activeActionIcon",type:"icon",iconList:P},{label:"关闭动作图标",prop:"inactiveActionIcon",type:"icon",iconList:P},{label:"改变前钩子",prop:"beforeChange",labelTip:"回调 false 则停止切换",component:S,tooltip:!0,defaultValue:"(cb) => cb(true)"}]},Ct={name:"table",title:"表格选择",icon:"el-icon-grid",group:"表单组件",isContainer:!0,props:{type:"table",label:"表格选择",children:{column:[]}},settings:[{label:"显示表头",prop:"showHeader",component:$,defaultValue:!0},{label:"斑马纹",prop:"stripe",component:$,defaultValue:!1},{label:"表格边框",prop:"border",component:$,defaultValue:!1},{label:"表头对齐方式",prop:"headerAlign",type:"radio",button:!0,dicData:le},{label:"整体对齐方式",prop:"align",type:"radio",button:!0,dicData:le},{label:"显示序号",prop:"index",type:"switch"},{label:"键值配置",prop:"props",component:S,valueType:"object",tooltip:!0,value:{label:"name",value:"id"}},{label:"格式化函数",prop:"formatter",component:S,valueType:"function",tooltip:!0,defaultValue:"(row) => row.name"},{label:"加载数据函数",prop:"onLoad",component:vt}]},$t={name:"textarea",title:"文本域",icon:"el-icon-chat-line-square",group:"表单组件",props:{type:"textarea",label:"文本域"},settings:[{label:"最小行数",prop:"minRows",type:"number"},{label:"最大行数",prop:"maxRows",type:"number"},{label:"最大长度",prop:"maxlength",type:"number"},{label:"显示统计字数",prop:"showWordLimit",component:$,defaultValue:!1,tip:"仅在最大长度大于0时有效"},{label:"是否能被缩放",prop:"resize",type:"select",dicData:[{label:"不可缩放",value:"none"},{label:"可水平缩放",value:"horizontal"},{label:"可垂直缩放",value:"vertical"},{label:"可自由缩放",value:"both"}]},{label:"输入框样式",prop:"inputStyle",component:S,valueType:"object",tooltip:!0,defaultValue:"{}"}]},St={name:"title",title:"标题",icon:"el-icon-minus",group:"布局组件",props:{type:"title",labelWidth:0,modelValue:"标题",styles:{textAlign:"center"}},settings:[{label:"标题内容",prop:"modelValue",type:"textarea",labelPosition:"top"},{label:"样式",prop:"styles",component:S,valueType:"object",tooltip:!0}]},Ot={name:"upload",title:"上传",icon:"el-icon-upload",group:"表单组件",props:{type:"upload",label:"上传"},settings:[{label:"上传地址",prop:"action"},{label:"请求头",prop:"headers",component:S,valueType:"object",tooltip:!0,defaultValue:"{}"},{label:"请求方法",prop:"method",type:"radio",button:!0,dicData:[{label:"POST",value:"post"},{label:"GET",value:"get"}]},{label:"是否支持多选",prop:"multiple",component:$,defaultValue:!1},{label:"额外参数",prop:"data",component:S,valueType:"object",tooltip:!0,defaultValue:"{}"},{label:"显示文件列表",prop:"showFileList",component:$,defaultValue:!0},{label:"拖拽排序",prop:"drag",component:$,defaultValue:!1},{label:"拖拽上传",prop:"dragFile",component:$,defaultValue:!1},{label:"接受上传类型",prop:"accept"},{label:"文件列表类型",prop:"listType",type:"select",dicData:[{label:"文本",value:"text"},{label:"图片",value:"picture"},{label:"图片卡片",value:"picture-card"},{label:"图片图片",value:"picture-img"}]},{label:"最大上传数量",prop:"limit",type:"number"},{label:"最大上传大小",prop:"fileSize",type:"number"},{label:"上传按钮文字",prop:"fileText"},{label:"上传等待文字",prop:"loadText"},{label:"上传请求配置",prop:"propsHttp",component:S,valueType:"object",tooltip:!0,defaultValue:`{
  home: "",
  res: "",
  url: "",
  name: "",
  fileName: "file"
}`},{label:"图片水印配置",prop:"canvasOption",component:S,valueType:"object",tooltip:!0,defaultValue:`{
  text: "",
  fontFamily: "microsoft yahei",
  color: "#999",
  fontSize: 16,
  opacity: 100,
  bottom: 10,
  right: 10,
  ratio: 1
}`}]},Lt={class:"resource-list"},Et={class:"resource-item"},jt=I({__name:"resource",setup(l){const{groupList:o,resources:e,elementTree:t,workType:m,setActiveElement:a,recordHistory:u,getResource:r}=U(),i=L(""),f=A(()=>{const n=Object.values(e.value).filter(c=>{const{name:h,title:_,keywords:O}=c,C=[h,_,O].filter(k=>k).join(",");return!c.disabled&&(C==null?void 0:C.includes(i.value))});return o.value.map(c=>({label:c,children:n.filter(h=>h.group===c).map((h,_)=>({...h,priority:h.priority??_})).sort((h,_)=>h.priority-_.priority)})).filter(c=>c.children.length)});function y(n){var h,_;if(m.value!=="design")return;const c=se(n);(_=(h=t.value)==null?void 0:h.children)==null||_.push(c),a(c),u("added")}function s({draggedContext:n,relatedContext:c}){var h;return pe(r(n.element.name),r((h=c.component.componentData)==null?void 0:h.name))}return(n,c)=>{const h=V("el-input"),_=V("el-button"),O=V("el-collapse-item"),C=V("el-collapse");return D(),M("div",Lt,[g(h,{modelValue:i.value,"onUpdate:modelValue":c[0]||(c[0]=k=>i.value=k),"suffix-icon":"el-icon-search",placeholder:"搜索组件"},null,8,["modelValue"]),g(C,{"model-value":f.value.map(k=>k.label)},{default:x(()=>[(D(!0),M(B,null,N(f.value,k=>(D(),E(O,{key:k.label,title:k.label,name:k.label},{default:x(()=>[g(b(ye),{list:k.children,group:{name:"components",pull:"clone",put:!1},clone:b(se),sort:!1,"item-key":"name",move:s},{item:x(({element:d})=>[H("div",Et,[g(_,{icon:d.icon,onClick:p=>y(d)},{default:x(()=>[J(ee(d.title),1)]),_:2},1032,["icon","onClick"])])]),_:2},1032,["list","clone"])]),_:2},1032,["title","name"]))),128))]),_:1},8,["model-value"])])}}}),It=["onMouseover"],Rt={class:"item-label"},Wt={class:"item-actions"},At=I({__name:"tree",setup(l){const{elementTree:o,activeElement:e,hoverElement:t,setActiveElement:m,recordHistory:a,getResource:u}=U(),r=A(()=>[W(o.value)]);function i(d,p,v){return p.data.isRoot?!1:v==="inner"?pe(u(d.data.name),u(p.data.name)):!0}const f=L();ke(()=>{var d,p;(p=f.value)==null||p.setCurrentKey((d=e.value)==null?void 0:d.id)});function y(d){m(d)}function s(){o.value=r.value[0]}function n(d){var v;const p=be(d.data);(v=f.value)==null||v.append(p,d.parent),s(),m(p),a("added")}function c(d){var p;(p=f.value)==null||p.remove(d),s(),m(),a("removed")}function h(d){var p;(p=d.data.children)!=null&&p.length&&(d.data.children.forEach(v=>{var T;return(T=f.value)==null?void 0:T.remove(v)}),s(),m(d.data),a("clear"))}function _(){s(),a("moved")}const O=[{name:"copy",type:"primary",icon:"el-icon-copy-document",handler:n},{name:"delete",type:"danger",icon:"el-icon-delete",handler:c},{name:"clear",type:"warning",icon:"el-icon-folder-delete",handler:h}];function C(d){return O.filter(p=>k(d,p.name))}function k(d,p){const{disabledActions:v,isContainer:T}=u(d.name)??{},w=!(v!=null&&v.includes(p));return p==="clear"?T&&w:w}return(d,p)=>{const v=V("el-link");return D(),E(b(pt),{ref_key:"treeRef",ref:f,class:"component-tree","node-key":"id",data:r.value,"default-expand-all":"",draggable:"","expand-on-click-node":!1,"allow-drop":i,onNodeClick:y,onNodeDrop:_},{default:x(({node:T,data:w})=>{var R,j;return[H("div",{class:"tree-item",onMouseover:z=>t.value=w||{},onMouseleave:p[0]||(p[0]=z=>t.value={})},[H("div",Rt,ee(((R=w.props)==null?void 0:R.label)||((j=b(u)(w.name))==null?void 0:j.title)),1),H("div",Wt,[(D(!0),M(B,null,N(C(w),z=>(D(),E(v,ce({key:z.name,underline:!1},z,{onClick:K(q=>z.handler(T),["stop"])}),null,16,["onClick"]))),128))])],40,It)]}),_:1},8,["data"])}}}),Pt={init:"初始化",added:"添加组件",moved:"移动组件",removed:"删除组件",property:"修改属性",clear:"清空子组件"},$l={copy:"复制",delete:"删除",clear:"清空"},Mt={class:"history-list"},Ut=["onClick"],zt=I({__name:"history",setup(l){const{historyList:o,historyIndex:e,restoreHistory:t}=U(),m=Ce("history-show-source",!1),a={renderValidationDecorations:"off",readOnly:!0},u=A(()=>document.documentElement.className.includes("dark")?"vs-dark":"light");return(r,i)=>{const f=V("el-switch"),y=V("el-tooltip");return D(),M("div",Mt,[J(" 显示源码："),g(f,{modelValue:b(m),"onUpdate:modelValue":i[0]||(i[0]=s=>Q(m)?m.value=s:null)},null,8,["modelValue"]),(D(!0),M(B,null,N(b(o),(s,n)=>(D(),E(y,{key:s.timestamp,disabled:!b(m),effect:"light",placement:"right"},{content:x(()=>[g(b(Ze),{original:b(ae)(b(o)[n-1]),modified:b(ae)(s),theme:u.value,options:a,language:"javascript",width:"800px",height:"600px"},null,8,["original","modified","theme"])]),default:x(()=>[H("div",{class:te(["history-item",{"is-active":n===b(e)}]),onClick:c=>b(t)(n)},[H("span",null,ee(b(Pt)[s.type]),1),H("span",null,ee(new Date(s.timestamp).toLocaleString()),1)],10,Ut)]),_:2},1032,["disabled"]))),128))])}}}),Bt=I({__name:"index",setup(l){const o=[{title:"组件",icon:"el-icon-menu",component:jt},{title:"大纲",icon:"el-icon-operation",component:At},{title:"历史",icon:"el-icon-clock",component:zt}];return(e,t)=>{const m=V("el-link"),a=V("el-tab-pane"),u=V("el-tabs");return D(),E(u,{"tab-position":"top",stretch:""},{default:x(()=>[(D(),M(B,null,N(o,r=>g(a,{key:r.title},{label:x(()=>[g(m,{title:r.title,icon:r.icon,underline:!1,style:{color:"inherit"}},null,8,["title","icon"])]),default:x(()=>[(D(),E(Te(r.component)))]),_:2},1024)),64))]),_:1})}}}),Ht={class:"item-actions"},_e=I({__name:"design",props:{list:{},componentData:{}},emits:["update:active","update:list"],setup(l,{emit:o}){const e=l,{list:t}=Z(e,o,{passive:!0,deep:!0}),{activeElement:m,hoverElement:a,formOption:u,setActiveElement:r,recordHistory:i,getResource:f}=U();function y(p){const v={...W(u.value),span:24,menuBtn:!1},{designOption:T}=f(p.name)??{};if(typeof T=="object")return{...v,...T};if(typeof T=="function")return{...v,...T(p)};{const w=[];return p.props&&w.push({...it(p.props,st),span:24}),{...v,column:w}}}function s(p){var v,T;return(v=f(p.name))!=null&&v.isContainer?24:((T=p.props)==null?void 0:T.span)||u.value.span||24}async function n(p){var T;const v=Object.keys(p)[0];v&&(r(),await fe(),r((T=p[v])==null?void 0:T.element),i(v))}function c(p){const v=be(p);t.value.push(v),r(v),i("added")}function h(p,v){t.value.splice(v,1),r(t.value[v]??t.value[v-1]),i("removed")}function _(p){var v;(v=p.children)!=null&&v.length&&(p.children=[],r(p),i("clear"))}function O({draggedContext:p,relatedContext:v}){var T;return pe(f(p.element.name),f((T=v.component.componentData)==null?void 0:T.name))}const C=[{name:"copy",type:"primary",icon:"el-icon-copy-document",handler:c},{name:"delete",type:"danger",icon:"el-icon-delete",handler:h},{name:"clear",type:"warning",icon:"el-icon-folder-delete",handler:_}];function k(p){return C.filter(v=>d(p,v.name))}function d(p,v){const{disabledActions:T,isContainer:w}=f(p.name)??{},R=!(T!=null&&T.includes(v));return v==="clear"?w&&R:R}return(p,v)=>{const T=V("avue-form"),w=V("el-button"),R=V("el-col");return D(),E(b(ye),{list:b(t),class:te(["el-row draggable-list",{"is-empty":!b(t).length,"is-root":p.componentData.isRoot}]),group:{name:"components"},"component-data":p.componentData,"item-key":"id",move:O,onChange:n},{item:x(({element:j,index:z})=>[g(R,{class:te(["draggable-item",{"is-active":b(m).id===j.id,"is-hover":b(a).name&&b(a).id===j.id}]),span:s(j),onClick:K(q=>b(r)(j),["stop"]),onMouseover:K(q=>a.value=j||{},["stop"]),onMouseleave:v[0]||(v[0]=K(q=>a.value={},["stop"]))},{default:x(()=>{var q;return[j.name!=="form"?(D(),E(T,{key:0,option:y(j)},null,8,["option"])):ne("",!0),(q=b(f)(j.name))!=null&&q.isContainer?(D(),E(_e,{key:1,class:"is-container","component-data":j,list:j.children??[],"onUpdate:list":X=>j.children=X},null,8,["component-data","list","onUpdate:list"])):ne("",!0),de(H("div",Ht,[(D(!0),M(B,null,N(k(j),X=>(D(),E(w,ce({key:X.name},X,{circle:"",plain:"",onClick:K(Jt=>X.handler(j,z),["stop"])}),null,16,["onClick"]))),128))],512),[[me,b(m).id===j.id]])]}),_:2},1032,["class","span","onClick","onMouseover"])]),_:1},8,["list","class","component-data"])}}}),Ft=I({setup(){const{proxy:l}=De(),{modelValue:o}=U(),e=L({}),t=L({}),m=A(()=>et.bind(l)(ae(o.value))),a=L();function u(r,i){console.log(r),i==null||i()}return{form:e,defaults:t,option:m,formRef:a,onSubmit:u}},render(){return xe(V("avue-form"),{ref:"formRef",modelValue:this.form,option:this.option,defaults:this.defaults,"onUpdate:modelValue":l=>this.form=l,"onUpdate:defaults":l=>this.defaults=l,onSubmit:this.onSubmit})}}),Nt=I({__name:"source",setup(l){const{modelValue:o,setActiveElement:e}=U();return(t,m)=>(D(),E(b(S),{modelValue:b(o),"onUpdate:modelValue":[m[0]||(m[0]=a=>Q(o)?o.value=a:null),m[1]||(m[1]=a=>b(e)())],"value-type":"object"},null,8,["modelValue"]))}}),qt=I({__name:"index",setup(l){const{elementTree:o,workType:e,setActiveElement:t}=U();return(m,a)=>b(e)==="preview"?(D(),E(Ft,{key:0})):b(e)==="source"?(D(),E(Nt,{key:1})):(D(),E(_e,{key:2,"component-data":b(o),list:b(o).children??[],"onUpdate:list":a[0]||(a[0]=u=>b(o).children=u),onClick:a[1]||(a[1]=K(u=>b(t)(),["stop"]))},null,8,["component-data","list"]))}}),Gt=I({__name:"index",setup(l){const o=U(),{elementTree:e,activeElement:t,baseOption:m,advanceOption:a,resolveSettings:u,recordHistory:r,getResource:i}=o,f=L(!1),y=L(""),s=L(0),n=L({}),c=L({labelPosition:"left",labelWidth:100,menuBtn:!1,span:24,tabs:!0,group:[]});F(()=>t.value.id,async()=>{f.value=!0,s.value=0,await fe();const{settings:O,disabledSettings:C}=i(t.value.name)??{},k={label:"基础",prop:"base",column:m.value},d={label:"属性",prop:"component",column:u(O)},p={label:"高级",prop:"advance",column:a.value},v=[k,d,p].filter(T=>!(C!=null&&C.includes(T.prop)));c.value.group=v,y.value=v[0].prop,n.value=W(t.value.props),f.value=!1},{immediate:!0});const h=ut(()=>r("property"),1e3);$e(n,O=>{const C=ot(O,[void 0,null,""],["$"]);if(t.value.isRoot)ue(e.value,"props",C);else{const k=_(e.value,t.value.id)??[];k.length&&!ve(C,ct(e.value,k.concat("props")))&&ue(e.value,k.concat("props"),C)}s.value&&h(),s.value++},{deep:!0,debounce:100});function _(O,C){if(O.id===C)return[];if(O.children)for(const k in O.children){const d=_(O.children[k],C);if(d)return["children",k].concat(d)}}return(O,C)=>{const k=V("avue-form");return f.value?ne("",!0):(D(),E(k,{key:0,modelValue:n.value,"onUpdate:modelValue":C[0]||(C[0]=d=>n.value=d),class:"settings-form",option:c.value},null,8,["modelValue","option"]))}}}),Kt=I({__name:"index",setup(l){const{elementTree:o,workType:e,deviceType:t,historyList:m,historyIndex:a,restoreHistory:u,resetHistory:r}=U(),i=[{label:"PC端",value:"pc",icon:"el-icon-monitor"},{label:"移动端",value:"mobile",icon:"el-icon-cellphone"}],f=[{label:"设计",value:"design",icon:"el-icon-brush"},{label:"源码",value:"source",icon:"el-icon-more"},{label:"预览",value:"preview",icon:"el-icon-view"}];return(y,s)=>{const n=V("el-button"),c=V("el-button-group"),h=V("el-col"),_=V("el-link"),O=V("el-radio-button"),C=V("el-radio-group"),k=V("el-row");return D(),E(k,{gutter:20},{default:x(()=>[g(h,{span:8,style:{"align-self":"center"}},{default:x(()=>[g(c,{size:"small"},{default:x(()=>{var d;return[g(n,{disabled:b(a)===0,title:"撤回",icon:"el-icon-arrow-left",onClick:s[0]||(s[0]=p=>b(u)(b(a)-1))},null,8,["disabled"]),g(n,{disabled:b(a)===b(m).length-1,title:"重做",icon:"el-icon-arrow-right",onClick:s[1]||(s[1]=p=>b(u)(b(a)+1))},null,8,["disabled"]),g(n,{disabled:!((d=b(o).children)!=null&&d.length),title:"清空",icon:"el-icon-delete",onClick:s[2]||(s[2]=p=>b(r)())},null,8,["disabled"])]}),_:1})]),_:1}),g(h,{span:8,style:{"text-align":"center"}},{default:x(()=>[g(C,{modelValue:b(t),"onUpdate:modelValue":s[3]||(s[3]=d=>Q(t)?t.value=d:null),size:"small",style:{"font-size":"unset"}},{default:x(()=>[(D(),M(B,null,N(i,d=>g(O,{key:d.value,label:d.value},{default:x(()=>[g(_,{title:d.label,icon:d.icon,underline:!1,style:{color:"inherit"},onClick:p=>t.value=d.value},null,8,["title","icon","onClick"])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1}),g(h,{span:8,style:{"text-align":"right"}},{default:x(()=>[g(C,{modelValue:b(e),"onUpdate:modelValue":s[4]||(s[4]=d=>Q(e)?e.value=d:null),size:"small",style:{"font-size":"unset"}},{default:x(()=>[(D(),M(B,null,N(f,d=>g(O,{key:d.value,label:d.value},{default:x(()=>[g(_,{title:d.label,icon:d.icon,underline:!1,style:{color:"inherit"},onClick:p=>e.value=d.value},null,8,["title","icon","onClick"])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),Sl=I({__name:"index",props:{modelValue:{},groupList:{},resources:{},baseOption:{},advanceOption:{},leftWidth:{},rightWidth:{},adapterIn:{type:Function,default:re},adapterOut:{type:Function,default:he}},emits:["reset"],setup(l,{emit:o}){const e=l,{workType:t,deviceType:m}=mt(e,o);return(a,u)=>{const r=V("el-aside"),i=V("el-header"),f=V("el-main"),y=V("el-container");return D(),E(y,{class:"form-design"},{default:x(()=>[g(r,{class:"left-panel",width:a.leftWidth},{default:x(()=>[g(Bt)]),_:1},8,["width"]),g(y,null,{default:x(()=>[g(i,{class:"main-header",height:"auto"},{default:x(()=>[g(Kt)]),_:1}),g(f,{class:"main-workspace"},{default:x(()=>[g(qt,{class:te(`device-${b(m)}`)},null,8,["class"])]),_:1})]),_:1}),de(g(r,{class:"right-panel",width:a.rightWidth},{default:x(()=>[g(Gt)]),_:1},8,["width"]),[[me,b(t)=="design"]])]),_:1})}}});export{bt as ControlSetter,$l as DesignActionMap,Cl as DicDataSetter,El as DicTreeSetter,S as EditorSetter,Sl as FormDesign,Pt as HistoryTypeMap,vt as OnLoadSetter,Al as RulesSetter,$ as SwitchSetter,Pl as ValueSetter,re as adapterIn,he as adapterOut,yt as advance,le as alignDic,je as array,tt as base,Ie as cascader,pe as checkRules,Re as checkbox,se as cloneItem,ht as color,be as copyItem,We as date,Ae as daterange,Pe as dates,Me as datetime,Ue as datetimerange,jl as dic,gt as dynamic,lt as form,ie as getRandomId,_t as group,Se as groupList,ze as icon,P as iconList,Be as img,Vt as input,et as jsonParse,ae as jsonStringify,He as month,Fe as monthrange,wt as number,kt as password,Ee as placementDic,Il as positionDic,Ne as radio,Tt as rate,qe as select,Rl as sizeDic,xt as slider,Dt as switch,Ct as table,$t as textarea,Ge as time,Ke as timerange,St as title,Je as tree,Ot as upload,Qe as url,Xe as week,Ye as year};
