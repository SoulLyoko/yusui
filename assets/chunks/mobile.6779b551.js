import{j as Re}from"./index.288677a1.js";import{I as Ce}from"./iconify.b68073ff.js";import{a as re,e as Ee,f as Me,w as Ie,g as Ge}from"./index.cd412afd.js";import{_ as Je,d as Qe}from"./index.b00b9483.js";import"./index.de24fa99.js";import{d as We}from"./data.4cb21f02.js";import{j as Ye}from"./tree.21d3b17d.js";import"./index.3d38e212.js";import"./vuedraggable.umd.00d46a83.js";import{u as te,m as He}from"./index.es.e5378d01.js";import{e as J,u as Xe}from"./index.ac4ff024.js";import{ab as Ue,g as A,h as j,A as ue,l as _,E as me,$ as Ze,S as qe,Y as Fe,d as Q,J as I,c as R,L as ee,K as H,o as N,b as T,w as C,N as L,a as M,t as G,B as oe,a3 as ge,k as q,R as se,_ as fe,z as et,C as tt,e as E,U as at,O as xe,a5 as lt,D as ot,a9 as st,aa as nt}from"./framework.f01dabf7.js";import{p as rt}from"./pick.2b716c9d.js";import{t as ut,b as ke,f as it}from"./index.fc3eb3b1.js";import{E as le}from"./index.22b43a78.js";import{u as $e}from"./index.386fc70b.js";import{d as ct}from"./differenceBy.08f10c1f.js";import{g as ae}from"./get.c8715fa2.js";function X(e){const{tableOption:t}=W();return Ue({...t,...e})}function pt(e){const{buttonHandler:t,request:l}=W(),{commitTask:y,revokeTask:r,saveDraft:w,startTask:o,terminateTask:f,transferTask:c,withdrawTask:p,rejectTask:k,greenChannel:v}=_e(l),a=A(()=>{const{flowDetail:V,formVariables:D,approvalFormData:n,debug:s,fileIds:i}=e,{flowDeployId:u}=V.value.process??{},{taskId:d,flowInstanceId:m}=V.value.task??{};return{flowDeployId:u,taskId:d,flowInstanceId:m,variables:D.value,debug:s.value,fileIds:i==null?void 0:i.value,...n.value}}),b=()=>a.value.taskId&&a.value.flowInstanceId;return{flow_draft(){if(b())return w(a.value)},flow_pass(){return b()?y(a.value):o(a.value)},flow_revoke(){if(b())return r(a.value)},flow_withdraw(){if(b())return p(a.value)},flow_terminate(){if(b())return f(a.value)},flow_transfer(){if(b())return c(a.value)},flow_reject(){if(b())return k(a.value)},flow_green(){if(b())return v(a.value)},...t==null?void 0:t(e)}}function dt(e){const t=j({});return ue(async()=>{var y;const{formProperty:l}=((y=_(e))==null?void 0:y.properties)||{};l!=null&&l.length&&(await me(),Object.keys(t.value).forEach(r=>{var f,c,p,k;const w=((f=t.value[r])==null?void 0:f.label)||"",o=l==null?void 0:l.find(v=>v.prop===r);if(t.value[r].display=o==null?void 0:o.display,t.value[r].disabled=o==null?void 0:o.disabled,t.value[r].detail=o==null?void 0:o.detail,t.value[r].readonly=o==null?void 0:o.readonly,t.value[r].rules=t.value[r].rules??[],o!=null&&o.required&&((c=t.value[r].rules)!=null&&c.some(v=>v.required)))return null;o!=null&&o.required?(p=t.value[r].rules)==null||p.push({required:!0,message:`${w}为必填项`}):t.value[r].rules=(k=t.value[r].rules)==null?void 0:k.filter(v=>!v.required)}))}),t}const mt={modelValue:{type:Object,default:()=>({})},title:{type:String},flowDetail:{type:Object,default:()=>({})},formLoading:{type:Boolean},submitLoading:{type:Boolean},activeTab:{type:String,default:"formTab"},activeBtn:{type:Object,default:()=>({})},approvalVisible:{type:Boolean},approvalFormData:{type:Object,default:()=>({})},flowKey:{type:String},taskId:{type:String},instanceId:{type:String},formId:{type:String},fileIds:{type:String},permission:{type:Object},afterGetDetail:{type:Function},beforeClick:{type:Function},beforeSubmit:{type:Function},afterSubmit:{type:Function},detail:{type:[Boolean,String],default:!1},debug:{type:[Boolean,String],default:!1}},ft={complete:e=>e},Le=Symbol("flowFormState");function vt(e,t){const l=re(e,void 0,{passive:!0,deep:!0}),{flowDetail:y,modelValue:r,formLoading:w,activeTab:o,afterGetDetail:f}=l,{tabs:c,customForm:p,request:k}=W(),v=j({}),a=A(()=>(c==null?void 0:c.filter(i=>{var d,m,h;const u=(h=(m=(d=y.value)==null?void 0:d.properties)==null?void 0:m.formProperty)==null?void 0:h.find(U=>U.prop===i.prop);return(u==null?void 0:u.display)!==!1}).map(i=>{var d,m;let u=i.component;if(i.prop==="formTab"){const h=p==null?void 0:p[((m=(d=y==null?void 0:y.value)==null?void 0:d.process)==null?void 0:m.formPath)??""];typeof h=="function"?u=Fe(h):h&&(u=h)}return{...i,component:u}}))??[]),b=j();Y()&&Ee(b,{onSwipeEnd(i,u){if(!["left","right"].includes(u))return;const d=a.value.findIndex(h=>h.prop===o.value),m=Me(d+(u==="right"?-1:1),0,a.value.length-1);o.value=a.value[m].prop}});const{getFlowDetail:V}=_e(k);ue(()=>{const{flowKey:i,taskId:u,instanceId:d}=e;!i&&!u&&!d||(w.value=!0,V({flowKey:i,taskId:u,flowInstanceId:d}).then(async m=>{var h;y.value=m.data,r.value=m.data.formData||{},await((h=f==null?void 0:f.value)==null?void 0:h.call(f))}).finally(()=>{w.value=!1}))});const D=A(()=>Object.entries(r.value||{}).filter(([i])=>!i.startsWith("$")).map(([i,u])=>({key:i,value:u}))),n=A(()=>e.detail===!0||e.detail==="true"),s={...l,formData:r,formVariables:D,tabRefs:v,tabList:a,detail:n,tabsRef:b,emit:t};return Ze(Le,s),s}function F(){return qe(Le)}const he=Q({__name:"button-list",emits:["click"],setup(e,{emit:t}){const{userInfo:l,request:y}=W(),{flowDetail:r}=F(),{data:w}=Ke(y).useList();function o(c,p){return c.map(k=>{const v=p.find(b=>b.buttonKey===k.buttonKey);return{...k,...rt(v,["display","approval"])}})}const f=A(()=>{var s,i,u,d;const c=typeof l=="function"?l():l,{assignee:p,status:k}=((s=r.value)==null?void 0:s.task)||{},{createUser:v,flowInstanceId:a,status:b}=((i=r.value)==null?void 0:i.flowInstance)||{},V={true:!0,false:!1,startUser:v==(c==null?void 0:c.userId),assignee:p==(c==null?void 0:c.userId),todo:k==ne.待办,done:k==ne.已办,notstarted:!a,started:!!a,finished:b===pe.已办结,unfinished:b===pe.未办结},{button:D}=((u=r.value)==null?void 0:u.properties)||{};return((d=o(w.value??[],D??[]))==null?void 0:d.filter(m=>{var h,U;return(U=(h=m.display)==null?void 0:h.split(","))==null?void 0:U.every(O=>V[O])}))??[]});return(c,p)=>{const k=I("el-button");return N(!0),R(H,null,ee(f.value,v=>(N(),T(k,{key:v.buttonKey,type:v.buttonType,onClick:a=>t("click",v)},{default:C(()=>[L(_(Ce),{icon:v.icon},null,8,["icon"]),M(" "+G(v.name),1)]),_:2},1032,["type","onClick"]))),128)}}}),bt=Q({__name:"common-comments",props:{modelValue:{}},setup(e){const t=e,{modelValue:l}=re(t),{request:y}=W(),{batchUpdate:r,create:w,remove:o,useList:f}=Kt(y),c=j(!1),{activeBtn:p}=F(),k=A(()=>{var d;return(d=p.value)==null?void 0:d.buttonKey}),{data:v,refresh:a}=f(k),b=A(()=>{var m,h,U;const d=l.value;if(d&&!((m=v.value)!=null&&m.some(O=>O.content===d))){const O=(((U=(h=v.value)==null?void 0:h[0])==null?void 0:U.sort)||1)-1;return[{content:d,sort:O},...v.value||[]]}return v.value});async function V(d){var m;await w({...d,type:(m=p.value)==null?void 0:m.buttonKey}),le.success("添加成功"),a()}async function D(d){await o(d.id),le.success("删除成功"),a()}async function n(d,m){let h=m.parent.data;h=h.map((U,O)=>({id:U.id,sort:O+1})),await r(h),le.success("修改排序成功"),a(),c.value=!1}function s(){c.value=!0}const i=j();async function u(d){var m;l.value=d.content??"",await me(),(m=i.value)==null||m.blur()}return(d,m)=>{const h=I("el-input"),U=I("el-text"),O=I("el-col"),z=I("el-button"),S=I("el-row"),g=I("el-tree"),$=I("el-popover");return N(),T($,{visible:c.value,placement:"bottom",title:"常用意见",width:_(Y)()?"98%":"600px"},{reference:C(()=>[L(h,{ref_key:"inputRef",ref:i,modelValue:_(l),"onUpdate:modelValue":m[0]||(m[0]=K=>oe(l)?l.value=K:null),type:"textarea",placeholder:"请输入意见",rows:"5",onFocus:m[1]||(m[1]=K=>c.value=!0),onBlur:m[2]||(m[2]=K=>c.value=!1)},null,8,["modelValue"])]),default:C(()=>[L(g,{data:b.value,"node-key":"content",draggable:"","allow-drop":(K,P,x)=>x!=="inner",props:{label:"content"},onNodeClick:u,onNodeDrop:n,onNodeDragStart:s},{default:C(({data:K})=>[L(S,{style:{width:"100%"}},{default:C(()=>[L(O,{span:22},{default:C(()=>[L(U,{truncated:"",title:K.content},{default:C(()=>[M(G(K.content),1)]),_:2},1032,["title"])]),_:2},1024),L(O,{span:2},{default:C(()=>[K.id?(N(),T(z,{key:0,type:"danger",size:"small",icon:"el-icon-close",text:"",onClick:ge(P=>D(K),["stop"])},null,8,["onClick"])):(N(),T(z,{key:1,type:"primary",size:"small",icon:"el-icon-plus",text:"",onClick:ge(P=>V(K),["stop"])},null,8,["onClick"]))]),_:2},1024)]),_:2},1024)]),_:1},8,["data","allow-drop"])]),_:1},8,["visible","width"])}}}),_t=Q({__name:"approval-tree",props:{modelValue:{},data:{},autoCheck:{type:Boolean},mode:{}},setup(e){const t=e,{modelValue:l}=re(t),y={element:"ep:flag",post:"ep:share",dept:"ep:share",user:"ep:user"},w={defaultExpandAll:!0,lazy:!0,showCheckbox:!0,nodeKey:"id",load:(a,b)=>{a.level===0?b(f.value):b(a.data.children??[])},onCheck:p,props:{label:"title",class(a){return`node-${a.type}`}}},o=j(),f=A(()=>ut(t.data??[],(a,b,V)=>{const D=$e();return a.taskNodeKey=(V==null?void 0:V.taskNodeKey)??a.taskNodeKey,a.incoming=(V==null?void 0:V.incoming)??a.incoming,a.multiple=(V==null?void 0:V.multiple)??a.multiple,a.parentId=(V==null?void 0:V.id)??a.parentId,{...a,id:D}}));Ie(()=>[f.value,o.value],async()=>{if(!(!o.value||!f.value.length)&&t.autoCheck){const a=c(f.value);a&&v([a])}},{immediate:!0,debounce:100});function c(a){var b;if(a.length===1)return(b=a[0].children)!=null&&b.length?c(a[0].children):a[0]}async function p(a,{checkedNodes:b}){var n;let V=b.filter(s=>s.type==="user");const D=V.some(s=>s.id===a.id);if(f.value.every(s=>!s.multiple)&&D)V=[a];else if(!a.multiple&&D){const u=((n=o.value)==null?void 0:n.getNode(a)).parent.data.children.filter(d=>d.id!==a.id);V=ct(V,u,"id")}v(V)}function k(a){const b=l.value.filter(V=>V.id!==a.id);v(b)}function v(a){var b;l.value=a,(b=o.value)==null||b.setCheckedNodes(a)}return(a,b)=>{const V=I("el-tag"),D=I("Icon"),n=I("el-tree");return N(),R(H,null,[(N(!0),R(H,null,ee(_(l),s=>(N(),T(V,{key:s.id,type:"info",closable:"",onClose:i=>k(s)},{default:C(()=>[M(G(s.title),1)]),_:2},1032,["onClose"]))),128)),L(n,se({ref_key:"treeRef",ref:o,class:["approval-tree",`mode-${a.mode}`],data:f.value},w),{default:C(({data:s})=>[q("div",null,[L(D,{icon:y[s.type]||y.element,style:{display:"inline-block"}},null,8,["icon"]),q("span",null,G(s.title),1)])]),_:1},16,["class","data"])],64)}}});const Ve=fe(_t,[["__scopeId","data-v-9646bed9"]]),yt={key:0},Ne=Q({__name:"assignee-setter",props:{modelValue:{},tableData:{},placeholder:{}},emits:["update:modelValue"],setup(e,{emit:t}){const l=e,y=A({get(){return typeof l.modelValue=="string"?l.modelValue?l.modelValue.split(","):[]:l.modelValue},set(D){var n;t("update:modelValue",D.join(",")),(n=l.tableData)!=null&&n.row&&(l.tableData.row.values=ke(f.value,s=>D==null?void 0:D.includes(s.id)),l.tableData.row.idVal=l.tableData.row.values.map(s=>s[`${o.value}Id`]).join(","))}}),r=A({get(){return Array.isArray(l.modelValue)?l.modelValue.join(","):l.modelValue},set(D){t("update:modelValue",D)}}),w=j(!1),o=A(()=>{var D,n;return(n=(D=l.tableData)==null?void 0:D.row)==null?void 0:n.type}),f=j([]),c=j([]),{request:p}=W(),{getUserTree:k}=zt(p),{getParam:v}=ie(p);et(o,async D=>{try{if(w.value=!0,["dept","post","user"].includes(D)){const n=await k(D==="user"?"":D);f.value=n.data}else if(o.value==="dynamic"){const n=await v("flow.trends.user");c.value=n.data}}finally{w.value=!1}},{immediate:!0});function a(){y.value=ke(f.value,D=>D.type===o.value).map(D=>D.id)}const b=A(()=>({checkStrictly:o.value!=="user",clearable:!0,collapseTags:!0,collapseTagsTooltip:!0,data:f.value,filterable:!0,loading:w.value,maxCollapseTags:3,multiple:!0,nodeKey:"id",props:{label:"title"},placeholder:"请选择",showCheckbox:!0})),V=A(()=>({clearable:!0,data:c.value,filterable:!0,loading:w.value,nodeKey:"value",props:{label:"title"},placeholder:"请选择"}));return(D,n)=>{const s=I("el-tree-select"),i=I("el-button"),u=I("el-input");return["dept","post","user"].includes(o.value)?(N(),R("div",yt,[L(s,se({modelValue:y.value,"onUpdate:modelValue":n[0]||(n[0]=d=>y.value=d)},b.value,{style:{width:"75%"}}),null,16,["modelValue"]),L(i,{text:"",type:"primary",icon:"el-icon-check",style:{width:"20%"},onClick:a},{default:C(()=>[M(" 全选 ")]),_:1})])):o.value==="dynamic"?(N(),T(s,se({key:1,modelValue:r.value,"onUpdate:modelValue":n[1]||(n[1]=d=>r.value=d)},V.value,{style:{width:"100%"}}),null,16,["modelValue"])):o.value==="userTask"?(N(),T(_(Je),{key:2,modelValue:r.value,"onUpdate:modelValue":n[2]||(n[2]=d=>r.value=d),"filter-type":"userTask",placeholder:"请选择"},null,8,["modelValue"])):(N(),T(u,{key:3,modelValue:r.value,"onUpdate:modelValue":n[3]||(n[3]=d=>r.value=d),clearable:"",placeholder:"请输入"},null,8,["modelValue"]))}}}),wt={key:0,class:"flow-viewer"},gt={key:0,class:"flow-status-legend"},kt={class:"legend-text"},ht=Q({__name:"index",props:{modelValue:{},view:{type:Boolean},flowFormOption:{},flowHistory:{},showLegend:{type:Boolean}},emits:["update:modelValue","nodeClick"],setup(e,{emit:t}){const l=e,y=tt();Ge(y,()=>{var s;(s=y.value)==null||s.on("node:click",i=>t("nodeClick",i))});const r=A({get(){let s=We();return typeof l.modelValue=="string"&&l.modelValue?s=JSON.parse(l.modelValue):typeof l.modelValue=="object"&&Object.keys(l.modelValue)&&(s=l.modelValue),s},set(s){t("update:modelValue",JSON.stringify(s))}}),w=A(()=>{const{column:s=[],group:i=[]}=JSON.parse(l.flowFormOption||"{}");return[...s,...i.map(d=>d.column??[]).flat()]}),{FlowDesign:o,tabs:f,request:c}=W(),{data:p}=Ke(c).useList(),k=A(()=>(f==null?void 0:f.map(s=>({...s,display:!0})))??[]),v=A(()=>{var s;return{formPropertyList:[...w.value,...k.value],buttonList:(s=p.value)==null?void 0:s.filter(i=>i.status===1),fieldsDic:w.value.map(i=>({label:i.label,value:`\${${i.prop}}`,desc:`\${${i.prop}}`})),flowButtonDisplayDic:J(ve),flowButtonApprovalDic:J(be)}}),a=j({}),b=j({});Ie(b,s=>{var i,u,d,m,h,U;s&&((d=(u=(i=s.assignee)==null?void 0:i.children)==null?void 0:u.column)!=null&&d[1]&&(s.assignee.children.column[1].component=Ne),(U=(h=(m=s.circulate)==null?void 0:m.children)==null?void 0:h.column)!=null&&U[1]&&(s.circulate.children.column[1].component=Ne))},{debounce:1});const{data:V}=ie(c).useParam("flow.task.status"),D=A(()=>{var s;return(s=l.flowHistory)==null?void 0:s.map(i=>{var d,m;const u=(m=(d=V.value)==null?void 0:d.find(h=>h.value===i.status))==null?void 0:m.style;return{id:i.taskNodeKey,style:u}})}),n=A(()=>{var s,i;return(i=(s=l.flowHistory)==null?void 0:s.filter(u=>u.taskNodeType==="userTask"))==null?void 0:i.map(u=>{var d;return{id:u.taskNodeKey,content:`<div>${u.assigneeName}</div>
        <div>${u.endTime??""}</div>
        <div>${((d=u.comment)==null?void 0:d.handleComment)??""}</div>`}})});return(s,i)=>s.view?(N(),R("div",wt,[s.showLegend!==!1?(N(),R("div",gt,[(N(!0),R(H,null,ee(_(V),u=>{var d;return N(),R("div",{key:u.label,class:"legend-item"},[q("div",{class:"legend-color",style:at({backgroundColor:(d=u.style)==null?void 0:d.fill})},null,4),q("span",kt,G(u.label),1)])}),128))])):E("",!0),L(_(o),{lf:y.value,"onUpdate:lf":i[0]||(i[0]=u=>y.value=u),"model-value":r.value,styles:D.value,tooltips:n.value,type:"viewer"},null,8,["lf","model-value","styles","tooltips"])])):(N(),T(_(o),{key:1,modelValue:r.value,"onUpdate:modelValue":i[1]||(i[1]=u=>r.value=u),formData:a.value,"onUpdate:formData":i[2]||(i[2]=u=>a.value=u),formDefaults:b.value,"onUpdate:formDefaults":i[3]||(i[3]=u=>b.value=u),"form-options":_(Qe),"data-options":v.value,"form-width":"30%"},null,8,["modelValue","formData","formDefaults","form-options","data-options"]))}});const Te=fe(ht,[["__scopeId","data-v-79c19aa8"]]),Vt=Q({__name:"node-select",props:{modelValue:{}},setup(e){const t=e,{modelValue:l}=re(t),{flowDetail:y}=F(),r=j(!1);function w({data:o}){o.type==="userTask"&&(r.value=!1,l.value=o.id)}return(o,f)=>{const c=I("el-button"),p=I("el-popover");return N(),T(p,{visible:r.value,"onUpdate:visible":f[0]||(f[0]=k=>r.value=k),placement:"bottom-start",width:"800px",trigger:"click"},{reference:C(()=>[L(c,null,{default:C(()=>[M(" 点击选择节点 ")]),_:1})]),default:C(()=>{var k,v;return[L(Te,{"model-value":(v=(k=_(y))==null?void 0:k.process)==null?void 0:v.flowData,view:"",style:{height:"600px"},onNodeClick:w},null,8,["model-value"])]}),_:1},8,["visible"])}}}),Nt=Q({__name:"approval-form",emits:["submit"],setup(e,{emit:t}){const{request:l}=W(),{getApprovalNode:y}=_e(l),{useParam:r}=ie(l),{formData:w,approvalFormData:o,activeBtn:f,approvalVisible:c,formVariables:p,flowDetail:k}=F(),v=j([]),a=j([]),b=j([]),V=j([]),D=j(!1),n=j(!1),s=j(),i=A(()=>{const S=v.value.length,g=b.value.length&&!v.value.length;return{menuBtn:!1,labelWidth:"auto",span:24,column:[{label:"指定节点",prop:"jumpTaskNodeKey",display:u("specifyNode"),rules:[{required:!0,message:"请选择指定节点"}]},{label:"审批人",prop:"assignee",display:u("assignee"),rules:S?[{required:!0,validator:d}]:[]},{label:"传阅人",prop:"circulate",display:u("circulate"),rules:g?[{required:!0,message:"请选择传阅人"}]:[]},{label:"意见",prop:"comment",display:u("comment"),rules:[{required:!0,message:"请填写意见"}]}]}});function u(S){var g,$;return($=(g=f.value)==null?void 0:g.approval)==null?void 0:$.includes(S)}function d(S,g,$){var x,Z,B;const K=((x=v.value[0])==null?void 0:x.type)==="parallelGateway",P=(B=(Z=v.value[0])==null?void 0:Z.children)==null?void 0:B.every(ce=>it([ce],ze=>a.value.some(Be=>Be.id===ze.id)));if(a.value.length){if(K&&!P)return $("请在每个节点选择审批人")}else return $("请选择审批人");return!0}const{data:m}=r("flow.approval.autocheck"),{data:h}=r("flow.approval.autocomment");ue(async()=>{var $,K;if(!c.value||!s.value)return;me(()=>{s.value.resetFields(),o.value.comment=w.value.comment||h.value==="true"&&f.value.name||""});const{taskId:S}=(($=k.value)==null?void 0:$.task)||{},{flowKey:g}=((K=k.value)==null?void 0:K.process)||{};if(U(),!!u("assignee")&&!(u("specifyNode")&&!o.value.jumpTaskNodeKey))try{n.value=!0;const P=await y({flowKey:g,taskId:S,variables:p.value,buttonType:f.value.buttonKey,jumpTaskNodeKey:o.value.jumpTaskNodeKey});v.value=P.data.approvalNodeList,b.value=P.data.circulateNodeList}finally{n.value=!1}});function U(){v.value=[],a.value=[],b.value=[],V.value=[]}async function O(){await Ae(s),D.value=!0;const{data:S,outgoing:g}=z(a.value),{data:$}=z(V.value);o.value.assignee=S,o.value.circulate=$,o.value.outgoing=[...g],t("submit")}function z(S){const g={},$={},K=new Set;return S.forEach(P=>{const{taskNodeKey:x,incoming:Z}=P;g[x]||(g[x]=new Set),P.userId&&g[x].add(P.userId),$[x]=[...g[x]].join(","),Z&&K.add(Z)}),{dataSet:g,data:$,outgoing:K}}return(S,g)=>{const $=I("el-skeleton"),K=I("avue-form"),P=I("el-button");return N(),T(xe(_(Y)()?"el-drawer":"el-dialog"),{modelValue:_(c),"onUpdate:modelValue":g[6]||(g[6]=x=>oe(c)?c.value=x:null),class:"approval-form-overlay",title:_(f).name,"append-to-body":"",width:"900px",size:"50%",direction:"btt"},{footer:C(()=>[L(P,{onClick:g[5]||(g[5]=x=>c.value=!1)},{default:C(()=>[M(" 取 消 ")]),_:1}),L(P,{type:"primary",onClick:O},{default:C(()=>[M(" 确 定 ")]),_:1})]),default:C(()=>[L(K,{ref_key:"formRef",ref:s,modelValue:_(o),"onUpdate:modelValue":g[4]||(g[4]=x=>oe(o)?o.value=x:null),class:"approval-form",option:i.value},{jumpTaskNodeKey:C(()=>[L(Vt,{modelValue:_(o).jumpTaskNodeKey,"onUpdate:modelValue":g[0]||(g[0]=x=>_(o).jumpTaskNodeKey=x)},null,8,["modelValue"])]),assignee:C(()=>[n.value?(N(),T($,{key:0})):(N(),T(Ve,{key:"AssigneeTree",modelValue:a.value,"onUpdate:modelValue":g[1]||(g[1]=x=>a.value=x),data:v.value,"auto-check":_(m)==="true",mode:_(Y)()?"vertical":"horizontal"},null,8,["modelValue","data","auto-check","mode"]))]),circulate:C(()=>[n.value?(N(),T($,{key:0})):(N(),T(Ve,{key:"CirculateTree",modelValue:V.value,"onUpdate:modelValue":g[2]||(g[2]=x=>V.value=x),data:b.value,mode:_(Y)()?"vertical":"horizontal"},null,8,["modelValue","data","mode"]))]),comment:C(()=>[L(bt,{modelValue:_(o).comment,"onUpdate:modelValue":g[3]||(g[3]=x=>_(o).comment=x)},null,8,["modelValue"])]),_:1},8,["modelValue","option"])]),_:1},8,["modelValue","title"])}}});const Dt={class:"flow-form__title"},Ct=Q({__name:"index",props:mt,emits:ft,setup(e,{emit:t}){const y=vt(e,t),{ApprovalForm:r,tabsProps:w}=W(),o=r??Nt,{title:f,detail:c,flowDetail:p,tabRefs:k,tabList:v,activeTab:a,activeBtn:b,formLoading:V,approvalVisible:D,submitLoading:n,beforeClick:s,beforeSubmit:i,afterSubmit:u,tabsRef:d}=y;async function m(O){var z,S;b.value=O;for(const g of Object.values(k.value))await((z=g==null?void 0:g.validate)==null?void 0:z.call(g));await((S=s==null?void 0:s.value)==null?void 0:S.call(s,O)),(O==null?void 0:O.approval)!=="false"?D.value=!0:U()}const h=pt(y);async function U(){var O,z;try{const{buttonKey:S}=b.value;n.value=!0,await((O=i==null?void 0:i.value)==null?void 0:O.call(i,b.value));const g=h[S];g?(await(g==null?void 0:g()),await((z=u==null?void 0:u.value)==null?void 0:z.call(u,b.value)),D.value=!1,t("complete",b.value)):le.error("无法找到相应的操作")}finally{n.value=!1}}return(O,z)=>{const S=I("el-skeleton"),g=I("el-main"),$=I("el-header"),K=I("el-tab-pane"),P=I("el-tabs"),x=I("el-footer"),Z=I("el-container");return _(V)?(N(),T(g,{key:0},{default:C(()=>[L(S)]),_:1})):(N(),T(Z,{key:1,class:"flow-form"},{default:C(()=>[L($,{class:"flow-form__header",height:"auto"},{default:C(()=>{var B;return[q("div",Dt,G(_(f)??((B=_(p).flowInstance)==null?void 0:B.title)),1),!_(c)&&!_(Y)()?(N(),T(he,{key:0,onClick:m})):E("",!0)]}),_:1}),L(g,{class:"flow-form__main"},{default:C(()=>[L(P,se({ref_key:"tabsRef",ref:d,modelValue:_(a),"onUpdate:modelValue":z[0]||(z[0]=B=>oe(a)?a.value=B:null)},_(w)),{default:C(()=>[(N(!0),R(H,null,ee(_(v),B=>(N(),T(K,{key:B.prop,label:B.label,name:B.prop,lazy:B.lazy,disabled:B.disabled,closable:B.closable},{default:C(()=>[(N(),T(xe(B.component),{ref_for:!0,ref:ce=>_(k)[B.prop]=ce},null,512))]),_:2},1032,["label","name","lazy","disabled","closable"]))),128))]),_:1},16,["modelValue"])]),_:1}),!_(c)&&_(Y)()?(N(),T(x,{key:0,class:"flow-form__footer",height:"auto"},{default:C(()=>[L(he,{onClick:m})]),_:1})):E("",!0),L(_(o),{onSubmit:U})]),_:1}))}}});const It=Q({setup(){const{flowDetail:e,formData:t,detail:l}=F(),y=dt(e.value),{proxy:r}=ot(),w=j({});ue(()=>{const{formOption:c}=e.value.process??{};w.value=Ye.bind(r)(c||'{"menuBtn":false}'),w.value.detail=!!l.value});const o=j();function f(){return Ae(o)}return{form:t,option:w,defaults:y,formRef:o,validate:f}},render(){return lt(I("avue-form"),{ref:"formRef",modelValue:this.form,defaults:this.defaults,option:this.option,class:this.option.class,"onUpdate:modelValue":e=>this.form=e,"onUpdate:defaults":e=>this.defaults=e})}}),Ut=Q({__name:"upload-table",setup(e){const{flowDetail:t,fileIds:l,detail:y}=F(),{upload:{action:r,headers:w,preview:o,download:f,props:c}={},request:p}=W(),k=typeof w=="function"?w():w,v=A(()=>{var h,U;return((U=(h=t.value)==null?void 0:h.task)==null?void 0:U.flowInstanceId)??$e()}),a=[{label:"文件名",prop:"fileName"},{label:"文件类型",prop:"fileType"},{label:"文件大小",prop:"fileSize"},{label:"版本",prop:"version"},{label:"上传时间",prop:"createTime"}],b=a.filter(h=>h.prop==="fileName"),V={rowKey:"id",align:"center",index:!1,border:!0,stripe:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuType:"menu",menuBtnTitle:"操作",column:Y()?b:a},{bindVal:D,getDataList:n,handleDel:s,handleSave:i,afterGetList:u,crudStateRefs:{tableData:d}}=Xe({crudOption:{...jt(p),saveSuccessMsg:"上传成功"},tableOption:V,queryForm:{isLatest:1,flowInstanceId:v.value}});u(()=>{l.value=d.value.map(h=>h.id).join(",")}),n();async function m(h,U){var P,x;const{fileName:O,fileType:z,fileSize:S,fileUrl:g,res:$}=c,K={fileName:ae({res:h},`${$}.${O}`),fileType:ae({res:h},`${$}.${z}`),fileSize:ae({res:h},`${$}.${S}`),fileUrl:ae({res:h},`${$}.${g}`),taskId:(x=(P=t.value)==null?void 0:P.task)==null?void 0:x.taskId,flowInstanceId:v.value,rootMark:(U==null?void 0:U.rootMark)||"",version:typeof(U==null?void 0:U.version)=="number"?U.version+1:1};await i(K,n,()=>{})}return(h,U)=>{const O=I("el-button"),z=I("el-upload"),S=I("el-dropdown-item"),g=I("avue-crud");return N(),T(g,st(nt(_(D))),{"menu-left":C(()=>[_(y)?E("",!0):(N(),T(z,{key:0,action:_(r),headers:_(k),"show-file-list":!1,onSuccess:U[0]||(U[0]=$=>m($))},{default:C(()=>[L(O,{type:"primary",icon:"el-icon-upload"},{default:C(()=>[M(" 点击上传 ")]),_:1})]),_:1},8,["action","headers"]))]),"menu-btn":C(({row:$,index:K})=>[L(S,{icon:"el-icon-view",onClick:P=>{var x;return(x=_(o))==null?void 0:x($,_(d))}},{default:C(()=>[M(" 预览 ")]),_:2},1032,["onClick"]),L(S,{icon:"el-icon-download",onClick:P=>{var x;return(x=_(f))==null?void 0:x($,_(d))}},{default:C(()=>[M(" 下载 ")]),_:2},1032,["onClick"]),_(y)?E("",!0):(N(),T(S,{key:0,icon:"el-icon-upload"},{default:C(()=>[L(z,{action:_(r),headers:_(k),"show-file-list":!1,onSuccess:P=>m(P,$)},{default:C(()=>[M(" 更新版本 ")]),_:2},1032,["action","headers","onSuccess"])]),_:2},1024)),_(y)?E("",!0):(N(),T(S,{key:1,icon:"el-icon-delete",onClick:P=>_(s)($,K)},{default:C(()=>[M(" 删除 ")]),_:2},1032,["onClick"]))]),_:1},16)}}}),xt={class:"flow-track"},$t={key:0},Lt={key:1},Tt=Q({__name:"flow-track",setup(e){const{flowDetail:t}=F(),l=j(Y()?"timeline":"table"),y=[{label:"table",icon:"ep:grid"},{label:"graph",icon:"ep:picture"},{label:"timeline",icon:"ep:finished"}],r=A(()=>{var p,k,v;return((v=(k=(p=t.value)==null?void 0:p.flowHistory)==null?void 0:k.filter(a=>a.taskNodeType==="userTask"))==null?void 0:v.map(a=>({...a,duration:Re(a.duration)})))??[]}),w={addBtn:!1,menu:!1,border:!0,column:[{label:"节点名称",prop:"taskNodeName"},{label:"处理人",prop:"assigneeName"},{label:"接收时间",prop:"startTime"},{label:"处理时间",prop:"endTime"},{label:"办理时长",prop:"duration"},{label:"操作类型",prop:"type",dicUrl:"/sapier-flow/flow-param/getParam",dicQuery:{paramKey:"flow.handle.type"}},{label:"办理意见",prop:"comment",bind:"comment.handleComment"}]},{request:o}=W(),{data:f}=ie(o).useParam("flow.handle.type");function c(p){var k;return(k=f.value)==null?void 0:k.find(v=>v.value===p)}return(p,k)=>{var i,u,d;const v=I("el-radio-button"),a=I("el-radio-group"),b=I("avue-crud"),V=I("el-card"),D=I("el-timeline-item"),n=I("el-timeline"),s=I("el-empty");return N(),R(H,null,[_(Y)()?E("",!0):(N(),T(a,{key:0,modelValue:l.value,"onUpdate:modelValue":k[0]||(k[0]=m=>l.value=m)},{default:C(()=>[(N(),R(H,null,ee(y,m=>L(v,{key:m.label,label:m.label},{default:C(()=>[L(_(Ce),{icon:m.icon},null,8,["icon"])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])),q("div",xt,[l.value==="table"?(N(),T(b,{key:0,data:r.value,option:w},null,8,["data"])):E("",!0),l.value==="graph"?(N(),T(Te,{key:1,"model-value":(u=(i=_(t))==null?void 0:i.process)==null?void 0:u.flowData,"flow-history":(d=_(t))==null?void 0:d.flowHistory,view:"","show-legend":""},null,8,["model-value","flow-history"])):E("",!0),l.value==="timeline"?(N(),R(H,{key:2},[r.value.length?(N(),T(n,{key:0},{default:C(()=>[(N(!0),R(H,null,ee([...r.value].reverse(),m=>(N(),T(D,{key:m.id,timestamp:m.endTime,placement:"top"},{default:C(()=>[L(V,null,{default:C(()=>{var h,U,O;return[q("div",null,G(m.assigneeName)+" 开始处理 ["+G(m.taskNodeName)+"] 环节 ",1),m.duration?(N(),R("div",$t," 办理时长："+G(m.duration),1)):E("",!0),m.type&&((h=m.comment)!=null&&h.handleComment)?(N(),R("div",Lt,G((U=c(m.type))==null?void 0:U.label)+"意见："+G((O=m.comment)==null?void 0:O.handleComment),1)):E("",!0)]}),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:1})):(N(),T(s,{key:1}))],64)):E("",!0)])],64)}}});const Ot=fe(Tt,[["__scopeId","data-v-a1713c28"]]),St={FlowDesign:{},FormDesign:{},FlowForm:Ct,request:{},tabs:[{label:"审批表单",prop:"formTab",component:It},{label:"附件资料",prop:"fileTab",component:Ut},{label:"流程跟踪",prop:"trackTab",component:Ot}],useFlowFormOptions:{type:"drawer",window:["","flow-form","left=0,top=0,width=1600,height=900"],overlay:{width:"80%",size:"80%",top:"100px",fullscreen:!0,destroyOnClose:!0}},tableOption:{align:"center",border:!0,card:!0,stripe:!0,searchMenuSpan:6,span:24},upload:{props:{fileName:"fileOriginalName",fileType:"fileType",fileSize:"fileSize",fileUrl:"fileUrl",res:"res.data"}}};function Kt(e){const t={list:"/sapier-flow/flow-user-common/list",save:"/sapier-flow/flow-user-common/save",update:"/sapier-flow/flow-user-common/update",remove:"/sapier-flow/flow-user-common/remove",batchUpdate:"/sapier-flow/flow-user-common/batchUpdate"},l=c=>e.get(t.list,{params:{type:c,ascs:"sort"}});return{url:t,getList:l,useList:c=>te(()=>l(c.value).then(p=>p.data.records),{refreshDeps:[c]}),create:c=>e.post(t.save,c),update:c=>e.post(t.update,c),remove:c=>e.post(t.remove,{},{params:{ids:c}}),batchUpdate:c=>e.post(t.batchUpdate,c)}}var Oe=(e=>(e.默认="default",e.主要="primary",e.成功="success",e.警告="warning",e.危险="danger",e.信息="info",e.文字="text",e))(Oe||{}),Pt=(e=>(e.保存草稿="flow_draft",e.发送="flow_pass",e.退回="flow_reject",e.终止="flow_terminate",e.撤销="flow_revoke",e.撤回到发起="flow_withdraw",e.打印="flow_print",e.转办="flow_transfer",e.加签="flow_add_instance",e.减签="flow_del_instance",e.指定回退="flow_rollback",e.绿色通道="flow_green",e))(Pt||{}),ve=(e=>(e.显示="true",e.隐藏="false",e.发起人="startUser",e.处理人="assignee",e.已办="done",e.待办="todo",e.未发起="notstarted",e.已发起="started",e.未办结="unfinished",e.已办结="finished",e))(ve||{}),be=(e=>(e.不显示="false",e.指定节点="specifyNode",e.审批人="assignee",e.传阅人="circulate",e.意见="comment",e))(be||{}),Se=(e=>(e[e.禁用=0]="禁用",e[e.正常=1]="正常",e))(Se||{});function Ke(e){const t={list:"/sapier-flow/dev-button/list",save:"/sapier-flow/dev-button/save",update:"/sapier-flow/dev-button/update",remove:"/sapier-flow/dev-button/remove"},l=f=>e.get(t.list,{params:f});return{url:t,getList:l,useList:()=>te(()=>l({size:-1,ascs:"sort"}).then(f=>f.data.records)),create:f=>e.post(t.save,f),update:f=>e.post(t.update,f),remove:f=>e.post(t.remove,{},{params:{ids:f}})}}function jt(e){const t={list:"/sapier-flow/flow-file/list",save:"/sapier-flow/flow-file/save",remove:"/sapier-flow/flow-file/remove"};return{getList:w=>e.get(t.list,{params:w}),create:w=>e.post(t.save,w),remove:w=>e.post(t.remove,{},{params:{ids:w}})}}function ie(e){const t={list:"/sapier-flow/flow-param/list",save:"/sapier-flow/flow-param/save",update:"/sapier-flow/flow-param/update",remove:"/sapier-flow/flow-param/remove",all:"/sapier-flow/flow-param/getAllParam",key:"/sapier-flow/flow-param/getParam"},l=p=>e.get(t.list,{params:p}),y=()=>e.get(t.all),r=p=>e.get(t.key,{params:{paramKey:p}});return{url:t,getList:l,getAllParam:y,getParam:r,useParam:p=>te(()=>r(p).then(k=>k.data)),create:p=>e.post(t.save,p),update:p=>e.post(t.update,p),remove:p=>e.post(t.remove,{},{params:{ids:p}})}}var ne=(e=>(e[e.已办=1]="已办",e[e.待办=2]="待办",e[e.失败=3]="失败",e[e.撤销=4]="撤销",e[e.终止=5]="终止",e))(ne||{}),pe=(e=>(e[e.已办结=1]="已办结",e[e.未办结=2]="未办结",e[e.已终止=3]="已终止",e))(pe||{}),At=(e=>(e[e.系统执行=1]="系统执行",e[e.用户办理=2]="用户办理",e[e.任务撤销=3]="任务撤销",e[e.任务退回=4]="任务退回",e[e.流程终止=5]="流程终止",e[e.任务转办=6]="任务转办",e[e.绿色通道=7]="绿色通道",e))(At||{});function _e(e){const t={publishList:"/sapier-flow/flow-run/queryPublishFlowList",taskList:"/sapier-flow/flow-run/userTaskList",detail:"/sapier-flow/flow-run/queryPublishFlowDetail",approvalNode:"/sapier-flow/flow-run/queryApprovalNode",start:"/sapier-flow/flow-run/startProcess",commit:"/sapier-flow/flow-run/commitTask",draft:"/sapier-flow/flow-run/saveDraft",revoke:"/sapier-flow/flow-run/revokeTask",terminate:"/sapier-flow/flow-run/terminateFlow",withdraw:"/sapier-flow/flow-run/withdrawToStart",transfer:"/sapier-flow/flow-run/transferTask",reject:"/sapier-flow/flow-run/rollbackTask",green:"/sapier-flow/flow-run/greenTask"},l=n=>e.get(t.detail,{params:n}),y=n=>e.post(t.approvalNode,n),r=n=>e.post(t.start,n),w=n=>e.post(t.commit,n),o=n=>e.post(t.draft,n),f=n=>e.post(t.revoke,n),c=n=>e.post(t.terminate,n),p=n=>e.post(t.withdraw,n),k=n=>e.post(t.transfer,n),v=n=>e.post(t.reject,n),a=n=>e.post(t.green,n),b=()=>e.get(t.publishList);return{url:t,getFlowDetail:l,getApprovalNode:y,startTask:r,commitTask:w,saveDraft:o,revokeTask:f,terminateTask:c,withdrawTask:p,transferTask:k,rejectTask:v,greenChannel:a,getPublishList:b,usePublishList:()=>te(()=>b().then(n=>n.data)),getTaskList:n=>e.get(t.taskList,{params:n})}}function zt(e){const t={tree:"/sapier-flow/flow-user/tree"},l=r=>e.get(t.tree,{params:{filter:r}});return{url:t,getUserTree:l,useUserTree:()=>te(()=>l().then(r=>r.data))}}var ye=(e=>(e.ASSIGN_ID="ASSIGN_ID",e.ASSIGN_UUID="ASSIGN_UUID",e.AUTO="AUTO",e.INPUT="INPUT",e.NONE="NONE",e))(ye||{}),we=(e=>(e.bigint="bigint",e.blob="blob",e.char="char",e.date="date",e.datetime="datetime",e.decimal="decimal",e.double="double",e.enum="enum",e.float="float",e.int="int",e.longblob="longblob",e.longtext="longtext",e.mediumblob="mediumblob",e.mediumint="mediumint",e.mediumtext="mediumtext",e.set="set",e.smallint="smallint",e.text="text",e.time="time",e.timestamp="timestamp",e.tinyblob="tinyblob",e.tinyint="tinyint",e.tinytext="tinytext",e.varbinary="varbinary",e.varchar="varchar",e.year="year",e))(we||{});function sa(e){const t={list:"/sapier-flow/dev-table/list",save:"/sapier-flow/dev-table/save",update:"/sapier-flow/dev-table/update",remove:"/sapier-flow/dev-table/remove",deploy:"/sapier-flow/dev-table/deploy",getFields:"/sapier-flow/dev-table/getTableFields"},l=p=>e.get(t.list,{params:p});return{url:t,getList:l,useList:()=>te(()=>l({size:-1}).then(p=>p.data.records)),create:p=>e.post(t.save,p),update:p=>e.post(t.update,p),remove:p=>e.post(t.remove,{},{params:{ids:p}}),deploy:p=>e.post(t.deploy,p),getFields:p=>e.get(t.getFields,{params:p})}}var Pe=(e=>(e[e.否=0]="否",e[e.是=1]="是",e))(Pe||{});const de=J(Pe),na=J(we),ra=J(ye),Bt=Ue(St);function W(e){return He(Bt,e)}const ua=X({rowKey:"id",labelWidth:150,column:[{label:"按钮名称",prop:"name",search:!0},{label:"按钮标识",prop:"buttonKey",search:!0},{label:"按钮图标",prop:"icon",component:"icon-select"},{label:"按钮类型",prop:"buttonType",type:"select",dicData:J(Oe)},{label:"默认显示条件",prop:"display",type:"select",multiple:!0,dataType:"string",value:"false",dicData:J(ve),tip:"选择多个时,所有条件都满足才显示",labelTip:`显示: 始终显示;<br/>隐藏: 始终隐藏;<br/>
      发起人: 用户为发起人时显示;<br/>处理人: 用户为处理人时显示;<br/>
      已办: 任务状态为已办时显示;<br/>待办: 任务状态为待办时显示;<br/>
      未发起: 流程未发起时显示;<br/>已发起: 流程已发起时显示;<br/>
      未办结: 流程未办结时显示;<br/>已办结: 流程已办结时显示;`},{label:"默认审批窗口显示",prop:"approval",type:"select",multiple:!0,dataType:"string",value:"false",dicData:J(be),labelTip:`不显示: 不显示审批窗口;<br/>指定节点: 显示指定节点选择框(常用于绿色通道等);<br/>
      审批人: 显示审批人选择框;<br/>传阅人: 显示传阅人选择框;<br/>意见: 显示意见输入框;`},{label:"排序",prop:"sort",type:"number",value:0},{label:"状态",prop:"status",type:"switch",value:1,dicData:J(Se)},{label:"按钮预览",prop:"buttonPreview",width:150}]}),je={menuBtn:!1,span:24,column:[{label:"流程名称",prop:"flowName",rules:[{required:!0,message:"请输入流程名称"}]},{label:"流程标识",prop:"flowKey",editDisabled:!0,rules:[{required:!0,message:"请输入流程标识"}]},{label:"流程分类",prop:"categoryId",type:"select",dicUrl:"/sapier-flow/flow-category/list",dicQuery:{size:-1},props:{label:"name",value:"id"}},{label:"流程图标",prop:"flowIcon",component:"icon-select"},{label:"流程描述",prop:"remarks"},{label:"自定义表单",prop:"formPath"},{label:"关联表",prop:"formDataTable",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicUrl:"/sapier-flow/dev-table/list",dicQuery:{size:-1},props:{label:"tableComment",value:"tableName",desc:"tableName",res:"data.records"}},{label:"排序",prop:"sort",type:"number",width:110},{label:"表单设计",prop:"formOption",display:!1,hide:!0},{label:"模型设计",prop:"flowData",display:!1,hide:!0}]},ia=X({rowKey:"flowModuleId",dialogFullscreen:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuWidth:100,menuType:"menu",menuBtnTitle:"操作",column:[...je.column.map((e,t)=>({...e,search:t<2})),{label:"流程主版本",prop:"mainVersion",formatter(e,t){return t?`V${t||""}`:""}}]}),ca=X({rowKey:"flowDeloyId",dialogFullscreen:!0,addBtn:!1,editBtn:!1,delBtn:!1,menuWidth:100,menuType:"menu",menuBtnTitle:"操作",column:[...je.column,{label:"流程版本",prop:"version",formatter(e,t){return t?`V${t||""}`:""}},{label:"是否主版本",prop:"mainVersion",type:"select",dicData:[{label:"否",value:0},{label:"是",value:1}]}]}),pa=X({rowKey:"id",menu:!1,addBtn:!1,column:[{label:"流程名称",prop:"flowName"},{label:"流程标识",prop:"flowKey"},{label:"流程分类",prop:"categoryId",type:"select",search:!0,dicUrl:"/sapier-flow/flow-category/list",props:{label:"name",value:"id"}},{label:"标题",prop:"processTitle",search:!0},{label:"流水号",prop:"serialNumber"},{label:"当前节点",prop:"taskNodeName"},{label:"审批人",prop:"assigneeName"},{label:"申请人",prop:"applyUserName"},{label:"接收时间",prop:"startTime"},{label:"任务状态",prop:"status",type:"select",search:!0,searchValue:ne.待办,dicUrl:"/sapier-flow/flow-param/getParam",dicQuery:{paramKey:"flow.task.status"}}]}),da=X({rowKey:"id",column:[{label:"配置名称",prop:"paramName",search:!0},{label:"配置Key",prop:"paramKey",search:!0},{label:"备注",prop:"remark"},{label:"系统内置",prop:"paramType",type:"switch",dicData:de},{label:"配置值",prop:"paramValue",type:"textarea",maxRows:20,span:24,overHidden:!0}]}),ma=X({rowKey:"id",menu:!1,addBtn:!1,column:[{label:"流程名称",prop:"flowName"},{label:"流程标识",prop:"flowKey"},{label:"流程分类",prop:"categoryId",type:"select",search:!0,dicUrl:"/sapier-flow/flow-category/list",props:{label:"name",value:"id"}},{label:"标题",prop:"processTitle",search:!0},{label:"流水号",prop:"serialNumber"},{label:"当前节点",prop:"taskNodeName"},{label:"审批人",prop:"assigneeName"},{label:"申请人",prop:"applyUserName"},{label:"接收时间",prop:"startTime"}]});const fa=X({rowKey:"id",column:[{label:"流程标识",prop:"flowKey",search:!0},{label:"流程名称",prop:"flowName",search:!0},{label:"流程备注",prop:"remarks"},{label:"排序",prop:"sort"}]}),va=X({rowKey:"id",column:[{label:"表单标识",prop:"formKey",search:!0},{label:"表单名称",prop:"formName",search:!0},{label:"表单备注",prop:"remarks"},{label:"排序",prop:"sort",type:"number"}]}),De=[{label:"字段名称",prop:"name"},{label:"字段备注",prop:"comment"},{label:"字段类型",prop:"type",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:J(we)},{label:"字段长度",prop:"size",type:"number"},{label:"小数位",prop:"point",type:"number"},{label:"默认值",prop:"default"},{label:"是否主键",prop:"primary",type:"switch",dicData:de,value:0},{label:"是否允许为空",prop:"permitNull",type:"switch",dicData:de,value:1}],ba=X({rowKey:"id",dialogFullscreen:!0,column:[{label:"表名",prop:"tableName",search:!0},{label:"表注释",prop:"tableComment",search:!0},{label:"表引擎",prop:"tableEngine"},{label:"表主键策略",prop:"tablePrimary",type:"select",filterable:!0,allowCreate:!0,defaultFirstOption:!0,dicData:J(ye)},{label:"数据库字段",prop:"editFields",hide:!0,type:"dynamic",children:{column:De}},{label:"默认字段",prop:"defaultFields",hide:!0,type:"dynamic",children:{addBtn:!1,delBtn:!1,column:De}}]});function Ae(e){return new Promise((t,l)=>{_(e).validate((r,w,o)=>{r?(w(),t(o)):l(o)})})}function Y(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}export{zt as A,ye as B,St as C,we as D,X as E,Te as F,de as G,At as H,na as I,ra as J,Nt as K,he as L,Ot as M,It as N,Ut as O,pt as P,mt as Q,ft as R,Le as S,ne as T,vt as U,Y as V,Pe as W,Ct as _,dt as a,Ae as b,W as c,Ke as d,ia as e,ca as f,sa as g,je as h,pa as i,da as j,ie as k,ma as l,_e as m,fa as n,va as o,ba as p,Kt as q,Oe as r,Pt as s,ua as t,F as u,ve as v,be as w,Se as x,jt as y,pe as z};
