import{u as L,d as M,v as h,C as x,N as n,M as k,r as G,b as S,E as m,O as g,x as j,y as A,F as R,L as Y,X as W,H as re,V as ee,a3 as F,j as P,a as N,I as ce,B as q,a7 as te,ak as ne,n as oe,q as ue}from"./framework.93e84c5c.js";import{u as H,D as le,_ as pe,a as de,b as me,c as _e}from"./preview.vue_vue_type_script_lang.7add6e2f.js";import{m as Dt,o as xt,d as Ot,e as Tt,f as Et,g as Lt,i as St,n as Mt,p as Rt,r as Ht,s as It,h as Ut,t as jt,j as At,k as Bt,l as Ft}from"./preview.vue_vue_type_script_lang.7add6e2f.js";import{a as fe,c as X,d as ae,V as ve,j as Z,e as he,h as ye}from"./tree.d280af5e.js";import{J as Wt,K as Pt,_ as Nt,L as qt,l as Gt,n as Jt,b as Kt,q as Xt,r as Zt,t as Qt,A as Yt,x as en,B as tn,C as nn,m as on,f as ln,g as an,D as sn,i as rn,o as cn,M as un,v as pn,z as dn,p as mn,k as _n,E as fn,F as vn,s as hn,G as yn,H as bn,I as gn,u as kn,w as wn,y as Cn}from"./tree.d280af5e.js";import{c as J}from"./cloneDeep.6b1411dd.js";import{E as be}from"./index.vue_vue_type_script_setup_true_lang.8b92edfa.js";import{a as se,b as ge,w as ke}from"./index.4f9c758a.js";import{a as we}from"./omitBy.496be11f.js";import{k as Ce}from"./baseGet.f3f2ab16.js";import"./index.e825d1f5.js";import{d as $e}from"./union.c774781a.js";import{s as Q}from"./set.30e920c7.js";import{i as Ve}from"./isEqual.1cc8ee6e.js";import{g as De}from"./get.51c768ca.js";import"./vue.runtime.esm-browser.prod.0ee3bd0e.js";import"./index.da343e5c.js";import"./merge.0f542de0.js";import"./baseSet.84292f44.js";import"./initCloneObject.fb0a9e5d.js";import"./basePickBy.40d88517.js";import"./index.e4b7a9bd.js";import"./use-form-item.f6cd6a08.js";import"./isNil.990ccdb3.js";import"./kebabCase.47021076.js";import"./createCompounder.12670e9b.js";import"./state-local.dd516420.js";import"./getTag.9f0d1dee.js";import"./pick.c38fd284.js";import"./index.07eec42b.js";import"./pickBy.e06d9ce3.js";import"./baseMap.717c06fd.js";function K($,l){const{parentWhiteList:_,parentBlackList:i}=($==null?void 0:$.rules)??{},{childWhiteList:u,childBlackList:a}=(l==null?void 0:l.rules)??{},p=[];if(_&&l){const s=_.includes((l==null?void 0:l.name)??"");p.push(s)}if(i&&l){const s=i.includes((l==null?void 0:l.name)??"");p.push(!s)}if(u){const s=u.includes(($==null?void 0:$.name)??"");p.push(s)}if(a){const s=a.includes(($==null?void 0:$.name)??"");p.push(!s)}return p.every(s=>s)}const kt=L({__name:"index",props:{modelValue:{},setterType:{}},setup($){const _=se($),{modelValue:i}=_,u={column:[{label:"名称",prop:"label"},{label:"值",prop:"value"}]},a={props:{value:"id"},formOption:{column:[{label:"名称",prop:"label"},{label:"值",prop:"value"}]}},p=M({});function s(r,c){r(),setTimeout(()=>{(c==="add"||c==="parentAdd")&&(p.value.id=fe())},100)}const V=(r,c,d)=>d(),y=(r,c,d)=>d(),T=(r,c)=>c();return(r,c)=>{const d=k("avue-tree"),f=k("avue-dynamic");return r.setterType=="tree"?(h(),x(d,{key:0,modelValue:p.value,"onUpdate:modelValue":c[0]||(c[0]=C=>p.value=C),data:n(i),option:a,"before-open":s,onSave:V,onUpdate:y,onDel:T},null,8,["modelValue","data"])):(h(),x(f,{key:1,children:u,"model-value":n(i)||[],"onUpdate:modelValue":c[1]||(c[1]=C=>i.value=C)},null,8,["model-value"]))}}}),xe={class:"resource-list"},Oe={class:"resource-item"},Te=L({__name:"resource",setup($){const{groupList:l,resources:_,elementTree:i,workType:u,setActiveElement:a,recordHistory:p,getResource:s}=H(),V=M(""),y=G(()=>{const c=Object.values(_.value).filter(d=>{const{name:f,title:C,keywords:D}=d,w=[f,C,D].filter(b=>b).join(",");return!d.disabled&&(w==null?void 0:w.includes(V.value))});return l.value.map(d=>({label:d,children:c.filter(f=>f.group===d).map((f,C)=>({...f,priority:f.priority??C})).sort((f,C)=>f.priority-C.priority)})).filter(d=>d.children.length)});function T(c){var f,C;if(u.value!=="design")return;const d=X(c);(C=(f=i.value)==null?void 0:f.children)==null||C.push(d),a(d),p("added")}function r({draggedContext:c,relatedContext:d}){var f;return K(s(c.element.name),s((f=d.component.componentData)==null?void 0:f.name))}return(c,d)=>{const f=k("el-input"),C=k("el-button"),D=k("el-collapse-item"),w=k("el-collapse");return h(),S("div",xe,[m(f,{modelValue:V.value,"onUpdate:modelValue":d[0]||(d[0]=b=>V.value=b),"suffix-icon":"el-icon-search",placeholder:"搜索组件"},null,8,["modelValue"]),m(w,{"model-value":y.value.map(b=>b.label)},{default:g(()=>[(h(!0),S(j,null,A(y.value,b=>(h(),x(D,{key:b.label,title:b.label,name:b.label},{default:g(()=>[m(n(le),{list:b.children,group:{name:"components",pull:"clone",put:!1},clone:n(X),sort:!1,"item-key":"name",move:r},{item:g(({element:t})=>[R("div",Oe,[m(C,{icon:t.icon,onClick:e=>T(t)},{default:g(()=>[Y(W(t.title),1)]),_:2},1032,["icon","onClick"])])]),_:2},1032,["list","clone"])]),_:2},1032,["title","name"]))),128))]),_:1},8,["model-value"])])}}}),Ee=["onMouseover"],Le={class:"item-label"},Se={class:"item-actions"},Me=L({__name:"tree",setup($){const{elementTree:l,activeElement:_,hoverElement:i,setActiveElement:u,recordHistory:a,getResource:p}=H(),s=G(()=>[J(l.value)]);function V(t,e,o){return e.data.isRoot?!1:o==="inner"?K(p(t.data.name),p(e.data.name)):!0}const y=M();re(()=>{var t,e;(e=y.value)==null||e.setCurrentKey((t=_.value)==null?void 0:t.id)});function T(t){u(t)}function r(){l.value=s.value[0]}function c(t){var o;const e=ae(t.data);(o=y.value)==null||o.append(e,t.parent),r(),u(e),a("added")}function d(t){var e;(e=y.value)==null||e.remove(t),r(),u(),a("removed")}function f(t){var e;(e=t.data.children)!=null&&e.length&&(t.data.children.forEach(o=>{var v;return(v=y.value)==null?void 0:v.remove(o)}),r(),u(t.data),a("clear"))}function C(){r(),a("moved")}const D=[{name:"copy",type:"primary",icon:"el-icon-copy-document",handler:c},{name:"delete",type:"danger",icon:"el-icon-delete",handler:d},{name:"clear",type:"warning",icon:"el-icon-folder-delete",handler:f}];function w(t){return D.filter(e=>b(t,e.name))}function b(t,e){const{disabledActions:o,isContainer:v}=p(t.name)??{},E=!(o!=null&&o.includes(e));return e==="clear"?v&&E:E}return(t,e)=>{const o=k("el-link");return h(),x(n(be),{ref_key:"treeRef",ref:y,class:"component-tree","node-key":"id",data:s.value,"default-expand-all":"",draggable:"","expand-on-click-node":!1,"allow-drop":V,onNodeClick:T,onNodeDrop:C},{default:g(({node:v,data:E})=>{var I,O;return[R("div",{class:"tree-item",onMouseover:U=>i.value=E||{},onMouseleave:e[0]||(e[0]=U=>i.value={})},[R("div",Le,W(((I=E.props)==null?void 0:I.label)||((O=n(p)(E.name))==null?void 0:O.title)),1),R("div",Se,[(h(!0),S(j,null,A(w(E),U=>(h(),x(o,ee({key:U.name,underline:!1},U,{onClick:F(B=>U.handler(v),["stop"])}),null,16,["onClick"]))),128))])],40,Ee)]}),_:1},8,["data"])}}}),Re={init:"初始化",added:"添加组件",moved:"移动组件",removed:"删除组件",property:"修改属性",clear:"清空子组件"},wt={copy:"复制",delete:"删除",clear:"清空"},He={class:"history-list"},Ie=["onClick"],Ue=L({__name:"history",setup($){const{historyList:l,historyIndex:_,restoreHistory:i}=H(),u=ge("history-show-source",!1),a={renderValidationDecorations:"off",readOnly:!0},p=G(()=>document.documentElement.className.includes("dark")?"vs-dark":"light");return(s,V)=>{const y=k("el-switch"),T=k("el-tooltip");return h(),S("div",He,[Y(" 显示源码："),m(y,{modelValue:n(u),"onUpdate:modelValue":V[0]||(V[0]=r=>P(u)?u.value=r:null)},null,8,["modelValue"]),(h(!0),S(j,null,A(n(l),(r,c)=>(h(),x(T,{key:r.timestamp,disabled:!n(u),effect:"light",placement:"right"},{content:g(()=>[m(n(ve),{original:n(Z)(n(l)[c-1]),modified:n(Z)(r),theme:p.value,options:a,language:"javascript",width:"800px",height:"600px"},null,8,["original","modified","theme"])]),default:g(()=>[R("div",{class:N(["history-item",{"is-active":c===n(_)}]),onClick:d=>n(i)(c)},[R("span",null,W(n(Re)[r.type]),1),R("span",null,W(new Date(r.timestamp).toLocaleString()),1)],10,Ie)]),_:2},1032,["disabled"]))),128))])}}}),je=L({__name:"index",setup($){const l=[{title:"组件",icon:"el-icon-menu",component:Te},{title:"大纲",icon:"el-icon-operation",component:Me},{title:"历史",icon:"el-icon-clock",component:Ue}];return(_,i)=>{const u=k("el-link"),a=k("el-tab-pane"),p=k("el-tabs");return h(),x(p,{"tab-position":"top",stretch:""},{default:g(()=>[(h(),S(j,null,A(l,s=>m(a,{key:s.title},{label:g(()=>[m(u,{title:s.title,icon:s.icon,underline:!1,style:{color:"inherit"}},null,8,["title","icon"])]),default:g(()=>[(h(),x(ce(s.component)))]),_:2},1024)),64))]),_:1})}}}),Ae={class:"item-actions"},ie=L({__name:"design",props:{list:{},componentData:{}},emits:["update:active","update:list"],setup($,{emit:l}){const _=$,{list:i}=se(_,l,{passive:!0,deep:!0}),{activeElement:u,hoverElement:a,formOption:p,setActiveElement:s,recordHistory:V,getResource:y}=H();function T(e){const o={...J(p.value),span:24,menuBtn:!1},{designOption:v}=y(e.name)??{};if(typeof v=="object")return{...o,...v};if(typeof v=="function")return{...o,...v(e)};{const E=[];return e.props&&E.push({...we(e.props,Ce),span:24}),{...o,column:E}}}function r(e){var o,v;return(o=y(e.name))!=null&&o.isContainer?24:((v=e.props)==null?void 0:v.span)||p.value.span||24}async function c(e){var v;const o=Object.keys(e)[0];o&&(s(),await oe(),s((v=e[o])==null?void 0:v.element),V(o))}function d(e){const o=ae(e);i.value.push(o),s(o),V("added")}function f(e,o){i.value.splice(o,1),s(i.value[o]??i.value[o-1]),V("removed")}function C(e){var o;(o=e.children)!=null&&o.length&&(e.children=[],s(e),V("clear"))}function D({draggedContext:e,relatedContext:o}){var v;return K(y(e.element.name),y((v=o.component.componentData)==null?void 0:v.name))}const w=[{name:"copy",type:"primary",icon:"el-icon-copy-document",handler:d},{name:"delete",type:"danger",icon:"el-icon-delete",handler:f},{name:"clear",type:"warning",icon:"el-icon-folder-delete",handler:C}];function b(e){return w.filter(o=>t(e,o.name))}function t(e,o){const{disabledActions:v,isContainer:E}=y(e.name)??{},I=!(v!=null&&v.includes(o));return o==="clear"?E&&I:I}return(e,o)=>{const v=k("avue-form"),E=k("el-button"),I=k("el-col");return h(),x(n(le),{list:n(i),class:N(["el-row draggable-list",{"is-empty":!n(i).length,"is-root":e.componentData.isRoot}]),group:{name:"components"},"component-data":e.componentData,"item-key":"id",move:D,onChange:c},{item:g(({element:O,index:U})=>[m(I,{class:N(["draggable-item",{"is-active":n(u).id===O.id,"is-hover":n(a).name&&n(a).id===O.id}]),span:r(O),onClick:F(B=>n(s)(O),["stop"]),onMouseover:F(B=>a.value=O||{},["stop"]),onMouseleave:o[0]||(o[0]=F(B=>a.value={},["stop"]))},{default:g(()=>{var B;return[O.name!=="form"?(h(),x(v,{key:0,option:T(O)},null,8,["option"])):q("",!0),(B=n(y)(O.name))!=null&&B.isContainer?(h(),x(ie,{key:1,class:"is-container","component-data":O,list:O.children??[],"onUpdate:list":z=>O.children=z},null,8,["component-data","list","onUpdate:list"])):q("",!0),te(R("div",Ae,[(h(!0),S(j,null,A(b(O),z=>(h(),x(E,ee({key:z.name},z,{circle:"",plain:"",onClick:F(Pe=>z.handler(O,U),["stop"])}),null,16,["onClick"]))),128))],512),[[ne,n(u).id===O.id]])]}),_:2},1032,["class","span","onClick","onMouseover"])]),_:1},8,["list","class","component-data"])}}}),Be=L({__name:"source",setup($){const{modelValue:l,setActiveElement:_}=H();return(i,u)=>(h(),x(n(he),{modelValue:n(l),"onUpdate:modelValue":[u[0]||(u[0]=a=>P(l)?l.value=a:null),u[1]||(u[1]=a=>n(_)())],"value-type":"object"},null,8,["modelValue"]))}}),Fe=L({__name:"index",setup($){const{elementTree:l,workType:_,setActiveElement:i}=H();return(u,a)=>n(_)==="preview"?(h(),x(pe,{key:0})):n(_)==="source"?(h(),x(Be,{key:1})):(h(),x(ie,{key:2,"component-data":n(l),list:n(l).children??[],"onUpdate:list":a[0]||(a[0]=p=>n(l).children=p),onClick:a[1]||(a[1]=F(p=>n(i)(),["stop"]))},null,8,["component-data","list"]))}}),ze=L({__name:"index",setup($){const l=H(),{elementTree:_,activeElement:i,baseOption:u,advanceOption:a,resolveSettings:p,recordHistory:s,getResource:V}=l,y=M(!1),T=M(""),r=M(0),c=M({}),d=M({labelPosition:"left",labelWidth:100,menuBtn:!1,span:24,tabs:!0,group:[]});ue(()=>i.value.id,async()=>{y.value=!0,r.value=0,await oe();const{settings:D,disabledSettings:w}=V(i.value.name)??{},b={label:"基础",prop:"base",column:u.value},t={label:"属性",prop:"component",column:p(D)},e={label:"高级",prop:"advance",column:a.value},o=[b,t,e].filter(v=>!(w!=null&&w.includes(v.prop)));d.value.group=o,T.value=o[0].prop,c.value=J(i.value.props),y.value=!1},{immediate:!0});const f=$e(()=>s("property"),1e3);ke(c,D=>{const w=ye(D,[void 0,null,""],["$"]);if(i.value.isRoot)Q(_.value,"props",w);else{const b=C(_.value,i.value.id)??[];b.length&&!Ve(w,De(_.value,b.concat("props")))&&Q(_.value,b.concat("props"),w)}r.value&&f(),r.value++},{deep:!0,debounce:100});function C(D,w){if(D.id===w)return[];if(D.children)for(const b in D.children){const t=C(D.children[b],w);if(t)return["children",b].concat(t)}}return(D,w)=>{const b=k("avue-form");return y.value?q("",!0):(h(),x(b,{key:0,modelValue:c.value,"onUpdate:modelValue":w[0]||(w[0]=t=>c.value=t),class:"settings-form",option:d.value},null,8,["modelValue","option"]))}}}),We=L({__name:"index",setup($){const{elementTree:l,workType:_,deviceType:i,historyList:u,historyIndex:a,restoreHistory:p,resetHistory:s}=H(),V=[{label:"PC端",value:"pc",icon:"el-icon-monitor"},{label:"移动端",value:"mobile",icon:"el-icon-cellphone"}],y=[{label:"设计",value:"design",icon:"el-icon-brush"},{label:"源码",value:"source",icon:"el-icon-more"},{label:"预览",value:"preview",icon:"el-icon-view"}];return(T,r)=>{const c=k("el-button"),d=k("el-button-group"),f=k("el-col"),C=k("el-link"),D=k("el-radio-button"),w=k("el-radio-group"),b=k("el-row");return h(),x(b,{gutter:20},{default:g(()=>[m(f,{span:8,style:{"align-self":"center"}},{default:g(()=>[m(d,{size:"small"},{default:g(()=>{var t;return[m(c,{disabled:n(a)===0,title:"撤回",icon:"el-icon-arrow-left",onClick:r[0]||(r[0]=e=>n(p)(n(a)-1))},null,8,["disabled"]),m(c,{disabled:n(a)===n(u).length-1,title:"重做",icon:"el-icon-arrow-right",onClick:r[1]||(r[1]=e=>n(p)(n(a)+1))},null,8,["disabled"]),m(c,{disabled:!((t=n(l).children)!=null&&t.length),title:"清空",icon:"el-icon-delete",onClick:r[2]||(r[2]=e=>n(s)())},null,8,["disabled"])]}),_:1})]),_:1}),m(f,{span:8,style:{"text-align":"center"}},{default:g(()=>[m(w,{modelValue:n(i),"onUpdate:modelValue":r[3]||(r[3]=t=>P(i)?i.value=t:null),size:"small",style:{"font-size":"unset"}},{default:g(()=>[(h(),S(j,null,A(V,t=>m(D,{key:t.value,label:t.value},{default:g(()=>[m(C,{title:t.label,icon:t.icon,underline:!1,style:{color:"inherit"},onClick:e=>i.value=t.value},null,8,["title","icon","onClick"])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1}),m(f,{span:8,style:{"text-align":"right"}},{default:g(()=>[m(w,{modelValue:n(_),"onUpdate:modelValue":r[4]||(r[4]=t=>P(_)?_.value=t:null),size:"small",style:{"font-size":"unset"}},{default:g(()=>[(h(),S(j,null,A(y,t=>m(D,{key:t.value,label:t.value},{default:g(()=>[m(C,{title:t.label,icon:t.icon,underline:!1,style:{color:"inherit"},onClick:e=>_.value=t.value},null,8,["title","icon","onClick"])]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),Ct=L({__name:"index",props:{modelValue:{},groupList:{},resources:{},baseOption:{},advanceOption:{},leftWidth:{},rightWidth:{},adapterIn:{type:Function,default:de},adapterOut:{type:Function,default:me}},emits:["reset"],setup($,{emit:l}){const _=$,{workType:i,deviceType:u}=_e(_,l);return(a,p)=>{const s=k("el-aside"),V=k("el-header"),y=k("el-main"),T=k("el-container");return h(),x(T,{class:"form-design"},{default:g(()=>[m(s,{class:"left-panel",width:a.leftWidth},{default:g(()=>[m(je)]),_:1},8,["width"]),m(T,null,{default:g(()=>[m(V,{class:"main-header",height:"auto"},{default:g(()=>[m(We)]),_:1}),m(y,{class:"main-workspace"},{default:g(()=>[m(Fe,{class:N(`device-${n(u)}`)},null,8,["class"])]),_:1})]),_:1}),te(m(s,{class:"right-panel",width:a.rightWidth},{default:g(()=>[m(ze)]),_:1},8,["width"]),[[ne,n(i)=="design"]])]),_:1})}}});export{Dt as ControlSetter,wt as DesignActionMap,kt as DicDataSetter,Wt as DicTreeSetter,he as EditorSetter,Ct as FormDesign,Re as HistoryTypeMap,xt as OnLoadSetter,Pt as RulesSetter,Nt as SwitchSetter,qt as ValueSetter,de as adapterIn,me as adapterOut,Ot as advance,Gt as alignDic,Jt as array,Kt as base,Xt as cascader,K as checkRules,Zt as checkbox,X as cloneItem,Tt as color,ae as copyItem,Qt as date,Yt as daterange,en as dates,tn as datetime,nn as datetimerange,on as dic,Et as dynamic,ln as form,fe as getRandomId,Lt as group,an as groupList,sn as icon,rn as iconList,cn as img,St as input,un as jsonParse,Z as jsonStringify,pn as month,dn as monthrange,Mt as number,Rt as password,mn as placementDic,_n as positionDic,fn as radio,Ht as rate,vn as select,hn as sizeDic,It as slider,Ut as switch,jt as table,At as textarea,yn as time,bn as timerange,Bt as title,gn as tree,Ft as upload,kn as url,wn as week,Cn as year};
